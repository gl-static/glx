(self.webpackChunkchatting_webapp=self.webpackChunkchatting_webapp||[]).push([[631],{77905:(e,t,s)=>{"use strict";s.d(t,{P:()=>w}),s(88674),s(73210),s(23157);var n=s(11106),a=s(80722),i=s(28847),r=s(70493),o=s(89980),l=s(16146),c=s(62696),d=s(44054),h=s(50766),p=s(74838),u=s(34288),m=s(34959),g=s(12266),f=s(74935),E=s(47470),C=s(92337),b=s(89262),_=s(96269),v=s(90747),y=s(84094),M=s(82251),P=s(4205);function w(e,t){return async(s,w)=>{const S=w();let T=e,N=T.indexOf(" ");N<0&&(N=T.length);const R=T.substring(0,N).toLowerCase();switch(T=R+" "+T.substring(N,T.length).trim(),R){case"/search":return s(m._8(T.substring(N+1,T.length))),{data:!0};case"/shortcuts":return E.tq()?{error:{message:(0,f._u)("create_post.shortcutsNotSupported","Keyboard shortcuts are not supported on your device")}}:(u.kk(),{data:!0});case"/leave":{if(t.channel_id&&(t.root_id||t.parent_id))return s(u.Cl("/leave is not supported in reply threads. Use it in the center channel instead.",t.channel_id,t.parent_id)),{data:!0};const e=(0,r.TB)(S)||{};if(e.type===C.gT.PRIVATE_CHANNEL)return u.EK(e),{data:!0};if(e.type===C.gT.DM_CHANNEL||e.type===C.gT.GM_CHANNEL){const t=(0,o.rc)(S);let n,c;e.type===C.gT.DM_CHANNEL?(n=(0,f.aU)(e),c=C.gT.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW):(n=e.id,c=C.gT.Preferences.CATEGORY_GROUP_CHANNEL_SHOW);const d=(0,l.ev)(S),h=(0,r.fG)(S,d),p=(0,l.gm)(S);return b.m.push("".concat(p,"/group/").concat(h)),s((0,i.$A)(t,[{category:c,name:n,user_id:t,value:"false"}])),(0,r.Dp)(S,e.id)&&s((0,a.Dn)(e.id)),{data:!0}}break}case"/settings":return s((0,p.h)({modalId:C.r8.USER_SETTINGS,dialogType:_.Z})),{data:!0};case"/collapse":case"/expand":s(m.ip()),s(m.eY())}if((0,c.D)(S)){const e=()=>w(),n=e=>({error:{message:e}}),a=new v.nr({dispatch:s,getState:e},y.zx,t.channel_id,t.root_id);if(a.isAppCommand(T))try{const{call:e,errorMessage:i}=await a.composeCallFromCommand(T);if(!e)return n(i);const r=await s((0,P.cW)(e,h._L.SUBMIT,y.zx));if(r.error)return n(r.error.error||y.zx.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error."}));const o=r.data;switch(o.type){case h.Bp.OK:return o.markdown&&s((0,P.ex)(o,o.markdown,t)),{data:!0};case h.Bp.FORM:case h.Bp.NAVIGATE:return{data:!0};default:return n((0,f.Us)((0,M.t)("apps.error.responses.unknown_type"),"App response type not supported. Response type: {type}.",{type:o.type}))}}catch(e){return n(e.message||(0,f._u)("apps.error.unknown","Unknown error."))}}let I;try{I=await n.je.executeCommand(T,t)}catch(e){return{error:e}}const O=I.goto_location&&(0,g.lt)(I.goto_location);return"/logout"===T.trim()?(u.gc(O?I.goto_location:"/"),{data:!0}):(I.trigger_id&&s({type:d.bK.RECEIVED_DIALOG_TRIGGER_ID,data:I.trigger_id}),O&&(I.goto_location.startsWith("/")?b.m.push(I.goto_location):I.goto_location.startsWith((0,g.fO)())?b.m.push(I.goto_location.substr((0,g.fO)().length)):window.open(I.goto_location)),{data:!0})}}},73787:(e,t,s)=>{"use strict";function n(e){return async(t,s)=>{const n=s().plugins.components.MessageWillBePosted;if(!n||0===n.length)return{data:e};let a=e;for(const e of n){const t=await e.hook(a);if(t){if(t.error)return{error:t.error};a=t.post}}return{data:a}}}function a(e,t){return async(s,n)=>{const a=n().plugins.components.SlashCommandWillBePosted;if(!a||0===a.length)return{data:{message:e,args:t}};let i=e,r=t;for(const e of a){const t=await e.hook(i,r);if(t){if(t.error)return{error:t.error};if(i=t.message,r=t.args,0===Object.keys(t).length)break}}return{data:{message:i,args:r}}}}s.d(t,{H:()=>n,J:()=>a}),s(88674),s(33948)},49725:(e,t,s)=>{"use strict";s.d(t,{d:()=>r,m:()=>o}),s(88674);var n=s(92405),a=s(47590),i=s(92337);function r(e){return async(t,s)=>{const r=await n.dq(e)(t,s);return r.error&&"api.post.update_post.permissions_time_limit.app_error"===r.error.server_error_id&&t((0,a.H)({type:i.Mw.ANNOUNCEMENT,message:r.error.message},!0)),r}}function o(e,t,s,a,r,o){return async a=>(a({type:i.MF.SELECT_ATTACHMENT_MENU_ACTION,postId:e,data:{[t]:{text:r,value:o}}}),a(n.T(e,t,s,o)),{data:!0})}},10873:(e,t,s)=>{"use strict";s.d(t,{yx:()=>a,v9:()=>i,aw:()=>r,YQ:()=>o});var n=s(92337);function a(e){return{type:n.MF.SET_SHOW_PREVIEW_ON_CREATE_COMMENT,showPreview:e}}function i(e){return{type:n.MF.SET_SHOW_PREVIEW_ON_CREATE_POST,showPreview:e}}function r(e){return{type:n.MF.SET_SHOW_PREVIEW_ON_EDIT_CHANNEL_HEADER_MODAL,showPreview:e}}function o(e){return{type:n.MF.SET_SHOW_PREVIEW_ON_EDIT_POST_MODAL,showPreview:e}}},57006:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var n=s(45697),a=s.n(n),i=s(67294),r=s(44012),o=s(19728),l=s(15558),c=s(74935),d=s(92337),h=s(82251);const p=e=>{const{ariaLabel:t,buttonClass:s,buttonId:n,iconComponent:a,onClick:p,tooltipKey:u,tooltipText:m,isRhsOpen:g}=e,f={flaggedPosts:{class:"text-nowrap",id:"flaggedTooltip",messageID:(0,h.t)("channel_header.flagged"),message:"Saved posts"},pinnedPosts:{class:"pinned-posts",id:"pinnedPostTooltip",messageID:(0,h.t)("channel_header.pinnedPosts"),message:"Pinned posts"},recentMentions:{class:"",id:"recentMentionsTooltip",messageID:(0,h.t)("channel_header.recentMentions"),message:"Recent mentions"},search:{class:"",id:"searchTooltip",messageID:(0,h.t)("channel_header.search"),message:"Search"},channelFiles:{class:"channel-files",id:"channelFilesTooltip",messageID:(0,h.t)("channel_header.channelFiles"),message:"Files trong nhóm"}};let E;var C;let b;return E="plugin"===u&&m?i.createElement(o.Z,{id:"pluginTooltip",className:""},i.createElement("span",null,m)):null==f[C=u]?null:i.createElement(o.Z,{id:f[C].id,className:f[C].class},i.createElement(r.Z,{id:f[C].messageID,defaultMessage:f[C].message})),t&&(b="".concat((0,c._u)(f[u].messageID,f[u].message))),E?i.createElement("div",null,i.createElement(l.Z,{trigger:["hover"],delayShow:d.gT.OVERLAY_TIME_DELAY,placement:"bottom",overlay:g?i.createElement(i.Fragment,null):E},i.createElement("button",{id:n,"aria-label":b,className:s||"channel-header__icon",onClick:p},a))):i.createElement("div",{className:"flex-child"},i.createElement("button",{id:n,className:s||"channel-header__icon",onClick:p},a))};p.propTypes={ariaLabel:a().bool,buttonClass:a().string,buttonId:a().string.isRequired,iconComponent:a().node.isRequired,onClick:a().func.isRequired,tooltipKey:a().string.isRequired,tooltipText:a().node,isRhsOpen:a().bool};const u=p},25350:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var n=s(45697),a=s.n(n),i=s(67294),r=s(19728),o=s(44012),l=s(74935),c=s(15558),d=(s(19601),s(86896));function h(e){const{formatMessage:t}=(0,d.Z)();return i.createElement("span",Object.assign({},e,{"aria-label":t({id:"members_popover.button.message",defaultMessage:"message"}),className:"style--none icon icon__message",tabIndex:-1}),i.createElement("svg",{width:"18px",height:"16px",viewBox:"0 0 18 16",role:"img","aria-label":t({id:"generic_icons.message",defaultMessage:"Message Icon"})},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},i.createElement("g",{transform:"translate(-200.000000, -174.000000)",fill:"inherit"},i.createElement("g",{transform:"translate(200.000000, 174.000000)"},i.createElement("path",{d:"M7.2546625,1.42801356 C10.458475,1.42801356 12.999475,3.24528136 12.999475,5.52023729 C12.9895,8.04188475 10.6062625,9.89326102 7.40245,9.89326102 C7.40245,9.89326102 6.9134125,9.91229831 6.4115125,9.83747119 L5.82535,9.79622373 L5.15335,10.3586169 C4.997425,10.5397356 4.3199125,11.1095322 3.736375,11.4794373 C4.0915375,10.4598847 4.07605,10.1370441 4.07605,10.1370441 L4.1251375,9.49004068 L3.55315,9.19549153 C2.0986375,8.44616271 1.4444875,6.88616271 1.4444875,5.52023729 C1.4444875,3.24528136 4.05085,1.42801356 7.2546625,1.42801356 M7.2546625,0.370386441 C3.465475,0.370386441 0.3944875,2.65829831 0.3944875,5.52023729 C0.3944875,7.3028678 1.2623125,9.20342373 3.0751375,10.1370441 C3.0751375,10.1478847 3.07225,10.1560814 3.07225,10.1679797 C3.07225,10.9426915 2.43175,12.0048136 2.1794875,12.4429356 L2.1805375,12.4429356 C2.1605875,12.4902644 2.148775,12.5420881 2.148775,12.5973492 C2.148775,12.8141627 2.322025,12.9881424 2.5375375,12.9881424 C2.5693,12.9881424 2.6210125,12.9815322 2.6393875,12.9815322 C2.6446375,12.9815322 2.6467375,12.9815322 2.6462125,12.9831186 C3.986275,12.762339 5.9642125,11.2435864 6.2576875,10.8837288 C6.5585125,10.928678 6.761425,10.9358169 7.0136875,10.9358169 C7.120525,10.9358169 7.2347125,10.9342305 7.3696375,10.9342305 C11.1583,10.9342305 14.094625,8.75446102 14.049475,5.52023729 C14.049475,2.65829831 11.0435875,0.370386441 7.2546625,0.370386441"}),i.createElement("path",{d:"M17.2055125,9.79172881 C17.2055125,8.35811525 16.6498,7.26532203 15.2624875,6.4451322 C15.228625,6.82614237 15.120475,7.23517966 15.0031375,7.59477288 C15.8998375,8.21903729 16.1555125,8.85995932 16.1555125,9.79172881 C16.1555125,10.9323797 15.62815,11.7597085 14.40175,12.3919051 L13.879375,12.653139 C13.879375,12.653139 13.9337125,14.0082237 14.0140375,14.3511593 C12.9895,13.5946915 12.6374875,12.9630237 12.6374875,12.9630237 L12.08545,13.0486915 C11.86705,13.0809492 11.276425,13.0812136 11.276425,13.0812136 C9.85,13.0812136 8.7929125,12.7388068 7.8909625,12.0278169 C8.135875,12.0124814 6.42805,12.0132746 6.3899875,12.0468542 C7.4326375,13.3297559 9.1373125,14.1388407 11.276425,14.1388407 C11.3927125,14.1388407 11.49115,14.1398983 11.58355,14.1398983 C11.801425,14.1398983 11.9773,14.1338169 12.237175,14.095478 C12.491275,14.4058915 13.914025,15.7728746 15.0724375,15.9629831 C15.0719125,15.9619254 15.073225,15.9619254 15.078475,15.9619254 C15.0939625,15.9619254 15.13885,15.967478 15.16615,15.967478 C15.3522625,15.967478 15.5024125,15.8167661 15.5024125,15.6293017 C15.5024125,15.5817085 15.49165,15.5367593 15.47485,15.4960407 L15.4759,15.4960407 C15.258025,15.117939 14.9159875,14.0129831 14.9159875,13.3435051 C14.9159875,13.3331932 14.9128375,13.3260542 14.9128375,13.3168 C16.4797,12.5095661 17.2055125,11.3321627 17.2055125,9.79172881"}))))))}function p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class u extends i.PureComponent{render(){let e=null,t="post-menu__item post-menu__item--wide";this.props.commentCount>0?(t+=" post-menu__item--show",e=i.createElement("span",{className:"post-menu__comment-count"},this.props.commentCount)):""!==this.props.searchStyle&&(t=t+" "+this.props.searchStyle);const s=i.createElement(r.Z,{id:"comment-icon-tooltip",className:"hidden-xs"},i.createElement(o.Z,{id:"post_info.comment_icon.tooltip.reply",defaultMessage:"Reply"}));return i.createElement(c.Z,{delayShow:500,placement:"top",overlay:s},i.createElement("button",{id:"".concat(this.props.location,"_commentIcon_").concat(this.props.postId),"aria-label":(0,l._u)("post_info.comment_icon.tooltip.reply","Reply").toLowerCase(),className:t+" "+this.props.extraClass,onClick:this.props.handleCommentClick},i.createElement("span",{className:"d-flex align-items-center"},i.createElement(h,{className:"icon icon--small"}),e)))}}p(u,"propTypes",{location:a().oneOf(["CENTER","SEARCH"]),handleCommentClick:a().func.isRequired,searchStyle:a().string,commentCount:a().number,postId:a().string,extraClass:a().string}),p(u,"defaultProps",{location:"CENTER",searchStyle:"",commentCount:0,extraClass:""})},17293:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});var n=s(14890),a=s(37703),i=s(5977),r=s(34959),o=s(45697),l=s.n(o),c=(s(88674),s(23123),s(15306),s(67294)),d=s(43253),h=s(44012),p=s(47470),u=s(89262);function m(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class g extends c.PureComponent{constructor(e){super(e),m(this,"deletePostBtn",void 0),m(this,"handleDelete",(async()=>{const{actions:e,post:t}=this.props;let s="";const n=await e.deleteAndRemovePost(t),a=(0,i.LX)(this.props.location.pathname,{path:"/:teamName/messages/:username/:postid"}),r=(0,i.LX)(this.props.location.pathname,{path:"/:teamName/group/:channelname/:postid"});if(a?s=a.params.postid:r&&(s=r.params.postid),s===t.id){const e=this.props.location.pathname.split("/").slice(0,-1).join("/");u.m.replace(e)}n.data&&this.onHide()})),m(this,"handleEntered",(()=>{var e,t;null===(e=this.deletePostBtn)||void 0===e||null===(t=e.current)||void 0===t||t.focus()})),m(this,"onHide",(()=>{if(this.setState({show:!1}),!p.tq()){let e;e=this.props.isRHS?document.getElementById("reply_textbox"):document.getElementById("post_textbox"),e&&e.focus()}})),this.deletePostBtn=c.createRef(),this.state={show:!0}}render(){let e="";this.props.commentCount>0&&""===this.props.post.root_id&&(e=c.createElement(h.Z,{id:"delete_post.warning",defaultMessage:"This post has {count, number} {count, plural, one {comment} other {comments}} on it.",values:{count:this.props.commentCount}}));const t=this.props.post.root_id?c.createElement(h.Z,{id:"delete_post.comment",defaultMessage:"Comment"}):c.createElement(h.Z,{id:"delete_post.post",defaultMessage:"Post"});return c.createElement(d.Z,{dialogClassName:"a11y__modal",show:this.state.show,onEntered:this.handleEntered,onHide:this.onHide,onExited:this.props.onHide,enforceFocus:!1,id:"deletePostModal",role:"dialog","aria-labelledby":"deletePostModalLabel"},c.createElement(d.Z.Header,{closeButton:!0},c.createElement(d.Z.Title,{componentClass:"h1",id:"deletePostModalLabel"},c.createElement(h.Z,{id:"delete_post.confirm",defaultMessage:"Confirm {term} Delete",values:{term:t}}))),c.createElement(d.Z.Body,null,c.createElement(h.Z,{id:"delete_post.question",defaultMessage:"Are you sure you want to delete this {term}?",values:{term:t}}),c.createElement("br",null),c.createElement("br",null),e),c.createElement(d.Z.Footer,null,c.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide},c.createElement(h.Z,{id:"delete_post.cancel",defaultMessage:"Cancel"})),c.createElement("button",{ref:this.deletePostBtn,type:"button",autoFocus:!0,className:"btn btn-danger",onClick:this.handleDelete,id:"deletePostModalButton"},c.createElement(h.Z,{id:"delete_post.del",defaultMessage:"Delete"}))))}}m(g,"propTypes",{channelName:l().string.isRequired,teamName:l().string.isRequired,commentCount:l().number.isRequired,isRHS:l().bool.isRequired,onHide:l().func.isRequired,actions:l().shape({deleteAndRemovePost:l().func.isRequired}).isRequired,location:l().shape({pathname:l().string.isRequired}).isRequired});const f=(0,i.EN)((0,a.connect)(null,(function(e){return{actions:(0,n.bindActionCreators)({deleteAndRemovePost:r.tR},e)}}))(g))},38373:(e,t,s)=>{"use strict";s.d(t,{Z:()=>K});var n=s(37703),a=s(14890),i=s(42560),r=s(70493),o=s(89980),l=s(16146),c=s(62696),d=s(50766),h=s(59929),p=s(6171),u=s(55165),m=s(74838),g=s(4205),f=s(34959),E=s(85174),C=s(47667),b=s(12266),_=s(45697),v=s.n(_),y=(s(88674),s(67294)),M=s(94184),P=s.n(M),w=s(44012),S=s(74806),T=s(19728),N=s(2015),R=s(92337),I=s(17293),O=s(15558),L=s(8142),A=s(74935),k=s(80020),x=s(94741),D=s(15240),Z=s(38122);class H extends y.PureComponent{render(){return y.createElement("span",this.props,y.createElement("svg",{width:"14px",height:"4px",viewBox:"0 0 14 4",role:"img","aria-label":"dots horizontal icon"},y.createElement("path",{d:"M10.2 2.00001C10.2 1.56267 10.3547 1.18934 10.664 0.880006C10.984 0.560006 11.3627 0.400006 11.8 0.400006C12.2373 0.400006 12.6107 0.560006 12.92 0.880006C13.24 1.18934 13.4 1.56267 13.4 2.00001C13.4 2.43734 13.24 2.81601 12.92 3.13601C12.6107 3.44534 12.2373 3.60001 11.8 3.60001C11.3627 3.60001 10.984 3.44534 10.664 3.13601C10.3547 2.81601 10.2 2.43734 10.2 2.00001ZM5.4 2.00001C5.4 1.56267 5.55467 1.18934 5.864 0.880006C6.184 0.560006 6.56267 0.400006 7 0.400006C7.43733 0.400006 7.81067 0.560006 8.12 0.880006C8.44 1.18934 8.6 1.56267 8.6 2.00001C8.6 2.43734 8.44 2.81601 8.12 3.13601C7.81067 3.44534 7.43733 3.60001 7 3.60001C6.56267 3.60001 6.184 3.44534 5.864 3.13601C5.55467 2.81601 5.4 2.43734 5.4 2.00001ZM0.6 2.00001C0.6 1.56267 0.754667 1.18934 1.064 0.880006C1.384 0.560006 1.76267 0.400006 2.2 0.400006C2.63733 0.400006 3.01067 0.560006 3.32 0.880006C3.64 1.18934 3.8 1.56267 3.8 2.00001C3.8 2.43734 3.64 2.81601 3.32 3.13601C3.01067 3.44534 2.63733 3.60001 2.2 3.60001C1.76267 3.60001 1.384 3.44534 1.064 3.13601C0.754667 2.81601 0.6 2.43734 0.6 2.00001Z"})))}}var q=s(93183);function j(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class U extends y.PureComponent{constructor(e){super(e),j(this,"editDisableAction",void 0),j(this,"buttonRef",void 0),j(this,"handleEditDisable",(()=>{this.setState({canEdit:!1})})),j(this,"handleFlagMenuItemActivated",(()=>{this.props.isFlagged?this.props.actions.unflagPost(this.props.post.id):this.props.actions.flagPost(this.props.post.id)})),j(this,"handleAddReactionMenuItemActivated",(e=>{e.preventDefault(),this.props.handleAddReactionClick&&this.props.handleAddReactionClick()})),j(this,"copyLink",(()=>{A.vQ("".concat(this.props.currentTeamUrl,"/pl/").concat(this.props.post.id))})),j(this,"handleCopyMessage",(()=>{A.vQ(this.props.post.message)})),j(this,"handlePinMenuItemActivated",(()=>{this.props.post.is_pinned?this.props.actions.unpinPost(this.props.post.id):this.props.actions.pinPost(this.props.post.id)})),j(this,"handleUnreadMenuItemActivated",(e=>{e.preventDefault(),this.props.actions.markPostAsUnread(this.props.post,this.props.location)})),j(this,"handleDeleteMenuItemActivated",(e=>{e.preventDefault();const t={ModalId:R.r8.DELETE_POST,dialogType:I.Z,dialogProps:{post:this.props.post,commentCount:this.props.commentCount,isRHS:this.props.location===R.tY.RHS_ROOT||this.props.location===R.tY.RHS_COMMENT}};this.props.actions.openModal(t)})),j(this,"handleReportPost",(()=>{this.props.actions.setReportPost(this.props.post.id)})),j(this,"handleEditMenuItemActivated",(()=>{this.props.actions.setEditingPost(this.props.post.id,this.props.commentCount,this.props.location===R.tY.CENTER?"post_textbox":"reply_textbox",this.props.post.root_id?A._u("rhs_comment.comment","Comment"):A._u("create_post.post","Post"),this.props.location===R.tY.RHS_ROOT||this.props.location===R.tY.RHS_COMMENT)})),j(this,"tooltip",y.createElement(T.Z,{id:"dotmenu-icon-tooltip",className:"hidden-xs"},y.createElement(w.Z,{id:"post_info.dot_menu.tooltip.more_actions",defaultMessage:"More actions"}))),j(this,"refCallback",(e=>{if(e){var t;const e=null===(t=this.buttonRef.current)||void 0===t?void 0:t.getBoundingClientRect();let s;s=void 0===(null==e?void 0:e.y)?void 0===(null==e?void 0:e.top)?0:null==e?void 0:e.top:null==e?void 0:e.y;const n=window.innerHeight-80,a=s-R.gT.CHANNEL_HEADER_HEIGHT,i=n-(a+R.gT.POST_AREA_HEIGHT);this.setState({openUp:a>i})}})),j(this,"renderDivider",(e=>y.createElement("li",{id:"divider_post_".concat(this.props.post.id,"_").concat(e),className:"MenuItem__divider",role:"menuitem"}))),j(this,"onClickAppBinding",(async e=>{const{post:t,intl:s}=this.props;if(!e.call)return;const n=(0,q.qM)(e.app_id,e.location,this.props.post.channel_id,this.props.teamId,this.props.post.id,this.props.post.root_id),a=(0,q.Zw)(e.call,n,{post:d.JI.ALL}),i=await this.props.actions.doAppCall(a,d._L.SUBMIT,s);if(i.error){const e=i.error,n=e.error||s.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForPost(e,n,t)}const r=i.data;switch(r.type){case d.Bp.OK:r.markdown&&this.props.actions.postEphemeralCallResponseForPost(r,r.markdown,t);break;case d.Bp.NAVIGATE:case d.Bp.FORM:break;default:{const e=s.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:r.type});this.props.actions.postEphemeralCallResponseForPost(r,e,t)}}})),this.editDisableAction=new L.Z(this.handleEditDisable),this.state={openUp:!1,canEdit:e.canEdit&&!e.isReadOnly,canDelete:e.canDelete&&!e.isReadOnly},this.buttonRef=y.createRef()}disableCanEditPostByTime(){const{post:e,isLicensed:t}=this.props,{canEdit:s}=this.state,n=this.props.postEditTimeLimit||R.gT.UNSET_POST_EDIT_TIME_LIMIT;if(s&&t&&n!==String(R.gT.UNSET_POST_EDIT_TIME_LIMIT)){const t=1e3,s=e.create_at+Number(n)*t-A.u3();s>0&&this.editDisableAction.fireAfter(s+t)}}componentDidMount(){this.disableCanEditPostByTime()}static getDerivedStateFromProps(e){return{canEdit:e.canEdit&&!e.isReadOnly,canDelete:e.canDelete&&!e.isReadOnly}}componentWillUnmount(){this.editDisableAction.cancel()}render(){var e;const t=E.Ew(this.props.post),s=A.tq(),n=(null===(e=this.props.pluginMenuItems)||void 0===e?void 0:e.filter((e=>e.filter?e.filter(this.props.post.id):e)).map((e=>e.subMenu?y.createElement(D.Z.ItemSubMenu,{key:e.id+"_pluginmenuitem",id:e.id,postId:this.props.post.id,text:e.text,subMenu:e.subMenu,action:e.action,root:!0}):y.createElement(D.Z.ItemAction,{key:e.id+"_pluginmenuitem",text:e.text,onClick:()=>{e.action&&e.action(this.props.post.id)}}))))||[];let a=[];return this.props.appsEnabled&&this.props.appBindings&&(a=this.props.appBindings.map((e=>{let t;return e.icon&&(t=y.createElement("img",{loading:"lazy",src:e.icon})),y.createElement(D.Z.ItemAction,{text:e.label,key:e.app_id+e.location,onClick:()=>this.onClickAppBinding(e),icon:t})}))),this.state.canDelete||this.state.canEdit||void 0===n||0!==n.length||!t?y.createElement(Z.Z,{onToggle:this.props.handleDropdownOpened},y.createElement(O.Z,{className:"hidden-xs",delayShow:500,placement:"top",overlay:this.tooltip,rootClose:!0},y.createElement("button",{ref:this.buttonRef,id:"".concat(this.props.location,"_button_").concat(this.props.post.id),"aria-label":A._u("post_info.dot_menu.tooltip.more_actions","More actions").toLowerCase(),className:P()("post-menu__item",{"post-menu__item--active":this.props.isMenuOpen}),type:"button","aria-expanded":"false"},y.createElement(H,{className:"icon icon--small"}))),y.createElement(D.Z,{id:"".concat(this.props.location,"_dropdown_").concat(this.props.post.id),openLeft:!0,openUp:this.state.openUp,ref:this.refCallback,ariaLabel:A._u("post_info.menuAriaLabel","Post extra options")},y.createElement(D.Z.ItemAction,{show:!t&&this.props.location===R.tY.CENTER,text:A._u("post_info.reply","Reply"),onClick:this.props.handleCommentClick}),y.createElement(k.Z,{channelId:this.props.post.channel_id,teamId:this.props.teamId,permissions:[N.Z.ADD_REACTION]},y.createElement(D.Z.ItemAction,{show:!1,text:A._u("rhs_root.mobile.add_reaction","Add Reaction"),onClick:this.handleAddReactionMenuItemActivated})),y.createElement(D.Z.ItemAction,{id:"unread_post_".concat(this.props.post.id),show:!t&&!this.props.channelIsArchived&&this.props.location!==R.tY.SEARCH,text:A._u("post_info.unread","Mark as Unread"),onClick:this.handleUnreadMenuItemActivated}),y.createElement(D.Z.ItemAction,{id:"permalink_".concat(this.props.post.id),show:!t,text:A._u("post_info.permalink","Copy Link"),onClick:this.copyLink}),y.createElement(D.Z.ItemAction,{show:s&&!t&&this.props.isFlagged,text:A._u("rhs_root.mobile.unflag","Remove from Saved"),onClick:this.handleFlagMenuItemActivated}),y.createElement(D.Z.ItemAction,{show:s&&!t&&!this.props.isFlagged,text:A._u("rhs_root.mobile.flag","Save"),onClick:this.handleFlagMenuItemActivated}),y.createElement(k.Z,{channelId:this.props.post.channel_id,teamId:this.props.teamId,permissions:[N.Z.USE_CHANNEL_PINPOST]},y.createElement(D.Z.ItemAction,{id:"unpin_post_".concat(this.props.post.id),show:!t&&!this.props.isReadOnly&&this.props.post.is_pinned,text:A._u("post_info.unpin","Unpin"),onClick:this.handlePinMenuItemActivated}),y.createElement(D.Z.ItemAction,{id:"pin_post_".concat(this.props.post.id),show:!t&&!this.props.isReadOnly&&!this.props.post.is_pinned,text:A._u("post_info.pin","Pin"),onClick:this.handlePinMenuItemActivated})),!t&&(this.state.canEdit||this.state.canDelete)&&this.renderDivider("edit"),y.createElement(D.Z.ItemAction,{show:!t&&this.props.location===R.tY.CENTER,text:A._u("post_info.copy","Sao chép"),onClick:this.handleCopyMessage}),y.createElement(D.Z.ItemAction,{id:"edit_post_".concat(this.props.post.id),show:!0,text:A._u("post_info.report","Báo cáo cho Admin"),onClick:this.handleReportPost}),y.createElement(D.Z.ItemAction,{id:"edit_post_".concat(this.props.post.id),show:this.state.canEdit,text:A._u("post_info.edit","Edit"),onClick:this.handleEditMenuItemActivated}),y.createElement(D.Z.ItemAction,{id:"delete_post_".concat(this.props.post.id),show:this.state.canDelete,text:A._u("post_info.del","Delete"),onClick:this.handleDeleteMenuItemActivated,isDangerous:!0}),(void 0!==n&&n.length>0||a.length>0||this.props.components.PostDropdownMenuItem&&this.props.components.PostDropdownMenuItem.length>0)&&this.renderDivider("plugins"),n,a,y.createElement(x.Z,{postId:this.props.post.id,pluggableName:"PostDropdownMenuItem"}))):null}}j(U,"propTypes",{teamId:v().string,location:v().oneOfType([v().oneOf(["CENTER"]),v().oneOf(["RHS_ROOT"]),v().oneOf(["RHS_COMMENT"]),v().oneOf(["SEARCH"]),v().string]),commentCount:v().number,isFlagged:v().bool,handleCommentClick:v().func,handleDropdownOpened:v().func,handleAddReactionClick:v().func,isMenuOpen:v().bool,isReadOnly:v().oneOfType([v().bool,v().oneOf([null])]),pluginMenuItems:v().array,isLicensed:v().bool,postEditTimeLimit:v().string,enableEmojiPicker:v().bool,channelIsArchived:v().bool,currentTeamUrl:v().string,appBindings:v().array,appsEnabled:v().bool.isRequired,components:v().objectOf(v().array).isRequired,actions:v().shape({flagPost:v().func.isRequired,unflagPost:v().func.isRequired,setReportPost:v().func.isRequired,setEditingPost:v().func.isRequired,pinPost:v().func.isRequired,unpinPost:v().func.isRequired,openModal:v().func.isRequired,markPostAsUnread:v().func.isRequired}).isRequired,canEdit:v().bool.isRequired,canDelete:v().bool.isRequired}),j(U,"defaultProps",{commentCount:0,isFlagged:!1,isReadOnly:!1,location:R.tY.CENTER,pluginMenuItems:[],appBindings:[]});const F=(0,S.ZP)(U);function B(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function G(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const V=(0,c.W)(d.NR.POST_MENU_ITEM),K=(0,n.connect)((function(e,t){const{post:s}=t,n=(0,i.lJ)(e),a=(0,i.iE)(e),d=(0,o.rc)(e),u=(0,r.mr)(e,s.channel_id),m=(0,l.kA)(e)||{},g="".concat((0,b.fO)(),"/").concat(m.name),f=(0,c.D)(e),_=!f||(0,h.Ew)(s)||(0,p.mM)(s.id)?void 0:V(e);return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?B(Object(s),!0).forEach((function(t){G(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):B(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({channelIsArchived:(0,C.t2)(u),components:e.plugins.components,postEditTimeLimit:a.PostEditTimeLimit,isLicensed:"true"===n.IsLicensed,teamId:(0,l.ev)(e),pluginMenuItems:e.plugins.components.PostDropdownMenu,canEdit:E.CY(e,s,n,a,u,d),canDelete:E.Rz(e,s,u),currentTeamUrl:g,appBindings:_,appsEnabled:f},t)}),(function(e){return{actions:(0,a.bindActionCreators)({flagPost:f.co,unflagPost:f.xk,setEditingPost:f.Jp,setReportPost:f.Ws,pinPost:f.wy,unpinPost:f.Vn,openModal:m.h,markPostAsUnread:f.VW,doAppCall:g.cW,postEphemeralCallResponseForPost:g.Rv,setThreadFollow:u.NC},e)}}))(F)},97198:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var n,a,i,r=s(37703),o=s(42560),l=s(45697),c=s.n(l),d=(s(15306),s(67294)),h=s(76279),p=s(92337),u=s(74935);class m extends d.PureComponent{render(){const{fileInfo:e}=this.props,t=(0,u.LM)(e.extension);let s;if(t===p.ml.IMAGE){var n;let t="post-image";e.width<p.ZP.THUMBNAIL_WIDTH&&e.height<p.ZP.THUMBNAIL_HEIGHT?t+=" small":t+=" normal";let s=(0,h.Ag)(e.id,null===(n=e.preview_path)||void 0===n?void 0:n.replace("_preview.jpg","_thumb.jpg"));return(0,u.Qf)(e.extension)&&!e.has_preview_image&&(s=(0,h.qm)(e.id)),d.createElement("div",{className:t,style:{backgroundImage:"url(".concat(s,")"),backgroundSize:"cover"}})}return s=e.extension===p.ml.SVG&&this.props.enableSVGs?d.createElement("img",{alt:"file thumbnail image",className:"post-image normal",src:(0,h.qm)(e.id),loading:"lazy"}):d.createElement("div",{className:"file-icon "+(0,u.Wx)(t)}),s}}n=m,a="propTypes",i={enableSVGs:c().bool.isRequired},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i;const g=(0,r.connect)((function(e){return{enableSVGs:"true"===(0,o.iE)(e).EnableSVGs}}))(m)},98543:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var n,a,i,r=s(45697),o=s.n(r),l=s(67294),c=s(19728),d=s(76279),h=s(15558),p=s(1823),u=s(60291),m=s(74935);class g extends l.PureComponent{render(){const{canDownload:e,children:t,compactDisplay:s,fileInfo:n,handleImageClick:a,iconClass:i}=this.props,r=n.name,o=(0,u.eE)(r);let g;return g=s?l.createElement(h.Z,{delayShow:1e3,placement:"top",overlay:l.createElement(c.Z,{id:"file-name__tooltip"},r)},l.createElement("a",{id:"file-attachment-link",href:"#",onClick:a,className:"post-image__name",rel:"noopener noreferrer"},l.createElement(p.Z,{className:"icon"}),o)):e?l.createElement("div",{className:i||"post-image__name"},l.createElement(h.Z,{delayShow:1e3,placement:"top",overlay:l.createElement(c.Z,{id:"file-name__tooltip"},(0,m._u)("view_image_popover.download","Download"))},l.createElement("a",{href:(0,d.gN)(n.id),"aria-label":(0,m._u)("view_image_popover.download","Download").toLowerCase(),download:r,target:"_blank",rel:"noopener noreferrer"},t||o))):l.createElement("span",{className:"post-image__name"},o),g}}n=g,a="propTypes",i={handleImageClick:o().func,compactDisplay:o().bool,canDownload:o().bool,children:o().node,iconClass:o().string},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i},75515:(e,t,s)=>{"use strict";s.d(t,{Z:()=>O});var n=s(37703),a=s(43832),i=s(42560),r=s(6602),o=s(51),l=s(45697),c=s.n(l),d=s(67294),h=s(76279),p=s(92337),u=s(74935),m=s(60291),g=s(98543),f=s(97198);function E(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class C extends d.PureComponent{constructor(e){super(e),E(this,"mounted",!1),E(this,"loadFiles",(()=>{const e=this.props.fileInfo;(0,u.LM)(e.extension)===p.ml.IMAGE?this.setState({loaded:!0}):e.extension===p.ml.SVG&&this.props.enableSVGs&&(0,u.po)((0,h.qm)(e.id),this.handleImageLoaded)})),E(this,"handleImageLoaded",(()=>{this.mounted&&this.setState({loaded:!0})})),E(this,"onAttachmentClick",(e=>{e.preventDefault(),"blur"in e.target&&e.target.blur(),this.props.handleImageClick&&this.props.handleImageClick(this.props.index)})),this.state={loaded:(0,u.LM)(e.fileInfo.extension)!==p.ml.IMAGE,fileInfo:e.fileInfo}}componentDidMount(){this.mounted=!0,this.loadFiles()}static getDerivedStateFromProps(e,t){if(e.fileInfo.id!==t.fileInfo.id){const t=e.fileInfo.extension;return{loaded:(0,u.LM)(t)!==p.ml.IMAGE&&!(e.enableSVGs&&t===p.ml.SVG),fileInfo:e.fileInfo}}return null}componentDidUpdate(e){this.state.loaded||this.props.fileInfo.id===e.fileInfo.id||this.loadFiles()}componentWillUnmount(){this.mounted=!1}render(){const{compactDisplay:e,fileInfo:t}=this.props,s=(0,m.eE)(t.name);let n,a;const i="".concat((0,u._u)("file_attachment.thumbnail","file thumbnail")," ").concat(t.name).toLowerCase();let r;return e||(n=d.createElement("a",{"aria-label":i,className:"post-image__thumbnail",href:"#",onClick:this.onAttachmentClick},this.state.loaded?d.createElement(f.Z,{fileInfo:t}):d.createElement("div",{className:"post-image__load"})),a=d.createElement("div",{className:"post-image__detail_wrapper",onClick:this.onAttachmentClick},d.createElement("div",{className:"post-image__detail"},d.createElement("span",{className:"post-image__name"},s),d.createElement("span",{className:"post-image__type"},t.extension.toUpperCase()),d.createElement("span",{className:"post-image__size"},(0,u.eA)(t.size))))),this.props.canDownloadFiles&&(r=d.createElement(g.Z,{fileInfo:t,compactDisplay:e,canDownload:this.props.canDownloadFiles,handleImageClick:this.onAttachmentClick,iconClass:"post-image__download"},d.createElement("i",{className:"icon icon-download-outline"}))),d.createElement("div",{className:"post-image__column"},n,d.createElement("div",{className:"post-image__details"},a,r))}}E(C,"propTypes",{index:c().number.isRequired,handleImageClick:c().func,compactDisplay:c().bool,canDownloadFiles:c().bool,enableSVGs:c().bool.isRequired});const b=(0,n.connect)((function(e){const t=(0,i.iE)(e);return{canDownloadFiles:(0,m.qL)(t),enableSVGs:"true"===t.EnableSVGs}}))(C);var _=s(14890),v=s(34959),y=s(67844),M=s(42329),P=s(78335);function w(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class S extends d.PureComponent{constructor(e){var t,s;super(e),w(this,"mounted",void 0),w(this,"imageLoaded",(()=>{this.mounted&&this.setState({loaded:!0})})),w(this,"handleImageClick",(e=>{e.preventDefault(),this.setState({showPreviewModal:!0})})),w(this,"showPreviewModal",(()=>{this.setState({showPreviewModal:!1})})),w(this,"toggleEmbedVisibility",(()=>{this.props.actions.toggleEmbedVisibility(this.props.postId)})),this.mounted=!0,this.state={loaded:!1,showPreviewModal:!1,dimensions:{width:(null===(t=e.fileInfo)||void 0===t?void 0:t.width)||0,height:(null===(s=e.fileInfo)||void 0===s?void 0:s.height)||0}}}componentDidMount(){this.mounted=!0}static getDerivedStateFromProps(e,t){var s,n,a;return(null===(s=e.fileInfo)||void 0===s?void 0:s.width)!==t.dimensions.width||e.fileInfo.height!==t.dimensions.height?{dimensions:{width:null===(n=e.fileInfo)||void 0===n?void 0:n.width,height:null===(a=e.fileInfo)||void 0===a?void 0:a.height}}:null}componentWillUnmount(){this.mounted=!1}render(){const{fileInfo:e,compactDisplay:t}=this.props,{loaded:s}=this.state;if(void 0===e)return d.createElement(d.Fragment,null);const{has_preview_image:n,id:a}=e,i=(0,h.qm)(a),r=n?(0,h.iY)(a):i,o=e.height,l=e.width;let c,m="";(l<50||o<50)&&(m="min-preview ",o>l&&(m+="min-preview--portrait ")),t&&(m+=" compact-display");let g="",f={},E={},C="";return(0,u.LM)(e.extension)===p.ml.SVG&&(C="svg",this.state.dimensions.height?f={width:"100%"}:E={height:350,maxWidth:"100%"}),s&&(c=d.createElement(P.Z,{show:this.state.showPreviewModal,onModalDismissed:this.showPreviewModal,fileInfos:[e],postId:this.props.postId}),g="image-fade-in"),d.createElement("div",{className:"file-view--single"},d.createElement("div",{className:"file__image"},this.props.isEmbedVisible&&d.createElement("div",{className:"image-container",style:E},d.createElement("div",{className:"image-loaded ".concat(g," ").concat(C),style:f},d.createElement(M.Z,{onClick:this.handleImageClick,className:m,src:r,dimensions:this.state.dimensions,fileInfo:this.props.fileInfo,onImageLoaded:this.imageLoaded,showLoader:this.props.isEmbedVisible,handleSmallImageContainer:!0}))),c))}}w(S,"propTypes",{postId:c().string.isRequired,isRhsOpen:c().bool.isRequired,compactDisplay:c().bool,isEmbedVisible:c().bool,actions:c().shape({toggleEmbedVisibility:c().func.isRequired}).isRequired}),w(S,"defaultProps",{compactDisplay:!1});const T=(0,n.connect)((function(e){return{isRhsOpen:(0,y.aC)(e)}}),(function(e){return{actions:(0,_.bindActionCreators)({toggleEmbedVisibility:v.bV},e)}}))(S);function N(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class R extends d.PureComponent{constructor(e){super(e),N(this,"handleImageClick",(e=>{this.setState({showPreviewModal:!0,startImgIndex:e})})),N(this,"hidePreviewModal",(()=>{this.setState({showPreviewModal:!1})})),this.state={showPreviewModal:!1,startImgIndex:0}}render(){const{compactDisplay:e,enableSVGs:t,fileInfos:s,fileCount:n,locale:a}=this.props;if(s&&1===s.length){const n=(0,u.LM)(s[0].extension);if(n===p.ml.IMAGE||n===p.ml.SVG&&t)return d.createElement(T,{fileInfo:s[0],isEmbedVisible:this.props.isEmbedVisible,postId:this.props.post.id,compactDisplay:e})}else if(1===n&&this.props.isEmbedVisible)return d.createElement("div",{style:I.minHeightPlaceholder});const i=(0,h.Vi)(s,a),r=[];if(i&&i.length>0)for(let t=0;t<i.length;t++){const s=i[t];r.push(d.createElement(b,{key:s.id,fileInfo:i[t],index:t,handleImageClick:this.handleImageClick,compactDisplay:e}))}else if(n>0)for(let e=0;e<n;e++)r.push(d.createElement("div",{key:"fileCount-".concat(e),className:"post-image__column post-image__column--placeholder"}));return d.createElement(d.Fragment,null,d.createElement("div",{"data-testid":"fileAttachmentList",className:"post-image__columns clearfix"},r),d.createElement(P.Z,{show:this.state.showPreviewModal,onModalDismissed:this.hidePreviewModal,startIndex:this.state.startImgIndex,fileInfos:i,postId:this.props.post.id}))}}N(R,"propTypes",{fileCount:c().number.isRequired,fileInfos:c().array.isRequired,compactDisplay:c().bool,enableSVGs:c().bool,isEmbedVisible:c().bool,locale:c().string.isRequired});const I={minHeightPlaceholder:{minHeight:"385px"}},O=(0,n.connect)((function(){const e=(0,a.Tw)();return function(t,s){const n=s.post?s.post.id:"",a=e(t,n);let l=0;return s.post.metadata&&s.post.metadata.files?l=(s.post.metadata.files||[]).length:s.post.file_ids?l=s.post.file_ids.length:s.post.filenames&&(l=s.post.filenames.length),{enableSVGs:"true"===(0,i.iE)(t).EnableSVGs,fileInfos:a,fileCount:l,isEmbedVisible:(0,o.Y_)(t,s.post.id),locale:(0,r.B)(t)}}}))(R)},13685:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var n=s(37703),a=s(42560),i=s(45697),r=s.n(i),o=(s(33948),s(67294)),l=s(76279),c=s(98543),d=s(92337),h=s(74935),p=(s(56977),s(44012)),u=s(29590),m=s(60291);function g(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class f extends o.PureComponent{constructor(...e){super(...e),g(this,"handleRemove",(()=>{this.props.handleRemove(this.props.clientId)}))}render(){let e,t,s,n=0;const{fileInfo:a,clientId:i}=this.props;if(a){n=a.percent?a.percent:0;const i=" (".concat(n.toFixed(0),"%)"),r=(0,m.s1)(a.type);t=o.createElement("div",{className:"file-icon "+h.Wx(r)}),e=o.createElement(o.Fragment,null,o.createElement(c.Z,{fileInfo:a,compactDisplay:!1,canDownload:!1}),o.createElement("span",{className:"post-image__uploadingTxt"},100===n?o.createElement(p.Z,{id:"create_post.fileProcessing",defaultMessage:"Processing..."}):o.createElement(o.Fragment,null,o.createElement(p.Z,{id:"admin.plugin.uploading",defaultMessage:"Uploading..."}),o.createElement("span",null,i)))),n&&(s=o.createElement(u.Z,{className:"post-image__progressBar",now:n,active:100===n}))}return o.createElement("div",{ref:i,key:i,className:"file-preview post-image__column","data-client-id":i},o.createElement("div",{className:"post-image__thumbnail"},t),o.createElement("div",{className:"post-image__details"},o.createElement("div",{className:"post-image__detail_wrapper"},o.createElement("div",{className:"post-image__detail"},e)),o.createElement("div",null,o.createElement("a",{className:"file-preview__remove",onClick:this.handleRemove},o.createElement("i",{className:"icon icon-close"}))),s))}}function E(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}g(f,"propTypes",{handleRemove:r().func.isRequired,clientId:r().string.isRequired});class C extends o.PureComponent{constructor(...e){super(...e),E(this,"handleRemove",(e=>{this.props.onRemove(e)}))}render(){const e=[];if(this.props.fileInfos.forEach((t=>{const s=h.LM(t.extension);let n,a="file-preview post-image__column";if(s===d.ml.SVG&&this.props.enableSVGs)n=o.createElement("img",{alt:"file preview",className:"post-image normal",src:(0,l.qm)(t.id),loading:"lazy"});else if(s===d.ml.IMAGE){let e="post-image";t.width&&t.width<d.ZP.THUMBNAIL_WIDTH&&t.height&&t.height<d.ZP.THUMBNAIL_HEIGHT?e+=" small":e+=" normal";let s=(0,l.Ag)(t.id);h.Qf(t.extension)&&!t.has_preview_image&&(s=(0,l.qm)(t.id)),n=o.createElement("div",{className:e,style:{backgroundImage:"url(".concat(s,")"),backgroundSize:"cover"}})}else a+=" custom-file",n=o.createElement("div",{className:"file-icon "+h.Wx(s)});e.push(o.createElement("div",{key:t.id,className:a},o.createElement("div",{className:"post-image__thumbnail"},n),o.createElement("div",{className:"post-image__details"},o.createElement("div",{className:"post-image__detail_wrapper"},o.createElement("div",{className:"post-image__detail"},o.createElement(c.Z,{fileInfo:t,compactDisplay:!1,canDownload:!1}),t.extension&&o.createElement("span",{className:"post-image__type"},t.extension.toUpperCase()),o.createElement("span",{className:"post-image__size"},h.eA(t.size)))),o.createElement("div",null,o.createElement("a",{className:"file-preview__remove",onClick:this.handleRemove.bind(this,t.id)},o.createElement("i",{className:"icon icon-close"}))))))})),this.props.uploadsInProgress&&this.props.uploadsProgressPercent){const t=this.props.uploadsProgressPercent;this.props.uploadsInProgress.forEach((s=>{const n=t[s];n&&e.push(o.createElement(f,{key:s,clientId:s,fileInfo:n,handleRemove:this.handleRemove}))}))}return o.createElement("div",{className:"file-preview__container",ref:"container"},e)}}E(C,"propTypes",{enableSVGs:r().bool.isRequired,onRemove:r().func.isRequired,fileInfos:r().array,uploadsInProgress:r().arrayOf(r().string)}),E(C,"defaultProps",{fileInfos:[],uploadsInProgress:[],uploadsProgressPercent:{}});const b=(0,n.connect)((function(e){return{enableSVGs:"true"===(0,a.iE)(e).EnableSVGs}}))(C)},49671:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var n=s(45697),a=s.n(n),i=s(67294),r=s(19728),o=s(44012),l=s(74935),c=s(89262),d=s(12266),h=s(92337),p=s(15558),u=s(15240),m=s(17189),g=s(38122),f=s(97198),E=s(49801),C=s(78335);function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const _=[E.ap.aS,E.ap.o$];class v extends i.PureComponent{constructor(e){super(e),b(this,"jumpToConv",(e=>{e.stopPropagation(),c.m.push("/".concat(this.props.teamName,"/pl/").concat(this.props.fileInfo.post_id))})),b(this,"copyLink",(()=>{(0,l.vQ)("".concat((0,d.fO)(),"/").concat(this.props.teamName,"/pl/").concat(this.props.fileInfo.post_id))})),b(this,"stopPropagation",(e=>{e.stopPropagation()})),b(this,"keepOpen",(e=>{this.setState({keepOpen:e})})),this.state={keepOpen:!1,showPreview:!1}}render(){const{fileInfo:e,channelDisplayName:t,channelType:s}=this.props;let n=t;return s===h.ZP.DM_CHANNEL?n=i.createElement(o.Z,{id:"search_item.file_badge.direct_message",defaultMessage:"Direct Message"}):s===h.ZP.GM_CHANNEL&&(n=i.createElement(o.Z,{id:"search_item.file_badge.group_message",defaultMessage:"Group Message"})),i.createElement("div",{"data-testid":"search-item-container",className:"search-item__container"},i.createElement("button",{className:"FileSearchResultItem"+(this.state.keepOpen?" keep-open":""),onClick:()=>this.setState({showPreview:!0})},i.createElement(f.Z,{fileInfo:e}),i.createElement("div",{className:"fileData"},i.createElement("div",{className:"fileDataName"},e.name),i.createElement("div",{className:"fileMetadata"},n&&i.createElement(m.Z,{className:"file-search-channel-name"},n),i.createElement("span",null,(0,l.eA)(e.size)),i.createElement("span",null," • "),i.createElement(E.ZP,{value:e.create_at,ranges:_}))),i.createElement(p.Z,{delayShow:1e3,placement:"top",overlay:i.createElement(r.Z,{id:"file-name__tooltip"},(0,l._u)("file_search_result_item.more_actions","More Actions"))},i.createElement(g.Z,{onToggle:this.keepOpen,stopPropagationOnToggle:!0},i.createElement("a",{href:"#",className:"action-icon dots-icon"},i.createElement("i",{className:"icon icon-dots-vertical"})),i.createElement(u.Z,{ariaLabel:"file menu",openLeft:!0},i.createElement(u.Z.ItemAction,{onClick:this.jumpToConv,ariaLabel:(0,l._u)("file_search_result_item.open_in_channel","Open in channel"),text:(0,l._u)("file_search_result_item.open_in_channel","Open in channel")}),i.createElement(u.Z.ItemAction,{onClick:this.copyLink,ariaLabel:(0,l._u)("file_search_result_item.copy_link","Copy link"),text:(0,l._u)("file_search_result_item.copy_link","Copy link")})))),i.createElement(p.Z,{delayShow:1e3,placement:"top",overlay:i.createElement(r.Z,{id:"file-name__tooltip"},(0,l._u)("file_search_result_item.download","Download"))},i.createElement("a",{className:"action-icon download-icon",href:"/api/v1/files/".concat(e.id,"?download=1"),onClick:this.stopPropagation},i.createElement("i",{className:"icon icon-download-outline"})))),i.createElement(C.Z,{show:this.state.showPreview,onModalDismissed:()=>this.setState({showPreview:!1}),startIndex:0,fileInfos:[this.props.fileInfo],postId:this.props.fileInfo.post_id}))}}b(v,"propTypes",{channelDisplayName:a().string.isRequired,channelType:a().string.isRequired,teamName:a().string.isRequired})},62788:(e,t,s)=>{"use strict";s.d(t,{Z:()=>V});var n=s(37703),a=s(14890),i=s(42560),r=s(81375),o=s(80569),l=s.n(o),c=s(44054),d=s(47590),h=s(60871),p=s(11106),u=s(74935);function m(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function g(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?m(Object(s),!0).forEach((function(t){f(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function f(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function E(e,t,s,n,a){return n=>(n({type:c.ml.UPLOAD_FILES_REQUEST}),l().post(p.je.getFilesRoute()).set(p.je.getOptions({method:"post"}).headers).field("channel_id",s).field("client_ids",a).attach("files",e,t).accept("application/json"))}function C(e,t,s,n,a,{err:i,res:o}){return(e,t)=>{if(i){let l;l=o&&o.body&&o.body.id?o.body:0!==i.status&&i.status?{message:u._u("channel_loader.unknown_error","We received an unexpected status code from the server.")+" ("+i.status+")"}:{message:u._u("file_upload.generic_error","There was a problem uploading your files.")},(0,h._f)(i,e,t);const p={type:c.ml.UPLOAD_FILES_FAILURE,clientIds:[a],channelId:s,rootId:n,error:i};return e((0,r.$C)([p,(0,d.mF)(i)])),{error:l}}const l=o.body.file_infos.map(((e,t)=>g(g({},e),{},{clientId:o.body.client_ids[t]})));return e((0,r.$C)([{type:c.ml.RECEIVED_UPLOAD_FILES,data:l,channelId:s,rootId:n},{type:c.ml.UPLOAD_FILES_SUCCESS}])),{data:o.body}}}var b=s(6602),_=s(60291),v=(s(19601),s(33948),s(32023),s(23123),s(45697)),y=s.n(v),M=s(67294),P=s(73935),w=s(50049),S=s(44012),T=s(74806),N=s(92337),R=s(8142),I=s(82251),O=s(47470),L=s(14906),A=s(72654),k=s(38122),x=s(15240),D=s(1823);function Z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function H(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(s),!0).forEach((function(t){q(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function q(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const j=(0,w.vU)({limited:{id:(0,I.t)("file_upload.limited"),defaultMessage:"Uploads limited to {count, number} files maximum. Please use additional posts for more files."},filesAbove:{id:(0,I.t)("file_upload.filesAbove"),defaultMessage:"Files above {max}MB could not be uploaded: {filenames}"},fileAbove:{id:(0,I.t)("file_upload.fileAbove"),defaultMessage:"File above {max}MB could not be uploaded: {filename}"},zeroBytesFiles:{id:(0,I.t)("file_upload.zeroBytesFiles"),defaultMessage:"You are uploading empty files: {filenames}"},zeroBytesFile:{id:(0,I.t)("file_upload.zeroBytesFile"),defaultMessage:"You are uploading an empty file: {filename}"},pasted:{id:(0,I.t)("file_upload.pasted"),defaultMessage:"Image Pasted at "},uploadFile:{id:(0,I.t)("file_upload.upload_files"),defaultMessage:"Upload files"}}),U={left:"inherit",right:0,bottom:"100%",top:"auto"};class F extends M.PureComponent{constructor(e){super(e),q(this,"fileUploadSuccess",((e,t,s)=>{if(e){this.props.onFileUpload(e.file_infos,e.client_ids,t,s);const a=Object.assign({},this.state.requests);for(var n=0;n<e.client_ids.length;n++)Reflect.deleteProperty(a,e.client_ids[n]);this.setState({requests:a})}})),q(this,"fileUploadFail",((e,t,s,n)=>{this.props.onUploadError(e,t,s,n)})),q(this,"pluginUploadFiles",(e=>{this.props.onUploadError(null),this.uploadFiles(e)})),q(this,"checkPluginHooksAndUploadFiles",(e=>{this.props.onUploadError(null);let t=Array.from(e).sort(((e,t)=>e.name.localeCompare(t.name,this.props.locale,{numeric:!0})));const s=this.props.pluginFilesWillUploadHooks;for(const e of s){const s=e.hook(t,this.pluginUploadFiles);s.message&&this.props.onUploadError(s.message),t=s.files}t&&this.uploadFiles(t)})),q(this,"uploadFiles",(e=>{const{channelId:t,rootId:s}=this.props,n=N.ZP.MAX_UPLOAD_FILES-this.props.fileCount;let a=0;const i=[],r=[],o=[];for(let l=0;l<e.length&&a<n;l++){if(e[l].size>this.props.maxFileSize){i.push(e[l]);continue}0===e[l].size&&r.push(e[l]);const n=(0,u.Ox)(),c=this.props.actions.uploadFile(e[l],e[l].name,t,s,n);c.on("progress",(t=>{this.props.onUploadProgress({clientId:n,name:e[l].name,percent:t.percent,type:e[l].type})})),c.end(((a,i)=>{const{error:r,data:o}=this.props.actions.handleFileUploadEnd(e[l],e[l].name,t,s,n,{err:a,res:i});r?this.fileUploadFail(r,n,t,s):o&&this.fileUploadSuccess(o,t,s)})),this.setState({requests:H(H({},this.state.requests),{},{[n]:c})}),o.push(n),a+=1}this.props.onUploadStart(o,t);const{formatMessage:l}=this.props.intl,c=[];if(e.length>n&&c.push(l(j.limited,{count:N.ZP.MAX_UPLOAD_FILES})),i.length>1){var d=i.map((e=>e.name)).join(", ");c.push(l(j.filesAbove,{max:this.props.maxFileSize/1048576,filenames:d}))}else i.length>0&&c.push(l(j.fileAbove,{max:this.props.maxFileSize/1048576,filename:i[0].name}));if(r.length>1){var h=r.map((e=>e.name)).join(", ");c.push(l(j.zeroBytesFiles,{filenames:h}))}else r.length>0&&c.push(l(j.zeroBytesFile,{filename:r[0].name}));c.length>0&&this.props.onUploadError(c.join(", "))})),q(this,"handleChange",(e=>{e.target.files.length>0&&(this.checkPluginHooksAndUploadFiles(e.target.files),(0,u.Mb)(e.target)),this.props.onFileUploadChange()})),q(this,"handleDrop",(e=>{if(!this.props.canUploadFiles)return void this.props.onUploadError((0,u._u)("file_upload.disabled","File attachments are disabled."));this.props.onUploadError(null);const t=e.dataTransfer.items||[],s=e.dataTransfer.files,n=[];Array.from(s).forEach(((e,s)=>{const a=t[s];a&&a.webkitGetAsEntry&&(null===a.webkitGetAsEntry()||a.webkitGetAsEntry().isDirectory)||n.push(e)}));const a=e.dataTransfer.types;if(a){if((0,u.z8)(e.dataTransfer))return;if(a.includes&&!a.includes("Files"))return;if(a.contains&&!a.contains("Files"))return}0!==n.length?(n.length&&this.checkPluginHooksAndUploadFiles(n),this.props.onFileUploadChange()):this.props.onUploadError((0,u._u)("file_upload.drag_folder","Folders cannot be uploaded. Please drag all files separately."))})),q(this,"registerDragEvents",((e,t)=>{const s=this,n=document.querySelector(t),a=new R.Z((()=>{n.classList.add("hidden")}));let i={};i=this.props.canUploadFiles?{enter(e){var t=e.detail.dataTransfer;!(0,u.z8)(t)&&(0,u.LK)(t)&&n.classList.remove("hidden")},leave(e){var t=e.detail.dataTransfer;!(0,u.z8)(t)&&(0,u.LK)(t)&&n.classList.add("hidden"),a.cancel()},over(){a.fireAfter(500)},drop(e){n.classList.add("hidden"),a.cancel(),s.handleDrop(e.detail)}}:{drop(e){s.handleDrop(e.detail)}},this.unbindDragsterEvents=function(e,t){const s=()=>{},n={enter:s,leave:s,over:s,drop:s},a=Object.assign(n,t),i=document.querySelector(e);if(!i)return s;let r=!1,o=!1;const l=e=>{if(r)return void(o=!0);r=!0;const t=new CustomEvent("dragster:enter",{detail:e});i.dispatchEvent(t),e.preventDefault()},c=e=>{if(o?o=!1:r&&(r=!1),!r&&!o){const t=new CustomEvent("dragster:leave",{detail:e});i.dispatchEvent(t)}e.preventDefault()},d=e=>{const t=new CustomEvent("dragster:over",{detail:e});i.dispatchEvent(t),e.preventDefault()},h=e=>{if(o?o=!1:r&&(r=!1),!r&&!o){const t=new CustomEvent("dragster:drop",{detail:e});i.dispatchEvent(t)}e.preventDefault()};return i.addEventListener("dragenter",l),i.addEventListener("dragleave",c),i.addEventListener("dragover",d),i.addEventListener("drop",h),i.addEventListener("dragster:enter",a.enter),i.addEventListener("dragster:leave",a.leave),i.addEventListener("dragster:over",a.over),i.addEventListener("dragster:drop",a.drop),()=>{i.removeEventListener("dragenter",l),i.removeEventListener("dragleave",c),i.removeEventListener("dragover",d),i.removeEventListener("drop",h),i.removeEventListener("dragster:enter",a.enter),i.removeEventListener("dragster:leave",a.leave),i.removeEventListener("dragster:over",a.over),i.removeEventListener("dragster:drop",a.drop)}}(e,i)})),q(this,"containsEventTarget",((e,t)=>e&&e.contains(t))),q(this,"pasteUpload",(e=>{const{formatMessage:t}=this.props.intl;if(!e.clipboardData||!e.clipboardData.items||(0,L.hC)(e.clipboardData))return;const s=this.props.getTarget(),n=P.findDOMNode(s);if(!this.containsEventTarget(n,e.target))return;this.props.onUploadError(null);const a=[];for(let t=0;t<e.clipboardData.items.length;t++){const s=e.clipboardData.items[t];"file"===s.kind&&a.push(s)}if(a&&a.length>0){if(!this.props.canUploadFiles)return void this.props.onUploadError((0,u._u)("file_upload.disabled","File attachments are disabled."));e.preventDefault();const s=[];for(let e=0;e<a.length;e++){const n=a[e].getAsFile();if(!n)continue;var i=new Date;let o=i.getHours();o=o<10?"0".concat(o):"".concat(o);let l=i.getMinutes();l=l<10?"0".concat(l):"".concat(l);var r="";n.name?n.name.includes(".")&&(r=n.name.substr(n.name.lastIndexOf("."))):a[e].type.includes("/")&&(r="."+a[e].type.split("/")[1].toLowerCase());const c=t(j.pasted)+i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+" "+o+"-"+l+r,d=new Blob([n],{type:n.type});d.name=c,s.push(d)}s.length>0&&(this.checkPluginHooksAndUploadFiles(s),this.props.onFileUploadChange())}})),q(this,"keyUpload",(e=>{if((0,u._E)(e)&&(0,u.pD)(e,N.ZP.KeyCodes.U)){if(e.preventDefault(),!this.props.canUploadFiles)return void this.props.onUploadError((0,u._u)("file_upload.disabled","File attachments are disabled."));const t="post"===this.props.postType&&"post_textbox"===document.activeElement.id,s="comment"===this.props.postType&&"reply_textbox"===document.activeElement.id;(t||s)&&(this.fileInput.current.focus(),this.fileInput.current.click())}})),q(this,"cancelUpload",(e=>{const t=Object.assign({},this.state.requests),s=t[e];s&&(s.abort(),Reflect.deleteProperty(t,e),this.setState({requests:t}))})),q(this,"handleMaxUploadReached",(e=>{e&&e.preventDefault();const{onUploadError:t}=this.props,{formatMessage:s}=this.props.intl;t(s(j.limited,{count:N.ZP.MAX_UPLOAD_FILES}))})),q(this,"toggleMenu",(e=>{this.setState({menuOpen:e})})),q(this,"handleLocalFileUploaded",(e=>{N.ZP.MAX_UPLOAD_FILES-this.props.fileCount>0?this.props.onClick&&this.props.onClick():this.handleMaxUploadReached(e),this.setState({menuOpen:!1})})),q(this,"simulateInputClick",(e=>{e.preventDefault(),e.stopPropagation(),this.fileInput.current.click()})),this.state={requests:{},menuOpen:!1},this.fileInput=M.createRef()}componentDidMount(){"post"===this.props.postType?this.registerDragEvents(".row.main",".center-file-overlay"):"comment"===this.props.postType&&this.registerDragEvents(".post-right__container",".right-file-overlay"),document.addEventListener("paste",this.pasteUpload),document.addEventListener("keydown",this.keyUpload)}componentWillUnmount(){document.removeEventListener("paste",this.pasteUpload),document.removeEventListener("keydown",this.keyUpload),this.unbindDragsterEvents()}render(){const{formatMessage:e}=this.props.intl;let t=!0;(0,O.k)()&&(t=!1);let s="";(0,O.my)()&&(s="image/*");const n=N.ZP.MAX_UPLOAD_FILES-this.props.fileCount;let a;const i=e({id:"accessibility.button.attachment",defaultMessage:"attachment"});if(0===this.props.pluginFileUploadMethods.length)a=M.createElement("div",null,M.createElement("button",{type:"button",id:"fileUploadButton","aria-label":i,className:"style--none post-action icon icon--attachment",onClick:this.simulateInputClick,onTouchEnd:this.simulateInputClick},M.createElement(D.Z,{className:"d-flex"})),M.createElement("input",{id:"fileUploadInput",tabIndex:"-1","aria-label":e(j.uploadFile),ref:this.fileInput,type:"file",onChange:this.handleChange,onClick:this.handleLocalFileUploaded,multiple:t,accept:s}));else{const n=this.props.pluginFileUploadMethods.map((e=>M.createElement("li",{key:e.pluginId+"_fileuploadpluginmenuitem",onClick:()=>{e.action&&e.action(this.checkPluginHooksAndUploadFiles),this.setState({menuOpen:!1})}},M.createElement("a",{href:"#"},M.createElement("span",{className:"mr-2"},e.icon),e.text))));a=M.createElement("div",null,M.createElement("input",{tabIndex:"-1","aria-label":e(j.uploadFile),ref:this.fileInput,type:"file",className:"file-attachment-menu-item-input",onChange:this.handleChange,onClick:this.handleLocalFileUploaded,multiple:t,accept:s}),M.createElement(k.Z,null,M.createElement("button",{type:"button","aria-label":i,className:"style--none post-action"},M.createElement("div",{id:"fileUploadButton",className:"icon icon--attachment"},M.createElement(D.Z,{className:"d-flex"}))),M.createElement(x.Z,{id:"fileUploadOptions",openLeft:!0,openUp:!0,ariaLabel:e({id:"file_upload.menuAriaLabel",defaultMessage:"Upload type selector"}),customStyles:U},M.createElement("li",null,M.createElement("a",{href:"#",onClick:this.simulateInputClick,onTouchEnd:this.simulateInputClick},M.createElement("span",{className:"mr-2"},M.createElement("i",{className:"fa fa-laptop"})),M.createElement(S.Z,{id:"yourcomputer",defaultMessage:"Your computer"}))),n)))}return this.props.canUploadFiles||(a=null),M.createElement("div",{className:n<=0?" style--none btn-file__disabled":"style--none"},a)}}q(F,"propTypes",{channelId:y().string.isRequired,rootId:y().string,fileCount:y().number.isRequired,getTarget:y().func.isRequired,intl:A.gm.isRequired,locale:y().string.isRequired,onClick:y().func,onFileUpload:y().func,onFileUploadChange:y().func,onUploadError:y().func,onUploadStart:y().func,postType:y().string,maxFileSize:y().number,canUploadFiles:y().bool.isRequired,pluginFileUploadMethods:y().arrayOf(y().object),pluginFilesWillUploadHooks:y().arrayOf(y().object),onUploadProgress:y().func.isRequired,actions:y().shape({uploadFile:y().func.isRequired,handleFileUploadEnd:y().func.isRequired}).isRequired}),q(F,"defaultProps",{pluginFileUploadMethods:[],pluginFilesWillUploadHooks:[]});const B=(0,T.ZP)(F,{forwardRef:!0});B.displayName="injectIntl(FileUpload)";const G=B,V=(0,n.connect)((function(e){const t=(0,i.iE)(e);return{maxFileSize:parseInt(t.MaxFileSize,10),canUploadFiles:(0,_.SI)(t),locale:(0,b.B)(e),pluginFileUploadMethods:e.plugins.components.FileUploadMethod,pluginFilesWillUploadHooks:e.plugins.components.FilesWillUploadHook}}),(function(e){return{actions:(0,a.bindActionCreators)({uploadFile:E,handleFileUploadEnd:C},e)}}),null,{forwardRef:!0})(G)},52881:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var n=s(45697),a=s.n(n),i=(s(33948),s(23123),s(67294)),r=s(44012),o=s(85174);function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c extends i.PureComponent{constructor(...e){super(...e),l(this,"renderSlashCommandError",(()=>{if(!this.props.submittedMessage)return this.props.error.message;const e=this.props.submittedMessage.split(" ")[0];return i.createElement(i.Fragment,null,i.createElement(r.Z,{id:"message_submit_error.invalidCommand",defaultMessage:"Command with a trigger of ''{command}'' not found. ",values:{command:e}}),i.createElement("a",{href:"#",onClick:this.props.handleSubmit},i.createElement(r.Z,{id:"message_submit_error.sendAsMessageLink",defaultMessage:"Click here to send as a message."})))}))}render(){const e=this.props.error;if(!e)return null;let t=e.message;return(0,o.cW)(e)&&(t=this.renderSlashCommandError()),i.createElement("div",{className:"has-error"},i.createElement("label",{className:"control-label"},t))}}l(c,"propTypes",{error:a().shape({}).isRequired,handleSubmit:a().func.isRequired,submittedMessage:a().string});const d=c},83440:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var n=s(37703),a=s(22222),i=s(67556),r=s(26961),o=s(23122);const l=(e,t,s,n,a)=>{const i=s+n;if(a[i]){const s=Object.keys(a[i]);if(s.length)return s.map((s=>(0,o.fw)(e[s],t)))}return[]};(0,a.P1)(i.Rf,r.kl,i.gO,(e=>e.entities.posts.selectedPostId),(e=>e.entities.typing),l);var c=s(45697),d=s.n(c),h=(s(33948),s(67294)),p=s(44012);function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class m extends h.PureComponent{constructor(...e){super(...e),u(this,"getTypingText",(()=>{let e=[],t=0;if(this.props.typingUsers&&(e=[...this.props.typingUsers],t=e.length),0===t)return"";if(1===t)return h.createElement(p.Z,{id:"msg_typing.isTyping",defaultMessage:"{user} is typing...",values:{user:e[0]}});const s=e.pop();return h.createElement(p.Z,{id:"msg_typing.areTyping",defaultMessage:"{users} and {last} are typing...",values:{users:e.join(", "),last:s}})}))}render(){return h.createElement("span",{className:"msg-typing"},this.getTypingText())}}u(m,"propTypes",{typingUsers:d().arrayOf(d().string).isRequired});const g=(0,n.connect)((function(){const e=(0,a.P1)(i.Rf,r.kl,((e,t)=>t.channelId),((e,t)=>t.postId),(e=>e.entities.typing),l);return function(t,s){return{typingUsers:e(t,{channelId:s.channelId,postId:s.postId})}}}))(m)},665:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>fb}),s(4723);var n=s(37703),a=s(14890),i=s(5977),r=s(18493),o=s(80722),l=s(11754),c=s(91925),d=s(26961),h=s(42560),p=s(89980),u=s(16146),m=s(70493),g=s(66527),f=s(12083),E=s(72657),C=s(28823),b=s(15433),_=s(59930),v=s(45697),y=s.n(v),M=(s(88674),s(33948),s(67294)),P=s(31425),w=s.n(P),S=s(58008),T=s(34288),N=s(92337),R=s(47470),I=s(74935),O=s(80868),L=s(391),A=s(94741),k=s(21440),x=s(92405),D=s(74650),Z=s(38348),H=s(74838),q=s(10873),j=s(28645),U=s(34959),F=s(49725),B=s(51),G=(s(73210),s(43253)),V=s(44012),K=s(74806),Y=s(94184),W=s.n(Y),z=s(85174),J=s(72654),X=s(14906),Q=s(17293),$=s(12227),ee=s(49880),te=s(32103),se=s(64501);function ne(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ae=N.gT.KeyCodes;class ie extends M.PureComponent{constructor(e){super(e),ne(this,"setShowPreview",(e=>{this.props.actions.setShowPreview(e)})),ne(this,"getContainer",(()=>this.editModalBody.current)),ne(this,"toggleEmojiPicker",(()=>{this.setState({showEmojiPicker:!this.state.showEmojiPicker}),!this.state.showEmojiPicker&&this.editbox&&this.editbox.focus()})),ne(this,"hideEmojiPicker",(()=>{this.setState({showEmojiPicker:!1}),this.editbox&&this.editbox.focus()})),ne(this,"handleEmojiClick",(e=>{const t=e&&(e.name||e.aliases&&e.aliases[0]);if(t){if(""===this.state.editText)this.setState({editText:":"+t+": "});else{const{editText:e}=this.state,{firstPiece:s,lastPiece:n}=(0,z.Nn)(this.state.caretPosition,e),a=""===s?":".concat(t,": ").concat(n):"".concat(s," :").concat(t,": ").concat(n),i=""===s?":".concat(t,": ").length:"".concat(s," :").concat(t,": ").length,r=this.editbox.getInputBox();this.setState({editText:a,caretPosition:i},(()=>{I.Mq(r,i)}))}this.setState({showEmojiPicker:!1}),this.editbox&&this.editbox.focus()}})),ne(this,"handleGifClick",(e=>{if(""===this.state.editText)this.setState({editText:e});else{const t=/\s+$/.test(this.state.editText)?this.state.editText+e:this.state.editText+" "+e;this.setState({editText:t})}this.setState({showEmojiPicker:!1}),this.editbox.focus()})),ne(this,"getTarget",(()=>this.refs.editPostEmoji)),ne(this,"handlePostError",(e=>{this.state.postError!==e&&this.setState({postError:e})})),ne(this,"handleEdit",(async()=>{if(this.isSaveDisabled())return;const{actions:e,editingPost:t}=this.props,s={message:this.state.editText,id:t.postId,channel_id:t.post.channel_id};if(this.state.postError)return this.setState({errorClass:"animation--highlight"}),void setTimeout((()=>{this.setState({errorClass:null})}),N.gT.ANIMATION_TIMEOUT);if(s.message===(t.post.message_source||t.post.message))return void this.handleHide();const n=t.post.file_ids&&t.post.file_ids.length>0;if(0!==s.message.trim().length||n)e.addMessageIntoHistory(s.message),await e.editPost(s)&&window.scrollTo(0,0),this.handleHide();else{this.handleHide(!1);const e={ModalId:N.r8.DELETE_POST,dialogType:Q.Z,dialogProps:{post:t.post,commentCount:t.commentCount,isRHS:t.isRHS}};this.props.actions.openModal(e)}})),ne(this,"handleChange",(e=>{const t=e.target.value;this.setState({editText:t})})),ne(this,"handlePaste",(e=>{if(!e.clipboardData||!e.clipboardData.items||!this.props.canEditPost||"edit_textbox"!==e.target.id)return;const{clipboardData:t}=e,s=(0,X.hC)(t);if(!s)return;e.preventDefault();const{editText:n}=this.state;let a=n,i=this.state.caretPosition;if((0,X.lw)(s.className)){const{formattedMessage:e,formattedCodeBlock:s}=(0,X.fB)(this.state.caretPosition,a,t);i=this.state.caretPosition+s.length,a=e}else a=(0,X.Kt)(s,n.trim(),i),i=a.length-(n.length-i);this.setState({editText:a,caretPosition:i},(()=>{I.Mq(this.editbox.getInputBox(),i)}))})),ne(this,"handleEditKeyPress",(e=>{const{ctrlSend:t,codeBlockOnCtrlEnter:s}=this.props,{allowSending:n,ignoreKeyPress:a}=(0,z.bp)(e,this.state.editText,t,s,Date.now(),this.lastChannelSwitchAt,this.state.caretPosition);if(a)return e.preventDefault(),void e.stopPropagation();n&&(e.preventDefault(),this.editbox.blur(),this.handleEdit())})),ne(this,"handleMouseUpKeyUp",(e=>{const t=I.qK(e.target);this.setState({caretPosition:t})})),ne(this,"handleSelect",(e=>{I.cf(this.editbox.getInputBox(),e)})),ne(this,"handleKeyDown",(e=>{const{ctrlSend:t,codeBlockOnCtrlEnter:s}=this.props,n=e.ctrlKey||e.metaKey,a=I._E(e)&&!e.altKey&&!e.shiftKey,i=I._E(e,!0)&&e.altKey,r=(t||s)&&I.pD(e,ae.ENTER)&&n,o=I.pD(e,ae.B)||I.pD(e,ae.I),l=I.pD(e,ae.K);I.m(e)?(e.stopPropagation(),this.setState({editText:I.V4(e)})):r?this.handleEdit():I.pD(e,ae.ESCAPE)&&!this.state.showEmojiPicker?this.handleHide():(a&&o||i&&l)&&this.applyHotkeyMarkdown(e)})),ne(this,"applyHotkeyMarkdown",(e=>{const t=I.IG(e);this.setState({editText:t.message},(()=>{const e=this.editbox.getInputBox();I.AU(e,t.selectionStart,t.selectionEnd)}))})),ne(this,"handleHide",((e=!0)=>{this.refocusId=e?this.props.editingPost.refocusId:null,this.props.actions.hideEditPostModal()})),ne(this,"handleCheckForChangesHide",(()=>{this.state.editText===this.props.editingPost.post.message&&this.handleHide()})),ne(this,"handleEntered",(()=>{this.editbox&&(this.editbox.focus(),this.editbox.recalculateSize())})),ne(this,"handleHeightChange",((e,t)=>{this.editbox&&this.setState({renderScrollbar:e>t,scrollbarWidth:I.LF(this.editbox.getInputBox())})})),ne(this,"handleExit",(()=>{this.props.actions.setShowPreview(!1)})),ne(this,"handleExited",(()=>{const e=this.refocusId;e&&setTimeout((()=>{const t=document.getElementById(e);t&&t.focus()})),this.refocusId=null,this.setState({editText:"",postError:"",errorClass:null,showEmojiPicker:!1,prevShowState:!1}),this.props.actions.setShowPreview(!1)})),ne(this,"setEditboxRef",(e=>{this.editbox=e,this.editbox&&this.editbox.focus()})),ne(this,"isSaveDisabled",(()=>{const e=this.props.editingPost.post;return e&&e.file_ids&&e.file_ids.length>0||""!==this.state.editText.trim()?!this.props.canEditPost:!this.props.canDeletePost})),this.state={editText:"",caretPosition:"".length,postError:"",errorClass:null,showEmojiPicker:!1,renderScrollbar:!1,scrollbarWidth:0,prevShowState:e.editingPost.show},this.editModalBody=M.createRef()}static getDerivedStateFromProps(e,t){return e.editingPost.show&&!t.prevShowState?{editText:e.editingPost.post.message_source||e.editingPost.post.message,prevShowState:e.editingPost.show}:null}componentDidMount(){document.addEventListener("paste",this.handlePaste)}componentWillUnmount(){document.removeEventListener("paste",this.handlePaste)}render(){const{formatMessage:e}=this.props.intl,t="edit-post-footer"+(this.state.postError?" has-error":"");let s=null;if(this.state.postError){const e="post-error"+(this.state.errorClass?" "+this.state.errorClass:"");s=M.createElement("label",{className:e},this.state.postError)}let n=null;const a=e({id:"emoji_picker.emojiPicker",defaultMessage:"Emoji Picker"}).toLowerCase();return"true"!==this.props.config.EnableEmojiPicker||this.props.shouldShowPreview||(n=M.createElement("div",null,M.createElement($.Z,{show:this.state.showEmojiPicker,container:this.getContainer,target:this.getTarget,onHide:this.hideEmojiPicker,onEmojiClick:this.handleEmojiClick,onGifClick:this.handleGifClick,enableGifPicker:"true"===this.props.config.EnableGifPicker,topOffset:0,rightOffset:10}),M.createElement("button",{"aria-label":a,id:"editPostEmoji",ref:"editPostEmoji",className:"style--none post-action",onClick:this.toggleEmojiPicker},M.createElement(ee.Z,{className:"icon icon--emoji"})))),M.createElement(G.Z,{id:"editPostModal",dialogClassName:"a11y__modal edit-modal",show:this.props.editingPost.show,onKeyDown:this.handleKeyDown,onSelect:this.handleSelect,onHide:this.handleCheckForChangesHide,onEntered:this.handleEntered,onExit:this.handleExit,onExited:this.handleExited,keyboard:!1,role:"dialog","aria-labelledby":"editPostModalLabel"},M.createElement(G.Z.Header,{closeButton:!0,onHide:this.handleHide},M.createElement(G.Z.Title,{componentClass:"h1",id:"editPostModalLabel"},M.createElement(V.Z,{id:"edit_post.edit",defaultMessage:"Edit {title}",values:{title:this.props.editingPost.title}}))),M.createElement(G.Z.Body,{bsClass:"modal-body edit-modal-body".concat(this.state.showEmojiPicker?" edit-modal-body--add-reaction":""),ref:this.editModalBody},M.createElement("div",{className:"post-create__container"},M.createElement("div",{className:W()("textarea-wrapper",{scroll:this.state.renderScrollbar}),style:this.state.renderScrollbar&&this.state.scrollbarWidth?{"--detected-scrollbar-width":"".concat(this.state.scrollbarWidth,"px")}:void 0},M.createElement(te.Z,{tabIndex:"0",onChange:this.handleChange,onKeyPress:this.handleEditKeyPress,onKeyDown:this.handleKeyDown,onSelect:this.handleSelect,onMouseUp:this.handleMouseUpKeyUp,onKeyUp:this.handleMouseUpKeyUp,onHeightChange:this.handleHeightChange,handlePostError:this.handlePostError,value:this.state.editText,channelId:this.props.editingPost.post&&this.props.editingPost.post.channel_id,emojiEnabled:"true"===this.props.config.EnableEmojiPicker,createMessage:I._u("edit_post.editPost","Edit the post..."),supportsCommands:!1,suggestionListStyle:"bottom",id:"edit_textbox",ref:this.setEditboxRef,characterLimit:this.props.maxPostSize,preview:this.props.shouldShowPreview,useChannelMentions:this.props.useChannelMentions}),M.createElement("div",{className:"post-body__actions"},n)),M.createElement("div",{className:"post-create-footer"},M.createElement(se.Z,{characterLimit:this.props.maxPostSize,showPreview:this.props.shouldShowPreview,ref:this.setTextboxLinksRef,updatePreview:this.setShowPreview,message:this.state.editText}),M.createElement("div",{className:t},s)))),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link",onClick:this.handleHide},M.createElement(V.Z,{id:"edit_post.cancel",defaultMessage:"Cancel"})),M.createElement("button",{id:"editButton",type:"button",className:"btn btn-primary",disabled:this.isSaveDisabled(),onClick:this.handleEdit},M.createElement(V.Z,{id:"edit_post.save",defaultMessage:"Save"}))))}}ne(ie,"propTypes",{canEditPost:y().bool,canDeletePost:y().bool,codeBlockOnCtrlEnter:y().bool,ctrlSend:y().bool,config:y().object.isRequired,intl:J.gm.isRequired,maxPostSize:y().number.isRequired,shouldShowPreview:y().bool.isRequired,useChannelMentions:y().bool.isRequired,editingPost:y().shape({post:y().object,postId:y().string,refocusId:y().string,commentCount:y().number,show:y().bool.isRequired,title:y().string,isRHS:y().bool}).isRequired,actions:y().shape({addMessageIntoHistory:y().func.isRequired,editPost:y().func.isRequired,hideEditPostModal:y().func.isRequired,openModal:y().func.isRequired,setShowPreview:y().func.isRequired}).isRequired});const re=(0,K.ZP)(ie),oe=(0,n.connect)((function(e){var t;const s=(0,h.iE)(e),n=(0,B.YK)(e),a=(0,p.rc)(e),i=(null==n||null===(t=n.post)||void 0===t?void 0:t.channel_id)||(0,m.gO)(e),r=(0,u.ev)(e);let o=!1,l=!1;n&&n.post&&n.post.user_id===a?(o=(0,Z.Ai)(e,{channel:i,team:r,permission:D.Pl.DELETE_POST}),l=(0,Z.Ai)(e,{channel:i,team:r,permission:D.Pl.EDIT_POST})):(o=(0,Z.Ai)(e,{channel:i,team:r,permission:D.Pl.DELETE_OTHERS_POSTS}),l=(0,Z.Ai)(e,{channel:i,team:r,permission:D.Pl.EDIT_OTHERS_POSTS}));const c=(0,Z.Ai)(e,{channel:i,team:r,permission:D.Pl.USE_CHANNEL_MENTIONS});return{canEditPost:l,canDeletePost:o,codeBlockOnCtrlEnter:(0,d.o4)(e,D.uP.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter",!0),ctrlSend:(0,d.o4)(e,D.uP.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),config:s,editingPost:n,channelId:i,shouldShowPreview:(0,j.fM)(e),maxPostSize:parseInt(s.MaxPostSize,10)||N.ZP.DEFAULT_CHARACTER_LIMIT,useChannelMentions:c}}),(function(e){return{actions:(0,a.bindActionCreators)({addMessageIntoHistory:x.$s,editPost:F.d,hideEditPostModal:U.D_,openModal:H.h,setShowPreview:q.YQ},e)}}))(re);function le(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ce=N.ZP.KeyCodes;class de extends M.PureComponent{constructor(e){super(e),le(this,"handleModalKeyDown",(e=>{(0,I.pD)(e,ce.ESCAPE)&&this.hideModal()})),le(this,"handleChange",(e=>{this.setState({reason:e.target.value})})),le(this,"handleSave",(async()=>{const{reason:e}=this.state;this.setState({saving:!0});const{reportPost:t,actions:s}=this.props,{error:n}=await s.reportPost(t.post.id,e||".");n?this.setState({serverError:n,saving:!1}):(this.setState({saving:!1}),this.hideModal())})),le(this,"hideModal",(()=>{this.props.actions.closeModal(N.r8.EDIT_CHANNEL_HEADER)})),le(this,"focusTextbox",(()=>{this.reportPostTextboxRef.current&&this.reportPostTextboxRef.current.focus()})),le(this,"blurTextbox",(()=>{this.reportPostTextboxRef.current&&this.reportPostTextboxRef.current.blur()})),le(this,"handleEntering",(()=>{this.focusTextbox()})),le(this,"handleTargetInput",(e=>{console.info("e",e),e.stopPropagation(),e.preventDefault()})),le(this,"handleKeyDown",(e=>{const{ctrlSend:t}=this.props;(0,I.m)(e)?this.setState({header:(0,I.V4)(e)}):t&&(0,I.pD)(e,ce.ENTER)&&!0===e.ctrlKey&&this.handleKeyPress(e)})),le(this,"handleKeyPress",(e=>{const{ctrlSend:t}=this.props;!(0,R.tq)()&&(t&&e.ctrlKey||!t)&&(!(0,I.pD)(e,ce.ENTER)||e.shiftKey||e.altKey||(e.preventDefault(),this.blurTextbox(),this.handleSave(e)))})),le(this,"renderError",(()=>{const{serverError:e}=this.state;if(!e)return null;let t;return t="model.channel.is_valid.header.app_error"===e.server_error_id?M.createElement(V.Z,{id:"edit_channel_header_modal.error",defaultMessage:"The text entered exceeds the character limit. The channel header is limited to {maxLength} characters.",values:{maxLength:1024}}):e.message,M.createElement("div",{className:"form-group has-error"},M.createElement("br",null),M.createElement("label",{className:"control-label"},t))})),this.state={post:e.reportPost.post,reason:"",saving:!1},this.reportPostTextboxRef=M.createRef()}render(){const{username:e}=this.props;return M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.props.show,keyboard:!1,onKeyDown:this.handleModalKeyDown,onHide:this.hideModal,onEntering:this.handleEntering,onExited:this.hideModal,role:"dialog","aria-labelledby":"reportPostModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"reportPostModalLabel"},M.createElement(V.Z,{id:"report_post_modal.title",defaultMessage:"Báo cáo {username} cho Admin",values:{username:e}}))),M.createElement(G.Z.Body,{bsClass:"modal-body edit-modal-body"},M.createElement("div",null,M.createElement("p",null,M.createElement(V.Z,{id:"report_post_modal.description",defaultMessage:"Lý do báo cáo {username}:",values:{username:e}})),M.createElement("div",{className:"textarea-wrapper"},M.createElement(te.Z,{value:this.state.reason,onChange:this.handleChange,onKeyPress:this.handleKeyPress,onKeyDown:this.handleKeyDown,handleFocus:this.handleTargetInput,supportsCommands:!1,suggestionListStyle:"bottom",createMessage:(0,I._u)("report_post_modal.reason","Nhập lý do..."),previewMessageLink:"",handlePostError:this.handlePostError,id:"report_textbox",ref:this.reportPostTextboxRef,characterLimit:1024,preview:!1,channelId:this.props.reportPost.post&&this.props.reportPost.post.channel_id,emojiEnabled:!1})),M.createElement("br",null),this.renderError())),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link cancel-button",onClick:this.hideModal},M.createElement(V.Z,{id:"edit_channel_header_modal.cancel",defaultMessage:"Cancel"})),M.createElement("button",{disabled:this.state.saving,type:"button",className:"btn btn-primary save-button",onClick:this.handleSave},M.createElement(V.Z,{id:"report_pat_modal.report",defaultMessage:"{status} báo cáo{ext}",values:{status:this.state.saving?"Đang gửi":"Gửi",ext:this.state.saving?"...":""}}))))}}le(de,"propTypes",{username:y().string.isRequired,reportPost:y().object.isRequired,show:y().bool.isRequired,ctrlSend:y().bool.isRequired,actions:y().shape({closeModal:y().func.isRequired,reportPost:y().func.isRequired}).isRequired});const he=(0,n.connect)((function(e){const t=(0,h.iE)(e),s=(0,B.nB)(e);s.post=s.post||{};let n="";return s.post&&s.post.user_id&&(n=(0,p.PR)(e,s.post.user_id).username),{ctrlSend:(0,d.o4)(e,D.uP.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),config:t,show:s.show,reportPost:s,username:n,maxPostSize:parseInt(t.MaxPostSize||"0",10)||500}}),(function(e){return{actions:(0,a.bindActionCreators)({closeModal:U._1,reportPost:U.mK},e)}}))(de);var pe=s(94159),ue=s(43832),me=s(17187),ge=s.n(me),fe=s(37780);function Ee(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ce=N.ZP.ActionTypes;class be extends(ge()){constructor(){super(),Ee(this,"addModalListener",((e,t)=>{this.on(e,t)})),Ee(this,"removeModalListener",((e,t)=>{this.removeListener(e,t)})),Ee(this,"handleEventPayload",(e=>{const t=e.action,{type:s,value:n}=t,a=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(t,["type","value"]);switch(s){case Ce.TOGGLE_SHORTCUTS_MODAL:case Ce.TOGGLE_IMPORT_THEME_MODAL:case Ce.TOGGLE_DELETE_POST_MODAL:case Ce.TOGGLE_GET_TEAM_INVITE_LINK_MODAL:case Ce.TOGGLE_GET_PUBLIC_LINK_MODAL:case Ce.TOGGLE_QUICK_SWITCH_MODAL:case Ce.TOGGLE_CHANNEL_PURPOSE_UPDATE_MODAL:case Ce.TOGGLE_CHANNEL_NAME_UPDATE_MODAL:case Ce.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL:this.emit(s,n,a)}})),this.dispatchToken=fe.Z.register(this.handleEventPayload)}}const _e=new be;var ve=s(20608);function ye(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Me extends M.PureComponent{constructor(e){super(e),ye(this,"textAreaRef",M.createRef()),ye(this,"onHide",(()=>{this.setState({copiedLink:!1}),this.props.onHide()})),ye(this,"copyLink",(()=>{const e=this.textAreaRef.current;if(e){e.focus(),e.setSelectionRange(0,this.props.link.length);try{this.setState({copiedLink:document.execCommand("copy")})}catch(e){this.setState({copiedLink:!1})}}})),this.state={copiedLink:!1}}render(){let e=null;this.props.helpText&&(e=M.createElement("p",null,this.props.helpText,M.createElement("br",null),M.createElement("br",null)));let t=null;document.queryCommandSupported("copy")&&(t=M.createElement("button",{id:"linkModalCopyLink","data-copy-btn":"true",type:"button",className:"btn btn-primary pull-left",onClick:this.copyLink},M.createElement(V.Z,{id:"get_link.copy",defaultMessage:"Copy Link"})));const s=M.createElement("textarea",{id:"linkModalTextArea",className:"form-control no-resize min-height",ref:this.textAreaRef,dir:"auto",value:this.props.link,onClick:this.copyLink,readOnly:!0});let n=null;return this.state.copiedLink&&(n=M.createElement("p",{className:"alert alert-success alert--confirm"},M.createElement(ve.Z,null),M.createElement(V.Z,{id:"get_link.clipboard",defaultMessage:" Link copied"}))),M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.props.show,onHide:this.onHide,role:"dialog","aria-labelledby":"getLinkModalLabel"},M.createElement(G.Z.Header,{id:"getLinkModalLabel",closeButton:!0},M.createElement("h4",{className:"modal-title"},this.props.title)),M.createElement(G.Z.Body,null,e,s),M.createElement(G.Z.Footer,null,M.createElement("button",{id:"linkModalCloseButton",type:"button",className:"btn btn-link",onClick:this.onHide},M.createElement(V.Z,{id:"get_link.close",defaultMessage:"Close"})),t,n))}}function Pe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}ye(Me,"propTypes",{show:y().bool.isRequired,onHide:y().func.isRequired,title:y().string.isRequired,helpText:y().string,link:y().string.isRequired}),ye(Me,"defaultProps",{helpText:null});class we extends M.PureComponent{constructor(e){super(e),Pe(this,"handleToggle",((e,t)=>{this.setState({show:e,fileId:t.fileId})})),Pe(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!1,fileId:""}}componentWillUnmount(){_e.removeModalListener(N.ZP.ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL,this.handleToggle)}componentDidMount(){_e.addModalListener(N.ZP.ActionTypes.TOGGLE_GET_PUBLIC_LINK_MODAL,this.handleToggle)}componentDidUpdate(e,t){this.state.show&&!t.show&&this.props.actions.getFilePublicLink(this.state.fileId)}render(){return M.createElement(Me,{show:this.state.show,onHide:this.onHide,title:I._u("get_public_link_modal.title","Copy Public Link"),helpText:I._u("get_public_link_modal.help","The link below allows anyone to see this file without being registered on this server."),link:this.props.link})}}Pe(we,"propTypes",{link:y().string,actions:y().shape({getFilePublicLink:y().func.isRequired}).isRequired}),Pe(we,"defaultProps",{link:""});const Se=(0,n.connect)((function(e){var t;return{link:null===(t=ue.c9(e))||void 0===t?void 0:t.link}}),(function(e){return{actions:(0,a.bindActionCreators)({getFilePublicLink:pe.c9},e)}}))(we);var Te=s(32579);function Ne(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Re extends M.PureComponent{constructor(e){super(e),Ne(this,"handleKeyPress",(e=>{"Enter"===e.key&&this.state.show&&this.handleSubmit()})),Ne(this,"handleSubmit",(()=>{const{actions:e}=this.props,{channel:t}=this.state;if(t){const s=t.id;e.leaveChannel(s).then((e=>{e.data&&this.handleHide()}))}})),Ne(this,"handleToggle",(e=>{this.setState({channel:e,show:null!==e})})),Ne(this,"handleHide",(()=>{this.setState({show:!1})})),this.state={show:!1}}componentDidMount(){_e.addModalListener(N.ZP.ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL,this.handleToggle)}componentWillUnmount(){_e.removeModalListener(N.ZP.ActionTypes.TOGGLE_LEAVE_PRIVATE_CHANNEL_MODAL,this.handleToggle)}render(){let e,t;this.state.channel&&this.state.channel.display_name&&(e=M.createElement(V.Z,{id:"leave_private_channel_modal.title",defaultMessage:"Leave Private Channel {channel}",values:{channel:M.createElement("b",null,this.state.channel.display_name)}}),t=M.createElement(V.Z,{id:"leave_private_channel_modal.message",defaultMessage:"Are you sure you wish to leave the private channel {channel}? You must be re-invited in order to re-join this channel in the future.",values:{channel:M.createElement("b",null,this.state.channel.display_name)}}));const s=M.createElement(V.Z,{id:"leave_private_channel_modal.leave",defaultMessage:"Yes, leave channel"});return M.createElement(Te.Z,{show:this.state.show,title:e,message:t,confirmButtonClass:"btn btn-danger",confirmButtonText:s,onConfirm:this.handleSubmit,onCancel:this.handleHide})}}Ne(Re,"propTypes",{actions:y().shape({leaveChannel:y().func.isRequired}).isRequired});const Ie=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({leaveChannel:b.TL},e)}}))(Re);var Oe=s(28847),Le=s(47715),Ae=s(82251);function ke(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function xe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(s),!0).forEach((function(t){De(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ke(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function De(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ze extends M.PureComponent{constructor(e){super(e),De(this,"hideModal",(()=>{this.setState({show:!1})})),De(this,"onConfirm",(e=>{this.hideModal();const t=xe({},this.state.currentUserStatus);if(t.status=this.state.newStatus,this.props.actions.setStatus(t),e){const e={category:D.uP.CATEGORY_AUTO_RESET_MANUAL_STATUS,user_id:t.user_id,name:t.user_id,value:"true"};this.props.actions.savePreferences(e.user_id,[e])}})),De(this,"onCancel",(e=>{if(this.hideModal(),e){const e=xe({},this.state.currentUserStatus),t={category:D.uP.CATEGORY_AUTO_RESET_MANUAL_STATUS,user_id:e.user_id,name:e.user_id,value:"false"};this.props.actions.savePreferences(t.user_id,[t])}})),De(this,"renderModalMessage",(()=>this.props.currentUserStatus===N.gg.OUT_OF_OFFICE?M.createElement(V.Z,{id:"modal.manual_status.auto_responder.message_".concat(this.state.newStatus),defaultMessage:'Would you like to switch your status to "{status}" and disable Automatic Replies?',values:{status:(0,I.cv)(this.state.newStatus)}}):M.createElement(V.Z,{id:"modal.manual_status.message_".concat(this.state.newStatus),defaultMessage:'Would you like to switch your status to "{status}"?',values:{status:(0,I.cv)(this.state.newStatus)}}))),this.state={show:!1,currentUserStatus:{},newStatus:e.newStatus||"online"}}componentDidMount(){this.props.actions.autoResetStatus().then((e=>{const t=e.manual,s=""===this.props.autoResetPref;this.setState({currentUserStatus:e,show:Boolean(e.status===N.gg.OUT_OF_OFFICE||t&&s)})}))}render(){const e=this.state.currentUserStatus.status||"",t="modal.manual_status.title_"+e,s=M.createElement(V.Z,{id:t,defaultMessage:'Your Status is Set to "{status}"',values:{status:(0,I.cv)(e)}}),n=this.renderModalMessage(),a=M.createElement(V.Z,{id:"modal.manual_status.button_".concat(this.state.newStatus),defaultMessage:'Yes, set my status to "{status}"',values:{status:(0,I.cv)(this.state.newStatus)}}),i="modal.manual_status.cancel_"+e,r=M.createElement(V.Z,{id:i,defaultMessage:'No, keep it as "{status}"',values:{status:(0,I.cv)(e)}}),o=M.createElement(V.Z,{id:"modal.manual_status.ask",defaultMessage:"Do not ask me again"}),l=this.props.currentUserStatus!==N.gg.OUT_OF_OFFICE;return M.createElement(Te.Z,{show:this.state.show,title:s,message:n,confirmButtonText:a,onConfirm:this.onConfirm,cancelButtonText:r,onCancel:this.onCancel,onExited:this.props.onHide,showCheckbox:l,checkboxText:o})}}De(Ze,"propTypes",{autoResetPref:y().string,currentUserStatus:y().string,newStatus:y().string,onHide:y().func,actions:y().shape({autoResetStatus:y().func.isRequired,setStatus:y().func.isRequired,savePreferences:y().func.isRequired}).isRequired}),(0,Ae.t)("modal.manual_status.auto_responder.message_"),(0,Ae.t)("modal.manual_status.auto_responder.message_away"),(0,Ae.t)("modal.manual_status.auto_responder.message_dnd"),(0,Ae.t)("modal.manual_status.auto_responder.message_offline"),(0,Ae.t)("modal.manual_status.auto_responder.message_online"),(0,Ae.t)("modal.manual_status.button_"),(0,Ae.t)("modal.manual_status.button_away"),(0,Ae.t)("modal.manual_status.button_dnd"),(0,Ae.t)("modal.manual_status.button_offline"),(0,Ae.t)("modal.manual_status.button_online"),(0,Ae.t)("modal.manual_status.cancel_"),(0,Ae.t)("modal.manual_status.cancel_away"),(0,Ae.t)("modal.manual_status.cancel_dnd"),(0,Ae.t)("modal.manual_status.cancel_offline"),(0,Ae.t)("modal.manual_status.cancel_ooo"),(0,Ae.t)("modal.manual_status.message_"),(0,Ae.t)("modal.manual_status.message_away"),(0,Ae.t)("modal.manual_status.message_dnd"),(0,Ae.t)("modal.manual_status.message_offline"),(0,Ae.t)("modal.manual_status.message_online"),(0,Ae.t)("modal.manual_status.title_"),(0,Ae.t)("modal.manual_status.title_away"),(0,Ae.t)("modal.manual_status.title_dnd"),(0,Ae.t)("modal.manual_status.title_offline"),(0,Ae.t)("modal.manual_status.title_ooo");const He=(0,n.connect)((function(e){const{currentUserId:t}=e.entities.users;return{autoResetPref:(0,d.U2)(e,D.uP.CATEGORY_AUTO_RESET_MANUAL_STATUS,t,""),currentUserStatus:(0,p.ZO)(e,t)}}),(function(e){return{actions:(0,a.bindActionCreators)({autoResetStatus:Le.u1,setStatus:r.Tf,savePreferences:Oe.$A},e)}}))(Ze);s(23123);var qe=s(50049);function je(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ue=(0,qe.vU)({mainHeader:{default:{id:(0,Ae.t)("shortcuts.header"),defaultMessage:"Keyboard Shortcuts\tCtrl|/"},mac:{id:(0,Ae.t)("shortcuts.header.mac"),defaultMessage:"Keyboard Shortcuts\t⌘|/"}},navHeader:{id:(0,Ae.t)("shortcuts.nav.header"),defaultMessage:"Navigation"},navPrev:{default:{id:(0,Ae.t)("shortcuts.nav.prev"),defaultMessage:"Previous channel:\tAlt|Up"},mac:{id:(0,Ae.t)("shortcuts.nav.prev.mac"),defaultMessage:"Previous channel:\t⌥|Up"}},navNext:{default:{id:(0,Ae.t)("shortcuts.nav.next"),defaultMessage:"Next channel:\tAlt|Down"},mac:{id:(0,Ae.t)("shortcuts.nav.next.mac"),defaultMessage:"Next channel:\t⌥|Down"}},navUnreadPrev:{default:{id:(0,Ae.t)("shortcuts.nav.unread_prev"),defaultMessage:"Previous unread channel:\tAlt|Shift|Up"},mac:{id:(0,Ae.t)("shortcuts.nav.unread_prev.mac"),defaultMessage:"Previous unread channel:\t⌥|Shift|Up"}},navUnreadNext:{default:{id:(0,Ae.t)("shortcuts.nav.unread_next"),defaultMessage:"Next unread channel:\tAlt|Shift|Down"},mac:{id:(0,Ae.t)("shortcuts.nav.unread_next.mac"),defaultMessage:"Next unread channel:\t⌥|Shift|Down"}},teamNavPrev:{default:{id:(0,Ae.t)("shortcuts.team_nav.prev"),defaultMessage:"Previous team:\tCtrl|Alt|Up"},mac:{id:(0,Ae.t)("shortcuts.team_nav.prev.mac"),defaultMessage:"Previous team:\t⌘|⌥|Up"}},teamNavNext:{default:{id:(0,Ae.t)("shortcuts.team_nav.next"),defaultMessage:"Next team:\tCtrl|Alt|Down"},mac:{id:(0,Ae.t)("shortcuts.team_nav.next.mac"),defaultMessage:"Next team:\t⌘|⌥|Down"}},teamNavSwitcher:{default:{id:(0,Ae.t)("shortcuts.team_nav.switcher"),defaultMessage:"Switch to a specific team:\tCtrl|Alt|[1-9]"},mac:{id:(0,Ae.t)("shortcuts.team_nav.switcher.mac"),defaultMessage:"Switch to a specific team:\t⌘|⌥|[1-9]"}},navSwitcher:{default:{id:(0,Ae.t)("shortcuts.nav.switcher"),defaultMessage:"Quick channel switcher:\tCtrl|K"},mac:{id:(0,Ae.t)("shortcuts.nav.switcher.mac"),defaultMessage:"Quick channel switcher:\t⌘|K"}},navDMMenu:{default:{id:(0,Ae.t)("shortcuts.nav.direct_messages_menu"),defaultMessage:"Direct messages menu:\tCtrl|Shift|K"},mac:{id:(0,Ae.t)("shortcuts.nav.direct_messages_menu.mac"),defaultMessage:"Direct messages menu:\t⌘|Shift|K"}},navSettings:{default:{id:(0,Ae.t)("shortcuts.nav.settings"),defaultMessage:"Account settings:\tCtrl|Shift|A"},mac:{id:(0,Ae.t)("shortcuts.nav.settings.mac"),defaultMessage:"Account settings:\t⌘|Shift|A"}},navMentions:{default:{id:(0,Ae.t)("shortcuts.nav.recent_mentions"),defaultMessage:"Recent mentions:\tCtrl|Shift|M"},mac:{id:(0,Ae.t)("shortcuts.nav.recent_mentions.mac"),defaultMessage:"Recent mentions:\t⌘|Shift|M"}},navFocusCenter:{default:{id:(0,Ae.t)("shortcuts.nav.focus_center"),defaultMessage:"Set focus to input field:\tCtrl|Shift|L"},mac:{id:(0,Ae.t)("shortcuts.nav.focus_center.mac"),defaultMessage:"Set focus to input field:\t⌘|Shift|L"}},navOpenCloseSidebar:{default:{id:(0,Ae.t)("shortcuts.nav.open_close_sidebar"),defaultMessage:"Open or close the right sidebar\tCtrl|."},mac:{id:(0,Ae.t)("shortcuts.nav.open_close_sidebar.mac"),defaultMessage:"Open or close the right sidebar\t⌘|."}},msgHeader:{id:(0,Ae.t)("shortcuts.msgs.header"),defaultMessage:"Messages"},msgInputHeader:{id:(0,Ae.t)("shortcuts.msgs.input.header"),defaultMessage:"Works inside an empty input field"},msgEdit:{id:(0,Ae.t)("shortcuts.msgs.edit"),defaultMessage:"Edit last message in channel:\tUp"},msgReply:{id:(0,Ae.t)("shortcuts.msgs.reply"),defaultMessage:"Reply to last message in channel:\tShift|Up"},msgReprintPrev:{default:{id:(0,Ae.t)("shortcuts.msgs.reprint_prev"),defaultMessage:"Reprint previous message:\tCtrl|Up"},mac:{id:(0,Ae.t)("shortcuts.msgs.reprint_prev.mac"),defaultMessage:"Reprint previous message:\t⌘|Up"}},msgReprintNext:{default:{id:(0,Ae.t)("shortcuts.msgs.reprint_next"),defaultMessage:"Reprint next message:\tCtrl|Down"},mac:{id:(0,Ae.t)("shortcuts.msgs.reprint_next.mac"),defaultMessage:"Reprint next message:\t⌘|Down"}},msgCompHeader:{id:(0,Ae.t)("shortcuts.msgs.comp.header"),defaultMessage:"Autocomplete"},msgCompUsername:{id:(0,Ae.t)("shortcuts.msgs.comp.username"),defaultMessage:"Username:\t@|[a-z]|Tab"},msgCompChannel:{id:(0,Ae.t)("shortcuts.msgs.comp.channel"),defaultMessage:"Channel:\t~|[a-z]|Tab"},msgCompEmoji:{id:(0,Ae.t)("shortcuts.msgs.comp.emoji"),defaultMessage:"Emoji:\t:|[a-z]|Tab"},msgLastReaction:{default:{id:(0,Ae.t)("shortcuts.msgs.comp.last_reaction"),defaultMessage:"React to last message:\tCtrl|Shift|⧵"},mac:{id:(0,Ae.t)("shortcuts.msgs.comp.last_reaction.mac"),defaultMessage:"React to last message:\t⌘|Shift|⧵"}},msgMarkdownHeader:{id:(0,Ae.t)("shortcuts.msgs.markdown.header"),defaultMessage:"Formatting"},msgMarkdownBold:{default:{id:(0,Ae.t)("shortcuts.msgs.markdown.bold"),defaultMessage:"Bold:\tCtrl|B"},mac:{id:(0,Ae.t)("shortcuts.msgs.markdown.bold.mac"),defaultMessage:"Bold:\t⌘|B"}},msgMarkdownItalic:{default:{id:(0,Ae.t)("shortcuts.msgs.markdown.italic"),defaultMessage:"Italic:\tCtrl|I"},mac:{id:(0,Ae.t)("shortcuts.msgs.markdown.italic.mac"),defaultMessage:"Italic:\t⌘|I"}},msgMarkdownLink:{default:{id:(0,Ae.t)("shortcuts.msgs.markdown.link"),defaultMessage:"Link:\tCtrl|Alt|K"},mac:{id:(0,Ae.t)("shortcuts.msgs.markdown.link.mac"),defaultMessage:"Link:\t⌘|Alt|K"}},filesHeader:{id:(0,Ae.t)("shortcuts.files.header"),defaultMessage:"Files"},filesUpload:{default:{id:(0,Ae.t)("shortcuts.files.upload"),defaultMessage:"Upload files:\tCtrl|U"},mac:{id:(0,Ae.t)("shortcuts.files.upload.mac"),defaultMessage:"Upload files:\t⌘|U"}},browserHeader:{id:(0,Ae.t)("shortcuts.browser.header"),defaultMessage:"Built-in Browser Commands"},browserChannelPrev:{default:{id:(0,Ae.t)("shortcuts.browser.channel_prev"),defaultMessage:"Back in history:\tAlt|Left"},mac:{id:(0,Ae.t)("shortcuts.browser.channel_prev.mac"),defaultMessage:"Back in history:\t⌘|["}},browserChannelNext:{default:{id:(0,Ae.t)("shortcuts.browser.channel_next"),defaultMessage:"Forward in history:\tAlt|Right"},mac:{id:(0,Ae.t)("shortcuts.browser.channel_next.mac"),defaultMessage:"Forward in history:\t⌘|]"}},browserFontIncrease:{default:{id:(0,Ae.t)("shortcuts.browser.font_increase"),defaultMessage:"Zoom in:\tCtrl|+"},mac:{id:(0,Ae.t)("shortcuts.browser.font_increase.mac"),defaultMessage:"Zoom in:\t⌘|+"}},browserFontDecrease:{default:{id:(0,Ae.t)("shortcuts.browser.font_decrease"),defaultMessage:"Zoom out:\tCtrl|-"},mac:{id:(0,Ae.t)("shortcuts.browser.font_decrease.mac"),defaultMessage:"Zoom out:\t⌘|-"}},browserInputHeader:{id:(0,Ae.t)("shortcuts.browser.input.header"),defaultMessage:"Works inside an input field"},browserHighlightPrev:{id:(0,Ae.t)("shortcuts.browser.highlight_prev"),defaultMessage:"Highlight text to the previous line:\tShift|Up"},browserHighlightNext:{id:(0,Ae.t)("shortcuts.browser.highlight_next"),defaultMessage:"Highlight text to the next line:\tShift|Down"},browserNewline:{id:(0,Ae.t)("shortcuts.browser.newline"),defaultMessage:"Create a new line:\tShift|Enter"},info:{id:(0,Ae.t)("shortcuts.info"),defaultMessage:"Begin a message with / for a list of all the commands at your disposal."}});class Fe extends M.PureComponent{constructor(e){super(e),je(this,"handleToggle",(()=>{this.setState({show:!this.state.show})})),je(this,"handleHide",(()=>{this.setState({show:!1})})),this.state={show:!1}}componentDidMount(){_e.addModalListener(N.ZP.ActionTypes.TOGGLE_SHORTCUTS_MODAL,this.handleToggle)}componentWillUnmount(){_e.removeModalListener(N.ZP.ActionTypes.TOGGLE_SHORTCUTS_MODAL,this.handleToggle)}getShortcuts(){const{isMac:e}=this.props,t={};return Object.keys(Ue).forEach((s=>{e&&Ue[s].mac?t[s]=Ue[s].mac:!e&&Ue[s].default?t[s]=Ue[s].default:t[s]=Ue[s]})),t}render(){const e=this.getShortcuts(),{formatMessage:t}=this.props.intl,s=I.IJ();return M.createElement(G.Z,{dialogClassName:"a11y__modal shortcuts-modal",show:this.state.show,onHide:this.handleHide,onExited:this.handleHide,role:"dialog","aria-labelledby":"shortcutsModalLabel"},M.createElement("div",{className:"shortcuts-content"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"shortcutsModalLabel"},M.createElement("strong",null,Be(t(e.mainHeader))))),M.createElement(G.Z.Body,null,M.createElement("div",{className:"row"},M.createElement("div",{className:"col-sm-4"},M.createElement("div",{className:"section"},M.createElement("div",null,M.createElement("h4",{className:"section-title"},M.createElement("strong",null,t(e.navHeader))),Be(t(e.navPrev)),Be(t(e.navNext)),Be(t(e.navUnreadPrev)),Be(t(e.navUnreadNext)),!s&&Be(t(e.teamNavPrev)),!s&&Be(t(e.teamNavNext)),Be(t(e.teamNavSwitcher)),Be(t(e.navSwitcher)),Be(t(e.navDMMenu)),Be(t(e.navSettings)),Be(t(e.navMentions)),Be(t(e.navFocusCenter)),Be(t(e.navOpenCloseSidebar))))),M.createElement("div",{className:"col-sm-4"},M.createElement("div",{className:"section"},M.createElement("div",null,M.createElement("h4",{className:"section-title"},M.createElement("strong",null,t(e.msgHeader))),M.createElement("span",null,M.createElement("strong",null,t(e.msgInputHeader))),M.createElement("div",{className:"subsection"},Be(t(e.msgEdit)),Be(t(e.msgReply)),Be(t(e.msgLastReaction)),Be(t(e.msgReprintPrev)),Be(t(e.msgReprintNext))),M.createElement("span",null,M.createElement("strong",null,t(e.msgCompHeader))),M.createElement("div",{className:"subsection"},Be(t(e.msgCompUsername)),Be(t(e.msgCompChannel)),Be(t(e.msgCompEmoji))),M.createElement("span",null,M.createElement("strong",null,t(e.msgMarkdownHeader))),M.createElement("div",{className:"subsection"},Be(t(e.msgMarkdownBold)),Be(t(e.msgMarkdownItalic)),Be(t(e.msgMarkdownLink)))))),M.createElement("div",{className:"col-sm-4"},M.createElement("div",{className:"section"},M.createElement("div",null,M.createElement("h4",{className:"section-title"},M.createElement("strong",null,t(e.filesHeader))),Be(t(e.filesUpload))),M.createElement("div",{className:"section--lower"},M.createElement("h4",{className:"section-title"},M.createElement("strong",null,t(e.browserHeader))),Be(t(e.browserChannelPrev)),Be(t(e.browserChannelNext)),Be(t(e.browserFontIncrease)),Be(t(e.browserFontDecrease)),M.createElement("span",null,M.createElement("strong",null,t(e.browserInputHeader))),M.createElement("div",{className:"subsection"},Be(t(e.browserHighlightPrev)),Be(t(e.browserHighlightNext)),Be(t(e.browserNewline))))))),M.createElement("div",{className:"info__label"},t(e.info)))))}}function Be(e){if(!e)return null;const t=e.split("\t"),s=M.createElement("span",null,t[0]);let n=null;return t.length>1&&(n=t[1].split("|").map((e=>M.createElement("span",{className:"shortcut-key",key:e},e)))),M.createElement("div",{className:"shortcut-line"},s,n)}je(Fe,"propTypes",{intl:J.gm.isRequired,isMac:y().bool.isRequired});const Ge=(0,K.ZP)(Fe);var Ve=s(53497),Ke=s(67844),Ye=s(59925);const We=s.p+"files/55d77b94009ea98824ee008af39dedb2.png",ze=s.p+"files/c061727f8ed3adcb588bcf6f84915d74.png",Je=e=>{let t="file-overlay hidden";return"right"===e.overlayType?t+=" right-file-overlay":"center"===e.overlayType&&(t+=" center-file-overlay"),M.createElement("div",{className:t},M.createElement("div",{className:"overlay__indent"},M.createElement("div",{className:"overlay__circle"},M.createElement("img",{className:"overlay__files",src:We,alt:"Files",loading:"lazy"}),M.createElement("span",null,M.createElement(V.Z,{id:"generic_icons.upload",defaultMessage:"Upload Icon"},(e=>M.createElement("i",{className:"fa fa-upload",title:e}))),M.createElement(V.Z,{id:"upload_overlay.info",defaultMessage:"Drop a file to upload it."})),M.createElement("img",{className:"overlay__logo",src:ze,width:"100",alt:"Logo",loading:"lazy"}))))};Je.propTypes={overlayType:y().string.isRequired};const Xe=Je;var Qe=s(85357),$e=s(16403),et=s(19728),tt=s(15558),st=s(89262);function nt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class at extends M.PureComponent{constructor(...e){super(...e),nt(this,"handleBack",(e=>{switch(e.preventDefault(),this.props.previousRhsState){case N.Hp.SEARCH:this.props.actions.showSearchResults();break;case N.Hp.MENTION:this.props.actions.showMentions();break;case N.Hp.FLAG:this.props.actions.showFlaggedPosts();break;case N.Hp.PIN:this.props.actions.showPinnedPosts()}})),nt(this,"handleJumpClick",(()=>{(0,I.tq)()&&this.props.actions.closeRightHandSide(),this.props.actions.setRhsExpanded(!1);const e=this.props.relativeTeamUrl;st.m.push("".concat(e,"/pl/").concat(this.props.rootPostId))}))}render(){let e;const t=M.createElement(et.Z,{id:"closeSidebarTooltip"},M.createElement(V.Z,{id:"rhs_header.closeSidebarTooltip",defaultMessage:"Close"}));let s;switch(this.props.previousRhsState){case N.Hp.SEARCH:case N.Hp.MENTION:s=M.createElement(et.Z,{id:"backToResultsTooltip"},M.createElement(V.Z,{id:"rhs_header.backToResultsTooltip",defaultMessage:"Back to search results"}));break;case N.Hp.FLAG:s=M.createElement(et.Z,{id:"backToResultsTooltip"},M.createElement(V.Z,{id:"rhs_header.backToFlaggedTooltip",defaultMessage:"Back to saved posts"}));break;case N.Hp.PIN:s=M.createElement(et.Z,{id:"backToResultsTooltip"},M.createElement(V.Z,{id:"rhs_header.backToPinnedTooltip",defaultMessage:"Back to pinned posts"}))}const n=M.createElement(et.Z,{id:"expandSidebarTooltip"},M.createElement(V.Z,{id:"rhs_header.expandSidebarTooltip",defaultMessage:"Expand Sidebar"})),a=M.createElement(et.Z,{id:"shrinkSidebarTooltip"},M.createElement(V.Z,{id:"rhs_header.collapseSidebarTooltip",defaultMessage:"Collapse Sidebar"})),i=this.props.channel.display_name;return s&&(e=M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:s},M.createElement("a",{href:"#",onClick:this.handleBack,className:"sidebar--right__back"},M.createElement(V.Z,{id:"generic_icons.back",defaultMessage:"Back Icon"},(e=>M.createElement("i",{className:"icon icon-arrow-back-ios","aria-label":e})))))),M.createElement("div",{className:"sidebar--right__header"},M.createElement("span",{className:"sidebar--right__title"},e,M.createElement(V.Z,{id:"rhs_header.details",defaultMessage:"Thread"}),i&&M.createElement("button",{onClick:this.handleJumpClick,className:"style--none sidebar--right__title__channel"},i)),M.createElement("div",{className:"pull-right"},M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:this.props.isExpanded?a:n},M.createElement("button",{type:"button",className:"sidebar--right__expand btn-icon","aria-label":"Expand",onClick:this.props.actions.toggleRhsExpanded},M.createElement(V.Z,{id:"rhs_header.expandSidebarTooltip.icon",defaultMessage:"Expand Sidebar Icon"},(e=>M.createElement("i",{className:"icon icon-arrow-expand","aria-label":e}))),M.createElement(V.Z,{id:"rhs_header.collapseSidebarTooltip.icon",defaultMessage:"Collapse Sidebar Icon"},(e=>M.createElement("i",{className:"icon icon-arrow-collapse","aria-label":e}))))),M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:t},M.createElement("button",{id:"rhsCloseButton",type:"button",className:"sidebar--right__close btn-icon","aria-label":"Close",onClick:this.props.actions.closeRightHandSide},M.createElement(V.Z,{id:"rhs_header.closeTooltip.icon",defaultMessage:"Close Sidebar Icon"},(e=>M.createElement("i",{className:"icon icon-close","aria-label":e})))))))}}nt(at,"propTypes",{isExpanded:y().bool.isRequired,rootPostId:y().string.isRequired,previousRhsState:y().string,relativeTeamUrl:y().string.isRequired,actions:y().shape({setRhsExpanded:y().func.isRequired,showMentions:y().func.isRequired,showSearchResults:y().func.isRequired,showFlaggedPosts:y().func.isRequired,showPinnedPosts:y().func.isRequired,closeRightHandSide:y().func.isRequired,toggleRhsExpanded:y().func.isRequired}).isRequired});const it=(0,n.connect)((function(e){return{isExpanded:(0,Ke.OZ)(e),relativeTeamUrl:(0,u.gm)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({setRhsExpanded:Ve.JI,showSearchResults:Ve.O8,showMentions:Ve.rb,showFlaggedPosts:Ve.Yv,showPinnedPosts:Ve.B7,showChannelFiles:Ve.Cj,closeRightHandSide:Ve.Lg,toggleRhsExpanded:Ve.fV},e)}}))(at);var rt=s(81827);const ot=({selected:e,posts:t,channel:s,previousRhsState:n})=>null!=t&&null!=e&&s?M.createElement("div",{id:"rhsContainer",className:"sidebar-right__body"},M.createElement(it,{rootPostId:e.id,channel:s,previousRhsState:n}),M.createElement(rt.Z,{rootPostId:e.id,useRelativeTimestamp:!1})):M.createElement("div",null);ot.propTypes={posts:y().array.isRequired,previousRhsState:y().string};const lt=(0,M.memo)(ot),ct=(0,n.connect)((function(){const e=(0,Qe.Zf)();return function(t){const s=(0,Ke.ct)(t),n=(0,$e.L)(t),a=(0,Ke.Gu)(t);let i=[];s&&(i=e(t,{rootId:s.id}));const r=(0,d.U2)(t,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.COLLAPSE_DISPLAY,N.uP.COLLAPSE_DISPLAY_DEFAULT);return{selected:s,channel:a,posts:i,socketConnectionStatus:n.connected,previewCollapsed:r,previewEnabled:(0,d.o4)(t,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.LINK_PREVIEW_DISPLAY,"true"===N.uP.LINK_PREVIEW_DISPLAY_DEFAULT),directTeammate:(0,I.PR)(t,null==a?void 0:a.id)}}}),(function(e){return{actions:(0,a.bindActionCreators)({removePost:x.M8,selectPostCard:Ve.Jm,getPostThread:x.ct},e)}}))(lt);s(19601);var dt=s(31298),ht=s(73727),pt=s(8142);function ut(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class mt extends M.PureComponent{constructor(...e){super(...e),ut(this,"handleBack",(e=>{switch(e.preventDefault(),this.props.previousRhsState){case N.Hp.CHANNEL_FILES:case N.Hp.SEARCH:this.props.actions.showSearchResults();break;case N.Hp.MENTION:this.props.actions.showMentions();break;case N.Hp.FLAG:this.props.actions.showFlaggedPosts();break;case N.Hp.PIN:this.props.actions.showPinnedPosts()}}))}render(){let e,t;switch(this.props.previousRhsState){case N.Hp.SEARCH:case N.Hp.MENTION:t=M.createElement(et.Z,{id:"backToResultsTooltip"},M.createElement(V.Z,{id:"rhs_header.backToResultsTooltip",defaultMessage:"Back to search results"}));break;case N.Hp.FLAG:t=M.createElement(et.Z,{id:"backToResultsTooltip"},M.createElement(V.Z,{id:"rhs_header.backToFlaggedTooltip",defaultMessage:"Back to saved posts"}));break;case N.Hp.PIN:t=M.createElement(et.Z,{id:"backToResultsTooltip"},M.createElement(V.Z,{id:"rhs_header.backToPinnedTooltip",defaultMessage:"Back to pinned posts"}))}const s=M.createElement(et.Z,{id:"closeSidebarTooltip"},M.createElement(V.Z,{id:"rhs_header.closeSidebarTooltip",defaultMessage:"Close"})),n=M.createElement(et.Z,{id:"expandSidebarTooltip"},M.createElement(V.Z,{id:"rhs_header.expandSidebarTooltip",defaultMessage:"Expand Sidebar"})),a=M.createElement(et.Z,{id:"shrinkSidebarTooltip"},M.createElement(V.Z,{id:"rhs_header.collapseSidebarTooltip",defaultMessage:"Collapse Sidebar"}));return t&&(e=M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:t},M.createElement("a",{href:"#",onClick:this.handleBack,className:"sidebar--right__back"},M.createElement(V.Z,{id:"generic_icons.back",defaultMessage:"Back Icon"},(e=>M.createElement("i",{className:"icon icon-arrow-back-ios","aria-label":e})))))),M.createElement("div",{className:"sidebar--right__header"},M.createElement("span",{className:"sidebar--right__title"},e,M.createElement(V.Z,{id:"search_header.title5",defaultMessage:"Extra information"})),M.createElement("div",{className:"pull-right"},M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:this.props.isExpanded?a:n},M.createElement("button",{type:"button",className:"sidebar--right__expand btn-icon","aria-label":"Expand",onClick:this.props.actions.toggleRhsExpanded},M.createElement(V.Z,{id:"rhs_header.expandSidebarTooltip.icon",defaultMessage:"Expand Sidebar Icon"},(e=>M.createElement("i",{className:"icon icon-arrow-expand","aria-label":e}))),M.createElement(V.Z,{id:"rhs_header.collapseSidebarTooltip.icon",defaultMessage:"Collapse Sidebar Icon"},(e=>M.createElement("i",{className:"icon icon-arrow-collapse","aria-label":e}))))),M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:s},M.createElement("button",{type:"button",className:"sidebar--right__close btn-icon","aria-label":"Close",onClick:this.props.actions.closeRightHandSide},M.createElement(V.Z,{id:"rhs_header.closeTooltip.icon",defaultMessage:"Close Sidebar Icon"},(e=>M.createElement("i",{className:"icon icon-close","aria-label":e})))))))}}ut(mt,"propTypes",{isExpanded:y().bool.isRequired,actions:y().shape({showMentions:y().func.isRequired,showSearchResults:y().func.isRequired,showFlaggedPosts:y().func.isRequired,showPinnedPosts:y().func.isRequired,closeRightHandSide:y().func.isRequired,toggleRhsExpanded:y().func.isRequired}).isRequired});const gt=(0,n.connect)((function(e){return{isExpanded:(0,Ke.OZ)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({showMentions:Ve.rb,showSearchResults:Ve.O8,showFlaggedPosts:Ve.Yv,showPinnedPosts:Ve.B7,closeRightHandSide:Ve.Lg,toggleRhsExpanded:Ve.fV},e)}}))(mt);var ft=s(64852),Et=s(20528),Ct=s(30529);function bt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function _t(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function vt(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function yt(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}class Mt extends M.Component{constructor(e){super(e),bt(this,"handleScroll",(()=>{this.state.isScrolling||this.setState({isScrolling:!0}),this.scrollStopAction.fireAfter(N.ZP.SCROLL_DELAY)})),bt(this,"handleScrollStop",(()=>{this.setState({isScrolling:!1})})),bt(this,"handleClick",(()=>{I.tq()&&T.Fy()})),this.scrollStopAction=new pt.Z(this.handleScrollStop),this.state={isScrolling:!1,topRhsPostCreateAt:0}}shouldComponentUpdate(e,t){return!I.JB(t.selected,this.props.selected)||t.isScrolling!==this.state.isScrolling}render(){if(null==this.props.selected)return M.createElement("div",null);const{selected:e,pluginPostCardTypes:t,teamUrl:s}=this.props,n=e.type;let a=null;if(t.hasOwnProperty(n)){const s=t[n].component;a=M.createElement(s,{post:e})}a||(a=M.createElement("div",{className:"info-card"},M.createElement(ft.Z,{message:e.props&&e.props.card})));let i=M.createElement(Et.Z,{userId:e.user_id,hideStatus:!0,disablePopover:!0});e.props.override_username&&this.props.enablePostUsernameOverride&&(i=M.createElement(Et.Z,{userId:e.user_id,hideStatus:!0,disablePopover:!0,overwriteName:e.props.override_username}));const r=M.createElement(Ct.Z,{compactDisplay:!1,post:e,userId:e.user_id});return M.createElement("div",{className:"sidebar-right__body sidebar-right__card"},M.createElement(gt,{previousRhsState:this.props.previousRhsState}),M.createElement(dt.ZP,{autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:vt,renderThumbVertical:yt,renderView:_t,onScroll:this.handleScroll},M.createElement("div",{className:"post-right__scroll"},a,M.createElement("div",{className:"d-flex post-card--info"},M.createElement("div",{className:"post-card--post-by overflow--ellipsis"},M.createElement(V.Z,{id:"rhs_card.message_by",defaultMessage:"Message by {avatar} {user}",values:{user:i,avatar:r}})),M.createElement("div",{className:"post-card--view-post"},M.createElement(ht.Link,{to:"".concat(s,"/pl/").concat(e.id),className:"post__permalink",onClick:this.handleClick},M.createElement(V.Z,{id:"rhs_card.jump",defaultMessage:"Jump"})))))))}}bt(Mt,"propTypes",{selected:y().object,pluginPostCardTypes:y().object,previousRhsState:y().oneOf(Object.values(N.Hp)),enablePostUsernameOverride:y().bool,teamUrl:y().string}),bt(Mt,"defaultProps",{pluginPostCardTypes:{}});const Pt=(0,n.connect)((function(e){const t=(0,Ke.Kj)(e);return{enablePostUsernameOverride:"true"===(0,h.iE)(e).EnablePostUsernameOverride,selected:t,pluginPostCardTypes:e.plugins.postCardTypes,teamUrl:(0,u.gm)(e)}}))(Mt);var wt,St,Tt,Nt=s(36246),Rt=s(8943);class It extends M.PureComponent{render(){return M.createElement("div",{id:"rhsContainer",className:"sidebar-right__body"},M.createElement(Rt.Z,null,this.props.title),this.props.showPluggable&&M.createElement(A.Z,{pluggableName:"RightHandSidebarComponent",pluggableId:this.props.pluggableId}))}}wt=It,St="propTypes",Tt={showPluggable:y().bool.isRequired,pluggableId:y().string.isRequired,title:y().oneOfType([y().string,y().object])},St in wt?Object.defineProperty(wt,St,{value:Tt,enumerable:!0,configurable:!0,writable:!0}):wt[St]=Tt;const Ot=(0,n.connect)((function(e){const t=e.plugins.components.RightHandSidebarComponent,s=(0,Ke.n_)(e),n=t.find((e=>e.id===s)),a=n?n.title:"";return{showPluggable:Boolean(n),pluggableId:s,title:a}}))(It);function Lt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class At extends M.PureComponent{constructor(e){super(e),Lt(this,"setPrevious",(()=>{this.props.isOpen&&(this.previous={searchVisible:this.props.searchVisible,isMentionSearch:this.props.isMentionSearch,isPinnedPosts:this.props.isPinnedPosts,isChannelFiles:this.props.isChannelFiles,isFlaggedPosts:this.props.isFlaggedPosts,selectedPostId:this.props.selectedPostId,selectedPostCardId:this.props.selectedPostCardId,previousRhsState:this.props.previousRhsState})})),Lt(this,"handleShortcut",(e=>{I._E(e)&&I.pD(e,N.ZP.KeyCodes.PERIOD)&&(e.preventDefault(),this.props.isOpen?this.props.actions.closeRightHandSide():this.props.actions.openAtPrevious(this.previous))})),Lt(this,"determineTransition",(()=>{const e=window.getComputedStyle(this.sidebarRight.current).getPropertyValue("transition"),t=Boolean(e)&&"all 0s ease 0s"!==e;this.sidebarRight.current&&t?(this.setState({isOpened:this.props.isOpen}),this.sidebarRight.current.addEventListener("transitionend",this.onFinishTransition)):(this.setState({isOpened:!0}),this.sidebarRight.current&&this.sidebarRight.current.removeEventListener("transitionend",this.onFinishTransition))})),Lt(this,"onFinishTransition",(e=>{"transform"===e.propertyName&&this.setState({isOpened:this.props.isOpen})})),Lt(this,"onShrink",(()=>{this.props.actions.setRhsExpanded(!1)})),Lt(this,"handleUpdateSearchTerms",(e=>{this.props.actions.updateSearchTerms(e),this.focusSearchBar()})),Lt(this,"getSearchBarFocus",(e=>{this.focusSearchBar=e})),this.sidebarRight=M.createRef(),this.state={isOpened:!1}}componentDidMount(){window.addEventListener("resize",this.determineTransition),document.addEventListener("keydown",this.handleShortcut),this.determineTransition()}componentWillUnmount(){window.removeEventListener("resize",this.determineTransition),document.removeEventListener("keydown",this.handleShortcut),this.sidebarRight.current&&this.sidebarRight.current.removeEventListener("transitionend",this.onFinishTransition)}componentDidUpdate(e){const t=e.searchVisible||e.postRightVisible,s=this.props.searchVisible||this.props.postRightVisible;!t&&s&&(this.determineTransition(),(0,Ye.L9)("ui","ui_rhs_opened"));const{actions:n,isChannelFiles:a,isPinnedPosts:i,rhsChannel:r,channel:o}=this.props;i&&e.isPinnedPosts===i&&r.id!==e.rhsChannel.id&&n.showPinnedPosts(r.id),a&&e.isChannelFiles===a&&r.id!==e.rhsChannel.id&&n.showChannelFiles(r.id),o&&e.channel&&o.id!==e.channel.id&&this.props.actions.setRhsExpanded(!1),this.setPrevious()}render(){const{rhsChannel:e,isFlaggedPosts:t,isPinnedPosts:s,isChannelFiles:n,postRightVisible:a,postCardVisible:i,previousRhsState:r,searchVisible:o,isPluginView:l,isOpen:c,isExpanded:d}=this.props;let h=null;const p=(a||i||l||o)&&d;switch(!0){case a:h=M.createElement("div",{className:"post-right__container"},M.createElement(Xe,{overlayType:"right"}),M.createElement(ct,{previousRhsState:r,toggleSize:this.toggleSize,shrink:this.onShrink}));break;case i:h=M.createElement(Pt,{previousRhsState:r});break;case l:h=M.createElement(Ot,null)}return M.createElement("div",{className:W()("sidebar--right",{"sidebar--right--expanded":p},{"move--left":c}),id:"sidebar-right",role:"complementary",ref:this.sidebarRight},M.createElement("div",{onClick:this.onShrink,className:"sidebar--right__bg"}),M.createElement("div",{className:"sidebar-right-container"},M.createElement(Nt.Z,{isFocus:o&&!t&&!s&&!n,isSideBarRight:!0,isSideBarRightOpen:this.state.isOpened,getFocus:this.getSearchBarFocus,channelDisplayName:e?e.display_name:""},h)))}}Lt(At,"propTypes",{isExpanded:y().bool.isRequired,isOpen:y().bool.isRequired,channel:y().object,postRightVisible:y().bool,postRightSameAsSelectedThread:y().bool,postCardVisible:y().bool,searchVisible:y().bool,isMentionSearch:y().bool,isFlaggedPosts:y().bool,isPinnedPosts:y().bool,isChannelFiles:y().bool,isPluginView:y().bool,previousRhsState:y().string,rhsChannel:y().object,selectedPostId:y().string,selectedPostCardId:y().string,actions:y().shape({setRhsExpanded:y().func.isRequired,showPinnedPosts:y().func.isRequired,openRHSSearch:y().func.isRequired,closeRightHandSide:y().func.isRequired,openAtPrevious:y().func.isRequired,updateSearchTerms:y().func.isRequired,showChannelFiles:y().func.isRequired})});const kt=(0,n.connect)((function(e){const t=(0,Ke.kV)(e),s=(0,m.TB)(e),n=(0,Ke.Bh)(e),a=(0,Ke.lW)(e);return{isExpanded:(0,Ke.OZ)(e),isOpen:(0,Ke.aC)(e),channel:s,postRightVisible:Boolean(n),postCardVisible:Boolean(a),searchVisible:Boolean(t)&&t!==N.Hp.PLUGIN,previousRhsState:(0,Ke.ZR)(e),isMentionSearch:t===N.Hp.MENTION,isFlaggedPosts:t===N.Hp.FLAG,isPinnedPosts:t===N.Hp.PIN,isChannelFiles:t===N.Hp.CHANNEL_FILES,isPluginView:t===N.Hp.PLUGIN,rhsChannel:(0,Ke.Gu)(e),selectedPostId:n,selectedPostCardId:a}}),(function(e){return{actions:(0,a.bindActionCreators)({setRhsExpanded:Ve.JI,showPinnedPosts:Ve.B7,openRHSSearch:Ve.Xv,closeRightHandSide:Ve.Lg,openAtPrevious:Ve.DQ,updateSearchTerms:Ve.MR,showChannelFiles:Ve.Cj},e)}}))(At);var xt=s(66660),Dt=s(45288),Zt=(s(39714),s(10188));const Ht=s.p+"files/4f99c2f6b91b67d35afdb9344dd442d0.gif",qt=s.p+"files/e5be3dc87420090bc22a4fd084ddf15d.gif";function jt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ut=N.ZP.Preferences,Ft=N.ZP.TutorialSteps;class Bt extends M.PureComponent{constructor(e){super(e),jt(this,"targetRef",void 0),jt(this,"show",(()=>{this.setState({show:!0})})),jt(this,"hide",(()=>{this.setState({show:!1})})),jt(this,"handleNext",(()=>{if(this.state.currentScreen<this.props.screens.length-1)return void this.setState({currentScreen:this.state.currentScreen+1});if(this.props.telemetryTag){let e=this.props.telemetryTag;this.props.screens.length>1&&(e+="_"+(this.state.currentScreen+1).toString()),this.state.currentScreen===this.props.screens.length-1?e+="_okay":e+="_next",(0,Ye.L9)("tutorial",e)}const{currentUserId:e,actions:t}=this.props,{closeRhsMenu:s,savePreferences:n}=t,a=[{user_id:e,category:Ut.TUTORIAL_STEP,name:e,value:(this.props.step+1).toString()}];s(),this.hide(),n(e,a)})),jt(this,"skipTutorial",(e=>{if(e.preventDefault(),this.props.telemetryTag){let e=this.props.telemetryTag;this.props.screens.length>1&&(e+="_"+this.state.currentScreen),e+="_skip",(0,Ye.L9)("tutorial",e)}const{currentUserId:t,actions:s}=this.props,n=[{user_id:t,category:Ut.TUTORIAL_STEP,name:t,value:Ft.FINISHED.toString()}];s.savePreferences(t,n)})),jt(this,"handleCircleClick",((e,t)=>{e.preventDefault(),this.setState({currentScreen:t})})),jt(this,"getTarget",(()=>this.targetRef.current)),this.state={currentScreen:0,show:!1},this.targetRef=M.createRef()}render(){const e=this.state.currentScreen===this.props.screens.length-1?M.createElement(V.Z,{id:"tutorial_tip.ok",defaultMessage:"Okay"}):M.createElement(V.Z,{id:"tutorial_tip.next",defaultMessage:"Next"}),t=[];if(this.props.screens.length>1)for(let e=0;e<this.props.screens.length;e++){let s="circle";e===this.state.currentScreen&&(s+=" active"),t.push(M.createElement("a",{href:"#",key:"dotactive"+e,className:s,"data-screen":e,onClick:t=>this.handleCircleClick(t,e)}))}let s=Ht;return"tip-overlay--header"!==this.props.overlayClass&&"tip-overlay--sidebar"!==this.props.overlayClass&&"tip-overlay--header--up"!==this.props.overlayClass||(s=qt),M.createElement("div",{id:"tipButton",className:"tip-div "+this.props.overlayClass,onClick:this.show},M.createElement("img",{alt:"tutorial tip",className:"tip-button",src:s,width:"35",onClick:this.show,ref:this.targetRef}),M.createElement(Zt.Z,{show:this.state.show},M.createElement("div",{className:"tip-backdrop"})),M.createElement(Zt.Z,{placement:this.props.placement,show:this.state.show,rootClose:!0,onHide:this.hide,target:this.getTarget},M.createElement("div",{className:"tip-overlay "+this.props.overlayClass},M.createElement("div",{className:"arrow"}),this.props.screens[this.state.currentScreen],M.createElement("div",{className:"tutorial__footer"},M.createElement("div",{className:"tutorial__circles"},t),M.createElement("div",{className:"text-right"},M.createElement("button",{id:"tipNextButton",className:"btn btn-primary",onClick:this.handleNext},e),M.createElement("div",{className:"tip-opt"},M.createElement(V.Z,{id:"tutorial_tip.seen",defaultMessage:"Seen this before? "}),M.createElement("a",{href:"#",onClick:this.skipTutorial},M.createElement(V.Z,{id:"tutorial_tip.out",defaultMessage:"Opt out of these tips."}))))))))}}jt(Bt,"propTypes",{currentUserId:y().string.isRequired,step:y().number.isRequired,screens:y().arrayOf(y().element).isRequired,placement:y().string.isRequired,overlayClass:y().string,telemetryTag:y().string,actions:y().shape({closeRhsMenu:y().func.isRequired,savePreferences:y().func.isRequired}).isRequired}),jt(Bt,"defaultProps",{overlayClass:""});const Gt=(0,n.connect)((function(e){const t=(0,p.rc)(e);return{currentUserId:t,step:(0,d.wS)(e,N.uP.TUTORIAL_STEP,t,0)}}),(function(e){return{actions:(0,a.bindActionCreators)({closeRhsMenu:Ve.Wj,savePreferences:Oe.$A},e)}}))(Bt),Vt=({toggleFunc:e,onBottom:t})=>{const s=[];s.push(M.createElement("div",null,M.createElement("h4",null,M.createElement(V.Z,{id:"sidebar_header.tutorial.title",defaultMessage:"Main Menu"})),M.createElement("p",null,M.createElement(Dt.Z,{id:"sidebar_header.tutorial.body1",defaultMessage:"The **Main Menu** is where you can **Invite New Members**, access your **Account Settings** and set your **Theme Color**."})),M.createElement("p",null,M.createElement(Dt.Z,{id:"sidebar_header.tutorial.body2",defaultMessage:"Team administrators can also access their **Team Settings** from this menu."})),M.createElement("p",null,M.createElement(Dt.Z,{id:"sidebar_header.tutorial.body3",defaultMessage:"System administrators will find a **System Console** option to administrate the entire system."}))));let n="right",a="left";return t&&(n="bottom",a="up"),M.createElement("div",{onClick:e},M.createElement(Gt,{placement:n,screens:s,overlayClass:"tip-overlay--header--"+a,telemetryTag:"tutorial_tip_3_main_menu"}))};Vt.propTypes={toggleFunc:y().func,onBottom:y().bool.isRequired};const Kt=Vt;var Yt=s(36745);function Wt(e){return{type:N.MF.SET_SHOW_NEXT_STEPS_VIEW,show:e}}const zt=()=>async(e,t)=>{const s=(0,p.rc)(t());e(Wt(!0)),e((0,Oe.$A)(s,[{user_id:s,category:N.uP.RECOMMENDED_NEXT_STEPS,name:N.jm.HIDE,value:"false"}]))};s(32023);var Jt=s(22222);function Xt(e){return e?"cloud_first_user_onboarding":"cloud_end_user_onboarding"}function Qt(e,t){return t.split(" ").some((t=>e.roles.includes(t)))||0===e.roles.length}var $t=s(50696),es=(s(60285),s(60291));function ts(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function ss(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(s),!0).forEach((function(t){ns(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ts(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ns(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const as=e=>{const{name:t,src:s,defaultSrc:n,placeholder:a,loadingPicture:i,onSelect:r,onRemove:o}=e,[l,c]=(0,M.useState)(),[d,h]=(0,M.useState)(),p=M.createRef(),u=M.createRef();let m;return(0,M.useEffect)((()=>{l||(s?c(s):n&&c(n))}),[s,l]),l&&l!==n&&(m=M.createElement("button",{"data-testid":"PictureSelector__removeButton",className:"PictureSelector__removeButton",disabled:i,onClick:()=>{o(),c(n||void 0)}},M.createElement(V.Z,{id:"picture_selector.remove_picture",defaultMessage:"Remove picture"}))),M.createElement("div",{className:"PictureSelector"},M.createElement("input",{name:t,"data-testid":"PictureSelector__input-".concat(t),ref:p,className:"PictureSelector__input hidden",accept:".jpg,.png,.bmp",type:"file",onChange:e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0],s=new FileReader;s.onload=e=>{c(URL.createObjectURL(t));const s=es.Ii(e.target.result);h(es.vl(s))},s.readAsArrayBuffer(t),r(t)}},disabled:i,"aria-hidden":!0,tabIndex:-1}),M.createElement("div",{className:"PictureSelector__imageContainer"},M.createElement("div",{"aria-label":(0,I._u)("picture_selector.image.ariaLabel","Picture selector image"),className:"PictureSelector__image",style:ss({backgroundImage:"url("+l+")"},d)},!l&&a),M.createElement("button",{ref:u,"data-testid":"PictureSelector__selectButton",className:"PictureSelector__selectButton",disabled:i,onClick:()=>{var t;e.onOpenDialog&&e.onOpenDialog(),p&&p.current&&(null===(t=u.current)||void 0===t||t.blur(),p.current.value="",p.current.click())},"aria-label":(0,I._u)("picture_selector.select_button.ariaLabel","Select picture")},M.createElement("i",{className:"icon icon-pencil-outline"}))),m)};as.propTypes={name:y().string.isRequired,src:y().string,defaultSrc:y().string,placeholder:y().node,loadingPicture:y().bool,onOpenDialog:y().func,onSelect:y().func.isRequired,onRemove:y().func.isRequired};const is=as;function rs(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class os extends M.PureComponent{constructor(e){super(e),rs(this,"handleInputChange",(e=>{let t;e.target.value?e.target.value.length>128&&(t=I._u("next_steps_view.complete_profile_step.fullNameTooBig","Your name must be less than 128 character")):t=I._u("next_steps_view.complete_profile_step.fullNameCannotBeBlank","Your full name cannot be blank"),this.setState({fullName:e.target.value,fullNameError:t})})),rs(this,"handleUsernameChange",(e=>{const t=I.rh(e.target.value);let s;t&&(s=t.id===N.qf.RESERVED_NAME?I._u("user.settings.general.usernameReserved","This username is reserved, please choose a new one."):I._u("next_steps_view.complete_profile_step.usernameTooBig","Username must begin with a letter, and contain between 3 to 22 lowercase characters made up of numbers, letters, and the symbols '.', '-', and '_'.")),this.setState({username:e.target.value,usernameError:s})})),rs(this,"isFinishDisabled",(()=>Boolean(!this.state.fullName||this.state.fullNameError||this.state.profilePictureError||this.state.usernameError))),rs(this,"onSkip",(()=>{this.props.onSkip(this.props.id)})),rs(this,"onFinish",(()=>{const e=this.state.fullName.split(" "),t=e[0].slice(0,64),s=e.slice(1).join(" ").slice(0,64),n=this.state.username.trim(),a=Object.assign({},this.props.currentUser,{username:n,first_name:t,last_name:s});this.props.actions.updateMe(a),this.state.profilePicture?this.props.actions.uploadProfileImage(this.props.currentUser.id,this.state.profilePicture):this.state.removeProfilePicture&&this.props.actions.setDefaultProfileImage(this.props.currentUser.id),(0,Ye.L9)(Xt(this.props.isAdmin),"click_save_profile"),this.props.onFinish(this.props.id)})),rs(this,"onOpenPictureDialog",(()=>{(0,Ye.L9)(Xt(this.props.isAdmin),"click_add_profile_photo")})),rs(this,"onSelectPicture",(e=>{if(!N.Ec.includes(e.type)||e.size>this.props.maxFileSize)return(0,Ye.L9)(Xt(this.props.isAdmin),"error_profile_photo_invalid"),void this.setState({profilePictureError:!0});this.setState({profilePicture:e,profilePictureError:!1,removeProfilePicture:!1})})),rs(this,"onRemovePicture",(()=>{(0,Ye.L9)(Xt(this.props.isAdmin),"click_remove_photo"),this.setState({profilePicture:void 0,profilePictureError:!1,removeProfilePicture:!0})}));const t=e.currentUser;this.state={fullName:t.first_name||t.last_name?"".concat(t.first_name," ").concat(t.last_name):"",username:t.username||"",profilePictureError:!1,removeProfilePicture:!1}}componentDidMount(){this.props.expanded&&(0,Ye.tF)(Xt(this.props.isAdmin),"pageview_complete_profile")}componentDidUpdate(e){e.expanded!==this.props.expanded&&this.props.expanded&&(0,Ye.tF)(Xt(this.props.isAdmin),"pageview_complete_profile")}render(){const{currentUser:e}=this.props,t=e.last_picture_update?I.bb(e.id,e.last_picture_update):void 0,s=I.Vl(e.id);return M.createElement("div",{className:"NextStepsView__stepWrapper"},M.createElement("div",{className:"CompleteProfileStep"},M.createElement("div",{className:"CompleteProfileStep__profilePicture"},M.createElement("h3",null,M.createElement(V.Z,{id:"next_steps_view.complete_profile_step.addAPhoto",defaultMessage:"Upload avatar"})),M.createElement(is,{name:"CompleteProfileStep__profilePicture",onOpenDialog:this.onOpenPictureDialog,onSelect:this.onSelectPicture,onRemove:this.onRemovePicture,src:t,defaultSrc:s})),M.createElement("div",{className:"CompleteProfileStep_compose"},M.createElement("div",{className:"CompleteProfileStep__fullName"},M.createElement("h3",null,M.createElement(V.Z,{id:"next_steps_view.complete_profile_step.enterYourName",defaultMessage:"Enter your name"})),M.createElement($t.Z,{name:"fullName",type:"text",value:this.state.fullName,onChange:this.handleInputChange,placeholder:I._u("next_steps_view.complete_profile_step.yourFullName","Your full name"),error:this.state.fullNameError,info:I._u("next_steps_view.complete_profile_step.nameWillBeDisplayed","Your name will be displayed with your messages")})),M.createElement("div",{className:"CompleteProfileStep__username"},M.createElement("h3",null,M.createElement(V.Z,{id:"next_steps_view.complete_profile_step.enterYourUsername",defaultMessage:"Tài khoản"})),M.createElement($t.Z,{name:"username",type:"text",value:this.state.username,onChange:this.handleUsernameChange,placeholder:I._u("next_steps_view.complete_profile_step.yourUsername","Đặt tên tài khoản"),error:this.state.usernameError,info:I._u("next_steps_view.complete_profile_step.usernameWillBeDisplayed","Tên tài khoản sẽ giúp người khác tìm bạn nhanh hơn")})))),this.state.profilePictureError&&M.createElement("span",{className:"CompleteProfileStep__pictureError"},M.createElement("i",{className:"icon icon-alert-outline"}),M.createElement(Dt.Z,{id:"next_steps_view.complete_profile_step.pictureError",defaultMessage:"Photos must be in BMP, JPG or PNG format. Maximum file size is {max}.",values:{max:I.eA(this.props.maxFileSize)}})),M.createElement("div",{className:"NextStepsView__wizardButtons"},M.createElement("button",{"data-testid":"CompleteProfileStep__saveProfileButton",className:W()("NextStepsView__button NextStepsView__finishButton primary",{disabled:this.isFinishDisabled()}),onClick:this.onFinish,disabled:this.isFinishDisabled()},M.createElement(V.Z,{id:"next_steps_view.complete_profile_step.saveProfile",defaultMessage:"Save profile"}))))}}rs(os,"propTypes",{maxFileSize:y().number.isRequired,actions:y().shape({updateMe:y().func.isRequired,setDefaultProfileImage:y().func.isRequired,uploadProfileImage:y().func.isRequired}).isRequired});const ls=(0,n.connect)((function(e){const t=(0,h.iE)(e);return{maxFileSize:parseInt(t.MaxFileSize,10)}}),(function(e){return{actions:(0,a.bindActionCreators)({updateMe:r.DO,setDefaultProfileImage:r.QJ,uploadProfileImage:r._p},e)}}))(os);var cs=s(96269);function ds(e){return M.createElement("div",{className:"TextCardWithAction"},M.createElement("div",{className:"card-body"},M.createElement(V.Z,{id:e.cardBodyMessageId,defaultMessage:e.cardBodyDefaultMessage})),M.createElement("div",{className:"NextStepsView__wizardButtons"},M.createElement("button",{className:"NextStepsView__button NextStepsView__finishButton primary",onClick:e.onClick},M.createElement(V.Z,{id:e.buttonMessageId,defaultMessage:e.buttonDefaultMessage}))))}var hs=s(18402);const ps=[{id:N.jm.COMPLETE_PROFILE,title:(0,I._u)("next_steps_view.titles.completeProfile","Hoàn thành hồ sơ"),component:ls,roles:[],visible:!0},{id:N.jm.NOTIFICATION_SETUP,title:(0,I._u)("next_steps_view.notificationSetup.setNotifications","Cài đặt thông báo"),roles:["system_user"],component:function(e){(0,M.useEffect)((()=>{e.expanded&&(0,Ye.tF)(Xt(e.isAdmin),"pageview_enable_notifications")}),[e.expanded]);const t=async()=>{(0,Ye.L9)(Xt(e.isAdmin),"click_enable_notifications");try{await(0,hs.c)({title:I._u("next_steps_view.notificationSetup.notficationsEnabledTitle","Notifications Enabled!"),body:I._u("next_steps_view.notificationSetup.notficationsEnabledBody","This is how notifications from Mattermost will appear"),requireInteraction:!1,silent:!1,onClick:()=>{}})}catch(e){}e.onFinish(e.id)};return"Notification"in window&&"denied"!==Notification.permission?M.createElement(ds,{cardBodyMessageId:"next_steps_view.notificationSetup.notficationsEnabledBody",cardBodyDefaultMessage:"We recommend enabling desktop notifications so you don’t miss any important communications.",buttonMessageId:"next_steps_view.notificationSetup.setNotifications",buttonDefaultMessage:"Set up notifications",onClick:t}):M.createElement("div",null,M.createElement(ds,{cardBodyMessageId:"next_steps_view.notificationSetupNotificationsDisabled",cardBodyDefaultMessage:"Notifications were previously disabled or you may be browsing in private mode. You'll need to open your browser settings or turn off private mode to enable notifications.",buttonMessageId:"next_steps_view.notificationSetup.skipThisStep",buttonDefaultMessage:"Skip this step",onClick:t}))},visible:!0},{id:N.jm.PREFERENCES_SETUP,title:(0,I._u)("next_steps_view.titles.preferenceSetup","Set your preferences"),roles:["system_user"],component:function(e){(0,M.useEffect)((()=>{e.expanded&&(0,Ye.tF)(Xt(e.isAdmin),"pageview_enable_notifications")}),[e.expanded]);const t=(0,n.useDispatch)(),s=()=>{e.onFinish(e.id)};return M.createElement(M.Fragment,null,M.createElement(ds,{cardBodyMessageId:"next_steps_view.preferenceSetup",cardBodyDefaultMessage:"You can change how you receive notifications, update your profile, customize display settings and more. Preferences can be accessed through the Main Menu.",buttonMessageId:"next_steps_view.preferenceSetup.setPreferences",buttonDefaultMessage:"Set Preferences",onClick:()=>{(0,Ye.L9)(Xt(e.isAdmin),"click_set_preferences"),t((0,H.h)({modalId:N.r8.USER_SETTINGS,dialogType:cs.Z,dialogProps:{onExit:s}}))}}))},visible:!1}],us=(0,Jt.P1)((e=>(0,p.ts)(e)),(e=>(0,p.Rf)(e)),((e,t)=>{if(!e.roles.includes("system_admin"))return!1;const s=Object.keys(t);for(const n of s){const s=t[n];if(s.roles.includes("system_admin")&&s.create_at<e.create_at)return!1}return!0})),ms=(0,Jt.P1)((e=>(0,p.ts)(e)),(e=>us(e)),((e,t)=>{const s=t?"first_admin ".concat(e.roles):e.roles;return ps.filter((e=>Qt(e,s)&&e.visible))})),gs=(0,d.YX)(),fs=(0,Jt.P1)((e=>Cs(e)),(e=>bs(e)),(e=>(0,h.lJ)(e)),(e=>e.views.nextSteps.show),((e,t,s,n)=>!n&&"true"===s.Cloud&&(e||t))),Es=(0,Jt.P1)((e=>gs(e,N.uP.RECOMMENDED_NEXT_STEPS)),(e=>e.some((e=>e.name===N.jm.HIDE&&"true"===e.value)))),Cs=(0,Jt.P1)((e=>gs(e,N.uP.RECOMMENDED_NEXT_STEPS)),(e=>(0,h.lJ)(e)),(e=>_s(e)),((e,t,s)=>!e.some((e=>e.name===N.jm.SKIP&&"true"===e.value))&&"true"===t.Cloud&&s)),bs=(0,Jt.P1)((e=>gs(e,N.uP.RECOMMENDED_NEXT_STEPS)),(e=>(0,h.lJ)(e)),(e=>_s(e)),((e,t,s)=>!!e.some((e=>e.name===N.jm.SKIP&&"true"===e.value))||"true"===t.Cloud&&!s)),_s=(0,Jt.P1)((e=>gs(e,N.uP.RECOMMENDED_NEXT_STEPS)),(e=>(0,p.ts)(e)),(e=>us(e)),((e,t,s)=>{const n=s?"first_admin ".concat(t.roles):t.roles;return!ps.every((t=>e.some((e=>e.name===t.id&&"true"===e.value||!Qt(t,n)))))}));var vs=s(33574),ys=s(36846),Ms=s(3598),Ps=s(2015),ws=(s(64765),s(85206)),Ss=s(56727);function Ts(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ns extends M.PureComponent{constructor(e){super(e),Ts(this,"handleTermChange",(e=>{this.setState({term:e})})),Ts(this,"nextPage",(()=>{this.setState({page:this.state.page+1}),this.props.nextPage(this.state.page+1)})),Ts(this,"previousPage",(()=>{this.setState({page:this.state.page-1})})),Ts(this,"search",(e=>{this.props.search(e),""!==e&&this.setState({page:0})})),this.state={term:"",page:0}}render(){return M.createElement(Ss.Z,Object.assign({},this.props,{nextPage:this.nextPage,previousPage:this.previousPage,search:this.search,page:this.state.page,term:this.state.term,onTermChange:this.handleTermChange}))}}Ts(Ns,"propTypes",{users:y().arrayOf(y().object),usersPerPage:y().number,total:y().number,extraInfo:y().object,nextPage:y().func.isRequired,search:y().func.isRequired,actions:y().arrayOf(y().any),actionProps:y().object,actionUserProps:y().object,focusOnMount:y().bool});var Rs=s(92902),Is=s(15240),Os=s(38122);function Ls(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class As extends M.PureComponent{constructor(e){super(e),Ls(this,"handleMakeMember",(async()=>{const e=this.props.currentUser;if(this.props.user.id===e.id&&e.roles.includes("system_admin"))this.handleDemote(this.props.user,"team_user");else{const{error:t}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!1);t?this.setState({serverError:t.message}):(this.props.actions.getUser(this.props.user.id),this.props.actions.getTeamMember(this.props.teamMember.team_id,this.props.user.id),this.props.user.id===e.id&&(await this.props.actions.getMyTeamMembers(),this.props.actions.getMyTeamUnreads()))}})),Ls(this,"handleRemoveFromTeam",(async()=>{const{error:e}=await this.props.actions.removeUserFromTeamAndGetStats(this.props.teamMember.team_id,this.props.user.id);e&&this.setState({serverError:e.message})})),Ls(this,"handleMakeAdmin",(async()=>{const e=this.props.currentUser;if(this.props.user.id===e.id&&e.roles.includes("system_admin"))this.handleDemote(this.props.user,"team_user team_admin");else{const{error:e}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!0);e?this.setState({serverError:e.message}):(this.props.actions.getUser(this.props.user.id),this.props.actions.getTeamMember(this.props.teamMember.team_id,this.props.user.id))}})),Ls(this,"handleDemote",((e,t)=>{this.setState({serverError:this.state.serverError,showDemoteModal:!0,user:e,role:t})})),Ls(this,"handleDemoteCancel",(()=>{this.setState({serverError:null,showDemoteModal:!1,user:null,role:null})})),Ls(this,"handleDemoteSubmit",(async()=>{const{error:e}=await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id,this.props.user.id,!0,!1);e?this.setState({serverError:e.message}):(this.props.actions.getUser(this.props.user.id),st.m.push(this.props.teamUrl))})),this.state={serverError:null,showDemoteModal:!1,user:null,role:null}}render(){let e=null;this.state.serverError&&(e=M.createElement("div",{className:"has-error"},M.createElement("label",{className:"has-error control-label"},this.state.serverError)));const{currentTeam:t,teamMember:s,user:n}=this.props;let a=null;a=I.a_(n)?M.createElement(V.Z,{id:"team_members_dropdown.guest",defaultMessage:"Guest"}):n.roles.length>0&&I.$O(n.roles)?M.createElement(V.Z,{id:"team_members_dropdown.systemAdmin",defaultMessage:"System Admin"}):s.roles.length>0&&I.GJ(s.roles)||s.scheme_admin?M.createElement(V.Z,{id:"team_members_dropdown.teamAdmin",defaultMessage:"Team Admin"}):M.createElement(V.Z,{id:"team_members_dropdown.member",defaultMessage:"Member"});const i=this.props.currentUser;let r=!I.a_(n)&&(I.GJ(s.roles)||s.scheme_admin)&&!I.$O(n.roles),o=!(I.a_(n)||I.GJ(s.roles)||I.$O(n.roles)||s.scheme_admin);n.delete_at>0&&(a=M.createElement(V.Z,{id:"team_members_dropdown.inactive",defaultMessage:"Inactive"}),r=!1,o=!1);const l=n.id!==i.id&&(!t.group_constrained||n.is_bot);let c=null;if(n.id===i.id){const t=M.createElement(V.Z,{id:"team_members_dropdown.confirmDemoteRoleTitle",defaultMessage:"Confirm Demotion from System Admin Role"}),s=M.createElement("div",null,M.createElement(V.Z,{id:"team_members_dropdown.confirmDemoteDescription",defaultMessage:"If you demote yourself from the System Admin role and there is not another user with System Admin privileges, you'll need to re-assign a System Admin by accessing the Mattermost server through a terminal and running the following command."}),M.createElement("br",null),M.createElement("br",null),M.createElement(V.Z,{id:"team_members_dropdown.confirmDemotionCmd",defaultMessage:"platform roles system_admin {username}",values:{username:i.username}}),e),n=M.createElement(V.Z,{id:"team_members_dropdown.confirmDemotion",defaultMessage:"Confirm Demotion"});c=M.createElement(Te.Z,{show:this.state.showDemoteModal,title:t,message:s,confirmButtonText:n,onConfirm:this.handleDemoteSubmit,onCancel:this.handleDemoteCancel})}if(!l&&!o&&!r)return M.createElement("div",null,a);const{index:d,totalUsers:h}=this.props;let p=!1;h>3&&h-d<=3&&(p=!0);const u=M.createElement(Is.Z.ItemAction,{id:"removeFromTeam",onClick:this.handleRemoveFromTeam,text:I._u("team_members_dropdown.leave_team","Remove From Team")}),m=M.createElement(Is.Z.ItemAction,{onClick:this.handleMakeAdmin,text:I._u("team_members_dropdown.makeAdmin","Make Team Admin")}),g=M.createElement(Is.Z.ItemAction,{onClick:this.handleMakeMember,text:I._u("team_members_dropdown.makeMember","Make Member")});return M.createElement(Os.Z,null,M.createElement("button",{id:"teamMembersDropdown_".concat(n.username),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true"},M.createElement("span",null,a," "),M.createElement(Rs.Z,null)),M.createElement("div",null,M.createElement(Is.Z,{openLeft:!0,openUp:p,ariaLabel:I._u("team_members_dropdown.menuAriaLabel","Change the role of a team member")},l?u:null,o?m:null,r?g:null),c,e))}}Ls(As,"propTypes",{teamUrl:y().string.isRequired,index:y().number.isRequired,totalUsers:y().number.isRequired,actions:y().shape({getMyTeamMembers:y().func.isRequired,getMyTeamUnreads:y().func.isRequired,getUser:y().func.isRequired,getTeamMember:y().func.isRequired,getTeamStats:y().func.isRequired,getChannelStats:y().func.isRequired,updateTeamMemberSchemeRoles:y().func.isRequired,updateUserActive:y().func.isRequired,removeUserFromTeamAndGetStats:y().func.isRequired}).isRequired});const ks=(0,n.connect)((function(e){return{currentUser:(0,p.ts)(e),teamUrl:(0,u.gm)(e),currentTeam:(0,u.kA)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getMyTeamMembers:l.r8,getMyTeamUnreads:l.Jw,getUser:r.PR,getTeamMember:l.PB,getTeamStats:l.zG,getChannelStats:o.mx,updateUserActive:r.q0,updateTeamMemberSchemeRoles:l.Ih,removeUserFromTeamAndGetStats:C.u7},e)}}))(As);function xs(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ds extends M.PureComponent{constructor(e){super(e),xs(this,"searchTimeoutId",void 0),xs(this,"loadComplete",(()=>{this.setState({loading:!1})})),xs(this,"nextPage",(async e=>{this.setState({loading:!0}),await Promise.all([this.props.actions.loadProfilesAndTeamMembers(e,50,this.props.currentTeamId,{active:!0}),this.props.actions.getTeamMembers(this.props.currentTeamId,e,N.ZP.DEFAULT_MAX_USERS_PER_TEAM,{sort:D.pd.SORT_USERNAME_OPTION,exclude_deleted_users:!0})]),this.loadComplete()})),xs(this,"search",(e=>{this.props.actions.setModalSearchTerm(e)})),this.searchTimeoutId=0,this.state={loading:!0}}async componentDidMount(){await Promise.all([this.props.actions.loadProfilesAndTeamMembers(0,N.ZP.PROFILE_CHUNK_SIZE,this.props.currentTeamId,{active:!0}),this.props.actions.getTeamMembers(this.props.currentTeamId,0,N.ZP.DEFAULT_MAX_USERS_PER_TEAM,{sort:D.pd.SORT_USERNAME_OPTION,exclude_deleted_users:!0}),this.props.actions.getTeamStats(this.props.currentTeamId)]),this.loadComplete()}componentWillUnmount(){this.props.actions.setModalSearchTerm("")}componentDidUpdate(e){if(e.searchTerm!==this.props.searchTerm){clearTimeout(this.searchTimeoutId);const e=this.props.searchTerm;if(""===e)return this.loadComplete(),void(this.searchTimeoutId=0);const t=window.setTimeout((async()=>{const{loadStatusesForProfilesList:s,loadTeamMembersForProfilesList:n,searchProfiles:a}=this.props.actions,{data:i}=await a(e,{team_id:this.props.currentTeamId});t===this.searchTimeoutId&&(this.setState({loading:!0}),s(i),n(i,this.props.currentTeamId,!0).then((({data:e})=>{e&&this.loadComplete()})))}),N.ZP.SEARCH_TIMEOUT_MILLISECONDS);this.searchTimeoutId=t}}render(){let e=null;this.props.canManageTeamMembers&&(e=[ks]);const t=this.props.teamMembers,s=this.props.users,n={};let a;if(this.state.loading)a=null;else{a=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.id]&&0===i.delete_at&&(a.push(i),n[i.id]={teamMember:t[i.id]})}}return M.createElement(Ns,{users:a,usersPerPage:50,total:this.props.totalTeamMembers,nextPage:this.nextPage,search:this.search,actions:e,actionUserProps:n,focusOnMount:!R.tq()})}}xs(Ds,"propTypes",{searchTerm:y().string.isRequired,users:y().array.isRequired,currentTeamId:y().string.isRequired,totalTeamMembers:y().number.isRequired,canManageTeamMembers:y().bool,actions:y().shape({getTeamMembers:y().func.isRequired,searchProfiles:y().func.isRequired,getTeamStats:y().func.isRequired,loadProfilesAndTeamMembers:y().func.isRequired,loadStatusesForProfilesList:y().func.isRequired,loadTeamMembersForProfilesList:y().func.isRequired,setModalSearchTerm:y().func.isRequired}).isRequired});const Zs=(0,n.connect)((function(e,t){const s=(0,Z.Rm)(e,{team:t.teamId,permission:D.Pl.MANAGE_TEAM_ROLES}),n=e.views.search.modalSearch;let a;a=n?(0,p.lo)(e,n):(0,p.fv)(e);const i=(0,u.vP)(e)||{active_member_count:0};return{searchTerm:n,users:a,teamMembers:(0,u.or)(e)||{},currentTeamId:e.entities.teams.currentTeamId,totalTeamMembers:i.active_member_count,canManageTeamMembers:s}}),(function(e){return{actions:(0,a.bindActionCreators)({searchProfiles:r.t6,getTeamStats:l.zG,getTeamMembers:l.YY,loadProfilesAndTeamMembers:Le.$u,loadStatusesForProfilesList:E.xO,loadTeamMembersForProfilesList:Le.Z5,setModalSearchTerm:ws.Gl},e)}}))(Ds);var Hs=s(41609),qs=s.n(Hs);function js(e,t,s){return async(n,a)=>{t.length>0&&await n(l._x(e,t.map((e=>e.id))));const i=a(),r=[],o=[],c=[];for(const s of t){const t=(0,u.PB)(i,e,s.id);(0,I.a_)(s)?o.push({user:s,reason:(0,I._u)("invite.members.user-is-guest","Contact your admin to make this guest a full member.")}):t?o.push({user:s,reason:(0,I._u)("invite.members.already-member","This person is already a team member.")}):c.push(s)}if(c.length>0){const t=(await n((0,C.XJ)(e,c.map((e=>e.id))))).data||[];for(const e of c){const s=t.find((t=>t.user_id===e.id&&t.error));s?o.push({user:e,reason:s.error.message}):r.push({user:e,reason:(0,I._u)("invite.members.added-to-team","This member has been added to the team.")})}}if(s.length>0){let t;try{t=await n(l.$B(e,s))}catch(e){t={data:s.map((e=>({email:e,error:{error:(0,I._u)("invite.members.unable-to-add-the-user-to-the-team","Unable to add the user to the team.")}})))}}const a=t.data||[];if(t.error){"app.email.rate_limit_exceeded.app_error"===t.error.server_error_id&&(t.error.message=(0,I._u)("invite.rate-limit-exceeded","Invite emails rate limit exceeded."));for(const e of s)o.push({email:e,reason:t.error.message})}else for(const e of s){const t=a.find((t=>e.toLowerCase()===t.email&&t.error));t?o.push({email:e,reason:t.error.message}):r.push({email:e,reason:(0,I._u)("invite.members.invite-sent","An invitation email has been sent.")})}}return{sent:r,notSent:o}}}function Us(e,t,s,n,a){return async(i,r)=>{s.length>0&&await i(l._x(e,s.map((e=>e.id))));const c=r(),d=[],h=[],p=(0,m.E0)(c),u=await Promise.all(s.map((s=>async function(e,t,s,n,a){if(!(0,I.a_)(t))return{notSent:{user:t,reason:(0,I._u)("invite.members.user-is-not-guest","This person is already a member.")}};let i=!0,r=!1;for(const e of n)a&&a[e]&&a[e][t.id]?r=!0:i=!1;if(i)return{notSent:{user:t,reason:(0,I._u)("invite.guests.already-all-channels-member","This person is already a member of all the channels.")}};try{await e((0,C.XJ)(s,[t.id]));for(const i of n)a&&a[i]&&a[i][t.id]||await e((0,o.JJ)(t.id,s,i))}catch(e){return{notSent:{user:t,reason:(0,I._u)("invite.guests.unable-to-add-the-user-to-the-channels","Unable to add the guest to the channels.")}}}return r?{notSent:{user:t,reason:(0,I._u)("invite.guests.already-some-channels-member","This person is already a member of some of the channels.")}}:{sent:{user:t,reason:{id:(0,Ae.t)("invite.guests.new-member"),message:"This guest has been added to the team and {count, plural, one {channel} other {channels}}.",values:{count:n.length}}}}}(i,s,e,t,p))));for(const e of u)e.sent&&d.push(e.sent),e.notSent&&h.push(e.notSent);if(n.length>0){let s;try{s=await i(l.AG(e,t,n,a))}catch(e){s={data:n.map((e=>({email:e,error:{error:(0,I._u)("invite.guests.unable-to-add-the-user-to-the-channels","Unable to add the guest to the channels.")}})))}}if(s.error){"app.email.rate_limit_exceeded.app_error"===s.error.server_error_id&&(s.error.message=(0,I._u)("invite.rate-limit-exceeded","Invite emails rate limit exceeded."));for(const e of n)h.push({email:e,reason:s.error.message})}else for(const e of s.data||[])e.error?h.push({email:e.email,reason:e.error.message}):d.push({email:e.email,reason:(0,I._u)("invite.guests.added-to-channel","An invitation email has been sent.")})}return{sent:d,notSent:h}}}var Fs,Bs=s(86486),Gs=s(75872),Vs=s(78318),Ks=s(65339),Ys=s(86896),Ws=s(11106);let zs;!function(e){e.NotStarted="NOT_STARTED",e.Started="STARTED",e.Success="SUCCESS",e.Failed="FAILED"}(Fs||(Fs={})),function(e){e.NotifyAdmin="Notify the admin.",e.Sending="Sending...",e.Sent="Sent!",e.Failed="Failed. Try again later."}(zs||(zs={}));const Js=e=>{const[t,s]=(0,M.useState)(Fs.NotStarted),{formatMessage:n}=(0,Ys.Z)();return(0,M.useEffect)((()=>{"function"==typeof e.extraFunc&&(t!==Fs.Success&&t!==Fs.Failed||e.extraFunc())}),[t]),M.createElement("button",{disabled:t!==Fs.NotStarted,onClick:()=>(async()=>{try{s(Fs.Started),await Ws.je.sendAdminUpgradeRequestEmail(),s(Fs.Success)}catch(e){e&&s(Fs.Failed)}})(),className:e.className?e.className:"btn-link"},(e=>{switch(e){case Fs.Started:return n({id:"invitation-modal.notify-admin.sending",defaultMessage:zs.Sending});case Fs.Success:return n({id:"invitation-modal.notify-admin.sent",defaultMessage:zs.Sent});case Fs.Failed:return n({id:"invitation-modal.notify-admin.failed",defaultMessage:zs.Failed});default:return n({id:"invitation-modal.notify-admin.notify",defaultMessage:zs.NotifyAdmin})}})(t))};Js.propTypes={className:y().string,extraFunc:y().func};const Xs=Js,Qs=()=>M.createElement("svg",{width:"512",height:"156",viewBox:"0 0 250 156",fill:"none",xmlns:"http://www.w3.org/2000/svg"},M.createElement("path",{opacity:"0.1",d:"M154.728 52.6597C153.343 52.398 151.911 52.5537 150.616 53.1067C149.834 53.4519 148.988 53.6284 148.133 53.6246C147.278 53.6209 146.434 53.4369 145.655 53.0848C144.737 52.6839 143.742 52.4863 142.739 52.5057C141.737 52.5251 140.751 52.761 139.848 53.1971C139.333 53.4696 138.759 53.613 138.176 53.6148C135.822 53.6148 133.863 51.2527 133.456 48.1359C133.926 47.7929 134.325 47.3634 134.633 46.8706C136.013 44.655 138.152 43.2334 140.552 43.2334C142.953 43.2334 145.064 44.6379 146.437 46.8315C146.85 47.4949 147.429 48.0407 148.116 48.4156C148.804 48.7905 149.577 48.982 150.361 48.9713H150.422C152.303 48.981 153.926 50.4784 154.728 52.6597Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M218.4 76.0436C216.577 75.7024 214.693 75.9053 212.987 76.6264C211.958 77.0764 210.845 77.3065 209.719 77.3016C208.594 77.2967 207.482 77.0568 206.458 76.5977C205.249 76.0751 203.939 75.8175 202.62 75.8428C201.3 75.8681 200.002 76.1757 198.815 76.7442C198.137 77.0995 197.381 77.2864 196.613 77.2888C193.515 77.2888 190.936 74.2092 190.4 70.1456C191.019 69.6985 191.545 69.1385 191.949 68.4959C193.766 65.6074 196.581 63.7539 199.741 63.7539C202.901 63.7539 205.68 65.5851 207.487 68.4449C208.031 69.3099 208.792 70.0214 209.697 70.5103C210.602 70.9991 211.62 71.2487 212.652 71.2347H212.732C215.208 71.2475 217.345 73.1997 218.4 76.0436Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M161.888 42.8765L158.082 45.2825L160.392 41.0957C159.737 40.5762 158.927 40.2883 158.09 40.2774H158.029C157.764 40.2821 157.5 40.2633 157.239 40.2212L155.954 41.0347L156.508 40.0332C155.594 39.7152 154.804 39.1165 154.252 38.3233L151.942 39.7889L153.414 37.1483C152.063 35.5337 150.243 34.542 148.242 34.542C145.842 34.542 143.703 35.9661 142.323 38.1816C141.915 38.8468 141.336 39.392 140.647 39.7611C139.957 40.1303 139.182 40.3101 138.399 40.2823H138.269C135.619 40.2823 133.471 43.2771 133.471 46.968C133.471 50.6589 135.619 53.6536 138.269 53.6536C138.852 53.6517 139.426 53.5093 139.942 53.2383C140.844 52.8012 141.83 52.5646 142.832 52.5447C143.835 52.5249 144.83 52.7224 145.748 53.1235C146.525 53.4709 147.365 53.6515 148.216 53.6536C149.067 53.6557 149.909 53.4793 150.687 53.1358C151.599 52.7423 152.584 52.5485 153.578 52.5675C154.571 52.5864 155.549 52.8177 156.444 53.2457C156.955 53.5116 157.521 53.6515 158.097 53.6536C160.748 53.6536 162.896 50.6613 162.896 46.968C162.91 45.5414 162.564 44.1343 161.888 42.8765V42.8765Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M228.257 62.9219L223.187 66.1324L226.264 60.5458C225.391 59.8525 224.312 59.4684 223.197 59.4539H223.115C222.763 59.4601 222.411 59.435 222.063 59.3789L220.352 60.4643L221.09 59.1279C219.872 58.7036 218.819 57.9048 218.085 56.8464L215.007 58.802L216.967 55.2786C215.168 53.1241 212.744 51.8008 210.078 51.8008C206.88 51.8008 204.032 53.701 202.193 56.6573C201.649 57.545 200.878 58.2724 199.96 58.7649C199.041 59.2575 198.008 59.4975 196.966 59.4604H196.793C193.262 59.4604 190.4 63.4564 190.4 68.3814C190.4 73.3064 193.262 77.3024 196.793 77.3024C197.569 77.2999 198.334 77.1098 199.021 76.7483C200.222 76.1651 201.536 75.8493 202.871 75.8228C204.207 75.7964 205.533 76.0599 206.756 76.5951C207.79 77.0586 208.91 77.2996 210.044 77.3024C211.177 77.3053 212.299 77.0698 213.335 76.6114C214.549 76.0864 215.863 75.8278 217.186 75.8531C218.509 75.8784 219.812 76.1871 221.005 76.7581C221.685 77.113 222.44 77.2997 223.207 77.3024C226.738 77.3024 229.599 73.3097 229.599 68.3814C229.619 66.4779 229.157 64.6003 228.257 62.9219V62.9219Z",fill:"var(--button-bg)"}),M.createElement("path",{d:"M127.166 35.4361C127.137 35.2133 127.068 34.9974 126.963 34.7986C126.879 34.6801 126.779 34.5747 126.664 34.4859C126.479 34.3143 126.262 34.18 126.026 34.0902C125.906 34.0435 125.776 34.0267 125.648 34.0412C125.52 34.0556 125.397 34.101 125.29 34.1733C125.101 34.3433 124.986 34.5813 124.972 34.8352C124.92 35.1796 124.98 35.5313 125.143 35.8392C125.34 36.1787 125.678 36.4059 125.96 36.677C126.167 36.8728 126.347 37.0955 126.494 37.339C126.562 37.4662 126.644 37.585 126.74 37.6932C126.787 37.7467 126.847 37.7883 126.914 37.8146C126.981 37.8409 127.053 37.8512 127.125 37.8446C127.244 37.8138 127.353 37.7504 127.439 37.6614C127.554 37.5613 127.868 37.3781 127.877 37.2169C127.887 37.0556 127.632 36.7918 127.581 36.6697C127.399 36.2742 127.261 35.8607 127.166 35.4361Z",fill:"var(--online-indicator)"}),M.createElement("path",{d:"M128 156C198.692 156 256 153.485 256 150.382C256 147.279 198.692 144.764 128 144.764C57.3076 144.764 0 147.279 0 150.382C0 153.485 57.3076 156 128 156Z",fill:"var(--center-channel-color)",fillOpacity:"0.08"}),M.createElement("path",{d:"M216.08 148.526H205.663C205.09 148.526 204.541 148.299 204.135 147.895C203.73 147.492 203.503 146.945 203.503 146.374C203.503 145.803 203.73 145.256 204.135 144.852C204.541 144.449 205.09 144.222 205.663 144.222C205.373 144.232 205.085 144.183 204.814 144.079C204.544 143.976 204.297 143.819 204.089 143.618C203.88 143.417 203.715 143.177 203.601 142.911C203.488 142.645 203.43 142.36 203.43 142.071C203.43 141.782 203.488 141.497 203.601 141.231C203.715 140.965 203.88 140.725 204.089 140.524C204.297 140.323 204.544 140.166 204.814 140.063C205.085 139.959 205.373 139.91 205.663 139.92H206.139C206.411 138.069 208.507 136.627 211.058 136.625C213.608 136.623 215.717 138.061 215.984 139.91H216.08C216.369 139.901 216.658 139.949 216.928 140.053C217.199 140.157 217.446 140.313 217.654 140.514C217.862 140.715 218.028 140.955 218.141 141.221C218.254 141.487 218.313 141.773 218.313 142.061C218.313 142.35 218.254 142.636 218.141 142.901C218.028 143.167 217.862 143.408 217.654 143.608C217.446 143.809 217.199 143.966 216.928 144.07C216.658 144.173 216.369 144.222 216.08 144.212C216.653 144.212 217.202 144.439 217.607 144.842C218.012 145.246 218.24 145.793 218.24 146.364C218.24 146.935 218.012 147.482 217.607 147.886C217.202 148.289 216.653 148.516 216.08 148.516V148.526Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M218.238 142.069C218.237 142.64 218.009 143.186 217.605 143.59C217.2 143.993 216.652 144.22 216.08 144.222H205.666L216.013 139.91H216.077C216.651 139.911 217.201 140.14 217.606 140.544C218.011 140.949 218.238 141.498 218.238 142.069V142.069Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M203.567 146.395C203.569 146.965 203.797 147.511 204.202 147.914C204.606 148.317 205.155 148.543 205.727 148.545H216.143L205.788 144.253H205.732C205.16 144.254 204.612 144.479 204.207 144.88C203.801 145.281 203.571 145.826 203.567 146.395V146.395Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{d:"M152.766 145.955H146.854C146.529 145.955 146.217 145.827 145.987 145.598C145.757 145.368 145.628 145.058 145.628 144.734C145.628 144.41 145.757 144.099 145.987 143.87C146.217 143.641 146.529 143.513 146.854 143.513C146.529 143.513 146.217 143.384 145.987 143.155C145.757 142.926 145.628 142.615 145.628 142.291C145.628 141.967 145.757 141.657 145.987 141.428C146.217 141.199 146.529 141.07 146.854 141.07H147.126C147.278 140.019 148.47 139.201 149.917 139.201C151.364 139.201 152.555 140.015 152.712 141.065H152.766C153.091 141.065 153.403 141.194 153.633 141.423C153.863 141.652 153.992 141.962 153.992 142.286C153.992 142.61 153.863 142.921 153.633 143.15C153.403 143.379 153.091 143.508 152.766 143.508C153.091 143.508 153.403 143.636 153.633 143.865C153.863 144.094 153.992 144.405 153.992 144.729C153.992 145.053 153.863 145.364 153.633 145.593C153.403 145.822 153.091 145.95 152.766 145.95V145.955Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M153.992 142.292C153.992 142.616 153.863 142.926 153.633 143.155C153.403 143.384 153.091 143.513 152.766 143.513H146.854L152.739 141.07H152.766C153.091 141.07 153.403 141.199 153.633 141.428C153.863 141.657 153.992 141.968 153.992 142.292V142.292Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M145.667 144.742C145.667 145.066 145.797 145.376 146.027 145.605C146.257 145.835 146.568 145.963 146.894 145.963H152.803L146.918 143.521H146.881C146.558 143.524 146.25 143.654 146.022 143.883C145.795 144.111 145.667 144.42 145.667 144.742V144.742Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{d:"M42.0414 152.885H29.5356C29.1887 152.896 28.8432 152.837 28.5195 152.712C28.1959 152.587 27.9007 152.399 27.6516 152.158C27.4024 151.918 27.2043 151.63 27.069 151.311C26.9337 150.993 26.864 150.651 26.864 150.305C26.864 149.959 26.9337 149.617 27.069 149.298C27.2043 148.98 27.4024 148.692 27.6516 148.451C27.9007 148.211 28.1959 148.022 28.5195 147.897C28.8432 147.772 29.1887 147.713 29.5356 147.724C29.1887 147.735 28.8432 147.676 28.5195 147.551C28.1959 147.426 27.9007 147.238 27.6516 146.997C27.4024 146.756 27.2043 146.468 27.069 146.15C26.9337 145.831 26.864 145.489 26.864 145.143C26.864 144.798 26.9337 144.455 27.069 144.137C27.2043 143.819 27.4024 143.53 27.6516 143.29C27.9007 143.049 28.1959 142.861 28.5195 142.736C28.8432 142.611 29.1887 142.552 29.5356 142.563H30.1045C30.4306 140.342 32.9489 138.613 36.0067 138.61C39.0645 138.608 41.5853 140.332 41.9163 142.55H42.0291C42.7024 142.571 43.3412 142.852 43.8101 143.334C44.279 143.815 44.5413 144.46 44.5413 145.131C44.5413 145.802 44.279 146.447 43.8101 146.929C43.3412 147.41 42.7024 147.691 42.0291 147.712C42.7024 147.732 43.3412 148.013 43.8101 148.495C44.279 148.977 44.5413 149.622 44.5413 150.293C44.5413 150.964 44.279 151.608 43.8101 152.09C43.3412 152.572 42.7024 152.853 42.0291 152.873L42.0414 152.885Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M44.6284 145.142C44.6271 145.826 44.3543 146.481 43.8695 146.965C43.3848 147.449 42.7276 147.722 42.0414 147.724H29.5356L41.9482 142.551H42.0242C42.3661 142.55 42.7047 142.617 43.0206 142.747C43.3365 142.877 43.6236 143.068 43.8655 143.309C44.1073 143.55 44.2992 143.836 44.4301 144.15C44.561 144.465 44.6284 144.802 44.6284 145.142Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M27.0271 150.321C27.0303 151.005 27.3049 151.66 27.791 152.142C28.277 152.625 28.935 152.897 29.6214 152.898H42.1272L29.7023 147.749H29.6263C28.9401 147.75 28.282 148.02 27.7951 148.502C27.3083 148.984 27.0323 149.638 27.0271 150.321Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M67.6781 37.3877C66.7052 37.2017 65.6986 37.3089 64.7871 37.6955C64.2432 37.9378 63.6541 38.063 63.0583 38.063C62.4626 38.063 61.8735 37.9378 61.3296 37.6955C60.6866 37.415 59.9901 37.2767 59.2882 37.2902C58.5863 37.3037 57.8957 37.4686 57.264 37.7737C56.9037 37.9642 56.5023 38.0647 56.0944 38.0668C54.4466 38.0668 53.0758 36.4131 52.7914 34.2293C53.1205 33.99 53.4002 33.6898 53.6153 33.3451C54.5814 31.794 56.0674 30.7998 57.7569 30.7998C59.4464 30.7998 60.9177 31.7769 61.8838 33.3182C62.1727 33.7806 62.5762 34.1613 63.0554 34.4235C63.5347 34.6857 64.0736 34.8208 64.6203 34.8156H64.6645C65.9764 34.8131 67.1117 35.8611 67.6781 37.3877Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M72.6854 30.5407L70.0224 32.2237L71.6384 29.2925C71.1809 28.927 70.6137 28.7249 70.0273 28.7184H69.9857C69.8009 28.7227 69.6162 28.7096 69.4339 28.6793L68.5291 29.2485L68.9165 28.5474C68.2771 28.3247 67.7245 27.9067 67.3374 27.353L65.7165 28.3764L66.7366 26.5273C65.7926 25.3988 64.5175 24.7051 63.1173 24.7051C61.4376 24.7051 59.9296 25.6993 58.9733 27.2504C58.6866 27.7131 58.2823 28.0924 57.8014 28.3497C57.3205 28.607 56.7799 28.7334 56.2342 28.716H56.1533C54.2995 28.716 52.7939 30.8118 52.7939 33.3962C52.7939 35.9805 54.2995 38.0764 56.1533 38.0764C56.5614 38.0755 56.963 37.9748 57.323 37.7832C57.9547 37.4782 58.6453 37.3132 59.3472 37.2997C60.0491 37.2862 60.7455 37.4245 61.3886 37.7051C61.9357 37.9484 62.5279 38.0749 63.1271 38.0764C63.7185 38.0756 64.3032 37.9517 64.8436 37.7124C65.4816 37.4372 66.1714 37.3017 66.8665 37.3152C67.5616 37.3287 68.2457 37.4908 68.8724 37.7906C69.2296 37.977 69.6266 38.0751 70.0298 38.0764C71.886 38.0764 73.3892 35.9805 73.3892 33.3962C73.3982 32.4007 73.1562 31.4188 72.6854 30.5407V30.5407Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M32.5198 64.2579C33.4888 64.0743 34.4907 64.1815 35.3986 64.5656C35.942 64.808 36.5307 64.9333 37.1261 64.9333C37.7215 64.9333 38.3102 64.808 38.8536 64.5656C39.4966 64.2851 40.1931 64.1468 40.895 64.1603C41.5969 64.1738 42.2875 64.3388 42.9192 64.6438C43.2796 64.834 43.6809 64.9346 44.0888 64.9369C45.7366 64.9369 47.1098 63.2832 47.3943 61.0995C47.0646 60.8608 46.7847 60.5605 46.5704 60.2152C45.6042 58.6641 44.106 57.6699 42.4263 57.6699C40.7466 57.6699 39.268 58.647 38.3018 60.1883C38.0118 60.6517 37.6066 61.0328 37.1255 61.2946C36.6444 61.5565 36.1037 61.6904 35.5555 61.6833H35.5138C34.2093 61.6833 33.0715 62.7312 32.5198 64.2579Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M27.498 57.4103L30.1609 59.0933L28.5425 56.1621C29.0002 55.797 29.5673 55.5949 30.1536 55.588H30.1977C30.3825 55.5923 30.5672 55.5792 30.7494 55.549L31.6518 56.1181L31.2644 55.4171C31.9045 55.1945 32.458 54.7765 32.846 54.2226L34.4619 55.2436L33.4394 53.3945C34.3859 52.266 35.6586 51.5723 37.0612 51.5723C38.7409 51.5723 40.2366 52.5664 41.2052 54.1176C41.4917 54.5805 41.8959 54.9599 42.3769 55.2172C42.8579 55.4746 43.3986 55.6008 43.9442 55.5832H44.0325C45.8888 55.5832 47.3919 57.679 47.3919 60.2634C47.3919 62.8477 45.8888 64.9435 44.0325 64.9435C43.6245 64.9421 43.223 64.8414 42.8629 64.6504C42.2312 64.3454 41.5406 64.1804 40.8387 64.1669C40.1368 64.1534 39.4403 64.2917 38.7973 64.5723C38.251 64.8156 37.6596 64.9421 37.0612 64.9435C36.4697 64.9433 35.885 64.8193 35.3447 64.5796C34.7063 64.3043 34.016 64.1689 33.3205 64.1823C32.625 64.1958 31.9406 64.358 31.3134 64.6578C30.9564 64.8445 30.5593 64.9425 30.156 64.9435C28.3022 64.9435 26.7966 62.8477 26.7966 60.2634C26.7873 59.2689 27.0284 58.288 27.498 57.4103V57.4103Z",fill:"var(--button-bg)"}),M.createElement("path",{d:"M128 152C150.091 152 168 151.105 168 150C168 148.895 150.091 148 128 148C105.909 148 88 148.895 88 150C88 151.105 105.909 152 128 152Z",fill:"var(--center-channel-color)",fillOpacity:"0.2"}),M.createElement("ellipse",{cx:"125",cy:"75.4243",rx:"50.6957",ry:"50.1196",fill:"none"}),M.createElement("path",{d:"M178 76.0017C178 86.4841 174.891 96.731 169.067 105.447C163.243 114.162 154.965 120.955 145.281 124.966C135.596 128.977 124.939 130.027 114.659 127.981C104.378 125.936 94.9341 120.888 87.5221 113.475C80.1102 106.063 75.0628 96.6192 73.0181 86.3381C70.9734 76.057 72.0233 65.4005 76.0351 55.7162C80.0468 46.0318 86.8402 37.7546 95.5562 31.9312C104.272 26.1077 114.519 22.9997 125.002 23C131.962 23.0002 138.854 24.3713 145.284 27.035C151.714 29.6988 157.557 33.6029 162.478 38.5246C167.399 43.4462 171.303 49.289 173.966 55.7194C176.63 62.1497 178 69.0416 178 76.0017V76.0017ZM118.875 104.056L158.19 64.7408C158.508 64.4234 158.761 64.0465 158.933 63.6314C159.105 63.2164 159.194 62.7714 159.194 62.3221C159.194 61.8727 159.105 61.4278 158.933 61.0127C158.761 60.5977 158.508 60.2207 158.19 59.9034L153.353 55.1014C153.036 54.7834 152.66 54.5311 152.245 54.359C151.831 54.1868 151.386 54.0982 150.937 54.0982C150.489 54.0982 150.044 54.1868 149.63 54.359C149.215 54.5311 148.839 54.7834 148.522 55.1014L116.457 87.1675L101.485 72.1601C100.842 71.5209 99.9724 71.1622 99.066 71.1622C98.1596 71.1622 97.29 71.5209 96.6473 72.1601L91.81 77.0259C91.1708 77.6687 90.8121 78.5382 90.8121 79.4446C90.8121 80.351 91.1708 81.2206 91.81 81.8633L114.039 104.084C114.356 104.402 114.733 104.655 115.148 104.827C115.563 104.999 116.008 105.088 116.458 105.088C116.907 105.088 117.352 104.999 117.767 104.827C118.182 104.655 118.559 104.402 118.876 104.084L118.875 104.056Z",fill:"var(--online-indicator)"})),$s=e=>M.createElement(M.Fragment,null,M.createElement(G.Z,{className:"ConfirmNotifyAdminModal",show:e.show,id:"confirmNotifyAdminModal",role:"dialog",onHide:e.actions.closeModal},M.createElement(G.Z.Header,{closeButton:!0}),M.createElement(G.Z.Body,null,M.createElement(Qs,null),M.createElement("div",{className:"title"},M.createElement(V.Z,{id:"confirm.notification_sent_to_admin.modal_title",defaultMessage:"Thank you!"})),M.createElement("div",{className:"description"},M.createElement(V.Z,{id:"confirm.notification_sent_to_admin.modal_body",defaultMessage:"A notification has been sent to your administrator."})),M.createElement("div",{className:"buttons"},M.createElement(Vs.Z,{className:"confirm-button",onClick:e.actions.closeModal},M.createElement(V.Z,{id:"confirm.notification_sent_to_admin.modal_done",defaultMessage:"Done"}))))));$s.propTypes={show:y().bool.isRequired,actions:y().shape({closeModal:y().func.isRequired}).isRequired};const en=$s,tn=(0,n.connect)((function(e){return{show:(0,Ms.g)(e,N.r8.CONFIRM_NOTIFY_ADMIN)}}),(function(e){return{actions:(0,a.bindActionCreators)({closeModal:()=>(0,H.M)(N.r8.CONFIRM_NOTIFY_ADMIN)},e)}}))(en),sn=()=>M.createElement("svg",{width:"512",height:"156",viewBox:"0 0 512 156",fill:"none",xmlns:"http://www.w3.org/2000/svg"},M.createElement("path",{opacity:"0.1",d:"M282.728 52.6597C281.343 52.398 279.911 52.5537 278.616 53.1067C277.834 53.4519 276.988 53.6284 276.133 53.6246C275.278 53.6209 274.434 53.4369 273.655 53.0848C272.737 52.6839 271.742 52.4863 270.74 52.5057C269.737 52.5251 268.751 52.761 267.849 53.1971C267.334 53.4696 266.76 53.613 266.176 53.6148C263.822 53.6148 261.863 51.2527 261.456 48.1359C261.926 47.7929 262.326 47.3634 262.633 46.8706C264.014 44.655 266.152 43.2334 268.552 43.2334C270.953 43.2334 273.064 44.6379 274.438 46.8315C274.851 47.4949 275.429 48.0407 276.117 48.4156C276.804 48.7905 277.577 48.982 278.361 48.9713H278.422C280.303 48.981 281.926 50.4784 282.728 52.6597Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M346.4 76.0436C344.578 75.7024 342.693 75.9053 340.988 76.6264C339.959 77.0764 338.845 77.3065 337.72 77.3016C336.594 77.2967 335.483 77.0568 334.458 76.5977C333.249 76.0751 331.94 75.8175 330.62 75.8428C329.301 75.8681 328.002 76.1757 326.815 76.7442C326.137 77.0995 325.381 77.2864 324.614 77.2888C321.515 77.2888 318.936 74.2092 318.4 70.1456C319.019 69.6985 319.545 69.1385 319.95 68.4959C321.767 65.6074 324.581 63.7539 327.741 63.7539C330.901 63.7539 333.68 65.5851 335.488 68.4449C336.032 69.3099 336.793 70.0214 337.698 70.5103C338.603 70.9991 339.62 71.2487 340.652 71.2347H340.733C343.208 71.2475 345.345 73.1997 346.4 76.0436Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M289.888 42.8765L286.082 45.2825L288.392 41.0957C287.737 40.5762 286.927 40.2883 286.09 40.2774H286.029C285.764 40.2821 285.5 40.2633 285.239 40.2212L283.954 41.0347L284.508 40.0332C283.594 39.7152 282.804 39.1165 282.252 38.3233L279.942 39.7889L281.414 37.1483C280.063 35.5337 278.243 34.542 276.242 34.542C273.842 34.542 271.703 35.9661 270.323 38.1816C269.915 38.8468 269.336 39.392 268.647 39.7611C267.957 40.1303 267.182 40.3101 266.399 40.2823H266.269C263.619 40.2823 261.471 43.2771 261.471 46.968C261.471 50.6589 263.619 53.6536 266.269 53.6536C266.852 53.6517 267.426 53.5093 267.942 53.2383C268.844 52.8012 269.83 52.5646 270.832 52.5447C271.835 52.5249 272.83 52.7224 273.748 53.1235C274.525 53.4709 275.365 53.6515 276.216 53.6536C277.067 53.6557 277.909 53.4793 278.687 53.1357C279.599 52.7423 280.584 52.5485 281.578 52.5675C282.571 52.5864 283.549 52.8177 284.444 53.2457C284.955 53.5116 285.521 53.6515 286.097 53.6536C288.748 53.6536 290.896 50.6613 290.896 46.968C290.91 45.5414 290.564 44.1343 289.888 42.8765Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M356.257 62.9219L351.187 66.1324L354.265 60.5458C353.392 59.8525 352.313 59.4684 351.197 59.4539H351.116C350.763 59.4601 350.411 59.435 350.064 59.3789L348.352 60.4643L349.09 59.1279C347.872 58.7036 346.82 57.9048 346.085 56.8464L343.008 58.802L344.968 55.2786C343.168 53.1241 340.744 51.8008 338.079 51.8008C334.88 51.8008 332.032 53.701 330.193 56.6573C329.649 57.545 328.878 58.2724 327.96 58.7649C327.042 59.2575 326.008 59.4975 324.966 59.4604H324.793C321.262 59.4604 318.4 63.4564 318.4 68.3814C318.4 73.3064 321.262 77.3024 324.793 77.3024C325.57 77.2999 326.334 77.1098 327.021 76.7483C328.222 76.1651 329.536 75.8493 330.872 75.8228C332.207 75.7964 333.533 76.0599 334.756 76.5951C335.79 77.0586 336.911 77.2996 338.044 77.3024C339.178 77.3053 340.299 77.0698 341.335 76.6114C342.55 76.0864 343.863 75.8278 345.186 75.8531C346.51 75.8784 347.812 76.1871 349.005 76.7581C349.685 77.113 350.44 77.2997 351.207 77.3024C354.738 77.3024 357.6 73.3097 357.6 68.3814C357.619 66.4779 357.157 64.6003 356.257 62.9219Z",fill:"var(--button-bg)"}),M.createElement("path",{d:"M255.167 35.4361C255.137 35.2133 255.068 34.9974 254.963 34.7986C254.88 34.6801 254.779 34.5747 254.664 34.4859C254.479 34.3143 254.263 34.18 254.026 34.0902C253.906 34.0435 253.777 34.0267 253.648 34.0412C253.52 34.0556 253.397 34.101 253.291 34.1733C253.101 34.3433 252.986 34.5813 252.972 34.8352C252.92 35.1796 252.981 35.5313 253.144 35.8392C253.34 36.1787 253.678 36.4059 253.96 36.677C254.167 36.8728 254.347 37.0955 254.495 37.339C254.562 37.4662 254.645 37.585 254.74 37.6932C254.788 37.7467 254.848 37.7883 254.914 37.8146C254.981 37.8409 255.053 37.8512 255.125 37.8446C255.245 37.8138 255.353 37.7504 255.439 37.6614C255.554 37.5613 255.868 37.3781 255.878 37.2169C255.888 37.0556 255.633 36.7918 255.581 36.6697C255.4 36.2742 255.261 35.8607 255.167 35.4361Z",fill:"var(--online-indicator)"}),M.createElement("path",{d:"M256 156C326.692 156 384 153.485 384 150.382C384 147.279 326.692 144.764 256 144.764C185.308 144.764 128 147.279 128 150.382C128 153.485 185.308 156 256 156Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M251.2 152.213C266.664 152.213 279.2 151.321 279.2 150.221C279.2 149.121 266.664 148.229 251.2 148.229C235.736 148.229 223.2 149.121 223.2 150.221C223.2 151.321 235.736 152.213 251.2 152.213Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M253.016 150.152C252.148 150.321 251.253 150.283 250.403 150.044C249.552 149.804 248.77 149.368 248.119 148.772C247.469 148.176 246.968 147.436 246.658 146.611C246.347 145.787 246.235 144.901 246.332 144.026C246.974 138.369 248.973 129.255 254.438 115.573C260.775 99.7106 258.489 95.8781 251.699 84.5025C249.507 80.8262 247.021 76.6614 244.343 71.3119C237.438 57.5693 240.062 46.9778 243.47 40.5316C247.094 33.6701 252.278 30.0769 252.857 29.6885L258.207 38.5066L257.717 38.9951C257.705 38.9951 257.962 38.9951 258.335 39.6718C256.241 41.4795 254.519 43.6755 253.266 46.1376C250.299 52.0562 250.692 58.8395 254.431 66.2824C256.935 71.2704 259.308 75.2495 261.402 78.7597C265.164 85.0618 268.133 90.04 269.117 96.3251C270.134 102.83 268.871 109.828 264.926 119.726C259.725 132.743 258.06 140.89 257.553 145.262C257.416 146.45 256.904 147.564 256.089 148.442C255.275 149.32 254.201 149.918 253.023 150.147L253.016 150.152Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M228.291 22.6071L250.985 0L273.9 22.6071H258.327V39.894H243.864V22.717L228.291 22.6071Z",fill:"var(--button-bg)"}),M.createElement("path",{d:"M300.8 149.822C308.753 149.822 315.2 149.287 315.2 148.627C315.2 147.967 308.753 147.432 300.8 147.432C292.847 147.432 286.4 147.967 286.4 148.627C286.4 149.287 292.847 149.822 300.8 149.822Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M301.631 148.924C301.178 149.012 300.711 148.993 300.267 148.868C299.823 148.743 299.414 148.515 299.075 148.204C298.735 147.893 298.474 147.507 298.311 147.076C298.149 146.646 298.091 146.183 298.142 145.726C298.475 142.773 299.52 138.015 302.374 130.872C305.682 122.589 304.488 120.588 300.945 114.648C299.799 112.73 298.492 110.554 297.097 107.759C293.498 100.585 294.866 95.0575 296.646 91.6915C297.819 89.4517 299.498 87.5136 301.55 86.0293L304.343 90.6338L304.083 90.878C304.083 90.878 304.216 90.878 304.407 91.2322C303.313 92.1757 302.413 93.3222 301.759 94.608C300.211 97.698 300.417 101.237 302.369 105.126C303.676 107.73 304.915 109.809 306.008 111.641C307.97 114.931 309.522 117.53 310.037 120.813C310.567 124.209 309.912 127.863 307.847 133.027C305.133 139.822 304.262 144.075 303.997 146.359C303.928 146.98 303.661 147.562 303.236 148.021C302.811 148.481 302.249 148.792 301.634 148.911L301.631 148.924Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M288.721 82.3295L300.569 70.5264L312.536 82.3295H304.404V91.3552H296.852V82.3881L288.721 82.3295Z",fill:"var(--button-bg)"}),M.createElement("path",{d:"M201.6 149.026C209.553 149.026 216 148.49 216 147.83C216 147.17 209.553 146.635 201.6 146.635C193.647 146.635 187.2 147.17 187.2 147.83C187.2 148.49 193.647 149.026 201.6 149.026Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M200.561 148.924C201.013 149.012 201.481 148.993 201.925 148.868C202.369 148.743 202.777 148.515 203.117 148.204C203.457 147.893 203.718 147.507 203.88 147.076C204.042 146.646 204.1 146.183 204.05 145.726C203.716 142.773 202.672 138.015 199.818 130.872C196.51 122.589 197.704 120.588 201.247 114.648C202.392 112.73 203.699 110.554 205.094 107.759C208.694 100.585 207.326 95.0575 205.546 91.6915C204.372 89.4517 202.694 87.5136 200.641 86.0293L197.848 90.6338L198.108 90.878C198.108 90.878 197.976 90.878 197.785 91.2322C198.879 92.1757 199.778 93.3222 200.433 94.608C201.98 97.698 201.774 101.237 199.822 105.126C198.515 107.73 197.277 109.809 196.184 111.641C194.222 114.931 192.67 117.53 192.155 120.813C191.625 124.209 192.28 127.863 194.344 133.027C197.059 139.822 197.929 144.075 198.194 146.359C198.264 146.98 198.531 147.562 198.956 148.021C199.381 148.481 199.942 148.792 200.558 148.911L200.561 148.924Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M213.471 82.3295L201.623 70.5264L189.656 82.3295H197.787V91.3552H205.34V82.3881L213.471 82.3295Z",fill:"var(--button-bg)"}),M.createElement("path",{d:"M344.079 148.526H333.663C333.09 148.526 332.54 148.299 332.135 147.895C331.73 147.492 331.502 146.945 331.502 146.374C331.502 145.803 331.73 145.256 332.135 144.852C332.54 144.449 333.09 144.222 333.663 144.222C333.373 144.232 333.084 144.183 332.814 144.079C332.544 143.976 332.297 143.819 332.088 143.618C331.88 143.417 331.714 143.177 331.601 142.911C331.488 142.645 331.43 142.36 331.43 142.071C331.43 141.782 331.488 141.497 331.601 141.231C331.714 140.965 331.88 140.725 332.088 140.524C332.297 140.323 332.544 140.166 332.814 140.063C333.084 139.959 333.373 139.91 333.663 139.92H334.138C334.411 138.069 336.507 136.627 339.057 136.625C341.608 136.623 343.716 138.061 343.984 139.91H344.079C344.369 139.901 344.658 139.949 344.928 140.053C345.199 140.157 345.445 140.313 345.654 140.514C345.862 140.715 346.028 140.955 346.141 141.221C346.254 141.487 346.312 141.773 346.312 142.061C346.312 142.35 346.254 142.636 346.141 142.901C346.028 143.167 345.862 143.408 345.654 143.608C345.445 143.809 345.199 143.966 344.928 144.07C344.658 144.173 344.369 144.222 344.079 144.212C344.652 144.212 345.202 144.439 345.607 144.842C346.012 145.246 346.24 145.793 346.24 146.364C346.24 146.935 346.012 147.482 345.607 147.886C345.202 148.289 344.652 148.516 344.079 148.516V148.526Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M346.238 142.069C346.237 142.64 346.01 143.186 345.605 143.59C345.201 143.993 344.652 144.22 344.08 144.222H333.666L344.014 139.91H344.078C344.652 139.911 345.201 140.14 345.606 140.544C346.011 140.949 346.239 141.498 346.238 142.069Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M331.566 146.395C331.568 146.965 331.797 147.511 332.201 147.914C332.606 148.317 333.155 148.543 333.727 148.545H344.143L333.788 144.253H333.732C333.16 144.254 332.612 144.479 332.206 144.88C331.801 145.281 331.571 145.826 331.566 146.395Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{d:"M280.766 145.955H274.854C274.529 145.955 274.217 145.827 273.987 145.598C273.757 145.368 273.628 145.058 273.628 144.734C273.628 144.41 273.757 144.099 273.987 143.87C274.217 143.641 274.529 143.513 274.854 143.513C274.529 143.513 274.217 143.384 273.987 143.155C273.757 142.926 273.628 142.615 273.628 142.291C273.628 141.967 273.757 141.657 273.987 141.428C274.217 141.199 274.529 141.07 274.854 141.07H275.126C275.278 140.019 276.47 139.201 277.917 139.201C279.363 139.201 280.555 140.015 280.712 141.065H280.766C281.091 141.065 281.403 141.194 281.633 141.423C281.863 141.652 281.992 141.962 281.992 142.286C281.992 142.61 281.863 142.921 281.633 143.15C281.403 143.379 281.091 143.508 280.766 143.508C281.091 143.508 281.403 143.636 281.633 143.865C281.863 144.094 281.992 144.405 281.992 144.729C281.992 145.053 281.863 145.364 281.633 145.593C281.403 145.822 281.091 145.95 280.766 145.95V145.955Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M281.993 142.292C281.993 142.616 281.863 142.926 281.633 143.155C281.404 143.384 281.092 143.513 280.767 143.513H274.854L280.74 141.07H280.767C281.092 141.07 281.404 141.199 281.633 141.428C281.863 141.657 281.993 141.968 281.993 142.292Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M273.668 144.742C273.668 145.066 273.797 145.376 274.027 145.605C274.257 145.835 274.569 145.963 274.894 145.963H280.804L274.919 143.521H274.882C274.559 143.524 274.25 143.654 274.023 143.883C273.795 144.111 273.668 144.42 273.668 144.742Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{d:"M170.042 152.885H157.536C157.189 152.896 156.843 152.837 156.52 152.712C156.196 152.587 155.901 152.399 155.652 152.158C155.403 151.918 155.205 151.63 155.069 151.311C154.934 150.993 154.864 150.651 154.864 150.305C154.864 149.959 154.934 149.617 155.069 149.298C155.205 148.98 155.403 148.692 155.652 148.451C155.901 148.211 156.196 148.022 156.52 147.897C156.843 147.772 157.189 147.713 157.536 147.724C157.189 147.735 156.843 147.676 156.52 147.551C156.196 147.426 155.901 147.238 155.652 146.997C155.403 146.756 155.205 146.468 155.069 146.15C154.934 145.831 154.864 145.489 154.864 145.143C154.864 144.798 154.934 144.455 155.069 144.137C155.205 143.819 155.403 143.53 155.652 143.29C155.901 143.049 156.196 142.861 156.52 142.736C156.843 142.611 157.189 142.552 157.536 142.563H158.105C158.431 140.342 160.949 138.613 164.007 138.61C167.065 138.608 169.586 140.332 169.917 142.55H170.029C170.703 142.571 171.341 142.852 171.81 143.334C172.279 143.815 172.542 144.46 172.542 145.131C172.542 145.802 172.279 146.447 171.81 146.929C171.341 147.41 170.703 147.691 170.029 147.712C170.703 147.732 171.341 148.013 171.81 148.495C172.279 148.977 172.542 149.622 172.542 150.293C172.542 150.964 172.279 151.608 171.81 152.09C171.341 152.572 170.703 152.853 170.029 152.873L170.042 152.885Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M172.628 145.142C172.627 145.826 172.354 146.481 171.869 146.965C171.384 147.449 170.727 147.722 170.041 147.724H157.535L169.948 142.551H170.024C170.366 142.55 170.704 142.617 171.02 142.747C171.336 142.877 171.623 143.068 171.865 143.309C172.107 143.55 172.299 143.836 172.43 144.15C172.561 144.465 172.628 144.802 172.628 145.142Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M155.027 150.321C155.031 151.005 155.305 151.66 155.791 152.142C156.277 152.625 156.935 152.897 157.622 152.898H170.127L157.703 147.749H157.627C156.94 147.75 156.282 148.02 155.795 148.502C155.309 148.984 155.033 149.638 155.027 150.321Z",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),M.createElement("path",{opacity:"0.1",d:"M195.678 37.3877C194.705 37.2017 193.698 37.3089 192.787 37.6955C192.243 37.9378 191.654 38.063 191.058 38.063C190.462 38.063 189.873 37.9378 189.329 37.6955C188.686 37.415 187.99 37.2767 187.288 37.2902C186.586 37.3037 185.895 37.4686 185.264 37.7737C184.903 37.9642 184.502 38.0647 184.094 38.0668C182.446 38.0668 181.075 36.4131 180.791 34.2293C181.12 33.99 181.4 33.6898 181.615 33.3451C182.581 31.794 184.067 30.7998 185.757 30.7998C187.446 30.7998 188.917 31.7769 189.883 33.3182C190.172 33.7806 190.576 34.1613 191.055 34.4235C191.534 34.6857 192.073 34.8208 192.62 34.8156H192.664C193.976 34.8131 195.111 35.8611 195.678 37.3877Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M200.685 30.5407L198.022 32.2237L199.638 29.2925C199.181 28.927 198.614 28.7249 198.027 28.7184H197.986C197.801 28.7227 197.616 28.7096 197.434 28.6793L196.529 29.2485L196.917 28.5474C196.277 28.3247 195.725 27.9067 195.337 27.353L193.717 28.3764L194.737 26.5273C193.793 25.3988 192.517 24.7051 191.117 24.7051C189.438 24.7051 187.93 25.6993 186.973 27.2504C186.687 27.7131 186.282 28.0924 185.801 28.3497C185.32 28.607 184.78 28.7334 184.234 28.716H184.153C182.3 28.716 180.794 30.8118 180.794 33.3962C180.794 35.9805 182.3 38.0764 184.153 38.0764C184.561 38.0755 184.963 37.9748 185.323 37.7832C185.955 37.4782 186.645 37.3132 187.347 37.2997C188.049 37.2862 188.746 37.4245 189.389 37.7051C189.936 37.9484 190.528 38.0749 191.127 38.0764C191.718 38.0756 192.303 37.9517 192.844 37.7124C193.482 37.4372 194.171 37.3017 194.867 37.3152C195.562 37.3287 196.246 37.4908 196.872 37.7906C197.23 37.977 197.627 38.0751 198.03 38.0764C199.886 38.0764 201.389 35.9805 201.389 33.3962C201.398 32.4007 201.156 31.4188 200.685 30.5407Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M160.52 64.2579C161.489 64.0743 162.49 64.1815 163.398 64.5656C163.942 64.808 164.53 64.9333 165.126 64.9333C165.721 64.9333 166.31 64.808 166.853 64.5656C167.496 64.2851 168.193 64.1468 168.895 64.1603C169.597 64.1738 170.287 64.3388 170.919 64.6438C171.279 64.834 171.681 64.9346 172.089 64.9369C173.736 64.9369 175.11 63.2832 175.394 61.0995C175.064 60.8608 174.784 60.5605 174.57 60.2152C173.604 58.6641 172.106 57.6699 170.426 57.6699C168.746 57.6699 167.268 58.647 166.302 60.1883C166.012 60.6517 165.606 61.0328 165.125 61.2946C164.644 61.5565 164.103 61.6904 163.555 61.6833H163.514C162.209 61.6833 161.071 62.7312 160.52 64.2579Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M155.498 57.4103L158.161 59.0933L156.543 56.1621C157.001 55.797 157.568 55.5949 158.154 55.588H158.198C158.383 55.5923 158.568 55.5792 158.75 55.549L159.652 56.1181L159.265 55.4171C159.905 55.1945 160.458 54.7765 160.846 54.2226L162.462 55.2436L161.44 53.3945C162.386 52.266 163.659 51.5723 165.062 51.5723C166.741 51.5723 168.237 52.5664 169.206 54.1176C169.492 54.5805 169.896 54.9599 170.377 55.2172C170.858 55.4746 171.399 55.6008 171.945 55.5832H172.033C173.889 55.5832 175.392 57.679 175.392 60.2634C175.392 62.8477 173.889 64.9436 172.033 64.9436C171.625 64.9421 171.223 64.8414 170.863 64.6504C170.232 64.3454 169.541 64.1804 168.839 64.1669C168.137 64.1534 167.441 64.2917 166.798 64.5723C166.251 64.8156 165.66 64.9421 165.062 64.9436C164.47 64.9433 163.885 64.8193 163.345 64.5796C162.707 64.3043 162.017 64.1689 161.321 64.1823C160.626 64.1958 159.941 64.358 159.314 64.6578C158.957 64.8445 158.56 64.9425 158.157 64.9436C156.303 64.9436 154.797 62.8477 154.797 60.2634C154.788 59.2689 155.029 58.288 155.498 57.4103Z",fill:"var(--button-bg)"}));function nn(e){const[t,s]=(0,M.useState)(!1);(0,M.useEffect)((()=>{(0,Ye.tF)(N.EA.CLOUD_PURCHASING,"pageview_modal_user_limit_reached")}),[]),(0,M.useEffect)((()=>{!0===t&&(e.actions.closeModal(N.r8.UPGRADE_CLOUD_ACCOUNT),e.actions.openModal({modalId:N.r8.CONFIRM_NOTIFY_ADMIN,dialogType:tn}))}),[t]);const n=()=>{(0,Ye.L9)(N.EA.CLOUD_PURCHASING,"click_modal_user_limit_not_now"),e.actions.closeModal(N.r8.UPGRADE_CLOUD_ACCOUNT)},a=e.userIsAdmin?M.createElement(Vs.Z,{className:"confirm-button",onClick:()=>{(0,Ye.L9)(N.EA.CLOUD_PURCHASING,"click_modal_user_limit_upgrade"),e.actions.closeModal(N.r8.UPGRADE_CLOUD_ACCOUNT),e.actions.openModal({modalId:N.r8.CLOUD_PURCHASE,dialogType:Ks.Z})}},M.createElement(V.Z,{id:"upgrade.cloud",defaultMessage:"Upgrade Mattermost Cloud"})):M.createElement(Xs,{extraFunc:()=>s(!0),className:"confirm-button"});return M.createElement(M.Fragment,null,e.show&&M.createElement(G.Z,{className:"UserLimitModal",show:e.show,id:"userLimitModal",role:"dialog",onHide:n},M.createElement(G.Z.Header,{closeButton:!0}),M.createElement(G.Z.Body,null,M.createElement(sn,null),M.createElement("div",{className:"title"},M.createElement(V.Z,{id:"upgrade.cloud_modal_title",defaultMessage:"You've reached the user limit\""})),M.createElement("div",{className:"description"},M.createElement(V.Z,{id:"upgrade.cloud_modal_body",defaultMessage:"The free tier is limited to {num} users. Upgrade Mattermost Cloud for more users.",values:{num:e.cloudUserLimit}})),M.createElement("div",{className:"buttons"},M.createElement(Vs.Z,{className:"dismiss-link",onClick:n},M.createElement(V.Z,{id:"cloud.upgrade.notrightnow",defaultMessage:"Not right now"})),a))))}function an(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"126px",height:"32px",viewBox:"0 0 126 32",role:"img","aria-label":t({id:"generic_icons.invite",defaultMessage:"Invite Icon"})},M.createElement("path",{d:"M 106,18 86,5.52 V 4 c 0,-2.22 1.78,-4 4,-4 h 32 c 2.20914,0 4,1.790861 4,4 v 1.5 z m 20,10 c 0,2.209139 -1.79086,4 -4,4 H 90 c -2.22,0 -4,-1.8 -4,-4 V 10.22 l 4,2.5 V 28 h 32 V 12.72 l 4,-2.5 z M 1,15 h 62 c 0.552285,0 1,0.447715 1,1 0,0.552285 -0.447715,1 -1,1 H 1 C 0.44771525,17 0,16.552285 0,16 0,15.447715 0.44771525,15 1,15 Z M 21,5 h 48 c 0.552285,0 1,0.447715 1,1 0,0.552285 -0.447715,1 -1,1 H 21 C 20.447715,7 20,6.552285 20,6 20,5.447715 20.447715,5 21,5 Z m 0,20 h 48 c 0.552285,0 1,0.447715 1,1 0,0.552285 -0.447715,1 -1,1 H 21 c -0.552285,0 -1,-0.447715 -1,-1 0,-0.552285 0.447715,-1 1,-1 z"})))}function rn(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.channel.arrow-right",defaultMessage:"Arrow right"})},M.createElement("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})))}function on(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}nn.propTypes={userIsAdmin:y().bool.isRequired,show:y().bool.isRequired,cloudUserLimit:y().string.isRequired,actions:y().shape({closeModal:y().func.isRequired,openModal:y().func.isRequired}).isRequired};class ln extends M.PureComponent{constructor(...e){super(...e),on(this,"onMembersKeyDown",(e=>{const t=e.which;13!==t&&32!==t||this.props.goToMembers()})),on(this,"onGuestsKeyDown",(e=>{const t=e.which;13!==t&&32!==t||this.props.goToGuests()}))}render(){const e=this.props.teamName;return M.createElement("div",{className:"InvitationModalInitialStep"},M.createElement("div",{className:"modal-icon"},M.createElement(an,null)),M.createElement("h1",{id:"invitation_modal_title"},M.createElement(Dt.Z,{id:"invitation_modal.title",defaultMessage:"Invite people to **{teamName}**",values:{teamName:e}})),M.createElement("div",{className:"invitation-modal-option",onClick:this.props.goToMembers,"data-testid":"inviteMembersLink",tabIndex:"0",onKeyDown:this.onMembersKeyDown,"aria-labelledby":"inviteMembersSectionHeader","aria-describedby":"inviteMembersSectionDescription"},M.createElement("div",{"data-testid":"inviteMembersSection"},M.createElement("h2",{id:"inviteMembersSectionHeader"},M.createElement(Dt.Z,{id:"invitation_modal.invite_members.title",defaultMessage:"Invite **Members**"})),this.props.emailInvitationsEnabled&&M.createElement(V.Z,{id:"invitation_modal.invite_members.description",defaultMessage:"Invite new team members with a link or by email. Team members have access to messages and files in open teams and public channels."},(e=>M.createElement("span",{id:"inviteMembersSectionDescription"},e))),!this.props.emailInvitationsEnabled&&M.createElement(V.Z,{id:"invitation_modal.invite_members.description-email-disabled",defaultMessage:"Invite new team members with a link. Team members have access to messages and files in open teams and public channels."},(e=>M.createElement("span",{id:"inviteMembersSectionDescription"},e)))),M.createElement(rn,{className:"arrow"})),M.createElement("div",{className:"invitation-modal-option",onClick:this.props.goToGuests,"data-testid":"inviteGuestLink",tabIndex:"0",onKeyDown:this.onGuestsKeyDown,"aria-labelledby":"inviteGuestsSectionHeader","aria-describedby":"inviteGuestsSectionDescription"},M.createElement("div",null,M.createElement("h2",{id:"inviteGuestsSectionHeader"},M.createElement(Dt.Z,{id:"invitation_modal.invite_guests.title",defaultMessage:"Invite **Guests**"})),M.createElement(V.Z,{id:"invitation_modal.invite_guests.description",defaultMessage:"Invite guests to one or more channels. Guests only have access to messages, files, and people in the channels they are members of."},(e=>M.createElement("span",{id:"inviteGuestsSectionDescription"},e)))),M.createElement(rn,{className:"arrow"})))}}on(ln,"propTypes",{teamName:y().string.isRequired,goToMembers:y().func.isRequired,goToGuests:y().func.isRequired,emailInvitationsEnabled:y().bool.isRequired}),s(23157);var cn=s(60871),dn=s(87742);function hn(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"126px",height:"38px",viewBox:"0 0 126 38",role:"img","aria-label":t({id:"generic_icons.invite_members",defaultMessage:"Invite Members Icon"})},M.createElement("path",{d:"M 108.83398 0.03515625 C 108.64165 0.03515625 108.4496 0.04983111 108.25977 0.08203125 C 109.08339 0.57981559 109.86736 1.165576 110.60156 1.8359375 C 113.34699 4.3426243 115.07813 7.1515117 115.07812 10.777344 L 115.07812 15.908203 C 115.07812 17.577458 114.81586 19.392207 114.32812 21.453125 C 114.19039 22.035006 114.02467 22.601886 113.83008 23.152344 C 116.57398 24.811724 118.17106 25.88194 118.62109 26.361328 C 120.0119 27.842823 120.78516 29.798054 120.78516 31.830078 L 120.78516 32 C 122.99178 32 124.78125 32.008356 124.78125 30.001953 C 124.78125 26.755542 122.78085 23.90476 118.77734 21.453125 L 118.46875 21.267578 L 118.46094 21.285156 C 118.44384 21.330296 118.43871 21.318446 118.44531 21.253906 L 118.46875 21.267578 L 118.47266 21.251953 C 118.52056 21.104379 118.6246 20.690139 118.78516 20.011719 C 119.2074 18.22759 119.07227 17.224165 119.07227 15.908203 L 119.07227 10.777344 C 119.07227 8.5210935 117.78998 3.8565489 115.79297 2.0332031 C 113.81134 0.22387865 111.50192 0.03515625 108.83594 0.03515625 L 108.83398 0.03515625 z M 100.84375 2.0332031 C 98.23721 2.0332031 95.848767 2.9659792 93.835938 4.7363281 C 91.761167 6.5611731 90.535156 8.4793085 90.535156 10.777344 L 90.535156 15.908203 C 90.535156 17.293336 90.80759 18.870238 91.328125 20.703125 C 91.751681 22.194536 92.389981 23.518449 93.25 24.634766 L 87.810547 27.792969 C 87.734577 27.827779 87.659451 27.865141 87.585938 27.904297 C 87.562827 27.916627 87.538385 27.928746 87.515625 27.941406 C 87.254658 28.067724 87.009242 28.216755 86.775391 28.382812 L 86.509766 28.574219 C 85.454567 29.323561 84.826172 30.535879 84.826172 31.830078 L 84.826172 33.994141 C 84.826172 36.20075 86.615661 37.992188 88.822266 37.992188 L 112.79492 37.992188 C 115.00153 37.992188 116.79102 36.20075 116.79102 33.994141 L 116.79102 31.830078 C 116.79102 30.814065 116.40241 29.834497 115.70703 29.09375 C 115.33382 28.696209 114.89968 28.36777 114.42188 28.113281 L 114.13867 27.962891 C 114.10527 27.945041 114.06897 27.932866 114.03516 27.916016 C 113.99746 27.894746 113.96392 27.869949 113.92578 27.849609 L 108.53711 24.673828 C 109.43906 23.498248 110.06724 22.107856 110.43945 20.535156 C 110.86169 18.751027 111.08203 17.224166 111.08203 15.908203 L 111.08203 10.777344 C 111.08203 8.5210941 109.90325 6.6104541 107.90625 4.7871094 C 105.92461 2.977785 103.50974 2.0332043 100.84375 2.0332031 z M 100.84375 6.0273438 C 102.50853 6.0273438 103.96628 6.5982778 105.21484 7.7382812 C 106.46343 8.878286 107.08789 9.8906745 107.08789 10.777344 L 107.08789 15.908203 C 107.08789 16.870874 106.90948 18.105944 106.55273 19.613281 C 106.19601 21.12062 105.52977 22.279175 104.55469 23.089844 C 104.24552 23.343181 104.012 23.661015 103.85742 24.041016 C 103.70244 24.421017 103.65168 24.811463 103.69922 25.216797 C 103.72302 25.622132 103.84065 25.997842 104.05469 26.339844 C 104.26872 26.681846 104.54401 26.953582 104.87695 27.15625 L 112.04492 31.375 C 112.09262 31.40033 112.13432 31.425832 112.16992 31.451172 C 112.20552 31.476502 112.23401 31.488281 112.25781 31.488281 L 112.54297 31.640625 C 112.63817 31.691295 112.72361 31.754092 112.79492 31.830078 L 112.79492 33.994141 L 88.822266 33.994141 L 88.822266 31.830078 L 89.089844 31.640625 C 89.196862 31.564625 89.297447 31.513613 89.392578 31.488281 C 89.416398 31.462951 89.439071 31.442357 89.462891 31.429688 C 89.486711 31.416988 89.513289 31.412109 89.537109 31.412109 L 96.921875 27.117188 C 97.254845 26.939854 97.526184 26.681846 97.740234 26.339844 C 97.954274 25.997845 98.073886 25.622132 98.097656 25.216797 C 98.145256 24.811463 98.089577 24.421017 97.935547 24.041016 C 97.780967 23.661012 97.562734 23.343179 97.277344 23.089844 C 96.302254 22.279177 95.599958 21.120619 95.171875 19.613281 C 94.743792 18.105943 94.529297 16.870874 94.529297 15.908203 L 94.529297 10.777344 C 94.529297 9.8906751 95.178468 8.8782834 96.474609 7.7382812 C 97.770749 6.5982776 99.22654 6.0273453 100.84375 6.0273438 z M 21 7.9707031 C 20.447715 7.9707031 20 8.4184181 20 8.9707031 C 20 9.5229881 20.447715 9.9707031 21 9.9707031 L 69 9.9707031 C 69.552285 9.9707031 70 9.5229881 70 8.9707031 C 70 8.4184181 69.552285 7.9707031 69 7.9707031 L 21 7.9707031 z M 1 17.970703 C 0.4477153 17.970703 -2.220446e-16 18.418418 0 18.970703 C 0 19.522988 0.4477153 19.970703 1 19.970703 L 63 19.970703 C 63.552285 19.970703 64 19.522988 64 18.970703 C 64 18.418418 63.552285 17.970703 63 17.970703 L 1 17.970703 z M 21 27.970703 C 20.447715 27.970703 20 28.418418 20 28.970703 C 20 29.522988 20.447715 29.970703 21 29.970703 L 69 29.970703 C 69.552285 29.970703 70 29.522988 70 28.970703 C 70 28.418418 69.552285 27.970703 69 27.970703 L 21 27.970703 z"})))}var pn=s(48552),un=s(14504);function mn(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.mail",defaultMessage:"Mail Icon"})},M.createElement("path",{d:"M4,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4M12,11L20,6H4L12,11M4,18H20V8.37L12,13.36L4,8.37V18Z"})))}function gn(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.add-mail",defaultMessage:"Add Mail Icon"})},M.createElement("path",{d:"M3,4C1.89,4 1,4.89 1,6V18A2,2 0 0,0 3,20H14V18H3V8.37L11,13.36L19,8.37V13H21V6A2,2 0 0,0 19,4H3M3,6H19L11,11L3,6M19,15V18H16V20H19V23H21V20H24V18H21V15H19Z"})))}var fn=s(38769),En=s(46261),Cn=s(54300),bn=s(56640),_n=s(69632);function vn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class yn extends M.PureComponent{constructor(e){super(e),vn(this,"renderUserName",(e=>{const t=(0,I.H6)(e);let s=null;t.fullName&&(s=M.createElement("span",{className:"fullname"},t.fullName));let n=null;return t.nickname&&(n=M.createElement("span",{className:"nickname"},t.nickname)),M.createElement(M.Fragment,null,t.displayName,s,n)})),vn(this,"loadingMessage",(()=>{const e=M.createElement(V.Z,{id:this.props.loadingMessageId,defaultMessage:this.props.loadingMessageDefault});return M.createElement(bn.Z,{text:e})})),vn(this,"getOptionValue",(e=>e.id||e.value)),vn(this,"formatOptionLabel",((e,t)=>{const s=(0,I.bb)(e.id,e.last_picture_update);let n=null,a=null;return e.is_bot&&(a=M.createElement(Cn.Z,null)),!(0,dn.Jh)(e.value)&&(0,I.a_)(e)&&(n=M.createElement(En.Z,null)),"menu"===t.context?e.value&&(0,dn.Jh)(e.value)?this.getCreateLabel(e.value):M.createElement(M.Fragment,null,M.createElement(_n.Z,{size:"lg",username:e.username,url:s}),this.renderUserName(e),a,n):e.value&&(0,dn.Jh)(e.value)?M.createElement(M.Fragment,null,M.createElement(mn,{className:"mail-icon"}),M.createElement("span",null,e.value)):M.createElement(M.Fragment,null,M.createElement(_n.Z,{size:"sm",username:e.username,url:s}),(0,I.Gf)(e),a,n)})),vn(this,"onChange",(e=>{this.props.onChange&&this.props.onChange(e.map((e=>e.id?e:e.value)))})),vn(this,"getCreateLabel",(e=>M.createElement(M.Fragment,null,M.createElement(gn,{className:"mail-plus-icon"}),M.createElement(Dt.Z,{key:"widgets.users_emails_input.valid_email",id:this.props.validAddressMessageId,defaultMessage:this.props.validAddressMessageDefault,values:{email:e},disableLinks:!0})))),vn(this,"NoOptionsMessage",(e=>{const t=e.selectProps.inputValue;return t?M.createElement("div",{className:"users-emails-input__option users-emails-input__option--no-matches"},M.createElement(Dt.Z,{id:this.props.noMatchMessageId,defaultMessage:this.props.noMatchMessageDefault,values:{text:t},disableLinks:!0},(t=>M.createElement(un.wx.NoOptionsMessage,e,t)))):null})),vn(this,"MultiValueRemove",(({children:e,innerProps:t})=>M.createElement("div",t,e||M.createElement(fn.Z,null)))),vn(this,"components",{NoOptionsMessage:this.NoOptionsMessage,MultiValueRemove:this.MultiValueRemove,IndicatorsContainer:()=>null}),vn(this,"handleInputChange",((e,t)=>{if("input-blur"===t.action&&""!==e){const e=this.props.value.map((e=>e.id?e:{label:e,value:e}));for(const t of this.state.options){if(this.props.inputValue===t.username||this.props.inputValue==="@"+t.username)return this.onChange([...e,t]),void this.props.onInputChange("");if(this.props.inputValue===t.email)return this.onChange([...e,t]),void this.props.onInputChange("")}if(this.props.emailInvitationsEnabled&&(0,dn.Jh)(this.props.inputValue)){const t=this.props.inputValue;this.onChange([...e,{value:t,label:t}]),this.props.onInputChange("")}}"input-blur"!==t.action&&"menu-close"!==t.action&&this.props.onInputChange(e)})),vn(this,"optionsLoader",((e,t)=>{const s=e=>{this.setState({options:e}),t(e)},n=this.props.usersLoader(this.props.inputValue,s);n&&n.then&&n.then(s)})),vn(this,"showAddEmail",((e,t,s)=>this.props.emailInvitationsEnabled&&0===s.length&&(0,dn.Jh)(e))),vn(this,"onFocus",(()=>{this.selectRef.current.handleInputChange(this.props.inputValue,{action:"custom"})})),vn(this,"onBlur",(()=>{this.selectRef.current.handleInputChange(this.props.inputValue,{action:"input-blur"})})),this.selectRef=M.createRef(),this.state={options:[]}}render(){const e=this.props.value.map((e=>e.id?e:{label:e,value:e}));return M.createElement(M.Fragment,null,M.createElement(pn.Z,{ref:this.selectRef,styles:this.customStyles,onChange:this.onChange,loadOptions:this.optionsLoader,isValidNewOption:this.showAddEmail,isMulti:!0,isClearable:!1,className:W()("UsersEmailsInput",this.props.showError?"error":"",{empty:""===this.props.inputValue}),classNamePrefix:"users-emails-input",placeholder:this.props.placeholder,components:this.components,getOptionValue:this.getOptionValue,formatOptionLabel:this.formatOptionLabel,defaultOptions:!1,defaultMenuIsOpen:!1,openMenuOnClick:!1,loadingMessage:this.loadingMessage,onInputChange:this.handleInputChange,inputValue:this.props.inputValue,openMenuOnFocus:!0,onFocus:this.onFocus,onBlur:this.onBlur,tabSelectsValue:!0,value:e,"aria-label":this.props.ariaLabel}),this.props.showError&&M.createElement("div",{className:"InputErrorBox"},M.createElement(Dt.Z,{id:this.props.errorMessageId,defaultMessage:this.props.errorMessageDefault,values:this.props.errorMessageValues||null,disableLinks:!0},(e=>M.createElement(un.wx.NoOptionsMessage,null,e))),this.props.extraErrorText||null))}}vn(yn,"propTypes",{placeholder:y().string,ariaLabel:y().string.isRequired,usersLoader:y().func,onChange:y().func,showError:y().bool,errorMessageId:y().string,errorMessageDefault:y().string,errorMessageValues:y().object,value:y().arrayOf(y().oneOfType([y().object,y().string])),onInputChange:y().func,inputValue:y().string,noMatchMessageId:y().string,noMatchMessageDefault:y().string,validAddressMessageId:y().string,validAddressMessageDefault:y().string,loadingMessageId:y().string,loadingMessageDefault:y().string,emailInvitationsEnabled:y().bool,extraErrorText:y().any}),vn(yn,"defaultProps",{noMatchMessageId:(0,Ae.t)("widgets.users_emails_input.no_user_found_matching"),noMatchMessageDefault:"No one found matching **{text}**, type email address",validAddressMessageId:(0,Ae.t)("widgets.users_emails_input.valid_email"),validAddressMessageDefault:"Add **{email}**",loadingMessageId:(0,Ae.t)("widgets.users_emails_input.loading"),loadingMessageDefault:"Loading",showError:!1});const Mn=e=>{const t=(0,n.useDispatch)(),s=e.styleButton?" style-button":"",a=e.styleLink?" style-link":"",i=M.createElement(V.Z,{id:"upgradeLink.warn.upgrade_now",defaultMessage:"Upgrade now"});return M.createElement("button",{className:"upgradeLink".concat(s).concat(a),onClick:s=>(async s=>{s.preventDefault(),e.telemetryInfo&&(0,Ye.L9)("upgrade_mm_cloud",e.telemetryInfo);try{t((0,H.h)({modalId:N.r8.CLOUD_PURCHASE,dialogType:Ks.Z}))}catch(e){}})(s)},e.buttonText?e.buttonText:i)};Mn.propTypes={telemetryInfo:y().string,buttonText:y().string,styleButton:y().bool,styleLink:y().bool};const Pn=Mn;function wn(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.link",defaultMessage:"Link Icon"})},M.createElement("path",{d:"M10.59,13.41C11,13.8 11,14.44 10.59,14.83C10.2,15.22 9.56,15.22 9.17,14.83C7.22,12.88 7.22,9.71 9.17,7.76V7.76L12.71,4.22C14.66,2.27 17.83,2.27 19.78,4.22C21.73,6.17 21.73,9.34 19.78,11.29L18.29,12.78C18.3,11.96 18.17,11.14 17.89,10.36L18.36,9.88C19.54,8.71 19.54,6.81 18.36,5.64C17.19,4.46 15.29,4.46 14.12,5.64L10.59,9.17C9.41,10.34 9.41,12.24 10.59,13.41M13.41,9.17C13.8,8.78 14.44,8.78 14.83,9.17C16.78,11.12 16.78,14.29 14.83,16.24V16.24L11.29,19.78C9.34,21.73 6.17,21.73 4.22,19.78C2.27,17.83 2.27,14.66 4.22,12.71L5.71,11.22C5.7,12.04 5.83,12.86 6.11,13.65L5.64,14.12C4.46,15.29 4.46,17.19 5.64,18.36C6.81,19.54 8.71,19.54 9.88,18.36L13.41,14.83C14.59,13.66 14.59,11.76 13.41,10.59C13,10.2 13,9.56 13.41,9.17Z"})))}var Sn=s(12266),Tn=s(67530);function Nn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Rn extends M.PureComponent{constructor(e){super(e),Nn(this,"copyLink",(()=>{this.props.isCloud&&(0,Ye.L9)("cloud_invite_users","click_copy_link");const e=this.inviteLinkRef.current,t=document.createElement("textarea");t.innerText=e.value,t.style.position="fixed",t.style.opacity=0,document.body.appendChild(t),t.select();try{this.setState({copiedLink:document.execCommand("copy")})}catch(e){this.setState({copiedLink:!1})}t.remove(),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.setState({copiedLink:!1})}),3e3)})),Nn(this,"debouncedSearchProfiles",(0,cn.Ds)(((e,t)=>{this.props.searchProfiles(e).then((({data:s})=>{t(s),0===s.length?this.setState({termWithoutResults:e}):this.setState({termWithoutResults:null})})).catch((()=>{t([])}))}),150)),Nn(this,"usersLoader",((e,t)=>{if(this.state.termWithoutResults&&e.startsWith(this.state.termWithoutResults))t([]);else try{this.debouncedSearchProfiles(e,t)}catch(e){t([])}})),Nn(this,"onChange",(e=>{this.setState({usersAndEmails:e},(()=>{this.shouldShowPickerError()&&this.props.isCloud&&(0,Ye.L9)("cloud_invite_users","warning_near_limit",{remaining:this.getRemainingUsers()-this.state.usersAndEmails.length})})),this.props.onEdit(e.length>0||this.state.usersInputValue)})),Nn(this,"onUsersInputChange",(e=>{this.setState({usersInputValue:e}),this.props.onEdit(this.state.usersAndEmails.length>0||e)})),Nn(this,"submit",(()=>{this.props.isCloud&&(0,Ye.L9)("cloud_invite_users","click_send_invitations",{num_invitations:this.state.usersAndEmails.length});const e=[],t=[];for(const s of this.state.usersAndEmails)(0,dn.Jh)(s)?t.push(s):e.push(s);this.props.onSubmit(e,t,this.state.usersInputValue)})),Nn(this,"getRemainingUsers",(()=>{const{subscriptionStats:e}=this.props,{usersAndEmails:t}=this.state;return e&&e.remaining_seats-t.length})),Nn(this,"shouldShowPickerError",(()=>{const{userLimit:e,isCloud:t,subscriptionStats:s}=this.props;if(s&&"true"===s.is_paid_tier)return!1;if("0"===e||!t)return!1;const n=this.getRemainingUsers();return 0===n&&""!==this.state.usersInputValue||n<0})),this.inviteLinkRef=M.createRef(),this.timeout=null,this.state={usersAndEmails:[],copiedLink:!1,termWithoutResults:null,usersInputValue:""}}render(){const e=(0,Sn.fO)()+"/signup_user_complete/?id="+this.props.inviteId;let t=(0,I._u)("invitation_modal.members.search-and-add.placeholder","Add members or email addresses"),s=(0,Ae.t)("invitation_modal.members.users_emails_input.no_user_found_matching"),n="No one found matching **{text}**, type email to invite";this.props.emailInvitationsEnabled||(t=(0,I._u)("invitation_modal.members.search-and-add.placeholder-email-disabled","Add members"),s=(0,Ae.t)("invitation_modal.members.users_emails_input.no_user_found_matching-email-disabled"),n="No one found matching **{text}**");const{subscriptionStats:a}=this.props,i=a&&a.remaining_seats,r=this.state.usersAndEmails.length>N.gT.MAX_ADD_MEMBERS_BATCH||0===this.state.usersAndEmails.length,o={showError:this.shouldShowPickerError(),errorMessageId:(0,Ae.t)("invitation_modal.invite_members.hit_cloud_user_limit"),errorMessageDefault:"You can only invite **{num} more {num, plural, one {member} other {members}}** to the team on the free tier.",errorMessageValues:{num:i<0?"0":i},extraErrorText:this.props.userIsAdmin?M.createElement(Pn,{telemetryInfo:"click_upgrade_users_emails_input"}):M.createElement(Xs,null)};return this.state.usersAndEmails.length>N.gT.MAX_ADD_MEMBERS_BATCH&&(o.showError=!0,o.errorMessageId=(0,Ae.t)("invitation_modal.invite_members.exceeded_max_add_members_batch"),o.errorMessageDefault="No more than **{text}** people can be invited at once",o.errorMessageValues.text=N.gT.MAX_ADD_MEMBERS_BATCH),M.createElement("div",{className:"InvitationModalMembersStep"},M.createElement("div",{className:"modal-icon"},M.createElement(hn,null)),M.createElement("h1",{id:"invitation_modal_title"},M.createElement(Dt.Z,{id:"invitation_modal.members.title",defaultMessage:"Invite **Members** to {teamName}",values:{teamName:this.props.teamName}})),M.createElement("div",{className:"share-link","data-testid":"shareLink"},M.createElement("h2",null,M.createElement(V.Z,{id:"invitation_modal.members.share_link.title",defaultMessage:"Share This Link"})),M.createElement("div",{className:"share-link-input-block"},M.createElement("input",{ref:this.inviteLinkRef,className:"share-link-input",type:"text",readOnly:!0,value:e,"aria-label":this.props.intl.formatMessage({id:"invitation_modal.members.share_link.input",defaultMessage:"team invite link"}),"data-testid":"shareLinkInput"}),M.createElement("button",{className:"share-link-input-button",onClick:this.copyLink,"data-testid":"shareLinkInputButton"},M.createElement(wn,null),!this.state.copiedLink&&M.createElement(V.Z,{id:"invitation_modal.members.share_link.copy_button",defaultMessage:"Copy Link"}),this.state.copiedLink&&M.createElement(V.Z,{id:"invitation_modal.members.share_link.link_copied",defaultMessage:"Link Copied"}))),M.createElement("div",{className:"help-text"},M.createElement(V.Z,{id:"invitation_modal.members.share_link.description",defaultMessage:"Share this link to invite people to this team."}))),M.createElement("div",{className:"invitation-modal-or"},M.createElement("hr",null),M.createElement("div",null,M.createElement(V.Z,{id:"invitation_modal.members.or",defaultMessage:"OR"}))),M.createElement("div",{className:"search-and-add","data-testid":"searchAdd"},M.createElement("h2",null,M.createElement(V.Z,{id:"invitation_modal.members.search_and_add.title",defaultMessage:"Add or Invite People"})),M.createElement("div",{"data-testid":"inputPlaceholder"},M.createElement(yn,Object.assign({},o,{usersLoader:this.usersLoader,placeholder:t,ariaLabel:(0,I._u)("invitation_modal.members.search_and_add.title","Invite People"),onChange:this.onChange,value:this.state.usersAndEmails,validAddressMessageId:(0,Ae.t)("invitation_modal.members.users_emails_input.valid_email"),validAddressMessageDefault:"Invite **{email}** as a team member",noMatchMessageId:s,noMatchMessageDefault:n,onInputChange:this.onUsersInputChange,inputValue:this.state.usersInputValue,emailInvitationsEnabled:this.props.emailInvitationsEnabled}))),M.createElement("div",{className:"help-text"},this.props.emailInvitationsEnabled&&M.createElement(V.Z,{id:"invitation_modal.members.search-and-add.description",defaultMessage:"Add existing members or send email invites to new members."}),!this.props.emailInvitationsEnabled&&M.createElement(V.Z,{id:"invitation_modal.members.search-and-add.description-email-disabled",defaultMessage:"Add existing members to this team."}))),M.createElement("div",{className:"invite-members"},M.createElement("button",{className:"btn "+(r?"btn-inactive":"btn-primary"),onClick:this.submit,disabled:r,id:"inviteMembersButton"},M.createElement(V.Z,{id:"invitation_modal.members.invite_button",defaultMessage:"Invite Members"}))))}}Nn(Rn,"propTypes",{teamName:y().string.isRequired,currentTeamId:y().string.isRequired,intl:y().any,inviteId:y().string.isRequired,searchProfiles:y().func.isRequired,emailInvitationsEnabled:y().bool.isRequired,onEdit:y().func.isRequired,onSubmit:y().func.isRequired,userLimit:y().string.isRequired,currentUsers:y().number.isRequired,userIsAdmin:y().bool.isRequired,isCloud:y().bool.isRequired,subscriptionStats:y().object,actions:y().shape({getSubscriptionStats:y().func.isRequired}).isRequired});const In=(0,K.ZP)((0,Tn.Z)(Rn)),On=(0,n.connect)((function(e){return{userLimit:(0,h.iE)(e).ExperimentalCloudUserLimit,userIsAdmin:(0,I.GJ)((0,p.ts)(e).roles),isCloud:"true"===(0,h.lJ)(e).Cloud,subscriptionStats:(0,h.F3)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getSubscriptionStats:Yt.F3},e)}}))(In);function Ln(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.close",defaultMessage:"Close Icon"})},M.createElement("path",{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M14.59,8L12,10.59L9.41,8L8,9.41L10.59,12L8,14.59L9.41,16L12,13.41L14.59,16L16,14.59L13.41,12L16,9.41L14.59,8Z"})))}var An=s(60820),kn=s(3636),xn=s(37951);function Dn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Zn extends M.PureComponent{constructor(e){super(e),Dn(this,"getOptionValue",(e=>e.id)),Dn(this,"handleInputChange",((e,t)=>{if("input-blur"===t.action&&""!==e)for(const e of this.state.options)if(this.props.inputValue===e.name)return this.onChange([...this.props.value,e]),void this.props.onInputChange("");"input-blur"!==t.action&&"menu-close"!==t.action&&this.props.onInputChange(e)})),Dn(this,"optionsLoader",((e,t)=>{const s=e=>{this.setState({options:e}),t(e)},n=this.props.channelsLoader(this.props.inputValue,s);n&&n.then&&n.then(s)})),Dn(this,"loadingMessage",(()=>{const e=M.createElement(V.Z,{id:this.props.loadingMessageId,defaultMessage:this.props.loadingMessageDefault});return M.createElement(bn.Z,{text:e})})),Dn(this,"NoOptionsMessage",(e=>{const t=e.selectProps.inputValue;return t?M.createElement("div",{className:"channels-input__option channels-input__option--no-matches"},M.createElement(Dt.Z,{id:this.props.noOptionsMessageId,defaultMessage:this.props.noOptionsMessageDefault,values:{text:t}},(t=>M.createElement(un.wx.NoOptionsMessage,e,t)))):null})),Dn(this,"formatOptionLabel",(e=>{let t=M.createElement(kn.Z,{className:"public-channel-icon"});return e.type===N.gT.PRIVATE_CHANNEL&&(t=M.createElement(xn.Z,{className:"private-channel-icon"})),M.createElement(M.Fragment,null,t,e.display_name,M.createElement("span",{className:"channel-name"},e.name))})),Dn(this,"onChange",(e=>{this.props.onChange&&this.props.onChange(e)})),Dn(this,"MultiValueRemove",(({children:e,innerProps:t})=>M.createElement("div",t,e||M.createElement(fn.Z,null)))),Dn(this,"components",{NoOptionsMessage:this.NoOptionsMessage,MultiValueRemove:this.MultiValueRemove,IndicatorsContainer:()=>null}),Dn(this,"onFocus",(()=>{this.selectRef.current.handleInputChange(this.props.inputValue,{action:"custom"})})),this.selectRef=M.createRef(),this.state={options:[]}}render(){return M.createElement(An.default,{ref:this.selectRef,styles:this.customStyles,onChange:this.onChange,loadOptions:this.optionsLoader,isMulti:!0,isClearable:!1,className:W()("ChannelsInput",{empty:""===this.props.inputValue}),classNamePrefix:"channels-input",placeholder:this.props.placeholder,components:this.components,getOptionValue:this.getOptionValue,formatOptionLabel:this.formatOptionLabel,noOptionsMessage:this.noOptionsMessage,loadingMessage:this.loadingMessage,defaultOptions:!1,defaultMenuIsOpen:!1,openMenuOnClick:!1,onInputChange:this.handleInputChange,inputValue:this.props.inputValue,openMenuOnFocus:!0,onFocus:this.onFocus,tabSelectsValue:!0,value:this.props.value,"aria-label":this.props.ariaLabel})}}function Hn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Dn(Zn,"propTypes",{placeholder:y().string,ariaLabel:y().string.isRequired,channelsLoader:y().func,onChange:y().func,value:y().arrayOf(y().object),onInputChange:y().func,inputValue:y().string,loadingMessageId:y().string,loadingMessageDefault:y().string,noOptionsMessageId:y().string,noOptionsMessageDefault:y().string}),Dn(Zn,"defaultProps",{loadingMessageId:(0,Ae.t)("widgets.channels_input.loading"),loadingMessageDefault:"Loading",noOptionsMessageId:(0,Ae.t)("widgets.channels_input.empty"),noOptionsMessageDefault:"No channels found"});class qn extends M.PureComponent{constructor(e){super(e),Hn(this,"onUsersEmailsChange",(e=>{this.setState({usersAndEmails:e}),this.props.onEdit(e.length>0||this.state.channels.length>0||""!==this.state.customMessage||this.state.usersInputValue||this.state.channelsInputValue)})),Hn(this,"onChannelsChange",(e=>{this.setState({channels:e}),this.props.onEdit(this.state.usersAndEmails.length>0||e.length>0||""!==this.state.customMessage||this.state.usersInputValue||this.state.channelsInputValue)})),Hn(this,"onMessageChange",(e=>{this.setState({customMessage:e.target.value}),this.props.onEdit(this.state.usersAndEmails.length>0||this.state.channels.length>0||""!==e.target.value||this.state.usersInputValue||this.state.channelsInputValue)})),Hn(this,"onUsersInputChange",(e=>{this.setState({usersInputValue:e}),this.props.onEdit(this.state.usersAndEmails.length>0||this.state.channels.length>0||""!==this.state.customMessage||e||this.state.channelsInputValue)})),Hn(this,"onChannelsInputChange",(e=>{this.setState({channelsInputValue:e}),this.props.onEdit(this.state.usersAndEmails.length>0||this.state.channels.length>0||""!==this.state.customMessage||this.state.usersInputValue||e)})),Hn(this,"debouncedSearchProfiles",(0,cn.Ds)(((e,t)=>{this.props.searchProfiles(e).then((({data:s})=>{t(s),0===s.length?this.setState({termWithoutResults:e}):this.setState({termWithoutResults:null})})).catch((()=>{t([])}))}),150)),Hn(this,"usersLoader",((e,t)=>{if(this.state.termWithoutResults&&e.startsWith(this.state.termWithoutResults))t([]);else try{this.debouncedSearchProfiles(e,t)}catch(e){t([])}})),Hn(this,"debouncedSearchChannels",(0,cn.Ds)((e=>this.props.searchChannels(this.props.currentTeamId,e)),150)),Hn(this,"channelsLoader",(async e=>e?(this.debouncedSearchChannels(e),this.props.myInvitableChannels.filter((t=>t.display_name.toLowerCase().startsWith(e.toLowerCase())||t.name.toLowerCase().startsWith(e.toLowerCase())))):this.props.myInvitableChannels)),Hn(this,"openCustomMessage",(()=>{this.setState({customMessageOpen:!0}),setTimeout((()=>{this.textareaRef.current&&this.textareaRef.current.focus()}))})),Hn(this,"closeCustomMessage",(()=>{this.setState({customMessageOpen:!1})})),Hn(this,"sendInvites",(()=>{const e=[],t=[];for(const s of this.state.usersAndEmails)(0,dn.Jh)(s)?t.push(s):e.push(s);this.props.onSubmit(e,t,this.state.channels,this.state.customMessageOpen?this.state.customMessage:"",this.state.usersInputValue,this.state.channelsInputValue)})),Hn(this,"getRemainingUsers",(()=>{const{subscriptionStats:e}=this.props,{usersAndEmails:t}=this.state;return e&&e.remaining_seats-t.length})),Hn(this,"shouldShowPickerError",(()=>{const{userLimit:e,userIsAdmin:t,isCloud:s,subscriptionStats:n}=this.props;if(n&&"true"===n.is_paid_tier)return!1;if("0"===e||!t||!s)return!1;const a=this.getRemainingUsers();return 0===a&&""!==this.state.usersInputValue||a<0})),this.textareaRef=M.createRef(),this.state={customMessageOpen:Boolean(e.defaultMessage),customMessage:e.defaultMessage||"",usersAndEmails:[],channels:e.defaultChannels||[],usersInputValue:"",channelsInputValue:""}}render(){let e=(0,I._u)("invitation_modal.guests.search-and-add.placeholder","Add guests or email addresses"),t=(0,Ae.t)("invitation_modal.guests.users_emails_input.no_user_found_matching"),s="No one found matching **{text}**, type email to invite";this.props.emailInvitationsEnabled||(e=(0,I._u)("invitation_modal.guests.search-and-add.placeholder-email-disabled","Add guests"),t=(0,Ae.t)("invitation_modal.guests.users_emails_input.no_user_found_matching-email-disabled"),s="No one found matching **{text}**");const{subscriptionStats:n}=this.props,a=n&&n.remaining_seats;return M.createElement("div",{className:"InvitationModalGuestsStep"},M.createElement("div",{className:"modal-icon"},M.createElement(an,null)),M.createElement("h1",{id:"invitation_modal_title"},M.createElement(Dt.Z,{id:"invitation_modal.guests.title",defaultMessage:"Invite **Guests** to {teamName}",values:{teamName:this.props.teamName}})),M.createElement("div",{className:"add-people","data-testid":"addPeople"},M.createElement("h2",null,M.createElement(V.Z,{id:"invitation_modal.guests.add_people.title",defaultMessage:"Invite People"})),M.createElement("div",{"data-testid":"emailPlaceholder"},M.createElement(yn,{usersLoader:this.usersLoader,placeholder:e,ariaLabel:(0,I._u)("invitation_modal.guests.add_people.title","Invite People"),showError:this.shouldShowPickerError(),errorMessageId:(0,Ae.t)("invitation_modal.invite_members.hit_cloud_user_limit"),errorMessageDefault:"You can only invite **{num} more {num, plural, one {member} other {members}}** to the team on the free tier.",errorMessageValues:{num:a<0?"0":a},extraErrorText:M.createElement(Pn,{handleClick:e=>this.handleLinkClick(e)}),onChange:this.onUsersEmailsChange,value:this.state.usersAndEmails,onInputChange:this.onUsersInputChange,inputValue:this.state.usersInputValue,validAddressMessageId:(0,Ae.t)("invitation_modal.guests.users_emails_input.valid_email"),validAddressMessageDefault:"Invite **{email}** as a guest",noMatchMessageId:t,noMatchMessageDefault:s,emailInvitationsEnabled:this.props.emailInvitationsEnabled})),M.createElement("div",{className:"help-text"},this.props.emailInvitationsEnabled&&M.createElement(V.Z,{id:"invitation_modal.guests.add_people.description",defaultMessage:"Add existing guests or send email invites to new guests."}),!this.props.emailInvitationsEnabled&&M.createElement(V.Z,{id:"invitation_modal.guests.add_people.description-email-disabled",defaultMessage:"Add existing guests."}))),M.createElement("div",{className:"add-channels","data-testid":"channelPlaceholder"},M.createElement("h2",null,M.createElement(V.Z,{id:"invitation_modal.guests.add_channels.title",defaultMessage:"Search and Add Channels"})),M.createElement("div",null,M.createElement(V.Z,{id:"invitation_modal.guests.add_channels.placeholder",defaultMessage:"Search and add channels"},(e=>M.createElement(Zn,{placeholder:e,ariaLabel:(0,I._u)("invitation_modal.guests.add_channels.title","Search and Add Channels"),channelsLoader:this.channelsLoader,onChange:this.onChannelsChange,onInputChange:this.onChannelsInputChange,inputValue:this.state.channelsInputValue,value:this.state.channels})))),M.createElement("div",{className:"help-text"},M.createElement(V.Z,{id:"invitation_modal.guests.add-channels.description",defaultMessage:"Specify the channels the guests have access to."}))),M.createElement("div",{className:"custom-message","data-testid":"customMessage"},!this.state.customMessageOpen&&M.createElement("a",{onClick:this.openCustomMessage,href:"#"},M.createElement(V.Z,{id:"invitation_modal.guests.custom-message.link",defaultMessage:"Set a custom message"})),this.state.customMessageOpen&&M.createElement(M.Fragment,null,M.createElement("div",null,M.createElement(V.Z,{id:"invitation_modal.guests.custom-message.title",defaultMessage:"Custom message"}),M.createElement(Ln,{onClick:this.closeCustomMessage})),M.createElement("textarea",{ref:this.textareaRef,onChange:this.onMessageChange,value:this.state.customMessage})),M.createElement("div",{className:"help-text"},M.createElement(V.Z,{id:"invitation_modal.guests.custom-message.description",defaultMessage:"Create a custom message to make your invite more personal."}))),M.createElement("div",{className:"invite-guests"},M.createElement("button",{className:"btn "+(0===this.state.channels.length||0===this.state.usersAndEmails.length?"btn-inactive":"btn-primary"),disabled:0===this.state.channels.length||0===this.state.usersAndEmails.length,onClick:this.sendInvites,id:"inviteGuestButton"},M.createElement(V.Z,{id:"invitation_modal.guests.invite_button",defaultMessage:"Invite Guests"}))))}}Hn(qn,"propTypes",{teamName:y().string.isRequired,myInvitableChannels:y().array.isRequired,currentTeamId:y().string.isRequired,searchProfiles:y().func.isRequired,searchChannels:y().func.isRequired,defaultChannels:y().array,defaultMessage:y().string,onEdit:y().func.isRequired,onSubmit:y().func.isRequired,emailInvitationsEnabled:y().bool.isRequired,userLimit:y().string.isRequired,userIsAdmin:y().bool.isRequired,isCloud:y().bool.isRequired,subscriptionStats:y().object,actions:y().shape({getSubscriptionStats:y().func.isRequired}).isRequired});const jn=(0,Tn.Z)(qn),Un=(0,n.connect)((function(e){return{userLimit:(0,h.iE)(e).ExperimentalCloudUserLimit,userIsAdmin:(0,I.GJ)((0,p.ts)(e).roles),isCloud:"true"===(0,h.lJ)(e).Cloud,subscriptionStats:(0,h.F3)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getSubscriptionStats:Yt.F3},e)}}))(jn);function Fn(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",role:"img","aria-label":t({id:"generic_icons.alert",defaultMessage:"Alert Icon"})},M.createElement("path",{d:"M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z"})))}class Bn extends M.PureComponent{render(){const{invitation:e}=this.props;let t,s,n,a,i;if(e.user){n="name";const r=(0,I.bb)(e.user.id,e.user.last_picture_update);t=M.createElement(_n.Z,{username:e.user.username,url:r,size:"lg"}),s=(0,I.JF)(e.user),e.user.is_bot&&(i=M.createElement(Cn.Z,null)),(0,I.a_)(e.user)&&(a=M.createElement(En.Z,null))}else e.email?(n="email",t=M.createElement(mn,{className:"mail-icon"}),s=e.email):(n="name",t=M.createElement(Fn,{className:"alert-icon"}),s=e.text);let r=e.reason;return e.reason&&e.reason.id&&(r=M.createElement(V.Z,{id:e.reason.id,defaultMessage:e.reason.message,values:e.reason.values})),M.createElement("div",{className:"InvitationModalConfirmStepRow"},M.createElement("div",{className:"username-or-icon"},t,M.createElement("span",{className:n},s,i,a)),M.createElement("div",{className:"reason"},r))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(Bn,"propTypes",{invitation:y().object.isRequired});class Gn extends M.PureComponent{render(){return M.createElement("div",{className:"InvitationModalConfirmStepTable"},M.createElement("div",{className:"table-header"},M.createElement("div",{className:"people-header"},M.createElement(V.Z,{id:"invitation-modal.confirm.people-header",defaultMessage:"People"})),M.createElement("div",{className:"details-header"},M.createElement(V.Z,{id:"invitation-modal.confirm.details-header",defaultMessage:"Details"}))),M.createElement("div",{className:"rows"},this.props.invites.map((e=>M.createElement(Bn,{key:e.text||e.email||e.user.id,invitation:e})))))}}function Vn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(Gn,"propTypes",{invites:y().arrayOf(y().object).isRequired});class Kn extends M.PureComponent{constructor(...e){super(...e),Vn(this,"getInvitesCountsMessage",((e,t)=>e>0&&t>0?M.createElement(Dt.Z,{id:"invitation_modal.confirm.members_subtitle",defaultMessage:"**{sentCount, number} {sentCount, plural, one {person} other {people}}** {sentCount, plural, one {has} other {have}} been invited, and **{notSentCount, number} {notSentCount, plural, one {invitation} other {invitations}}** {notSentCount, plural, one {was} other {were}} not sent",values:{sentCount:e,notSentCount:t}}):e>0&&0===t?M.createElement(Dt.Z,{id:"invitation_modal.confirm.members_subtitle_without_not_sent",defaultMessage:"**{sentCount, number} {sentCount, plural, one {person} other {people}}** {sentCount, plural, one {has} other {have}} been invited",values:{sentCount:e}}):0===e&&t>0?M.createElement(Dt.Z,{id:"invitation_modal.confirm.members_subtitle_without_sent",defaultMessage:"**{notSentCount, number} {notSentCount, plural, one {invitation} other {invitations}}** {notSentCount, plural, one {was} other {were}} not sent",values:{notSentCount:t}}):M.createElement(Dt.Z,{id:"invitation_modal.confirm.members_subtitle_without_sent_and_not_sent",defaultMessage:"No invitation sent"})))}render(){const{teamName:e,invitesType:t,invitesSent:s,invitesNotSent:n,onDone:a,onInviteMore:i}=this.props;return M.createElement("div",{className:"InvitationModalConfirmStep"},M.createElement("div",{className:"modal-icon"},M.createElement(an,null)),t===N.wx.INVITE_MEMBER&&M.createElement("h1",{id:"invitation_modal_title"},M.createElement(Dt.Z,{id:"invitation_modal.confirm.members_title",defaultMessage:"**Members** Invited to **{teamName}**",values:{teamName:e}})),t===N.wx.INVITE_GUEST&&M.createElement("h1",{id:"invitation_modal_title"},M.createElement(Dt.Z,{id:"invitation_modal.confirm.guests_title",defaultMessage:"**Guests** Invited to **{teamName}**",values:{teamName:e}})),M.createElement("h2",{className:"subtitle"},this.getInvitesCountsMessage(s.length,n.length)),s.length>0&&M.createElement("div",{className:"invitation-modal-confirm-sent"},M.createElement("h2",null,M.createElement(V.Z,{id:"invitation_modal.confirm.sent-header",defaultMessage:"Successful Invites"})),M.createElement(Gn,{invites:s})),n.length>0&&M.createElement("div",{className:"invitation-modal-confirm-not-sent"},M.createElement("h2",null,M.createElement(V.Z,{id:"invitation_modal.confirm.not-sent-header",defaultMessage:"Invitations Not Sent"})),M.createElement(Gn,{invites:n})),M.createElement("div",{className:"button-input-block"},M.createElement("button",{className:"btn invite-more",onClick:i},M.createElement(V.Z,{id:"invitation_modal.invite.more",defaultMessage:"Invite More People"})),M.createElement("button",{className:"btn btn-primary confirm-done",onClick:a},M.createElement(V.Z,{id:"invitation_modal.confirm.done",defaultMessage:"Done"}))))}}function Yn(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Vn(Kn,"propTypes",{teamName:y().string.isRequired,onDone:y().func.isRequired,onInviteMore:y().func.isRequired,invitesType:y().oneOf([N.wx.INVITE_MEMBER,N.wx.INVITE_GUEST]).isRequired,invitesSent:y().array.isRequired,invitesNotSent:y().array.isRequired});const Wn="initial",zn="members",Jn="guests",Xn="confirm";class Qn extends M.PureComponent{constructor(e){super(e),Yn(this,"modal",M.createRef()),Yn(this,"goToFirstStep",(()=>{this.props.canAddUsers&&this.props.canInviteGuests?this.goToInitialStep():this.props.canAddUsers?this.goToMembers():this.props.canInviteGuests?this.goToGuests():this.close()})),Yn(this,"goToInitialStep",(()=>{this.state.hasChanges?this.setState({confirmBack:!0}):this.setState({step:Wn,hasChanges:!1,lastInviteChannels:[],lastInviteMesssage:"",prevStep:this.state.step}),this.modal&&this.modal.current&&this.modal.current.enforceFocus()})),Yn(this,"goToMembers",(()=>{this.props.isCloud&&(0,Ye.L9)("cloud_invite_users","click_invite_members"),this.setState({step:zn,prevStep:this.state.step,hasChanges:!1,invitesSent:[],invitesNotSent:[],invitesType:N.wx.INVITE_MEMBER}),this.modal&&this.modal.current&&this.modal.current.enforceFocus()})),Yn(this,"goToGuests",(()=>{this.props.isCloud&&(0,Ye.L9)("cloud_invite_users","click_invite_guests"),this.setState({step:Jn,prevStep:this.state.step,hasChanges:!1,invitesSent:[],invitesNotSent:[],invitesType:N.wx.INVITE_GUEST}),this.modal&&this.modal.current&&this.modal.current.enforceFocus()})),Yn(this,"goToPrevStep",(()=>{this.state.prevStep===Jn?this.setState({step:Jn,prevStep:this.state.step,hasChanges:!1,invitesSent:[],invitesNotSent:[],invitesType:N.wx.INVITE_GUEST}):this.state.prevStep===zn&&this.setState({step:zn,prevStep:this.state.step,hasChanges:!1,invitesSent:[],invitesNotSent:[],invitesType:N.wx.INVITE_MEMBER}),this.modal&&this.modal.current&&this.modal.current.enforceFocus()})),Yn(this,"getBackFunction",(()=>this.state.step===Xn&&this.state.invitesNotSent.length>0?this.goToPrevStep:(this.state.step===zn||this.state.step===Jn)&&this.props.canInviteGuests&&this.props.canAddUsers?this.goToInitialStep:null)),Yn(this,"onEdit",(e=>{this.setState({hasChanges:e})})),Yn(this,"close",(()=>{this.state.hasChanges?this.setState({confirmModal:!0}):this.props.actions.closeModal()})),Yn(this,"confirmBack",(()=>{this.setState({step:Wn,hasChanges:!1,confirmBack:!1})})),Yn(this,"cancelBack",(()=>{this.setState({confirmBack:!1})})),Yn(this,"confirmClose",(()=>{this.props.actions.closeModal(),this.setState({confirmModal:!1})})),Yn(this,"cancelClose",(()=>{this.setState({confirmModal:!1})})),Yn(this,"onMembersSubmit",(async(e,t,s)=>{const n=await this.props.actions.sendMembersInvites(this.props.currentTeam.id,e,t);this.props.isCloud&&(0,Ye.L9)("cloud_invite_users","invitations_sent",{num_invitations_sent:n.sent}),""!==s&&n.notSent.push({text:s,reason:M.createElement(V.Z,{id:"invitation-modal.confirm.not-valid-user-or-email",defaultMessage:"Does not match a valid user or email."})}),this.setState({step:Xn,prevStep:this.state.step,invitesSent:n.sent,invitesNotSent:n.notSent,invitesType:N.wx.INVITE_MEMBER,hasChanges:!1})})),Yn(this,"onGuestsSubmit",(async(e,t,s,n,a,i)=>{const r=await this.props.actions.sendGuestsInvites(this.props.currentTeam.id,s.map((e=>e.id)),e,t,n);""!==a&&r.notSent.push({text:a,reason:M.createElement(V.Z,{id:"invitation-modal.confirm.not-valid-user-or-email",defaultMessage:"Does not match a valid user or email."})}),""!==i&&r.notSent.push({text:i,reason:M.createElement(V.Z,{id:"invitation-modal.confirm.not-valid-channel",defaultMessage:"Does not match a valid channel name."})}),this.setState({step:Xn,prevStep:this.state.step,lastInviteChannels:s,lastInviteMessage:n,invitesSent:r.sent,invitesNotSent:r.notSent,invitesType:N.wx.INVITE_GUEST,hasChanges:!1})}));let t=Wn;e.canInviteGuests||(t=zn),e.canAddUsers||(t=Jn),this.state={step:t,prevStep:null,lastInviteChannels:[],lastInviteMessage:"",confirmModal:!1,confirmBack:!1,hasChanges:!1,invitesType:N.wx.INVITE_MEMBER,invitesSent:[],invitesNotSent:[]}}componentDidMount(){this.props.isCloud&&(0,Ye.tF)("cloud_invite_users","pageview_invite_users")}componentDidUpdate(e,t){this.state.step!==zn||t.step===zn||this.props.currentTeam.invite_id||this.props.actions.getTeam(this.props.currentTeam.id)}render(){const e=M.createElement(Gs.Z,null,M.createElement(Bs.Z,{show:Boolean(this.props.show),onClose:this.close,onGoBack:this.getBackFunction(),ref:this.modal,ariaLabelledBy:"invitation_modal_title"},M.createElement("div",{"data-testid":"invitationModal",className:"InvitationModal"},M.createElement(Te.Z,{show:this.state.confirmModal||this.state.confirmBack,title:M.createElement(V.Z,{id:"invitation-modal.discard-changes.title",defaultMessage:"Discard Changes"}),message:M.createElement(V.Z,{id:"invitation-modal.discard-changes.message",defaultMessage:"You have unsent invitations, are you sure you want to discard them?"}),confirmButtonText:M.createElement(V.Z,{id:"invitation-modal.discard-changes.button",defaultMessage:"Yes, Discard"}),modalClass:"invitation-modal-confirm",onConfirm:this.state.confirmModal?this.confirmClose:this.confirmBack,onCancel:this.state.confirmModal?this.cancelClose:this.cancelBack}),this.state.step===Wn&&M.createElement(ln,{teamName:this.props.currentTeam.display_name,goToMembers:this.goToMembers,goToGuests:this.goToGuests,emailInvitationsEnabled:this.props.emailInvitationsEnabled}),this.state.step===zn&&M.createElement(On,{teamName:this.props.currentTeam.display_name,currentTeamId:this.props.currentTeam.id,inviteId:this.props.currentTeam.invite_id,searchProfiles:this.props.actions.searchProfiles,emailInvitationsEnabled:this.props.emailInvitationsEnabled,onSubmit:this.onMembersSubmit,onEdit:this.onEdit}),this.state.step===Jn&&M.createElement(Un,{teamName:this.props.currentTeam.display_name,currentTeamId:this.props.currentTeam.id,myInvitableChannels:this.props.invitableChannels,searchProfiles:this.props.actions.searchProfiles,searchChannels:this.props.actions.searchChannels,defaultChannels:this.state.lastInviteChannels,defaultMessage:this.state.lastInviteMessage,emailInvitationsEnabled:this.props.emailInvitationsEnabled,onSubmit:this.onGuestsSubmit,onEdit:this.onEdit}),this.state.step===Xn&&M.createElement(Kn,{teamName:this.props.currentTeam.display_name,currentTeamId:this.props.currentTeam.id,onDone:this.close,onInviteMore:this.goToFirstStep,invitesType:this.state.invitesType,invitesSent:this.state.invitesSent,invitesNotSent:this.state.invitesNotSent})))),t={closeModal:this.props.actions.closeModal,openModal:this.props.actions.openModal},s=M.createElement(nn,{userIsAdmin:this.props.userIsAdmin,cloudUserLimit:this.props.cloudUserLimit,show:Boolean(this.props.show),actions:t});return M.createElement(M.Fragment,null,this.props.isFreeTierWithNoFreeSeats?s:e)}}Yn(Qn,"propTypes",{show:y().bool,currentTeam:y().object.isRequired,invitableChannels:y().array.isRequired,canInviteGuests:y().bool.isRequired,canAddUsers:y().bool.isRequired,emailInvitationsEnabled:y().bool.isRequired,isCloud:y().bool.isRequired,isFreeTierWithNoFreeSeats:y().bool.isRequired,userIsAdmin:y().bool.isRequired,cloudUserLimit:y().string.isRequired,actions:y().shape({closeModal:y().func.isRequired,sendGuestsInvites:y().func.isRequired,sendMembersInvites:y().func.isRequired,searchProfiles:y().func.isRequired,searchChannels:y().func.isRequired,getTeam:y().func.isRequired,openModal:y().func}).isRequired});const $n=(e,t={})=>e?(0,r.t6)(e,t):(0,r.cp)(0,20,t),ea=(e,t)=>(0,o.r6)(e,t),ta=(0,n.connect)((function(e){const t=(0,h.iE)(e),s=(0,h.lJ)(e),n=(0,m.zE)(e),a=(0,u.kA)(e),i=(0,h.F3)(e),r=n.filter((t=>t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&(t.type===N.gT.PRIVATE_CHANNEL?(0,Z.Ai)(e,{channel:t.id,team:a.id,permission:D.Pl.MANAGE_PRIVATE_CHANNEL_MEMBERS}):(0,Z.Ai)(e,{channel:t.id,team:a.id,permission:D.Pl.MANAGE_PUBLIC_CHANNEL_MEMBERS})))),o="true"===t.EnableGuestAccounts,l="true"===t.EnableEmailInvitations,c=s&&"true"===s.IsLicensed,d=!Boolean(a.group_constrained)&&c&&o&&(0,Z.Rm)(e,{team:a.id,permission:D.Pl.INVITE_GUEST}),g="true"===s.Cloud,f=g&&!qs()(i)&&"false"===i.is_paid_tier&&i.remaining_seats<=0,E=(0,Z.Rm)(e,{team:a.id,permission:D.Pl.ADD_USER_TO_TEAM});return{invitableChannels:r,currentTeam:a,canInviteGuests:d,canAddUsers:E,isFreeTierWithNoFreeSeats:f,emailInvitationsEnabled:l,show:(0,Ms.g)(e,N.r8.INVITATION),isCloud:g,userIsAdmin:(0,I.GJ)((0,p.ts)(e).roles),cloudUserLimit:t.ExperimentalCloudUserLimit||"10"}}),(function(e){return{actions:(0,a.bindActionCreators)({closeModal:()=>(0,H.M)(N.r8.INVITATION),sendGuestsInvites:Us,sendMembersInvites:js,searchProfiles:$n,searchChannels:ea,getTeam:l.VP,openModal:e=>(0,H.h)(e)},e)}}))(Qn);function sa(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class na extends M.PureComponent{constructor(e){super(e),sa(this,"handleHide",(()=>{this.setState({show:!1})})),sa(this,"handleExit",(()=>{this.props.onHide()})),sa(this,"handleInvitePeople",(()=>{const{actions:e}=this.props;e.openModal({modalId:N.r8.INVITATION,dialogType:ta}),this.handleExit()})),this.state={show:!0}}componentDidMount(){this.props.onLoad&&this.props.onLoad()}render(){let e="";return this.props.currentTeam&&(e=this.props.currentTeam.display_name),M.createElement(G.Z,{dialogClassName:"a11y__modal more-modal",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"teamMemberModalLabel",id:"teamMembersModal"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"teamMemberModalLabel"},M.createElement(V.Z,{id:"team_member_modal.members",defaultMessage:"{team} Members",values:{team:e}})),M.createElement(vs.Z,{teamId:this.props.currentTeam.id,permissions:[Ps.Z.ADD_USER_TO_TEAM,Ps.Z.INVITE_GUEST]},M.createElement("button",{id:"invitePeople",type:"button",className:"btn btn-primary invite-people-btn",onClick:this.handleInvitePeople},M.createElement(V.Z,{id:"team_member_modal.invitePeople",defaultMessage:"Invite People"})))),M.createElement(G.Z.Body,null,M.createElement(Zs,{teamId:this.props.currentTeam.id})))}}sa(na,"propTypes",{currentTeam:y().shape({id:y().string.isRequired,display_name:y().string.isRequired}).isRequired,onHide:y().func.isRequired,onLoad:y().func,actions:y().shape({openModal:y().func.isRequired}).isRequired});const aa=(0,n.connect)((function(e){const t=N.r8.TEAM_MEMBERS;return{currentTeam:(0,u.kA)(e),show:(0,Ms.g)(e,t)}}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h},e)}}))(na);var ia=s(4002),ra=s.n(ia),oa=s(73935),la=(s(41817),s(93733)),ca=s(87878),da=s(68538),ha=s(70767),pa=s(927);function ua(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function ma(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ua(Object(s),!0).forEach((function(t){ga(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ua(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ga(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const fa=["image/jpeg","image/png","image/bmp"];class Ea extends M.PureComponent{constructor(e){super(e),ga(this,"updateSection",(e=>{this.setState(this.setupInitialState(this.props)),this.props.updateSection(e)})),ga(this,"handleOpenInviteRadio",(e=>{this.setState({allow_open_invite:e})})),ga(this,"handleAllowedDomainsSubmit",(async()=>{var e={serverError:"",clientError:""},t=ma({},this.props.team);t.allowed_domains=this.state.allowed_domains;const{error:s}=await this.props.actions.patchTeam(t);s?(e.serverError=s.message,this.setState(e)):this.updateSection("")})),ga(this,"handleOpenInviteSubmit",(async()=>{var e={serverError:"",clientError:""},t=ma({},this.props.team);t.allow_open_invite=this.state.allow_open_invite;const{error:s}=await this.props.actions.patchTeam(t);s?(e.serverError=s.message,this.setState(e)):this.updateSection("")})),ga(this,"handleNameSubmit",(async()=>{var e={serverError:"",clientError:""};let t=!0;const s=this.state.name.trim();if(s?s.length<N.ZP.MIN_TEAMNAME_LENGTH?(e.clientError=M.createElement(V.Z,{id:"general_tab.teamNameRestrictions",defaultMessage:"Team Name must be {min} or more characters up to a maximum of {max}. You can add a longer team description.",values:{min:N.ZP.MIN_TEAMNAME_LENGTH,max:N.ZP.MAX_TEAMNAME_LENGTH}}),t=!1):e.clientError="":(e.clientError=I._u("general_tab.required","This field is required"),t=!1),this.setState(e),!t)return;var n=ma({},this.props.team);n.display_name=this.state.name;const{error:a}=await this.props.actions.patchTeam(n);a?(e.serverError=a.message,this.setState(e)):this.updateSection("")})),ga(this,"handleInviteIdSubmit",(async()=>{const e={serverError:"",clientError:""};this.setState(e);const{error:t}=await this.props.actions.regenerateTeamInviteId(this.props.team.id);t?(e.serverError=t.message,this.setState(e)):this.updateSection("")})),ga(this,"handleClose",(()=>{this.updateSection("")})),ga(this,"handleDescriptionSubmit",(async()=>{var e={serverError:"",clientError:""};let t=!0;if(this.state.description.trim()===this.props.team.description?(e.clientError=I._u("general_tab.chooseDescription","Please choose a new description for your team"),t=!1):e.clientError="",this.setState(e),!t)return;var s=ma({},this.props.team);s.description=this.state.description;const{error:n}=await this.props.actions.patchTeam(s);n?(e.serverError=n.message,this.setState(e)):this.updateSection("")})),ga(this,"handleTeamIconSubmit",(async()=>{if(!this.state.teamIconFile)return;if(!this.state.submitActive)return;this.setState({loadingIcon:!0,clientError:"",serverError:""});const{error:e}=await this.props.actions.setTeamIcon(this.props.team.id,this.state.teamIconFile);e?this.setState({loadingIcon:!1,serverError:e.message}):(this.setState({loadingIcon:!1,submitActive:!1}),this.updateSection(""))})),ga(this,"handleTeamIconRemove",(async()=>{this.setState({loadingIcon:!0,clientError:"",serverError:""});const{error:e}=await this.props.actions.removeTeamIcon(this.props.team.id);e?this.setState({loadingIcon:!1,serverError:e.message}):(this.setState({loadingIcon:!1,submitActive:!1}),this.updateSection(""))})),ga(this,"handleUpdateSection",(e=>{"invite_id"!==e||this.props.activeSection===e||this.props.team.invite_id?this.updateSection(e):this.setState({shouldFetchTeam:!0},(()=>{this.updateSection(e)}))})),ga(this,"updateName",(e=>{this.setState({name:e.target.value})})),ga(this,"updateDescription",(e=>{this.setState({description:e.target.value})})),ga(this,"updateTeamIcon",(e=>{if(e&&e.target&&e.target.files&&e.target.files[0]){const t=e.target.files[0];fa.includes(t.type)?t.size>this.props.maxFileSize?this.setState({clientError:I._u("general_tab.teamIconTooLarge","Unable to upload team icon. File is too large.")}):this.setState({teamIconFile:e.target.files[0],clientError:"",submitActive:!0}):this.setState({clientError:I._u("general_tab.teamIconInvalidFileType","Only BMP, JPG or PNG images may be used for team icons")})}else this.setState({teamIconFile:null,clientError:I._u("general_tab.teamIconError","An error occurred while selecting the image.")})})),ga(this,"updateAllowedDomains",(e=>{this.setState({allowed_domains:e.target.value})})),this.state=this.setupInitialState(e)}setupInitialState(e){const t=e.team;return{name:t.display_name,invite_id:t.invite_id,allow_open_invite:t.allow_open_invite,description:t.description,allowed_domains:t.allowed_domains,serverError:"",clientError:"",teamIconFile:null,loadingIcon:!1,submitActive:!1,isInitialState:!0}}static getDerivedStateFromProps(e,t){const{team:s}=e;return t.isInitialState?null:{name:s.display_name,description:s.description,allowed_domains:s.allowed_domains,invite_id:s.invite_id,allow_open_invite:s.allow_open_invite,isInitialState:!1}}componentDidUpdate(e,t){!t.shouldFetchTeam&&this.state.shouldFetchTeam&&this.fetchTeam()}fetchTeam(){this.state.serverError||this.props.actions.getTeam(this.props.team.id).then((({error:e})=>{const t={shouldFetchTeam:!1};e&&(t.serverError=e.message),this.setState(t)}))}componentDidMount(){ra()("#team_settings").on("hidden.bs.modal",this.handleClose)}componentWillUnmount(){ra()("#team_settings").off("hidden.bs.modal",this.handleClose)}render(){const e=this.props.team;let t,s,n,a,i,r,o=null,l=null;if(this.state.clientError&&(o=this.state.clientError),this.state.serverError&&(l=this.state.serverError),"open_invite"===this.props.activeSection){let s;s=e.group_constrained?[M.createElement("div",{key:"userOpenInviteOptions"},M.createElement("div",null,M.createElement(Dt.Z,{id:"team_settings.openInviteDescription.groupConstrained",defaultMessage:"No, members of this team are added and removed by linked groups. [Learn More](!https://mattermost.com/pl/default-ldap-group-constrained-team-channel.html)"})))]:[M.createElement("fieldset",{key:"userOpenInviteOptions"},M.createElement("legend",{className:"form-legend hidden-label"},M.createElement(V.Z,{id:"team_settings.openInviteDescription.ariaLabel",defaultMessage:"Invite Code"})),M.createElement("div",{className:"radio"},M.createElement("label",null,M.createElement("input",{id:"teamOpenInvite",name:"userOpenInviteOptions",type:"radio",defaultChecked:this.state.allow_open_invite,onChange:this.handleOpenInviteRadio.bind(this,!0)}),M.createElement(V.Z,{id:"general_tab.yes",defaultMessage:"Yes"})),M.createElement("br",null)),M.createElement("div",{className:"radio"},M.createElement("label",null,M.createElement("input",{id:"teamOpenInviteNo",name:"userOpenInviteOptions",type:"radio",defaultChecked:!this.state.allow_open_invite,onChange:this.handleOpenInviteRadio.bind(this,!1)}),M.createElement(V.Z,{id:"general_tab.no",defaultMessage:"No"})),M.createElement("br",null)),M.createElement("div",{className:"mt-5"},M.createElement(V.Z,{id:"general_tab.openInviteDesc",defaultMessage:'When allowed, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing from "Yes" to "No" will regenerate the  invitation code, create a new invitation link and invalidate the previous link.'})))],t=M.createElement(la.Z,{title:I._u("general_tab.openInviteTitle","Allow any user with an account on this server to join this team"),inputs:s,submit:this.handleOpenInviteSubmit,serverError:l,updateSection:this.handleUpdateSection})}else{let s="";s=!0===this.state.allow_open_invite?I._u("general_tab.yes","Yes"):e.group_constrained?I._u("team_settings.openInviteSetting.groupConstrained","No, members of this team are added and removed by linked groups."):I._u("general_tab.no","No"),t=M.createElement(ca.Z,{title:I._u("general_tab.openInviteTitle","Allow any user with an account on this server to join this team"),describe:s,updateSection:this.handleUpdateSection,section:"open_invite"})}if("invite_id"===this.props.activeSection&&this.props.canInviteTeamMembers){const e=[];e.push(M.createElement("div",{key:"teamInviteSetting"},M.createElement("div",{className:"row"},M.createElement("label",{className:"col-sm-5 control-label visible-xs-block"}),M.createElement("div",{className:"col-sm-12"},M.createElement("input",{id:"teamInviteId",autoFocus:!0,className:"form-control",type:"text",value:this.state.invite_id,maxLength:"32",onFocus:I.h$,readOnly:!0}))),M.createElement("div",{className:"setting-list__hint"},M.createElement(V.Z,{id:"general_tab.codeLongDesc",defaultMessage:"The Invite Code is part of the unique team invitation link which is sent to members you’re inviting to this team. Regenerating the code creates a new invitation link and invalidates the previous link.",values:{getTeamInviteLink:M.createElement("strong",null,M.createElement(V.Z,{id:"general_tab.getTeamInviteLink",defaultMessage:"Get Team Invite Link"}))}})))),s=M.createElement(la.Z,{title:I._u("general_tab.codeTitle","Invite Code"),inputs:e,submit:this.handleInviteIdSubmit,serverError:l,clientError:o,updateSection:this.handleUpdateSection,saveButtonText:I._u("general_tab.regenerate","Regenerate")})}else this.props.canInviteTeamMembers&&(s=M.createElement(ca.Z,{title:I._u("general_tab.codeTitle","Invite Code"),describe:I._u("general_tab.codeDesc","Click 'Edit' to regenerate Invite Code."),updateSection:this.handleUpdateSection,section:"invite_id"}));if("name"===this.props.activeSection){const e=[];let t=M.createElement(V.Z,{id:"general_tab.teamName",defaultMessage:"Team Name"});I.tq()&&(t=""),e.push(M.createElement("div",{key:"teamNameSetting",className:"form-group"},M.createElement("label",{className:"col-sm-5 control-label"},t),M.createElement("div",{className:"col-sm-7"},M.createElement("input",{id:"teamName",autoFocus:!0,className:"form-control",type:"text",maxLength:N.ZP.MAX_TEAMNAME_LENGTH.toString(),onChange:this.updateName,value:this.state.name,onFocus:I.h$}))));const s=M.createElement("span",null,I._u("general_tab.teamNameInfo","Set the name of the team as it appears on your sign-in screen and at the top of the left-hand sidebar."));n=M.createElement(la.Z,{title:I._u("general_tab.teamName","Team Name"),inputs:e,submit:this.handleNameSubmit,serverError:l,clientError:o,updateSection:this.handleUpdateSection,extraInfo:s})}else{var c=this.state.name;n=M.createElement(ca.Z,{title:I._u("general_tab.teamName","Team Name"),describe:c,updateSection:this.handleUpdateSection,section:"name"})}if("description"===this.props.activeSection){const e=[];let t=M.createElement(V.Z,{id:"general_tab.teamDescription",defaultMessage:"Team Description"});I.tq()&&(t=""),e.push(M.createElement("div",{key:"teamDescriptionSetting",className:"form-group"},M.createElement("label",{className:"col-sm-5 control-label"},t),M.createElement("div",{className:"col-sm-7"},M.createElement("input",{id:"teamDescription",autoFocus:!0,className:"form-control",type:"text",maxLength:N.ZP.MAX_TEAMDESCRIPTION_LENGTH.toString(),onChange:this.updateDescription,value:this.state.description,onFocus:I.h$}))));const s=M.createElement("span",null,I._u("general_tab.teamDescriptionInfo","Team description provides additional information to help users select the right team. Maximum of 50 characters."));a=M.createElement(la.Z,{title:I._u("general_tab.teamDescription","Team Description"),inputs:e,submit:this.handleDescriptionSubmit,serverError:l,clientError:o,updateSection:this.handleUpdateSection,extraInfo:s})}else{let e="";e=this.state.description?this.state.description:M.createElement(V.Z,{id:"general_tab.emptyDescription",defaultMessage:"Click 'Edit' to add a team description."}),a=M.createElement(ca.Z,{title:I._u("general_tab.teamDescription","Team Description"),describe:e,updateSection:this.handleUpdateSection,section:"description"})}if("team_icon"===this.props.activeSection){const t=M.createElement(Dt.Z,{id:"setting_picture.help.team",defaultMessage:"Upload a team icon in BMP, JPG or PNG format.\\nSquare images with a solid background color are recommended."});i=M.createElement(da.Z,{imageContext:"team",title:I._u("general_tab.teamIcon","Team Icon"),src:I.uZ(e),file:this.state.teamIconFile,serverError:this.state.serverError,clientError:this.state.clientError,loadingPicture:this.state.loadingIcon,submitActive:this.state.submitActive,updateSection:e=>{this.updateSection(""),e.preventDefault()},onFileChange:this.updateTeamIcon,onSubmit:this.handleTeamIconSubmit,onRemove:this.handleTeamIconRemove,helpText:t})}else{let t;t=e.last_team_icon_update?M.createElement(V.Z,{id:"general_tab.teamIconLastUpdated",defaultMessage:"Image last updated {date}",values:{date:M.createElement(qe.Ji,{value:new Date(e.last_team_icon_update),day:"2-digit",month:"short",year:"numeric"})}}):I.tq()?I._u("general_tab.teamIconEditHintMobile","Click to upload an image"):I._u("general_tab.teamIconEditHint","Click 'Edit' to upload an image."),i=M.createElement(ca.Z,{title:I._u("general_tab.teamIcon","Team Icon"),describe:t,section:"team_icon",updateSection:this.handleUpdateSection})}if("allowed_domains"===this.props.activeSection){const e=[];e.push(M.createElement("div",{key:"allowedDomainsSetting",className:"form-group"},M.createElement("div",{className:"col-sm-12"},M.createElement(pa.Z,{id:"allowedDomains",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateAllowedDomains,value:this.state.allowed_domains,onFocus:I.h$,placeholder:{id:(0,Ae.t)("general_tab.AllowedDomainsExample"),defaultMessage:"corp.mattermost.com, mattermost.org"},"aria-label":I._u("general_tab.allowedDomains.ariaLabel","Allowed Domains")}))));const t=M.createElement("span",null,I._u("general_tab.AllowedDomainsInfo",'Users can only join the team if their email matches a specific domain (e.g. "mattermost.org") or list of comma-separated domains (e.g. "corp.mattermost.com, mattermost.org").'));r=M.createElement(la.Z,{title:I._u("general_tab.allowedDomains","Allow only users with a specific email domain to join this team"),inputs:e,submit:this.handleAllowedDomainsSubmit,serverError:l,clientError:o,updateSection:this.handleUpdateSection,extraInfo:t})}else{let e="";e=this.state.allowed_domains?this.state.allowed_domains:M.createElement(V.Z,{id:"general_tab.allowedDomainsEdit",defaultMessage:"Click 'Edit' to add an email domain whitelist."}),r=M.createElement(ca.Z,{title:I._u("general_tab.allowedDomains","allowedDomains"),describe:e,updateSection:this.handleUpdateSection,section:"allowed_domains"})}return M.createElement("div",null,M.createElement("div",{className:"modal-header"},M.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},M.createElement("span",{"aria-hidden":"true"},"×")),M.createElement("h4",{className:"modal-title",ref:"title"},M.createElement("div",{className:"modal-back"},M.createElement("span",{onClick:this.props.collapseModal},M.createElement(ha.Z,null))),M.createElement(V.Z,{id:"general_tab.title",defaultMessage:"General Settings"}))),M.createElement("div",{ref:"wrapper",className:"user-settings"},M.createElement("h3",{className:"tab-header"},M.createElement(V.Z,{id:"general_tab.title",defaultMessage:"General Settings"})),M.createElement("div",{className:"divider-dark first"}),n,M.createElement("div",{className:"divider-light"}),a,M.createElement("div",{className:"divider-light"}),i,!e.group_constrained&&M.createElement(M.Fragment,null,M.createElement("div",{className:"divider-light"}),r),M.createElement("div",{className:"divider-light"}),t,!e.group_constrained&&M.createElement(M.Fragment,null,M.createElement("div",{className:"divider-light"}),s),M.createElement("div",{className:"divider-dark"})))}}ga(Ea,"propTypes",{updateSection:y().func.isRequired,team:y().object.isRequired,activeSection:y().string.isRequired,closeModal:y().func.isRequired,collapseModal:y().func.isRequired,maxFileSize:y().number,actions:y().shape({getTeam:y().func.isRequired,patchTeam:y().func.isRequired,regenerateTeamInviteId:y().func.isRequired,removeTeamIcon:y().func.isRequired,setTeamIcon:y().func.isRequired}),canInviteTeamMembers:y().bool});const Ca=(0,n.connect)((function(e,t){const s=(0,h.iE)(e);return{maxFileSize:parseInt(s.MaxFileSize,10),canInviteTeamMembers:(0,Z.Rm)(e,{team:t.team.id,permission:D.Pl.INVITE_USER})}}),(function(e){return{actions:(0,a.bindActionCreators)({getTeam:l.VP,patchTeam:l.Pb,regenerateTeamInviteId:l.aF,removeTeamIcon:l.QL,setTeamIcon:l.kx},e)}}))(Ea);function ba(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _a extends M.PureComponent{constructor(e){super(e),ba(this,"doFileSelect",(e=>{e.preventDefault();let t=e.target.value;"fakepath"===t.substring(3,11)&&(t=t.substring(12)),this.setState({clientError:"",serverError:"",filename:t})})),ba(this,"openFileSelect",(()=>{this.uploadinput.current.value="",this.uploadinput.current.click()})),ba(this,"doSubmit",(e=>{e.preventDefault();const t=this.uploadinput.current;t.files&&t.files[0]?this.props.submit(t.files[0]):this.setState({clientError:!0})})),this.uploadinput=M.createRef(),this.state={clientError:"",serverError:"",filename:""}}render(){let e=null;this.state.clientError&&(e=M.createElement("div",{className:"file-status"},M.createElement(V.Z,{id:"setting_upload.noFile",defaultMessage:"No file selected."})));let t=null;this.state.serverError&&(t=M.createElement("div",{className:"file-status"},this.state.serverError));let s=null,n="btn btn-sm btn-primary disabled";return this.state.filename&&(s=M.createElement("div",{className:"file-status file-name"},this.state.filename),n="btn btn-sm btn-primary"),M.createElement("ul",{className:"section-max"},M.createElement("li",{className:"col-sm-12 section-title"},this.props.title),M.createElement("li",{className:"col-sm-offset-3 col-sm-9"},this.props.helpText),M.createElement("li",{className:"col-sm-offset-3 col-sm-9"},M.createElement("ul",{className:"setting-list"},M.createElement("li",{className:"setting-list-item"},M.createElement("input",{ref:this.uploadinput,accept:this.props.fileTypesAccepted,type:"file",onChange:this.doFileSelect,tabIndex:"-1","aria-hidden":!0}),M.createElement("button",{onClick:this.openFileSelect,className:"btn btn-sm btn-primary btn-file sel-btn"},M.createElement(V.Z,{id:"setting_upload.select",defaultMessage:"Select file"})),M.createElement("a",{className:n,onClick:this.doSubmit},M.createElement(V.Z,{id:"setting_upload.import",defaultMessage:"Import"})),s,t,e))))}}_a.propTypes={title:y().node.isRequired,submit:y().func.isRequired,fileTypesAccepted:y().string.isRequired,helpText:y().object};var va=s(37668);function ya(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ma=(0,qe.vU)({importSlack:{id:(0,Ae.t)("team_import_tab.importSlack"),defaultMessage:"Import from Slack (Beta)"}});class Pa extends M.PureComponent{constructor(e){super(e),ya(this,"onImportFailure",(()=>{this.setState({status:"fail"})})),ya(this,"onImportSuccess",(e=>{this.setState({status:"done",link:"data:application/octet-stream;charset=utf-8,"+encodeURIComponent(atob(e.results))})})),ya(this,"doImportSlack",(e=>{this.setState({status:"in-progress",link:""}),I.f4(this.props.team.id,e,this.onImportSuccess,this.onImportFailure)})),this.state={status:"ready",link:""}}render(){const e=M.createElement("a",{href:"https://docs.mattermost.com/administration/migrating.html#migrating-from-slack",target:"_blank",rel:"noopener noreferrer"},M.createElement(V.Z,{id:"team_import_tab.importHelpDocsLink",defaultMessage:"documentation"})),t=M.createElement("strong",null,M.createElement(V.Z,{id:"team_import_tab.importHelpExportInstructions",defaultMessage:"Slack > Administration > Workspace settings > Import/Export Data > Export > Start Export"})),s=M.createElement("a",{href:"https://github.com/grundleborg/slack-advanced-exporter",target:"_blank",rel:"noopener noreferrer"},M.createElement(V.Z,{id:"team_import_tab.importHelpExporterLink",defaultMessage:"Slack Advanced Exporter"})),n=M.createElement("a",{href:"https://docs.mattermost.com/administration/migrating.html#migrating-from-slack-using-the-mattermost-cli",target:"_blank",rel:"noopener noreferrer"},M.createElement(V.Z,{id:"team_import_tab.importHelpCliDocsLink",defaultMessage:"CLI tool for Slack import"})),a=M.createElement("div",null,M.createElement("p",null,M.createElement(V.Z,{id:"team_import_tab.importHelpLine1",defaultMessage:"Slack import to Mattermost supports importing of messages in your Slack team's public channels."})),M.createElement("p",null,M.createElement(V.Z,{id:"team_import_tab.importHelpLine2",defaultMessage:"To import a team from Slack, go to {exportInstructions}. See {uploadDocsLink} to learn more.",values:{exportInstructions:t,uploadDocsLink:e}})),M.createElement("p",null,M.createElement(V.Z,{id:"team_import_tab.importHelpLine3",defaultMessage:"To import posts with attached files, see {slackAdvancedExporterLink} for details.",values:{slackAdvancedExporterLink:s}})),M.createElement("p",null,M.createElement(V.Z,{id:"team_import_tab.importHelpLine4",defaultMessage:"For Slack teams with over 10,000 messages, we recommend using the {cliLink}.",values:{cliLink:n}}))),i=M.createElement(_a,{title:M.createElement(V.Z,Ma.importSlack),submit:this.doImportSlack,helpText:a,fileTypesAccepted:".zip"});let r;switch(this.state.status){case"ready":r="";break;case"in-progress":r=M.createElement("p",{className:"confirm-import alert alert-warning"},M.createElement(bn.Z,{text:I._u("team_import_tab.importing","Importing...")}));break;case"done":r=M.createElement("p",{className:"confirm-import alert alert-success"},M.createElement(ve.Z,null),M.createElement(V.Z,{id:"team_import_tab.successful",defaultMessage:" Import successful: "}),M.createElement("a",{href:this.state.link,download:"MattermostImportSummary.txt"},M.createElement(V.Z,{id:"team_import_tab.summary",defaultMessage:"View Summary"})));break;case"fail":r=M.createElement("p",{className:"confirm-import alert alert-warning"},M.createElement(va.Z,null),M.createElement(V.Z,{id:"team_import_tab.failure",defaultMessage:" Import failure: "}),M.createElement("a",{href:this.state.link,download:"MattermostImportSummary.txt"},M.createElement(V.Z,{id:"team_import_tab.summary",defaultMessage:"View Summary"})))}return M.createElement("div",null,M.createElement("div",{className:"modal-header"},M.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},M.createElement("span",{"aria-hidden":"true"},"×")),M.createElement("h4",{className:"modal-title",ref:"title"},M.createElement("div",{className:"modal-back"},M.createElement("span",{onClick:this.props.collapseModal},M.createElement(ha.Z,null))),M.createElement(V.Z,{id:"team_import_tab.import",defaultMessage:"Import"}))),M.createElement("div",{ref:"wrapper",className:"user-settings"},M.createElement("h3",{className:"tab-header"},M.createElement(V.Z,{id:"team_import_tab.import",defaultMessage:"Import"})),M.createElement("div",{className:"divider-dark first"}),i,M.createElement("div",{className:"divider-dark"}),r))}}ya(Pa,"propTypes",{closeModal:y().func.isRequired,collapseModal:y().func.isRequired}),Pa.propTypes={closeModal:y().func.isRequired,collapseModal:y().func.isRequired,team:y().object.isRequired};const wa=(0,K.ZP)(Pa),Sa=({activeTab:e="",activeSection:t="",updateSection:s,closeModal:n,collapseModal:a,team:i})=>{if(!i)return null;let r;switch(e){case"general":r=M.createElement("div",null,M.createElement(Ca,{team:i,activeSection:t,updateSection:s,closeModal:n,collapseModal:a}));break;case"import":r=M.createElement("div",null,M.createElement(wa,{team:i,activeSection:t,updateSection:s,closeModal:n,collapseModal:a}));break;default:r=M.createElement("div",null)}return r};Sa.propTypes={activeTab:y().string.isRequired,activeSection:y().string.isRequired,updateSection:y().func.isRequired,closeModal:y().func.isRequired,collapseModal:y().func.isRequired};const Ta=Sa,Na=(0,n.connect)((function(e){return{team:(0,u.kA)(e)}}))(Ta);function Ra(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ia=M.lazy((()=>s.e(821).then(s.bind(s,76821))));class Oa extends M.PureComponent{constructor(e){super(e),Ra(this,"modalBodyRef",void 0),Ra(this,"updateTab",(e=>{this.setState({activeTab:e,activeSection:""})})),Ra(this,"updateSection",(e=>{this.setState({activeSection:e})})),Ra(this,"collapseModal",(()=>{const e=oa.findDOMNode(this.modalBodyRef.current);ra()(e).closest(".modal-dialog").removeClass("display--content"),this.setState({activeTab:"",activeSection:""})})),Ra(this,"handleHide",(()=>{this.setState({show:!1})})),Ra(this,"handleHidden",(()=>{this.setState({activeTab:"general",activeSection:""}),this.props.onHide()})),this.state={activeTab:"general",activeSection:"",show:!0},this.modalBodyRef=M.createRef()}render(){const e=[];return e.push({name:"general",uiName:I._u("team_settings_modal.generalTab","General"),icon:"icon fa fa-cog",iconTitle:I._u("generic_icons.settings","Settings Icon")}),M.createElement(G.Z,{dialogClassName:"a11y__modal settings-modal settings-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleHidden,role:"dialog","aria-labelledby":"teamSettingsModalLabel",id:"teamSettingsModal"},M.createElement(G.Z.Header,{id:"teamSettingsModalLabel",closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1"},M.createElement(V.Z,{id:"team_settings_modal.title",defaultMessage:"Team Settings"}))),M.createElement(G.Z.Body,{ref:this.modalBodyRef},M.createElement("div",{className:"settings-table"},M.createElement("div",{className:"settings-links"},M.createElement(M.Suspense,{fallback:null},M.createElement(Ia,{tabs:e,activeTab:this.state.activeTab,updateTab:this.updateTab}))),M.createElement("div",{className:"settings-content minimize-settings"},M.createElement(Na,{activeTab:this.state.activeTab,activeSection:this.state.activeSection,updateSection:this.updateSection,closeModal:this.handleHide,collapseModal:this.collapseModal})))))}}Ra(Oa,"propTypes",{onHide:y().func.isRequired,isCloud:y().bool});const La=(0,n.connect)((function(e){const t=N.r8.TEAM_SETTINGS;return{show:(0,Ms.g)(e,t),isCloud:"true"===(0,h.lJ)(e).Cloud}}))(Oa);var Aa=s(66362),ka=(s(24603),s(22558)),xa=s(26134);const Da=s.p+"files/377564d283f9bc35cce974f33e37eaf3.png";var Za=s(52718),Ha=s(31848);function qa(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function ja(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?qa(Object(s),!0).forEach((function(t){Ua(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):qa(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ua(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Fa extends M.PureComponent{constructor(e){super(e),Ua(this,"searchTimeoutId",void 0),Ua(this,"selectedItemRef",void 0),Ua(this,"handleHide",(()=>{this.props.actions.setModalSearchTerm(""),this.setState({show:!1})})),Ua(this,"handleExit",(()=>{this.props.onHide&&this.props.onHide()})),Ua(this,"handleResponse",(e=>{let t=null;e&&e.message&&(t=e.message),this.setState({saving:!1,addError:t})})),Ua(this,"handleSubmit",(async()=>{const e=this.state.values.map((e=>e.id));if(0!==e.length){if(this.props.skipCommit)return this.props.onAddCallback&&this.props.onAddCallback(e),void this.handleHide();this.setState({saving:!0}),await Promise.all(e.map((async e=>{const{error:t}=await this.props.actions.linkGroupSyncable(e,this.props.currentTeamId,D.Fl.SYNCABLE_TYPE_TEAM,{auto_add:!0,scheme_admin:!1,scheme_mod:!1});this.handleResponse(t),t||this.handleHide()})))}})),Ua(this,"addValue",(e=>{const t=Object.assign([],this.state.values),s=t.map((e=>e.id));e&&e.id&&-1===s.indexOf(e.id)&&t.push(e),this.setState({values:t})})),Ua(this,"setGroupsLoadingState",(e=>{this.setState({loadingGroups:e})})),Ua(this,"handlePageChange",((e,t)=>{e>t&&(this.setGroupsLoadingState(!0),this.props.actions.getGroupsNotAssociatedToTeam(this.props.currentTeamId,this.props.searchTerm,e,51).then((()=>{this.setGroupsLoadingState(!1)})))})),Ua(this,"handleDelete",(e=>this.setState({values:e}))),Ua(this,"search",(e=>this.props.actions.setModalSearchTerm(e))),Ua(this,"renderOption",((e,t,s,n)=>{const a=t?"more-modal__row--selected":"";return M.createElement("div",{key:e.id,ref:t?this.selectedItemRef:e.id,className:"more-modal__row clickable "+a,onClick:()=>s(e),onMouseMove:()=>n(e)},M.createElement("img",{className:"more-modal__image",src:Da,alt:"group picture",width:"32",height:"32",loading:"lazy"}),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},e.display_name,M.createElement(Ha.Z,null),"-",M.createElement(Ha.Z,null),M.createElement("span",{className:"more-modal__name_sub"},M.createElement(V.Z,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),M.createElement("div",{className:"more-modal__actions"},M.createElement("div",{className:"more-modal__actions--round"},M.createElement(Za.Z,null))))})),Ua(this,"renderValue",(e=>e.data.display_name)),this.searchTimeoutId=0,this.state={values:[],show:!0,search:!1,saving:!1,addError:null,loadingGroups:!0},this.selectedItemRef=M.createRef()}componentDidMount(){Promise.all([this.props.actions.getGroupsNotAssociatedToTeam(this.props.currentTeamId,"",0,51),this.props.actions.getAllGroupsAssociatedToTeam(this.props.currentTeamId,!1,!0)]).then((()=>{this.setGroupsLoadingState(!1)}))}componentDidUpdate(e){if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);const e=this.props.searchTerm;if(""===e)return;this.searchTimeoutId=window.setTimeout((async()=>{this.setGroupsLoadingState(!0),await this.props.actions.getGroupsNotAssociatedToTeam(this.props.currentTeamId,e),this.setGroupsLoadingState(!1)}),N.ZP.SEARCH_TIMEOUT_MILLISECONDS)}}render(){const e=M.createElement("div",{id:"numGroupsRemaining"},M.createElement(V.Z,{id:"multiselect.numGroupsRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {group} other {groups}}. ",values:{num:10-this.state.values.length}})),t=(0,I._u)("multiselect.add","Add"),s=(0,I._u)("multiselect.adding","Adding...");let n=null;this.state.addError&&(n=M.createElement("div",{className:"has-error col-sm-12"},M.createElement("label",{className:"control-label font-weight--normal"},this.state.addError)));let a=this.props.groups;if(this.props.excludeGroups){const e=e=>{var t;return!(null!==(t=this.props.excludeGroups)&&void 0!==t&&t.find((t=>t.id===e.id)))};a=a.filter(e)}if(this.props.includeGroups){const e=e=>{var t;return null===(t=this.props.includeGroups)||void 0===t?void 0:t.find((t=>t.id===e.id))};a=[...a,...this.props.includeGroups.filter(e)]}const i=a.map((e=>ja(ja({},e),{},{label:e.display_name,value:e.id})));return M.createElement(G.Z,{id:"addGroupsToTeamModal",dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1"},M.createElement(V.Z,{id:"add_groups_to_team.title",defaultMessage:"Add New Groups to {teamName} Team",values:{teamName:M.createElement("strong",null,this.props.currentTeamName)}}))),M.createElement(G.Z.Body,null,n,M.createElement(xa.Z,{key:"addGroupsToTeamKey",options:i,optionRenderer:this.renderOption,selectedItemRef:this.selectedItemRef,values:this.state.values,valueRenderer:this.renderValue,perPage:50,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,maxValues:10,numRemainingText:e,buttonSubmitText:t,buttonSubmitLoadingText:s,saving:this.state.saving,loading:this.state.loadingGroups,placeholderText:(0,I._u)("multiselect.addGroupsPlaceholder","Search and add groups")})))}}Ua(Fa,"propTypes",{currentTeamName:y().string.isRequired,currentTeamId:y().string.isRequired,searchTerm:y().string.isRequired,groups:y().array.isRequired,excludeGroups:y().array,includeGroups:y().array,onHide:y().func,skipCommit:y().bool,onAddCallback:y().func,actions:y().shape({getGroupsNotAssociatedToTeam:y().func.isRequired,setModalSearchTerm:y().func.isRequired,linkGroupSyncable:y().func.isRequired,getAllGroupsAssociatedToTeam:y().func.isRequired}).isRequired});const Ba=(0,n.connect)((function(e,t){const s=e.views.search.modalSearch,n=t.team||(0,u.kA)(e)||{};let a=(0,ka.D$)(e,n.id);if(s){const e=RegExp(s,"i");a=a.filter((t=>e.test(t.display_name)||e.test(t.name)))}return{currentTeamName:n.display_name,currentTeamId:n.id,skipCommit:t.skipCommit,onAddCallback:t.onAddCallback,excludeGroups:t.excludeGroups,searchTerm:s,groups:a}}),(function(e){return{actions:(0,a.bindActionCreators)({getGroupsNotAssociatedToTeam:c.D$,setModalSearchTerm:ws.Gl,linkGroupSyncable:c.Bh,getAllGroupsAssociatedToTeam:c.K9},e)}}))(Fa);var Ga=s(19476);function Va(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ka extends M.PureComponent{constructor(e){super(e),Va(this,"handleHide",(()=>{this.setState({show:!1})})),Va(this,"handleExit",(()=>{this.props.onHide&&this.props.onHide()})),Va(this,"onNext",(()=>{const e=this.state.page+1;this.onPageChange(e)})),Va(this,"onPrev",(()=>{const e=this.state.page-1;this.onPageChange(e)})),Va(this,"onPageChange",(async e=>{this.setState({loading:!0});const t=await this.props.loadItems(e,this.state.searchTerm);this.setState({page:e,items:t.items,loading:!1})})),Va(this,"onSearchInput",(async e=>{const{target:t}=e,s=t.value;this.setState({loading:!0,searchTerm:s});const n=await this.props.loadItems(0,s),{items:a,totalCount:i}=n;this.setState({loading:!1,items:a,totalCount:i})})),this.numPerPage=e.numPerPage||50,this.state={show:!0,page:0,items:[],totalCount:0,loading:!0,searchTerm:""}}async componentDidMount(){const{totalCount:e,items:t}=await this.props.loadItems(0,"");this.setState({totalCount:e,items:t,loading:!1})}renderRows(){return this.state.loading?M.createElement("div",null,M.createElement(Ga.Z,{position:"absolute",key:"loading"})):this.state.items.map((e=>this.props.renderRow(e,this)))}paginationRange(){let e=this.state.page*this.numPerPage+1;const t=e+this.state.items.length-1;return 0===t&&(e=0),{startCount:e,endCount:t}}render(){if(!this.props.show)return null;const{endCount:e,startCount:t}=this.paginationRange();return M.createElement("div",null,M.createElement(G.Z,{dialogClassName:"a11y__modal more-modal more-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1"},M.createElement("span",{className:"name"},this.props.titleText)),this.props.titleBarButtonText&&this.props.titleBarButtonOnClick&&M.createElement("a",{className:"btn btn-md btn-primary",href:"#",onClick:this.props.titleBarButtonOnClick},this.props.titleBarButtonText)),M.createElement(G.Z.Body,null,M.createElement("div",{className:"filtered-user-list"},M.createElement("div",{className:"filter-row"},M.createElement("div",{className:"col-xs-12"},M.createElement("label",{className:"hidden-label",htmlFor:"searchUsersInput"},this.props.searchPlaceholderText),M.createElement("input",{id:"searchUsersInput",className:"form-control filter-textbox",placeholder:this.props.searchPlaceholderText,onChange:this.onSearchInput})),M.createElement("div",{className:"col-sm-12"},M.createElement("span",{className:"member-count pull-left"},M.createElement(V.Z,{id:"list_modal.paginatorCount",defaultMessage:"{startCount, number} - {endCount, number} of {total, number} total",values:{startCount:t,endCount:e,total:this.state.totalCount}})))),M.createElement("div",{className:"more-modal__list"},M.createElement("div",null,this.renderRows())),M.createElement("div",{className:"filter-controls"},this.state.page>0&&M.createElement("button",{onClick:this.onPrev,className:"btn btn-link filter-control filter-control__prev"},M.createElement(V.Z,{id:"filtered_user_list.prev",defaultMessage:"Previous"})),this.state.items.length>=this.props.numPerPage&&e!==this.state.totalCount&&M.createElement("button",{onClick:this.onNext,className:"btn btn-link filter-control filter-control__next"},M.createElement(V.Z,{id:"filtered_user_list.next",defaultMessage:"Next"})))))))}}function Ya(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Va(Ka,"propTypes",{loadItems:y().func.isRequired,renderRow:y().func.isRequired,onHide:y().func,titleText:y().string,searchPlaceholderText:y().string,titleBarButtonText:y().string,titleBarButtonOnClick:y().func,numPerPage:y().number,show:y().bool}),Va(Ka,"defaultProps",{show:!0});class Wa extends M.PureComponent{constructor(...e){super(...e),Ya(this,"state",{showConfirmModal:!1,item:{member_count:0},listModal:null}),Ya(this,"loadItems",(async(e,t)=>{const{data:s}=await this.props.actions.getGroupsAssociatedToTeam(this.props.team.id,t,e,50,!0);return{items:s.groups,totalCount:s.totalGroupCount}})),Ya(this,"handleDeleteCanceled",(()=>{this.setState({showConfirmModal:!1})})),Ya(this,"handleDeleteConfirmed",(()=>{this.setState({showConfirmModal:!1});const{item:e,listModal:t}=this.state;this.props.actions.unlinkGroupSyncable(e.id,this.props.team.id,D.Fl.SYNCABLE_TYPE_TEAM).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:s}=await t.props.loadItems(t.setState.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:s})}))})),Ya(this,"onClickRemoveGroup",((e,t)=>{this.setState({showConfirmModal:!0,item:e,listModal:t})})),Ya(this,"onClickConfirmRemoveGroup",((e,t)=>this.props.actions.unlinkGroupSyncable(e.id,this.props.team.id,D.Fl.SYNCABLE_TYPE_TEAM).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:s}=await t.props.loadItems(t.setState.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:s})})))),Ya(this,"onHide",(()=>{this.props.actions.closeModal(N.r8.MANAGE_TEAM_GROUPS)})),Ya(this,"titleButtonOnClick",(()=>{this.onHide(),this.props.actions.openModal({modalId:N.r8.ADD_GROUPS_TO_TEAM,dialogType:Ba})})),Ya(this,"setTeamMemberStatus",(async(e,t,s)=>{this.props.actions.patchGroupSyncable(e.id,this.props.team.id,D.Fl.SYNCABLE_TYPE_TEAM,{scheme_admin:s}).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:s}=await t.props.loadItems(t.setState.page,t.state.searchTerm);this.props.actions.getMyTeamMembers(),t.setState({loading:!1,items:e,totalCount:s})}))})),Ya(this,"renderRow",((e,t)=>{let s;return s=e.scheme_admin?I._u("team_members_dropdown.teamAdmins","Team Admins"):I._u("team_members_dropdown.teamMembers","Team Members"),M.createElement("div",{key:e.id,className:"more-modal__row"},M.createElement("img",{className:"more-modal__image",src:Da,alt:"group picture",width:"32",height:"32",loading:"lazy"}),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ","&nbsp;",M.createElement("span",{className:"more-modal__name_count"},M.createElement(V.Z,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),M.createElement("div",{className:"more-modal__actions"},M.createElement(Os.Z,null,M.createElement("button",{id:"teamGroupsDropdown_".concat(e.display_name),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true"},M.createElement("span",null,s," "),M.createElement(Rs.Z,null)),M.createElement(Is.Z,{openLeft:!0,ariaLabel:I._u("team_members_dropdown.menuAriaLabel","Change the role of a team member")},M.createElement(Is.Z.ItemAction,{show:!e.scheme_admin,onClick:()=>this.setTeamMemberStatus(e,t,!0),text:I._u("team_members_dropdown.makeTeamAdmins","Make Team Admins")}),M.createElement(Is.Z.ItemAction,{show:Boolean(e.scheme_admin),onClick:()=>this.setTeamMemberStatus(e,t,!1),text:I._u("team_members_dropdown.makeTeamMembers","Make Team Members")}),M.createElement(Is.Z.ItemAction,{onClick:()=>this.onClickRemoveGroup(e,t),text:I._u("group_list_modal.removeGroupButton","Remove Group")})))))}))}render(){const{formatMessage:e}=this.props.intl,t=this.state.item.member_count;return M.createElement(M.Fragment,null,M.createElement(Ka,{show:!this.state.showConfirmModal,titleText:e({id:"groups",defaultMessage:"{team} Groups"},{team:this.props.team.display_name}),searchPlaceholderText:e({id:"manage_team_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick}),M.createElement(Te.Z,{show:this.state.showConfirmModal,title:e({id:"remove_group_confirm_title",defaultMessage:"Remove Group and {memberCount, number} {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),message:e({id:"remove_group_confirm_message",defaultMessage:"{memberCount, number} {memberCount, plural, one {member} other {members}} associated to this group will be removed from the team. Are you sure you wish to remove this group and {memberCount} {memberCount, plural, one {member} other {members}}?"},{memberCount:t}),confirmButtonText:e({id:"remove_group_confirm_button",defaultMessage:"Yes, Remove Group and {memberCount, plural, one {Member} other {Members}}"},{memberCount:t}),onConfirm:this.handleDeleteConfirmed,onCancel:this.handleDeleteCanceled}))}}Ya(Wa,"propTypes",{intl:J.gm.isRequired,team:y().object.isRequired,actions:y().shape({getGroupsAssociatedToTeam:y().func.isRequired,unlinkGroupSyncable:y().func.isRequired,patchGroupSyncable:y().func.isRequired,getMyTeamMembers:y().func.isRequired,closeModal:y().func.isRequired,openModal:y().func.isRequired}).isRequired});const za=(0,K.ZP)(Wa),Ja=(0,n.connect)(((e,t)=>({team:e.entities.teams.teams[t.teamID]})),(e=>({actions:(0,a.bindActionCreators)({getGroupsAssociatedToTeam:c.c9,closeModal:H.M,openModal:H.h,unlinkGroupSyncable:c.je,patchGroupSyncable:c.B2,getMyTeamMembers:l.r8},e)})))(za);function Xa(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Qa extends M.PureComponent{constructor(...e){super(...e),Xa(this,"toggleShortcutsModal",(e=>{e.preventDefault(),T.kk()})),Xa(this,"handleKeyDown",(e=>{(0,I._E)(e)&&e.shiftKey&&(0,I.pD)(e,N.gT.KeyCodes.A)&&this.props.actions.openModal({ModalId:N.r8.USER_SETTINGS,dialogType:cs.Z})})),Xa(this,"handleEmitUserLoggedOutEvent",(()=>{T.gc()})),Xa(this,"getFlagged",(e=>{e.preventDefault(),this.props.actions.showFlaggedPosts(),this.props.actions.closeRhsMenu()})),Xa(this,"searchMentions",(e=>{e.preventDefault(),this.props.isMentionSearch?this.props.actions.closeRightHandSide():(this.props.actions.closeRhsMenu(),this.props.actions.showMentions())}))}async componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}render(){const{currentUser:e,teamIsGroupConstrained:t,isLicensedForLDAPGroups:s}=this.props;if(!e)return null;const{formatMessage:n}=this.props.intl;return M.createElement(Is.Z,{mobile:this.props.mobile,id:this.props.id,openUp:!0,ariaLabel:n({id:"navbar_dropdown.menuAriaLabel",defaultMessage:"main menu"})},M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{id:"recentMentions",show:this.props.mobile,onClick:this.searchMentions,icon:this.props.mobile&&M.createElement("i",{className:"mentions"},"@"),text:n({id:"sidebar_right_menu.recentMentions",defaultMessage:"Recent Mentions"})})),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemToggleModalRedux,{id:"accountSettings",modalId:N.r8.USER_SETTINGS,dialogType:cs.Z,text:n({id:"navbar_dropdown.accountSettings",defaultMessage:"Account Settings"}),icon:this.props.mobile&&M.createElement("i",{className:"fa fa-cog"})})),M.createElement(Is.Z.Group,null,M.createElement(vs.Z,{teamId:this.props.teamId,permissions:[D.Pl.MANAGE_TEAM]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"teamSettings",modalId:N.r8.TEAM_SETTINGS,dialogType:La,text:n({id:"navbar_dropdown.teamSettings",defaultMessage:"Team Settings"}),icon:this.props.mobile&&M.createElement("i",{className:"fa fa-globe"})})),M.createElement(vs.Z,{teamId:this.props.teamId,permissions:[D.Pl.MANAGE_TEAM]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"manageGroups",show:t&&s,modalId:N.r8.MANAGE_TEAM_GROUPS,dialogProps:{teamID:this.props.teamId},dialogType:Ja,text:n({id:"navbar_dropdown.manageGroups",defaultMessage:"Manage Groups"}),icon:this.props.mobile&&M.createElement("i",{className:"fa fa-user-plus"})})),M.createElement(vs.Z,{teamId:this.props.teamId,permissions:[D.Pl.REMOVE_USER_FROM_TEAM,D.Pl.MANAGE_TEAM_ROLES]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"manageMembers",modalId:N.r8.TEAM_MEMBERS,dialogType:aa,text:n({id:"navbar_dropdown.manageMembers",defaultMessage:"Manage Members"}),icon:this.props.mobile&&M.createElement("i",{className:"fa fa-users"})}))),M.createElement(Is.Z.Group,null,M.createElement(ys.Z,{permissions:D.Pl.SYSCONSOLE_READ_PERMISSIONS},M.createElement(Is.Z.ItemLink,{id:"systemConsole",show:!this.props.mobile,to:"/admin_console",text:n({id:"navbar_dropdown.console",defaultMessage:"System Console"}),icon:this.props.mobile&&M.createElement("i",{className:"fa fa-wrench"})}))),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemToggleModalRedux,{id:"about",modalId:N.r8.ABOUT,dialogType:Aa.Z,text:n({id:"navbar_dropdown.about",defaultMessage:"About {appTitle}"},{appTitle:this.props.siteName||"Gomlo"}),icon:this.props.mobile&&M.createElement("i",{className:"fa fa-info"})})),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{id:"logout",onClick:this.handleEmitUserLoggedOutEvent,text:n({id:"navbar_dropdown.logout",defaultMessage:"Log Out"}),icon:this.props.mobile&&M.createElement("i",{className:"fa fa-sign-out"})})))}}Xa(Qa,"propTypes",{mobile:y().bool.isRequired,id:y().string,teamId:y().string,teamName:y().string,siteName:y().string,currentUser:y().object,appDownloadLink:y().string,enableCommands:y().bool.isRequired,enableCustomEmoji:y().bool.isRequired,enableIncomingWebhooks:y().bool.isRequired,enableOAuthServiceProvider:y().bool.isRequired,enableOutgoingWebhooks:y().bool.isRequired,canManageSystemBots:y().bool.isRequired,canCreateOrDeleteCustomEmoji:y().bool.isRequired,canManageIntegrations:y().bool.isRequired,enablePluginMarketplace:y().bool.isRequired,experimentalPrimaryTeam:y().string,helpLink:y().string,reportAProblemLink:y().string,moreTeamsToJoin:y().bool.isRequired,pluginMenuItems:y().arrayOf(y().object),isMentionSearch:y().bool,teamIsGroupConstrained:y().bool.isRequired,isLicensedForLDAPGroups:y().bool,showGettingStarted:y().bool.isRequired,intl:J.gm.isRequired,showNextStepsTips:y().bool,firstAdminVisitMarketplaceStatus:y().bool,actions:y().shape({openModal:y().func.isRequred,showMentions:y().func,showFlaggedPosts:y().func,closeRightHandSide:y().func.isRequired,closeRhsMenu:y().func.isRequired,unhideNextSteps:y().func.isRequired,getSubscriptionStats:y().func.isRequired}).isRequired}),Xa(Qa,"defaultProps",{teamType:"",mobile:!1,pluginMenuItems:[]});const $a=(0,K.ZP)((0,Tn.Z)(Qa)),ei=(0,n.connect)((function(e){const t=(0,h.iE)(e),s=(0,u.kA)(e),n=(0,p.ts)(e),a=t.AppDownloadLink,i="true"===t.EnableCommands,r="true"===t.EnableCustomEmoji,o=t.SiteName,l="true"===t.EnableIncomingWebhooks,c="true"===t.EnableOAuthServiceProvider,d="true"===t.EnableOutgoingWebhooks,m="true"===t.PluginsEnabled&&"true"===t.EnableMarketplace,g=t.ExperimentalPrimaryTeam,f=t.HelpLink,E=t.ReportAProblemLink;let C=(0,Z.AN)(e,{permission:D.Pl.CREATE_EMOJIS})||(0,Z.AN)(e,{permission:D.Pl.DELETE_EMOJIS});if(!C)for(const t of(0,u.Dc)(e))if((0,Z.Rm)(e,{team:t.id,permission:D.Pl.CREATE_EMOJIS})||(0,Z.Rm)(e,{team:t.id,permission:D.Pl.DELETE_EMOJIS})){C=!0;break}const b=(0,Z.ch)(e,{permission:D.Pl.MANAGE_SLASH_COMMANDS})||(0,Z.ch)(e,{permission:D.Pl.MANAGE_OAUTH})||(0,Z.ch)(e,{permission:D.Pl.MANAGE_INCOMING_WEBHOOKS})||(0,Z.ch)(e,{permission:D.Pl.MANAGE_OUTGOING_WEBHOOKS}),_=(0,Z.AN)(e,{permission:D.Pl.MANAGE_BOTS})||(0,Z.AN)(e,{permission:D.Pl.MANAGE_OTHERS_BOTS}),v=b||_,y=(0,u.O5)(e),M=y&&y.length>0,P=(0,Ke.kV)(e),w="true"===(0,h.lJ)(e).Cloud,S=e.entities.cloud.subscription,T="true"===(null==S?void 0:S.is_free_trial),R=(0,I.Hq)(null==S?void 0:S.trial_end_at);return{appDownloadLink:a,enableCommands:i,enableCustomEmoji:r,canManageIntegrations:v,enableIncomingWebhooks:l,enableOAuthServiceProvider:c,enableOutgoingWebhooks:d,canManageSystemBots:_,enablePluginMarketplace:m,experimentalPrimaryTeam:g,helpLink:f,reportAProblemLink:E,pluginMenuItems:e.plugins.components.MainMenu,canCreateOrDeleteCustomEmoji:C,moreTeamsToJoin:M,siteName:o,teamId:s.id,teamName:s.name,currentUser:n,isMentionSearch:P===N.Hp.MENTION,teamIsGroupConstrained:Boolean(s.group_constrained),isLicensedForLDAPGroups:"true"===e.entities.general.license.LDAPGroups,showGettingStarted:fs(e),showNextStepsTips:bs(e),isFreeTrial:T,daysLeftOnTrial:R,showNextSteps:Cs(e),isCloud:w,subscriptionStats:(0,h.F3)(e),firstAdminVisitMarketplaceStatus:(0,h.zv)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h,showMentions:Ve.rb,showFlaggedPosts:Ve.Yv,closeRightHandSide:Ve.Lg,closeRhsMenu:Ve.Wj,unhideNextSteps:zt,getSubscriptionStats:Yt.F3},e)}}))($a);function ti(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class si extends M.PureComponent{constructor(...e){super(...e),ti(this,"handleEmitUserLoggedOutEvent",(()=>{T.gc()}))}render(){let e="";null!=this.props.siteName&&(e=this.props.siteName);let t=e;this.props.teamDisplayName&&(t=this.props.teamDisplayName);let s=null;return this.props.showTutorialTip&&(s=M.createElement(Kt,{onBottom:!0}),this.props.actions.openRhsMenu()),M.createElement("div",{className:W()("sidebar--menu",{"move--left":this.props.isOpen&&I.tq()}),id:"sidebar-menu"},M.createElement("div",{className:"team__header theme"},M.createElement(ht.Link,{className:"team__name",to:"/group/".concat(N.gT.DEFAULT_CHANNEL)},t)),M.createElement("div",{className:"nav-pills__container mobile-main-menu"},s,M.createElement(xt.Z,{in:this.props.isOpen&&I.tq(),classNames:"MobileRightSidebarMenu",enter:!0,exit:!0,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:500,exit:500}},M.createElement(ei,{mobile:!0}))))}}ti(si,"propTypes",{isOpen:y().bool.isRequired,teamDisplayName:y().string,showTutorialTip:y().bool.isRequired,siteName:y().string,actions:y().shape({openRhsMenu:y().func.isRequired}).isRequired});const ni=(0,n.connect)((function(e){const t=(0,h.iE)(e),s=(0,u.kA)(e),n="true"===t.EnableTutorial,a=(0,d.wS)(e,N.uP.TUTORIAL_STEP,(0,p.rc)(e),N.PN.FINISHED),i=t.SiteName;return{teamDisplayName:s&&s.display_name,isOpen:(0,Ke.Xb)(e),showTutorialTip:n&&(0,I.tq)()&&a===N.PN.MENU_POPOVER,siteName:i}}),(function(e){return{actions:(0,a.bindActionCreators)({openRhsMenu:Ve.qn},e)}}))(si);var ai=s(2418);function ii(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ri=N.ZP.ActionTypes;class oi extends M.PureComponent{constructor(e){super(e),ii(this,"updateShow",((e,t)=>{this.setState({show:e,callback:t.callback})})),ii(this,"handleSubmit",(e=>{var t,s;e.preventDefault();const n=this.state.value;if(!oi.isInputValid(n))return void this.setState({inputError:M.createElement(V.Z,{id:"user.settings.import_theme.submitError",defaultMessage:"Invalid format, please try copying and pasting in again."})});const[a,i,r,o,l,c,d,h]=n.split(","),p={type:"custom",sidebarBg:a,sidebarText:c,sidebarUnreadText:c,sidebarTextHoverBg:l,sidebarTextActiveBorder:r,sidebarTextActiveColor:o,sidebarHeaderBg:i,sidebarTeamBarBg:(0,ai.B5)(i,"#000000",.2,!0),sidebarHeaderTextColor:c,onlineIndicator:d,mentionBg:h};(0,ai.Yn)(p),null===(t=(s=this.state).callback)||void 0===t||t.call(s,p),this.setState({show:!1,callback:null})})),ii(this,"handleChange",(e=>{const t=e.target.value;this.setState({value:t}),oi.isInputValid(t)?this.setState({inputError:null}):this.setState({inputError:M.createElement(V.Z,{id:"user.settings.import_theme.submitError",defaultMessage:"Invalid format, please try copying and pasting in again."})})})),ii(this,"handleOnHide",(()=>{this.setState({show:!1})})),this.state={value:"",inputError:null,show:!1,callback:null}}componentDidMount(){_e.addModalListener(ri.TOGGLE_IMPORT_THEME_MODAL,this.updateShow)}componentWillUnmount(){_e.removeModalListener(ri.TOGGLE_IMPORT_THEME_MODAL,this.updateShow)}static isInputValid(e){if(0===e.length)return!1;if(-1!==e.indexOf(" "))return!1;if(e.length>0&&-1===e.indexOf(","))return!1;if(e.length>0){const t=e.split(",");if(10!==t.length)return!1;for(let e=0;e<t.length;e++){if(7!==t[e].length&&4!==t[e].length)return!1;if("#"!==t[e].charAt(0))return!1}}return!0}render(){return M.createElement("span",null,M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.handleOnHide,role:"dialog","aria-labelledby":"importThemeModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"importThemeModalLabel"},M.createElement(V.Z,{id:"user.settings.import_theme.importHeader",defaultMessage:"Import Slack Theme"}))),M.createElement("form",{role:"form",className:"form-horizontal"},M.createElement(G.Z.Body,null,M.createElement("p",null,M.createElement(V.Z,{id:"user.settings.import_theme.importBody",defaultMessage:'To import a theme, go to a Slack team and look for "Preferences -> Themes". Open the custom theme option, copy the theme color values and paste them here:'})),M.createElement("div",{className:"form-group less"},M.createElement("div",{className:"col-sm-12"},M.createElement("input",{id:"themeVector",type:"text",className:"form-control",value:this.state.value,onChange:this.handleChange}),M.createElement("div",{className:"input__help"},this.state.inputError)))),M.createElement(G.Z.Footer,null,M.createElement("button",{id:"cancelButton",type:"button",className:"btn btn-link",onClick:this.handleOnHide},M.createElement(V.Z,{id:"user.settings.import_theme.cancel",defaultMessage:"Cancel"})),M.createElement("button",{id:"submitButton",onClick:this.handleSubmit,type:"submit",className:"btn btn-primary"},M.createElement(V.Z,{id:"user.settings.import_theme.submit",defaultMessage:"Submit"}))))))}}const li=(0,K.ZP)(oi);var ci=s(48196),di=s(6602);function hi(e){return e.views.lhs.isOpen}var pi=s(60862),ui=s(60868),mi=s(88136),gi=(s(27852),s(31738));function fi(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ei extends M.PureComponent{constructor(...e){super(...e),fi(this,"copy",(()=>{let e=this.props.link;-1===e.indexOf("http://")&&-1===e.indexOf("https://")&&(e=this.props.siteURL+e),this.props.actions.copyToClipboard(e)}))}render(){const e=M.createElement(gi.xV,{id:"copy-url-context-menu"+this.props.menuId},M.createElement(gi.sN,{onClick:this.copy},M.createElement(V.Z,{id:"copy_url_context_menu.getChannelLink",defaultMessage:"Copy Link"}))),t=M.createElement(gi.W4,{id:"copy-url-context-menu"+this.props.menuId,holdToDisplay:-1},this.props.children);return M.createElement("span",null,e,t)}}fi(Ei,"propTypes",{children:y().node.isRequired,link:y().string.isRequired,menuId:y().string.isRequired,siteURL:y().string,actions:y().shape({copyToClipboard:y().func.isRequired}).isRequired});const Ci=(0,n.connect)((function(e){return{siteURL:(0,h.iE)(e).SiteURL}}),(function(){return{actions:{copyToClipboard:I.vQ}}}))(Ei);var bi=s(97281);function _i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class vi extends M.PureComponent{constructor(...e){super(...e),_i(this,"handleSwitch",(e=>{e.preventDefault(),(0,Ye.B1)("TeamLink#click"),(0,Ye.L9)("ui","ui_team_sidebar_switch_team"),this.props.switchTeam(this.props.url)})),_i(this,"handleDisabled",(e=>{e.preventDefault()}))}render(){const{teamIconUrl:e,displayName:t,btnClass:s,mentions:n,unread:a,isDraggable:i=!1,teamIndex:r,teamId:o}=this.props,{formatMessage:l}=this.props.intl;let c=this.props.active?"active":"";const d=this.props.disabled?"team-disabled":"",h=!this.props.url.endsWith("create_team")&&!this.props.url.endsWith("select_team"),p=this.props.active||this.props.disabled?this.handleDisabled:this.handleSwitch;let u,m=l({id:"team.button.ariaLabel",defaultMessage:"{teamName} team"},{teamName:t});c||(a?(c="unread",u=M.createElement("span",{className:"unread-badge"})):c=h?"":"special",m=l({id:"team.button.unread.ariaLabel",defaultMessage:"{teamName} team unread"},{teamName:t}),n&&(m=l({id:"team.button.mentions.ariaLabel",defaultMessage:"{teamName} team, {mentionCount} mentions"},{teamName:t,mentionCount:n}),u=M.createElement("span",{className:"badge badge-max-number pull-right small"},n>99?"99+":n))),m=m.toLowerCase();const g=M.createElement(bi.Z,{className:c,withHover:!0,content:this.props.content||t||"",url:e});let f,E=this.props.tip||(0,I._u)("team.button.name_undefined","This team does not have a name");if(void 0!==this.props.order&&this.props.order<10){let e;e=(0,I.V5)()?l({id:"team.button.tooltip.mac",defaultMessage:"⌘ ⌥ {order}"},{order:this.props.order}):l({id:"team.button.tooltip",defaultMessage:"Ctrl+Alt+{order}"},{order:this.props.order}),E=M.createElement(M.Fragment,null,E,M.createElement("div",{className:"tooltip-help"},e)),this.props.showOrder&&(f=M.createElement("div",{className:"order-indicator"},this.props.order))}const C=M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:this.props.placement,overlay:M.createElement(et.Z,{id:"tooltip-".concat(this.props.url)},E)},M.createElement("div",{className:"team-btn "+s},u,g));let b=M.createElement(ht.Link,{id:"".concat(this.props.url.slice(1),"TeamButton"),"aria-label":m,className:d,to:this.props.url,onClick:p},C);return(0,R.P)()&&h&&(b=M.createElement(Ci,{link:this.props.url,menuId:this.props.url},b)),i?M.createElement(ui._l,{draggableId:o,index:r},((e,t)=>M.createElement("div",Object.assign({className:"draggable-team-container",ref:e.innerRef},e.draggableProps,e.dragHandleProps),M.createElement("div",{className:W()(["team-container ".concat(c),{isDragging:t.isDragging}])},b,f)))):M.createElement("div",{className:"team-container ".concat(c)},b,f)}}_i(vi,"propTypes",{btnClass:y().string,url:y().string.isRequired,displayName:y().string,content:y().node,tip:y().oneOfType([y().string,y().element]).isRequired,order:y().number,showOrder:y().bool,active:y().bool,disabled:y().bool,unread:y().bool,mentions:y().number,placement:y().oneOf(["left","right","top","bottom"]),teamIconUrl:y().oneOfType([y().string,y().oneOf([null])]),switchTeam:y().func.isRequired,isDraggable:y().bool,teamIndex:y().number,teamId:y().string});const yi=(0,K.ZP)(vi);function Mi(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Pi(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function wi(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function Si(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}class Ti extends M.PureComponent{constructor(e){super(e),Mi(this,"switchToPrevOrNextTeam",((e,t,s)=>{if(I.pD(e,N.gT.KeyCodes.UP)||I.pD(e,N.gT.KeyCodes.DOWN)){e.preventDefault();const n=I.pD(e,N.gT.KeyCodes.DOWN)?1:-1,a=s.findIndex((e=>e.id===t))+n;let i;return i=-1===a?s[s.length-1]:a===s.length?s[0]:s[a],this.props.actions.switchTeam("/".concat(i.name)),!0}return!1})),Mi(this,"switchToTeamByNumber",((e,t,s)=>{const n=[N.gT.KeyCodes.ONE,N.gT.KeyCodes.TWO,N.gT.KeyCodes.THREE,N.gT.KeyCodes.FOUR,N.gT.KeyCodes.FIVE,N.gT.KeyCodes.SIX,N.gT.KeyCodes.SEVEN,N.gT.KeyCodes.EIGHT,N.gT.KeyCodes.NINE,N.gT.KeyCodes.ZERO];for(const a in n)if(I.pD(e,n[a])&&parseInt(a,10)<s.length){if(e.preventDefault(),s[a].id===t)return!1;const n=s[a];return this.props.actions.switchTeam("/".concat(n.name)),!0}return!1})),Mi(this,"handleKeyDown",(e=>{if((e.ctrlKey||e.metaKey)&&e.altKey){const{currentTeamId:t}=this.props,s=(0,mi.Z)(this.props.myTeams,this.props.locale,this.props.userTeamsOrderPreference);if(this.switchToPrevOrNextTeam(e,t,s))return;if(this.switchToTeamByNumber(e,t,s))return;this.setState({showOrder:!0})}})),Mi(this,"handleKeyUp",(e=>{(e.ctrlKey||e.metaKey)&&e.altKey||this.setState({showOrder:!1})})),Mi(this,"onDragEnd",(e=>{const{updateTeamsOrderForUser:t}=this.props.actions;if(!e.destination)return;const s=(0,mi.Z)(this.props.myTeams,this.props.locale,this.props.userTeamsOrderPreference),n=e.source.index,a=e.destination.index,i=((e,t,n)=>[...e.slice(0,t),s.find((e=>e.id===n)),...e.slice(t,e.length)])((o=n,[...(r=s).slice(0,o),...r.slice(o+1,r.length)]),a,e.draggableId);var r,o;t(i.map((e=>e.id))),this.setState({teamsOrder:i})})),this.state={showOrder:!1,teamsOrder:[]}}componentDidMount(){this.props.actions.getTeams(0,200),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)}render(){const e=document.querySelector("#root");if(this.props.myTeams.length<=1)return e.classList.remove("multi-teams"),null;e.classList.add("multi-teams");const t=[],s=(0,mi.Z)(this.props.myTeams,this.props.locale,this.props.userTeamsOrderPreference).map(((e,t)=>{var s,n,a,i;const r=this.props.myTeamMembers[e.id];return M.createElement(yi,{key:"switch_team_"+e.name,url:"/".concat(e.name),tip:e.display_name,active:e.id===this.props.currentTeamId,displayName:e.display_name,unread:this.props.collapsedThreads?r.msg_count_root+(null===(s=this.props.threadCounts)||void 0===s||null===(n=s[e.id])||void 0===n?void 0:n.total_unread_threads)>0:r.msg_count>0,order:t+1,showOrder:this.state.showOrder,mentions:this.props.collapsedThreads?r.mention_count_root+(null===(a=this.props.threadCounts)||void 0===a||null===(i=a[e.id])||void 0===i?void 0:i.total_unread_mentions):r.mention_count,teamIconUrl:I.uZ(e),switchTeam:this.props.actions.switchTeam,isDraggable:!0,teamId:e.id,teamIndex:t})})),n=[];return this.props.moreTeamsToJoin&&!this.props.experimentalPrimaryTeam?n.push(M.createElement(yi,{btnClass:"team-btn__add",key:"more_teams",url:"/select_team",tip:M.createElement(V.Z,{id:"team_sidebar.join",defaultMessage:"Other teams you can join"}),content:M.createElement("i",{className:"icon icon-plus"}),switchTeam:this.props.actions.switchTeam})):n.push(M.createElement(ys.Z,{permissions:[Ps.Z.CREATE_TEAM],key:"more_teams"},M.createElement(yi,{btnClass:"team-btn__add",url:"/create_team",tip:M.createElement(V.Z,{id:"navbar_dropdown.create",defaultMessage:"Create a Team"}),content:M.createElement("i",{className:"icon icon-plus"}),switchTeam:this.props.actions.switchTeam}))),t.push(M.createElement("div",{key:"team-sidebar-bottom-plugin",className:"team-sidebar-bottom-plugin is-empty"},M.createElement(A.Z,{pluggableName:"BottomTeamSidebar"}))),M.createElement("div",{className:W()("team-sidebar",{"move--right":this.props.isOpen}),role:"navigation","aria-labelledby":"teamSidebarWrapper"},M.createElement("div",{className:"team-wrapper",id:"teamSidebarWrapper"},M.createElement(dt.ZP,{autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:wi,renderThumbVertical:Si,renderView:Pi},M.createElement(ui.Z5,{onDragEnd:this.onDragEnd},M.createElement(ui.bK,{droppableId:"my_teams",type:"TEAM_BUTTON"},(e=>M.createElement("div",Object.assign({ref:e.innerRef},e.droppableProps),s,e.placeholder)))),n)),t)}}Mi(Ti,"propTypes",{myTeams:y().array.isRequired,collapsedThreads:y().bool.isRequired,currentTeamId:y().string.isRequired,match:y().shape({url:y().string.isRequired}).isRequired,moreTeamsToJoin:y().bool.isRequired,isOpen:y().bool.isRequired,experimentalPrimaryTeam:y().string,locale:y().string.isRequired,actions:y().shape({getTeams:y().func.isRequired,switchTeam:y().func.isRequired,updateTeamsOrderForUser:y().func.isRequired}).isRequired,userTeamsOrderPreference:y().string.isRequired});const Ni=(0,i.EN)((0,n.connect)((function(e){const t=(0,h.iE)(e).ExperimentalPrimaryTeam,s=(0,u.O5)(e),n=s&&s.length>0;return{currentTeamId:(0,u.ev)(e),myTeams:(0,u.Dc)(e),myTeamMembers:(0,u.gb)(e),isOpen:hi(e),collapsedThreads:(0,d.ym)(e),experimentalPrimaryTeam:t,locale:(0,di.B)(e),moreTeamsToJoin:n,userTeamsOrderPreference:(0,d.U2)(e,N.uP.TEAMS_ORDER,"",""),threadCounts:(0,pi.qN)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getTeams:l.LK,switchTeam:C.Xr,updateTeamsOrderForUser:C.A6},e)}}))(Ti));var Ri=s(24210),Ii=s(63951),Oi=s(47486),Li=s(3163),Ai=s(44054),ki=s(76669),xi=s(45403);function Di(e){return{type:N.MF.SIDEBAR_DRAGGING_SET_STATE,data:e}}function Zi(){return{type:N.MF.SIDEBAR_DRAGGING_STOP}}function Hi(e,t,s){return async(n,a)=>{if(s){const e=a().views.channelSidebar.multiSelectedChannelIds;s.forEach((t=>{e.indexOf(t)>=0&&n(Fi(t))}))}const i=await n((0,Ri.k4)(e,t,s));return n({type:N.MF.ADD_NEW_CATEGORY_ID,data:i.data.id})}}function qi(e,t){return ji(e,0,t,!1)}function ji(e,t,s,n=!0){return(a,i)=>{const r=i(),o=r.views.channelSidebar.multiSelectedChannelIds;let l=[];if(o.length&&-1!==o.indexOf(s)){const t=(0,xi.Yy)(r),n=(0,xi.ER)(r);let i=[s];const c=t.find((t=>t.id===e));i=o.filter((e=>{const t=n.find((t=>e===t.id)),s=(null==t?void 0:t.type)===D.LQ.DM_CHANNEL||(null==t?void 0:t.type)===D.LQ.GM_CHANNEL;return(null==c?void 0:c.type)===Oi.y.CUSTOM||(null==c?void 0:c.type)===Oi.y.FAVORITES||s&&(null==c?void 0:c.type)===Oi.y.DIRECT_MESSAGES||!s&&(null==c?void 0:c.type)!==Oi.y.DIRECT_MESSAGES}));const d=n.map((e=>e.id));i.sort(((e,t)=>d.indexOf(e)-d.indexOf(t))),i.forEach((e=>a(Fi(e)))),l=i}else l=[s];const c=function(e,t,s,n,a){if(0===n)return 0;const i=(0,Li.n3)(e,t),r=(0,Li.kb)()(e,i),o=r.filter(((e,t)=>e!==a&&-1!==s.indexOf(e)&&t<=n)),l=n-o.length;if(i.channel_ids.length===r.length)return l;const c=(0,ki.FY)(r,s,l),d=c[c.indexOf(s[0])-1];let h=i.channel_ids.indexOf(d)+1;const p=i.channel_ids.indexOf(s[0]);return-1!==p&&p<h&&(h-=1),Math.max(h-o.length,0)}(r,e,l,t,s);return a((0,Ri.Yw)(e,l,c,n))}}function Ui(){return(e,t)=>0===t().views.channelSidebar.multiSelectedChannelIds.length?Promise.resolve({data:!0}):e({type:N.MF.MULTISELECT_CHANNEL_CLEAR})}function Fi(e){return(t,s)=>{const n=s();if(!n.views.channelSidebar.multiSelectedChannelIds.length){const e=(0,m.gO)(n);t({type:N.MF.MULTISELECT_CHANNEL,data:e})}return t({type:N.MF.MULTISELECT_CHANNEL_ADD,data:e})}}function Bi(e){return(t,s)=>{const n=s(),a=n.views.channelSidebar.multiSelectedChannelIds;let i=n.views.channelSidebar.lastSelectedChannel;if(!a.length){const e=(0,m.gO)(n);t({type:N.MF.MULTISELECT_CHANNEL,data:e}),i=e}const r=(0,xi.QP)(n).map((e=>e.id)),o=r.indexOf(e),l=r.indexOf(i);if(o===l)return null;const c=Math.min(l,o),d=Math.max(l,o),h=r.slice(c,d+1);return t({type:N.MF.MULTISELECT_CHANNEL_TO,data:h})}}function Gi(e){return t=>t({type:Ai.Y.RECEIVED_CATEGORY_CURRENT,data:{id:e}})}function Vi(e){return t=>t({type:Ai.P.SIDEBAR_GET_MORE,data:{type:e,index:0}})}var Ki=s(26700),Yi=s(11381);function Wi(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class zi extends M.PureComponent{constructor(e){super(e),Wi(this,"handleClear",(()=>{this.setState({categoryName:""})})),Wi(this,"handleChange",(e=>{this.setState({categoryName:e.target.value})})),Wi(this,"handleCancel",(()=>{this.handleClear()})),Wi(this,"handleConfirm",(()=>{this.props.categoryId?this.props.actions.renameCategory(this.props.categoryId,this.state.categoryName):(this.props.actions.createCategory(this.props.currentTeamId,this.state.categoryName,this.props.channelIdsToAdd),(0,Ye.L9)("ui","ui_sidebar_created_category"))})),Wi(this,"isConfirmDisabled",(()=>!this.state.categoryName||Boolean(this.props.initialCategoryName)&&this.props.initialCategoryName===this.state.categoryName||this.state.categoryName.length>22)),Wi(this,"getText",(()=>{let e,t,s;return this.props.categoryId?(e=M.createElement(V.Z,{id:"rename_category_modal.renameCategory",defaultMessage:"Rename Category"}),t=M.createElement(V.Z,{id:"rename_category_modal.rename",defaultMessage:"Rename"})):(e=M.createElement(V.Z,{id:"create_category_modal.createCategory",defaultMessage:"Create New Category"}),t=M.createElement(V.Z,{id:"create_category_modal.create",defaultMessage:"Create"}),s=M.createElement(V.Z,{id:"edit_category_modal.helpText",defaultMessage:"Drag channels into this category to organize your sidebar."})),{modalHeaderText:e,editButtonText:t,helpText:s}})),this.state={categoryName:e.initialCategoryName||""}}render(){const{modalHeaderText:e,editButtonText:t,helpText:s}=this.getText();return M.createElement(Yi.Z,{onHide:this.props.onHide,modalHeaderText:e,handleConfirm:this.handleConfirm,handleCancel:this.handleCancel,confirmButtonText:t,isConfirmDisabled:this.isConfirmDisabled(),id:"editCategoryModal"},M.createElement(Ki.Z,{inputComponent:Ki.x,autoFocus:!0,className:"form-control filter-textbox",type:"text",value:this.state.categoryName,placeholder:(0,I._u)("edit_category_modal.placeholder","Name your category"),clearable:!0,onClear:this.handleClear,onChange:this.handleChange,maxLength:22}),Boolean(s)&&M.createElement("span",{className:"edit-category__helpText"},s))}}Wi(zi,"propTypes",{onHide:y().func.isRequired,currentTeamId:y().string.isRequired,categoryId:y().string,initialCategoryName:y().string,channelIdsToAdd:y().arrayOf(y().string),actions:y().shape({createCategory:y().func.isRequired,renameCategory:y().func.isRequired}).isRequired});const Ji=(0,n.connect)((function(e){return{currentTeamId:(0,u.kA)(e).id}}),(function(e){return{actions:(0,a.bindActionCreators)({createCategory:Hi,renameCategory:Ri.t6},e)}}))(zi);var Xi=s(71843),Qi=s.n(Xi),$i=(s(85827),s(71816)),er=s(23122),tr=s(70735),sr=s.n(tr),nr=s(43174),ar=s.n(nr),ir=s(23279),rr=s.n(ir),or=s(7681),lr=s(49801),cr=s(68403);function dr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function hr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const pr=N.ZP.MAX_USERS_IN_GM-1,ur={useTime:!1,style:"long",ranges:[{within:["minute",-1],display:["second",0]},{within:["hour",-1],display:["minute"]},{within:["hour",-24],display:["hour"]},{within:["day",-30],display:["day"]},{within:["month",-11],display:["month"]},{within:["year",-1e3],display:["year"]}]};function mr(e){return"G"===(null==e?void 0:e.type)}function gr(e){return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(s),!0).forEach((function(t){hr(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):dr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({value:e.id,label:mr(e)?e.display_name:e.username},e)}class fr extends M.PureComponent{constructor(e){super(e),hr(this,"searchTimeoutId",void 0),hr(this,"exitToChannel",void 0),hr(this,"multiselect",void 0),hr(this,"selectedItemRef",void 0),hr(this,"loadModalData",(()=>{this.getUserProfiles(),this.props.actions.getTotalUsersStats(),this.loadProfilesMissingStatus(this.props.users,this.props.statuses)})),hr(this,"loadProfilesMissingStatus",((e=[],t={})=>{const s=e.filter((e=>!t[e.id])).map((e=>e.id));s.length>0&&this.props.actions.getStatusesByIds(s)})),hr(this,"handleHide",(()=>{this.props.actions.setModalSearchTerm(""),this.setState({show:!1}),this.props.bodyOnly&&this.handleExit()})),hr(this,"setUsersLoadingState",(e=>{this.setState({loadingUsers:e})})),hr(this,"handleExit",(()=>{var e,t,s,n;this.exitToChannel&&st.m.push(this.exitToChannel),null===(e=(t=this.props).onModalDismissed)||void 0===e||e.call(t),null===(s=(n=this.props).onHide)||void 0===s||s.call(n)})),hr(this,"handleSubmit",((e=this.state.values)=>{const{actions:t}=this.props;if(this.state.saving)return;const s=e.map((e=>e.id));if(0===s.length)return;this.setState({saving:!0});const n=e=>{const{data:t,error:s}=e;this.setState({saving:!1}),s||(this.exitToChannel="/"+this.props.currentTeamName+"/group/"+t.name,this.handleHide())};1===s.length?t.openDirectChannelToUserId(s[0]).then(n):t.openGroupChannelToUserIds(s).then(n)})),hr(this,"addValue",(e=>{if(mr(e))this.addUsers(e.profiles);else{const t=Object.assign([],this.state.values);-1===t.indexOf(e)&&t.push(e),this.setState({values:t})}})),hr(this,"addUsers",(e=>{const t=Object.assign([],this.state.values),s=t.map((e=>e.id));for(const n of e)-1===s.indexOf(n.id)&&t.push(gr(n));this.setState({values:t})})),hr(this,"getUserProfiles",(e=>{const t=e?e+1:0;"any"===this.props.restrictDirectMessage?this.props.actions.getProfiles(t,100).then((()=>{this.setUsersLoadingState(!1)})):this.props.actions.getProfilesInTeam(this.props.currentTeamId,t,100).then((()=>{this.setUsersLoadingState(!1)}))})),hr(this,"handlePageChange",((e,t)=>{e>t&&(this.setUsersLoadingState(!0),this.getUserProfiles(e))})),hr(this,"resetPaging",(()=>{var e;null===(e=this.multiselect.current)||void 0===e||e.resetPaging()})),hr(this,"search",rr()((e=>{this.props.actions.setModalSearchTerm(e)}),250)),hr(this,"handleDelete",(e=>{this.setState({values:e})})),hr(this,"renderAriaLabel",(e=>{var t;return null!==(t=null==e?void 0:e.username)&&void 0!==t?t:""})),hr(this,"optionDisplayParts",(e=>{if(mr(e))return M.createElement(M.Fragment,null,M.createElement("div",{className:"more-modal__gm-icon bg-text-200"},e.profiles.length),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},M.createElement("span",null,e.profiles.map((e=>"@".concat(e.username))).join(", ")))));const{id:t,delete_at:s,is_bot:n=!1,last_picture_update:a}=e,i=(0,I.bj)(e);let r=i;return e.id===this.props.currentUserId?r=M.createElement(V.Z,{id:"more_direct_channels.directchannel.you",defaultMessage:"{displayname} (you)",values:{displayname:i}}):e.delete_at&&(r=M.createElement(V.Z,{id:"more_direct_channels.directchannel.deactivated",defaultMessage:"{displayname} - Deactivated",values:{displayname:i}})),M.createElement(M.Fragment,null,M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(t,a),status:s||n?void 0:this.props.statuses[t],size:"md"}),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},r,M.createElement(Cn.Z,{show:n,className:"badge-popoverlist"}),M.createElement(En.Z,{show:(0,I.a_)(e),className:"badge-popoverlist"}),M.createElement(cr.Z,{userID:e.id,showTooltip:!0,emojiSize:15})),!n&&M.createElement("div",{className:"more-modal__description"},e.email)))})),hr(this,"handleSubmitImmediatelyOn",(e=>e.id===this.props.currentUserId||Boolean(e.delete_at))),hr(this,"note",(()=>{let e;return this.props.currentChannelMembers&&(this.state.values&&this.state.values.length>=pr?e=M.createElement(V.Z,{id:"more_direct_channels.new_convo_note.full",defaultMessage:"You've reached the maximum number of people for this conversation. Consider creating a private channel instead."}):this.props.isExistingChannel&&(e=M.createElement(V.Z,{id:"more_direct_channels.new_convo_note",defaultMessage:"This will start a new conversation. If you're adding a lot of people, consider creating a private channel instead."}))),e})),hr(this,"renderOptionValue",((e,t,s,n)=>{const{id:a,last_post_at:i}=e;return M.createElement("div",{key:a,ref:t?this.selectedItemRef:e.id,className:W()("more-modal__row clickable",{"more-modal__row--selected":t}),onClick:()=>s(e),onMouseEnter:()=>n(e)},this.optionDisplayParts(e),!(0,I.tq)()&&Boolean(i)&&M.createElement("div",{className:"more-modal__lastPostAt"},M.createElement(lr.ZP,Object.assign({},ur,{value:i}))),M.createElement("div",{className:"more-modal__actions"},M.createElement("div",{className:"more-modal__actions--round"},M.createElement(Za.Z,null))))})),hr(this,"computeOptions",(()=>{const{currentUserId:e,searchTerm:t,myDirectChannels:s,recentDMUsers:n=[]}=this.props,{values:a}=this.state,[i,r]=ar()(this.props.users,(({delete_at:e})=>0===e)),o=this.props.groupChannels.filter((({profiles:e})=>sr()(e,a,"id").length)),[l,c]=ar()(o,"last_post_at");let d=a.length?i.filter((({id:t})=>t!==e)):i.concat(r);d=d.filter((e=>(0===e.delete_at||s.some((({name:t})=>t.includes(e.id))))&&!n.some((({id:t})=>t===e.id))));const h=[...a.length?n.filter((({id:t})=>t!==e)):n,...l].sort(((e,t)=>t.last_post_at-e.last_post_at));return h.length&&!t?h.slice(0,20):[...h,...d,...c]})),this.searchTimeoutId=0,this.multiselect=M.createRef(),this.selectedItemRef=M.createRef();const t=[];if(e.currentChannelMembers)for(let s=0;s<e.currentChannelMembers.length;s++){const n=Object.assign({},e.currentChannelMembers[s]);n.id!==e.currentUserId&&t.push(gr(n))}this.state={values:t,show:!0,search:!1,saving:!1,loadingUsers:!0}}updateFromProps(e){if(e.searchTerm!==this.props.searchTerm){clearTimeout(this.searchTimeoutId);const e=this.props.searchTerm;if(""===e)this.resetPaging();else{const t="any"===this.props.restrictDirectMessage?"":this.props.currentTeamId;this.searchTimeoutId=setTimeout((async()=>{this.setUsersLoadingState(!0);const[{data:s},{data:n}]=await Promise.all([this.props.actions.searchProfiles(e,{team_id:t}),this.props.actions.searchGroupChannels(e)]);s&&this.props.actions.loadStatusesForProfilesList(s),n&&this.props.actions.loadProfilesForGroupChannels(n),this.resetPaging(),this.setUsersLoadingState(!1)}),N.ZP.SEARCH_TIMEOUT_MILLISECONDS)}}e.users.length===this.props.users.length&&Object.keys(e.statuses).length===Object.keys(this.props.statuses).length||this.loadProfilesMissingStatus(this.props.users,this.props.statuses)}componentDidUpdate(e){this.updateFromProps(e)}renderValue(e){return e.data.username}render(){const{bodyOnly:e}=this.props,{values:t}=this.state,s=(0,I._u)("multiselect.go","Go"),n=(0,I._u)("multiselect.loading","Loading.."),a=M.createElement(V.Z,{id:"multiselect.numPeopleRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {person} other {people}}. ",values:{num:pr-t.length}}),i=M.createElement(xa.Z,{key:"moreDirectChannelsList",ref:this.multiselect,options:this.computeOptions().map(gr),optionRenderer:this.renderOptionValue,selectedItemRef:this.selectedItemRef,values:this.state.values,valueRenderer:this.renderValue,ariaLabelRenderer:this.renderAriaLabel,perPage:50,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,noteText:this.note(),maxValues:pr,numRemainingText:a,buttonSubmitText:s,buttonSubmitLoadingText:n,submitImmediatelyOn:this.handleSubmitImmediatelyOn,saving:this.state.saving,loading:this.state.loadingUsers,users:this.props.users,totalCount:this.props.totalCount,placeholderText:(0,I._u)("multiselect.placeholder","Search and add members")});return e?i:M.createElement(G.Z,{dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,onEntered:this.loadModalData,role:"dialog","aria-labelledby":"moreDmModalLabel",id:"moreDmModal"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"moreDmModalLabel"},M.createElement(V.Z,{id:"more_direct_channels.title",defaultMessage:"Direct Messages"}))),M.createElement(G.Z.Body,{role:"application"},i),M.createElement(G.Z.Footer,{className:"modal-footer--invisible"},M.createElement("button",{id:"closeModalButton",type:"button",className:"btn btn-link"},M.createElement(V.Z,{id:"general_button.close",defaultMessage:"Close"}))))}}function Er(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Cr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Er(Object(s),!0).forEach((function(t){br(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Er(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function br(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}hr(fr,"propTypes",{currentUserId:y().string.isRequired,currentTeamId:y().string.isRequired,currentTeamName:y().string.isRequired,searchTerm:y().string.isRequired,users:y().array.isRequired,groupChannels:y().array.isRequired,myDirectChannels:y().array.isRequired,totalCount:y().number,currentChannelMembers:y().array.isRequired,isExistingChannel:y().bool.isRequired,restrictDirectMessage:y().string,onModalDismissed:y().func.isRequired,onHide:y().func,bodyOnly:y().bool,actions:y().shape({getProfiles:y().func.isRequired,getProfilesInTeam:y().func.isRequired,getStatusesByIds:y().func.isRequired,getTotalUsersStats:y().func.isRequired,loadStatusesForProfilesList:y().func.isRequired,loadProfilesForGroupChannels:y().func.isRequired,openDirectChannelToUserId:y().func.isRequired,openGroupChannelToUserIds:y().func.isRequired,searchProfiles:y().func.isRequired,searchGroupChannels:y().func.isRequired,setModalSearchTerm:y().func.isRequired}).isRequired});const _r=(0,dn.GA)(((e,t)=>e.filter((e=>(0,er.vI)(e.profiles,t).length>0)))),vr=(0,dn.GA)(((e,t)=>Object.values(e).filter((e=>e.type===N.gT.DM_CHANNEL&&e.name.includes(t))))),yr=(0,n.connect)((()=>{const e=(0,p.uZ)();return(t,s)=>{const n=(0,p.rc)(t);let a=[];s.isExistingChannel&&(a=(0,p.OX)(t));const i=(0,h.iE)(t).RestrictDirectMessage,r=t.views.search.modalSearch;let o;o=r?"any"===i?e(t,r,!1):(0,p.lo)(t,r,!1):"any"===i?(0,p.cp)(t,{}):(0,p.fv)(t);const l=_r((0,m.P6)(t),r),c=vr((0,m.IU)(t),n);let d=c.reduce(((e,s)=>{if(!s.last_post_at)return e;const a=(0,p.PR)(t,(0,$i.aU)(n,s.name));return a&&e.push(Cr(Cr({},a),{},{last_post_at:s.last_post_at})),e}),[]);r&&(d=Qi()(d,o,"id"));const g=(0,u.kA)(t),f=(0,p.S1)(t)||{total_users_count:0};return{currentTeamId:g.id,currentTeamName:g.name,searchTerm:r,users:o.sort(er.gh),myDirectChannels:c,groupChannels:l,recentDMUsers:d,statuses:t.entities.users.statuses,currentChannelMembers:a,currentUserId:n,restrictDirectMessage:i,totalCount:f.total_users_count}}}),(function(e){return{actions:(0,a.bindActionCreators)({getProfiles:r.cp,getProfilesInTeam:r.gV,getStatusesByIds:r.W7,getTotalUsersStats:r.S1,loadStatusesForProfilesList:E.xO,loadProfilesForGroupChannels:Le.Tg,openDirectChannelToUserId:Ii.Pn,openGroupChannelToUserIds:Ii.iU,searchProfiles:r.t6,searchGroupChannels:o.PP,setModalSearchTerm:ws.Gl},e)}}))(fr);var Mr=s(67556);function Pr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const wr=new(s(45860).Z)({concurrency:2});class Sr extends M.PureComponent{constructor(...e){super(...e),Pr(this,"prefetchTimeout",void 0),Pr(this,"prefetchPosts",(e=>e)),Pr(this,"prefetchData",(()=>{const{prefetchRequestStatus:e,prefetchQueueObj:t}=this.props;for(const s in t){if(!t.hasOwnProperty(s))continue;const n=t[s];for(const t of n)e.hasOwnProperty(t)||wr.add((async()=>this.prefetchPosts(t)))}}))}async componentDidUpdate(e){const{currentChannelId:t,prefetchQueueObj:s,sidebarLoaded:n}=this.props;!t||!n||e.currentChannelId&&e.sidebarLoaded?e.prefetchQueueObj!==s&&(clearTimeout(this.prefetchTimeout),await wr.clear(),this.prefetchData()):(wr.add((async()=>this.prefetchPosts(t))),await(0,Le.D3)(),this.prefetchData(),this.props.actions.trackDMGMOpenChannels())}render(){return null}}function Tr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Nr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(s),!0).forEach((function(t){Rr(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Tr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Rr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var Ir;Pr(Sr,"propTypes",{currentChannelId:y().string.isRequired,sidebarLoaded:y().bool.isRequired,unreadChannels:y().array.isRequired,actions:y().shape({prefetchChannelPosts:y().func.isRequired,trackDMGMOpenChannels:y().func.isRequired}).isRequired}),function(e){e[e.high=1]="high",e[e.medium=2]="medium",e[e.low=3]="low"}(Ir||(Ir={}));const Or=(0,dn.GA)(((e,t)=>e.reduce(((e,s)=>{const n=s.id,a=t[n];if(a&&!(0,$i.Mm)(a)){if(a.mention_count>0)return Nr(Nr({},e),{},{[Ir.high]:[...e[Ir.high],n]});if(a.notify_props&&"mention"!==a.notify_props.mark_unread&&s.total_msg_count-a.msg_count)return Nr(Nr({},e),{},{[Ir.medium]:[...e[Ir.medium],n]})}return e}),{[Ir.high]:[],[Ir.medium]:[],[Ir.low]:[]})));function Lr(e){return"true"===(0,h.iE)(e).EnableLegacySidebar||(0,xi.Yy)(e).length>0}const Ar=(0,n.connect)((function(e){const t=e.views.channel.lastUnreadChannel,s=(0,Mr.h4)(e),n=(0,m.Xn)(e,t),a=Or(n,s),i=e.views.channel.channelPrefetchStatus;return{currentChannelId:(0,m.gO)(e),prefetchQueueObj:a,prefetchRequestStatus:i,sidebarLoaded:Lr(e),unreadChannels:n}}),(function(e){return{actions:(0,a.bindActionCreators)({prefetchChannelPosts:b.AV,trackDMGMOpenChannels:Le.eq},e)}}))(Sr);function kr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class xr extends M.PureComponent{static getDerivedStateFromProps(e){return!1===e.show?{displayNameError:""}:null}constructor(e){super(e),kr(this,"onEnterKeyDown",(e=>{const t=I.pD(e,N.ZP.KeyCodes.ENTER),{ctrlSend:s}=this.props;s&&t&&!e.ctrlKey?e.preventDefault():(s&&t&&e.ctrlKey||!s&&t&&!e.shiftKey&&!e.altKey)&&this.handleSubmit(e)})),kr(this,"handleSubmit",(e=>{e.preventDefault(),this.displayNameInput.current.value.trim().length<N.ZP.MIN_CHANNELNAME_LENGTH?this.setState({displayNameError:!0}):this.props.onSubmitChannel()})),kr(this,"handleChange",(()=>{const e={displayName:this.displayNameInput.current.value,purpose:this.channelPurposeInput.current.value};this.props.onDataChanged(e)})),kr(this,"handleOnURLChange",(e=>{e.preventDefault(),this.props.onChangeURLPressed&&this.props.onChangeURLPressed()})),kr(this,"handlePublicTypeSelect",(()=>{this.props.onTypeSwitched("O")})),kr(this,"handlePrivateTypeSelect",(()=>{this.props.onTypeSwitched("P")})),this.state={displayNameError:""},this.channelPurposeInput=M.createRef(),this.displayNameInput=M.createRef()}render(){const{canCreatePublicChannel:e,canCreatePrivateChannel:t}=this.props,s=e&&t;var n=null,a=null,i="form-group";this.state.displayNameError&&(n=M.createElement("p",{className:"input__help error"},M.createElement(V.Z,{id:"channel_modal.displayNameError",defaultMessage:"Display name must have at least 2 characters."}),this.state.displayNameError),i+=" has-error"),this.props.serverError&&(a=M.createElement("div",{className:"form-group has-error"},M.createElement("div",{className:"col-sm-12"},M.createElement("p",{id:"createChannelError",className:"input__help error"},this.props.serverError))));const r=M.createElement("div",{className:"flex-parent"},M.createElement(kn.Z,{className:"icon icon__globe icon--body type-icon"}),M.createElement(V.Z,{id:"channel_modal.publicName",defaultMessage:"Public"}),M.createElement(V.Z,{id:"channel_modal.publicHint",defaultMessage:" - Anyone can join this channel"})),o=M.createElement("div",{className:"flex-parent"},M.createElement(xn.Z,{className:"icon icon__lock icon--body type-icon"}),M.createElement(V.Z,{id:"channel_modal.privateName",defaultMessage:"Private"}),M.createElement(V.Z,{id:"channel_modal.privateHint",defaultMessage:" - Only invited members can join this channel"}));let l=null;l=s?M.createElement("fieldset",{key:"channelType",className:"multi-select__radio"},M.createElement("div",{className:"radio"},M.createElement("label",null,M.createElement("input",{id:"public",type:"radio",name:"channelType",checked:"O"===this.props.channelType,onChange:this.handlePublicTypeSelect,"aria-labelledby":"channelModalTypeLabel"}),r)),M.createElement("div",{className:"radio"},M.createElement("label",null,M.createElement("input",{id:"private",type:"radio",name:"channelType",checked:"P"===this.props.channelType,onChange:this.handlePrivateTypeSelect,"aria-labelledby":"channelModalTypeLabel"}),o))):M.createElement("div",{className:"type-container multi-select__radio"},M.createElement("div",{className:"radio"},e?r:null,t?o:null));const c=(0,Sn.ZC)();return M.createElement("span",null,M.createElement(G.Z,{dialogClassName:"a11y__modal new-channel__modal new-channel",show:this.props.show,bsSize:"large",onHide:this.props.onModalDismissed,onExited:this.props.onModalExited,autoFocus:!0,restoreFocus:!0,role:"dialog","aria-labelledby":"newChannelModalLabel"},M.createElement(G.Z.Header,null,M.createElement("button",{type:"button",className:"close",onClick:this.props.onModalDismissed,"aria-label":"Close",title:"Close"},M.createElement("span",{"aria-hidden":"true"},"×")),M.createElement(G.Z.Title,{componentClass:"h1",id:"newChannelModalLabel"},M.createElement(V.Z,{id:"channel_modal.modalTitle",defaultMessage:"New Channel"}))),M.createElement("form",{role:"form",className:"form-horizontal"},M.createElement(G.Z.Body,null,M.createElement("div",{className:"form-group"},M.createElement("label",{className:"col-sm-3 form__label control-label",id:"channelModalTypeLabel"},M.createElement(V.Z,{id:"channel_modal.type",defaultMessage:"Type"})),M.createElement("div",{className:"col-sm-9"},l)),M.createElement("div",{className:i},M.createElement("label",{className:"col-sm-3 form__label control-label",htmlFor:"newChannelName"},M.createElement(V.Z,{id:"channel_modal.name",defaultMessage:"Name"})),M.createElement("div",{className:"col-sm-9"},M.createElement(pa.Z,{id:"newChannelName",onChange:this.handleChange,type:"text",ref:this.displayNameInput,className:"form-control",placeholder:{id:(0,Ae.t)("channel_modal.nameEx"),defaultMessage:'E.g.: "Bugs", "Marketing", "客户支持"'},maxLength:N.ZP.MAX_CHANNELNAME_LENGTH,value:this.props.channelData.displayName,autoFocus:!0,onKeyDown:this.onEnterKeyDown}),n,M.createElement("p",{className:"input__help dark"},"URL: "+c+this.props.channelData.name+" (",M.createElement("button",{className:"color--link style--none",onClick:this.handleOnURLChange},M.createElement(V.Z,{id:"channel_modal.edit",defaultMessage:"Edit"})),")"))),M.createElement("div",{className:"form-group"},M.createElement("div",{className:"col-sm-3"},M.createElement("label",{className:"form__label control-label",htmlFor:"newChannelPurpose"},M.createElement(V.Z,{id:"channel_modal.purpose",defaultMessage:"Purpose"})),M.createElement("label",{className:"form__label light"},M.createElement(V.Z,{id:"channel_modal.optional",defaultMessage:"(optional)"}))),M.createElement("div",{className:"col-sm-9"},M.createElement("textarea",{id:"newChannelPurpose",className:"form-control no-resize",ref:this.channelPurposeInput,rows:"4",placeholder:I._u("channel_modal.purposeEx",'E.g.: "A channel to file bugs and improvements"'),maxLength:"250",value:this.props.channelData.purpose,onChange:this.handleChange}),a))),M.createElement(G.Z.Footer,null,M.createElement("button",{id:"cancelNewChannel",type:"button",className:"btn btn-link",onClick:this.props.onModalDismissed,onBlur:()=>document.getElementById("newChannelName").focus()},M.createElement(V.Z,{id:"channel_modal.cancel",defaultMessage:"Cancel"})),M.createElement("button",{id:"submitNewChannel",onClick:this.handleSubmit,type:"submit",className:"btn btn-primary"},M.createElement(V.Z,{id:"channel_modal.createNew",defaultMessage:"Create Channel"}))))))}}kr(xr,"propTypes",{show:y().bool.isRequired,currentTeamId:y().string.isRequired,channelType:y().string.isRequired,channelData:y().object.isRequired,ctrlSend:y().bool,serverError:y().node,onSubmitChannel:y().func.isRequired,onModalDismissed:y().func.isRequired,onModalExited:y().func,onTypeSwitched:y().func.isRequired,onChangeURLPressed:y().func.isRequired,onDataChanged:y().func.isRequired,canCreatePublicChannel:y().bool.isRequired,canCreatePrivateChannel:y().bool.isRequired});const Dr=(0,n.connect)((function(e){return{ctrlSend:(0,d.o4)(e,D.uP.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),currentTeamId:(0,u.ev)(e)}}))(xr);function Zr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s(15306);class Hr extends M.PureComponent{constructor(e){super(e),Zr(this,"urlInput",void 0),Zr(this,"onURLChanged",(e=>{const t=e.target.value.trim();this.setState({currentURL:t.replace(/[^A-Za-z0-9-_]/g,"").toLowerCase(),userEdit:!0})})),Zr(this,"onSubmit",(e=>{var t,s;e.preventDefault(),e.preventDefault();const n=(null===(t=this.urlInput)||void 0===t||null===(s=t.current)||void 0===s?void 0:s.value)||"",a=(0,Sn.pj)(n);a.length>0?this.setState({urlErrors:a}):(this.setState({urlErrors:"",userEdit:!1}),this.props.onModalSubmit(n))})),Zr(this,"onCancel",(()=>{this.setState({urlErrors:"",userEdit:!1}),this.props.onModalDismissed()})),this.urlInput=M.createRef(),this.state={currentURL:e.currentURL,urlErrors:"",userEdit:!1}}static getDerivedStateFromProps(e,t){return t.userEdit?null:{currentURL:e.currentURL}}render(){let e="input-group input-group--limit",t=null,s=null;this.state.urlErrors&&(e+=" has-error"),this.props.serverError||this.state.urlErrors?t=M.createElement("div",{className:"has-error"},M.createElement("p",{className:"input__help error"},this.state.urlErrors||this.props.serverError)):s=M.createElement("p",{className:"input__help"},M.createElement(V.Z,{id:"change_url.helpText",defaultMessage:"You can use lowercase letters, numbers, dashes, and underscores."}));const n=this.props.currentTeamURL+"/channels",a=(0,Sn.ZC)(n),i=M.createElement(et.Z,{id:"urlTooltip"},n);return M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.props.show,onHide:this.onCancel,onExited:this.props.onModalExited,role:"dialog","aria-labelledby":"changeUrlModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"changeUrlModalLabel"},this.props.title)),M.createElement("form",{role:"form",className:"form-horizontal"},M.createElement(G.Z.Body,null,M.createElement("div",{className:"form-group"},M.createElement("label",{className:"col-sm-3 form__label control-label"},M.createElement(V.Z,{id:"change_url.urlLabel",defaultMessage:"Channel URL"})),M.createElement("div",{className:"col-sm-9"},M.createElement("div",{className:e},M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:i},M.createElement("span",{className:"input-group-addon"},a)),M.createElement("input",{type:"text",ref:this.urlInput,className:"form-control",maxLength:N.ZP.MAX_CHANNELNAME_LENGTH,onChange:this.onURLChanged,value:this.state.currentURL,autoFocus:!0})),t,s))),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onCancel},M.createElement(V.Z,{id:"change_url.close",defaultMessage:"Close"})),M.createElement("button",{onClick:this.onSubmit,type:"submit",className:"btn btn-primary"},this.props.submitButtonText))))}}Zr(Hr,"propTypes",{show:y().bool,title:y().node,submitButtonText:y().node,currentURL:y().string,currentTeamURL:y().string.isRequired,serverError:y().node,onModalSubmit:y().func.isRequired,onModalExited:y().func,onModalDismissed:y().func.isRequired}),Zr(Hr,"defaultProps",{show:!1,title:"Change URL",submitButtonText:"Save",currentURL:"",serverError:null});const qr=(0,n.connect)((function(e){const t=(0,u.kA)(e);return{currentTeamURL:"".concat((0,Sn.fO)(),"/").concat(t.name)}}))(Hr);function jr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Ur(e){let t=e.channelType||N.ZP.OPEN_CHANNEL;return e.canCreatePublicChannel||t!==N.ZP.OPEN_CHANNEL||(t=N.ZP.PRIVATE_CHANNEL),e.canCreatePrivateChannel||t!==N.ZP.PRIVATE_CHANNEL||(t=N.ZP.OPEN_CHANNEL),t}class Fr extends M.PureComponent{constructor(e){super(e),jr(this,"onSubmit",(()=>{if(!this.state.channelDisplayName)return void this.setState({serverError:I._u("channel_flow.invalidName","Invalid Channel Name")});if(this.state.channelName.length<2)return void this.setState({flowState:3});const{actions:e,currentTeamId:t}=this.props,s={team_id:t,name:this.state.channelName,display_name:this.state.channelDisplayName,purpose:this.state.channelPurpose,header:this.state.channelHeader,type:this.state.channelType,create_at:0,creator_id:"",delete_at:0,extra_update_at:0,group_constrained:!1,id:"",last_post_at:0,scheme_id:"",total_msg_count:0,total_msg_count_root:0,update_at:0};e.createChannel(s).then((({data:t,error:s})=>{s?this.onCreateChannelError(s):t&&(this.onModalDismissed(),e.switchToChannel(t))}))})),jr(this,"onModalDismissed",(()=>{this.props.actions.closeModal(N.r8.NEW_CHANNEL_FLOW)})),jr(this,"onCreateChannelError",(e=>{"model.channel.is_valid.2_or_more.app_error"===e.server_error_id?this.setState({flowState:3,serverError:M.createElement(V.Z,{id:"channel_flow.handleTooShort",defaultMessage:"Channel URL must be 2 or more lowercase alphanumeric characters"})}):"store.sql_channel.update.exists.app_error"===e.server_error_id?this.setState({serverError:I._u("channel_flow.alreadyExist","A channel with that URL already exists")}):this.setState({serverError:e.message})})),jr(this,"typeSwitched",(e=>{this.setState({channelType:e,serverError:""})})),jr(this,"urlChangeRequested",(e=>{e&&e.preventDefault(),this.setState({flowState:2})})),jr(this,"urlChangeSubmitted",(e=>{3===this.state.flowState?this.setState({channelName:e,nameModified:!0},this.onSubmit):this.setState({flowState:1,serverError:null,channelName:e,nameModified:!0})})),jr(this,"urlChangeDismissed",(()=>{this.setState({flowState:1})})),jr(this,"channelDataChanged",(e=>{this.setState({channelDisplayName:e.displayName,channelPurpose:e.purpose,channelHeader:e.header}),this.state.nameModified||this.setState({channelName:(0,Sn.oK)(e.displayName.trim())})})),this.state={serverError:"",channelType:Ur(e),flowState:1,channelDisplayName:"",channelName:"",channelPurpose:"",channelHeader:"",nameModified:!1}}render(){const e={name:this.state.channelName,displayName:this.state.channelDisplayName,purpose:this.state.channelPurpose,header:this.state.channelHeader};let t=!1,s=!1,n="",a="";switch(this.state.flowState){case 1:t=!0;break;case 2:s=!0,n=M.createElement(V.Z,{id:"channel_flow.changeUrlTitle",defaultMessage:"Change Channel URL"}),a=n;break;case 3:s=!0,n=M.createElement(V.Z,{id:"channel_flow.set_url_title",defaultMessage:"Set Channel URL"}),a=M.createElement(V.Z,{id:"channel_flow.create",defaultMessage:"Create Channel"})}return M.createElement("span",null,M.createElement(Dr,{show:t,channelType:this.state.channelType,canCreatePublicChannel:this.props.canCreatePublicChannel,canCreatePrivateChannel:this.props.canCreatePrivateChannel,channelData:e,serverError:this.state.serverError,onSubmitChannel:this.onSubmit,onModalDismissed:this.onModalDismissed,onTypeSwitched:this.typeSwitched,onChangeURLPressed:this.urlChangeRequested,onDataChanged:this.channelDataChanged}),M.createElement(qr,{show:s,title:n,submitButtonText:a,currentURL:this.state.channelName,serverError:this.state.serverError,onModalSubmit:this.urlChangeSubmitted,onModalDismissed:this.urlChangeDismissed}))}}jr(Fr,"propTypes",{currentTeamId:y().string.isRequired,canCreatePublicChannel:y().bool.isRequired,canCreatePrivateChannel:y().bool.isRequired,actions:y().shape({createChannel:y().func.isRequired,switchToChannel:y().func.isRequired,closeModal:y().func.isRequired}).isRequired}),jr(Fr,"defaultProps",{channelType:N.ZP.OPEN_CHANNEL});const Br=(0,n.connect)((function(e){const t=(0,u.kA)(e),s=(0,m.gO)(e);let n=!1,a=!1;return t&&(n=(0,Z.Ai)(e,{channel:s,team:t.id,permission:Ps.Z.CREATE_PUBLIC_CHANNEL}),a=(0,Z.Ai)(e,{channel:s,team:t.id,permission:Ps.Z.CREATE_PRIVATE_CHANNEL})),{currentTeamId:t.id,canCreatePrivateChannel:a,canCreatePublicChannel:n}}),(function(e){return{actions:(0,a.bindActionCreators)({createChannel:o.mi,switchToChannel:b.qZ,closeModal:H.M},e)}}))(Fr);var Gr=s(21843),Vr=s(32136),Kr=s(79097);function Yr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Wr extends M.PureComponent{static getDerivedStateFromProps(e,t){return{isSearch:e.isSearch,page:e.isSearch&&!t.isSearch?0:t.page}}constructor(e){super(e),Yr(this,"createChannelRow",(e=>{const t="".concat(e.display_name,", ").concat(e.purpose).toLowerCase();let s,n;const{shouldShowArchivedChannels:a}=this.props;return a&&(s=M.createElement("div",{className:"more-modal__icon-container"},M.createElement(Vr.Z,{className:"icon icon__archive"}))),e.shared&&(n=M.createElement(Kr.Z,{className:"shared-channel-icon",channelType:e.type,withTooltip:!0})),M.createElement("div",{className:"more-modal__row",key:e.id,id:"ChannelRow-".concat(e.name)},M.createElement("div",{className:"more-modal__details"},M.createElement("button",{onClick:this.handleJoin.bind(this,e),"aria-label":t,className:"style--none more-modal__name"},s,e.display_name,n),M.createElement("p",{className:"more-modal__description"},e.purpose)),M.createElement("div",{className:"more-modal__actions"},M.createElement("button",{onClick:this.handleJoin.bind(this,e),className:"btn btn-primary",disabled:this.state.joiningChannel},M.createElement(Gr.Z,{loading:this.state.joiningChannel===e.id,text:(0,I._u)("more_channels.joining","Joining...")},M.createElement(V.Z,{id:a?"more_channels.view":"more_channels.join",defaultMessage:a?"View":"Join"})))))})),Yr(this,"nextPage",(e=>{e.preventDefault(),this.setState({page:this.state.page+1,nextDisabled:!0}),this.nextTimeoutId=setTimeout((()=>this.setState({nextDisabled:!1})),500),this.props.nextPage(this.state.page+1),ra()(oa.findDOMNode(this.channelListScroll.current)).scrollTop(0)})),Yr(this,"previousPage",(e=>{e.preventDefault(),this.setState({page:this.state.page-1}),ra()(oa.findDOMNode(this.channelListScroll.current)).scrollTop(0)})),Yr(this,"doSearch",(()=>{const e=this.filter.current.value;this.props.search(e),""===e&&this.setState({page:0})})),Yr(this,"toggleArchivedChannelsOn",(()=>{this.props.toggleArchivedChannels(!0)})),Yr(this,"toggleArchivedChannelsOff",(()=>{this.props.toggleArchivedChannels(!1)})),this.nextTimeoutId=0,this.state={joiningChannel:"",page:0,nextDisabled:!1},this.filter=M.createRef(),this.channelListScroll=M.createRef()}componentDidMount(){!R.tq()&&this.filter.current&&this.filter.current.focus()}handleJoin(e){this.setState({joiningChannel:e.id}),this.props.handleJoin(e,(()=>{this.setState({joiningChannel:""})}))}render(){const e=this.props.channels;let t,s,n;if(this.props.loading&&0===e.length)t=M.createElement(Ga.Z,null);else if(0===e.length)t=M.createElement("div",{className:"no-channel-message"},M.createElement("p",{className:"primary-message"},M.createElement(V.Z,{id:"more_channels.noMore",defaultMessage:"No more channels to join"})),this.props.noResultsText);else{const e=this.state.page*this.props.channelsPerPage,a=e+this.props.channelsPerPage,i=this.props.channels.slice(e,a);t=i.map(this.createChannelRow),i.length>=this.props.channelsPerPage&&a<this.props.channels.length&&(s=M.createElement("button",{className:"btn btn-link filter-control filter-control__next",onClick:this.nextPage,disabled:this.state.nextDisabled},M.createElement(V.Z,{id:"more_channels.next",defaultMessage:"Next"}))),this.state.page>0&&(n=M.createElement("button",{className:"btn btn-link filter-control filter-control__prev",onClick:this.previousPage},M.createElement(V.Z,{id:"more_channels.prev",defaultMessage:"Previous"})))}let a,i=M.createElement("div",{className:"filter-row filter-row--full"},M.createElement("div",{className:"col-sm-12"},M.createElement(Ki.Z,{id:"searchChannelsTextbox",ref:this.filter,className:"form-control filter-textbox",placeholder:{id:(0,Ae.t)("filtered_channels_list.search"),defaultMessage:"Search channels"},inputComponent:pa.Z,onInput:this.doSearch})));return this.props.createChannelButton&&(i=M.createElement("div",{className:"channel_search"},M.createElement("div",{className:"search_input"},M.createElement(Ki.Z,{id:"searchChannelsTextbox",ref:this.filter,className:"form-control filter-textbox",placeholder:{id:(0,Ae.t)("filtered_channels_list.search"),defaultMessage:"Search channels"},inputComponent:pa.Z,onInput:this.doSearch})),M.createElement("div",{className:"create_button"},this.props.createChannelButton))),this.props.canShowArchivedChannels&&(a=M.createElement("div",{className:"more-modal__dropdown"},M.createElement(Os.Z,{id:"channelsMoreDropdown"},M.createElement("a",null,M.createElement("span",null,this.props.shouldShowArchivedChannels?(0,I._u)("more_channels.show_archived_channels","Show: Archived Channels"):(0,I._u)("more_channels.show_public_channels","Show: Public Channels")),M.createElement("span",{className:"caret"})),M.createElement(Is.Z,{openLeft:!1,ariaLabel:(0,I._u)("team_members_dropdown.menuAriaLabel","Change the role of a team member")},M.createElement(Is.Z.ItemAction,{id:"channelsMoreDropdownPublic",onClick:this.toggleArchivedChannelsOff,text:(0,I._u)("suggestion.search.public","Public Channels")}),M.createElement(Is.Z.ItemAction,{id:"channelsMoreDropdownArchived",onClick:this.toggleArchivedChannelsOn,text:(0,I._u)("suggestion.archive","Archived Channels")}))))),M.createElement("div",{className:"filtered-user-list"},i,a,M.createElement("div",{role:"application",ref:"channelList",className:"more-modal__list"},M.createElement("div",{id:"moreChannelsList",ref:this.channelListScroll},t)),M.createElement("div",{className:"filter-controls"},n,s))}}function zr(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Wr.defaultProps={channels:[],isSearch:!1},Wr.propTypes={channels:y().arrayOf(y().object),channelsPerPage:y().number,nextPage:y().func.isRequired,isSearch:y().bool,search:y().func.isRequired,handleJoin:y().func.isRequired,noResultsText:y().object,loading:y().bool,createChannelButton:y().element,toggleArchivedChannels:y().func.isRequired,shouldShowArchivedChannels:y().bool.isRequired,canShowArchivedChannels:y().bool.isRequired};class Jr extends M.PureComponent{constructor(e){super(e),zr(this,"searchTimeoutId",void 0),zr(this,"handleHide",(()=>{this.setState({show:!1}),this.props.bodyOnly&&this.handleExit()})),zr(this,"handleNewChannel",(()=>{this.handleExit(),this.props.actions.openModal({modalId:N.r8.NEW_CHANNEL_FLOW,dialogType:Br})})),zr(this,"handleExit",(()=>{this.props.actions.closeModal(N.r8.MORE_CHANNELS)})),zr(this,"onChange",(e=>{this.state.search&&!e||this.setState({searchedChannels:[],serverError:null})})),zr(this,"nextPage",(e=>{this.props.actions.getChannels(this.props.teamId,e+1,50)})),zr(this,"handleJoin",(async(e,t)=>{const{actions:s,currentUserId:n,teamId:a,teamName:i}=this.props,r=await s.joinChannel(n,a,e.id);r.error?this.setState({serverError:r.error.message}):(st.m.push((0,Sn.d0)(i,e.name)),this.handleHide()),t&&t()})),zr(this,"search",(e=>{if(clearTimeout(this.searchTimeoutId),""===e)return this.onChange(!0),this.setState({search:!1,searchedChannels:[],searching:!1,searchTerm:e}),void(this.searchTimeoutId=0);this.setState({search:!0,searching:!0,searchTerm:e});const t=window.setTimeout((async()=>{try{const{data:s}=await this.props.actions.searchMoreChannels(e,this.state.shouldShowArchivedChannels);if(t!==this.searchTimeoutId)return;s?this.setSearchResults(s):this.setState({searchedChannels:[],searching:!1})}catch(e){this.setState({searchedChannels:[],searching:!1})}}),100);this.searchTimeoutId=t})),zr(this,"setSearchResults",(e=>{this.setState({searchedChannels:this.state.shouldShowArchivedChannels?e.filter((e=>0!==e.delete_at)):e.filter((e=>0===e.delete_at)),searching:!1})})),zr(this,"toggleArchivedChannels",(e=>{this.search(this.state.searchTerm),this.setState({shouldShowArchivedChannels:e})})),this.searchTimeoutId=0,this.state={show:!0,shouldShowArchivedChannels:"private"===this.props.morePublicChannelsModalType,search:!1,searchedChannels:[],serverError:null,searching:!1,searchTerm:""}}componentDidMount(){this.props.actions.getChannels(this.props.teamId,0,100),this.props.canShowArchivedChannels&&this.props.actions.getArchivedChannels(this.props.teamId,0,100)}render(){const{channels:e,archivedChannels:t,teamId:s,channelsRequestStarted:n,bodyOnly:a}=this.props,{search:i,searchedChannels:r,serverError:o,show:l,searching:c,shouldShowArchivedChannels:d}=this.state;let h,p;h=d?i?r:t:i?r:e,o&&(p=M.createElement("div",{className:"form-group has-error"},M.createElement("label",{className:"control-label"},o)));const u=M.createElement(vs.Z,{teamId:s,permissions:[Ps.Z.CREATE_PUBLIC_CHANNEL]},M.createElement("button",{id:"createNewChannel",type:"button",className:"btn btn-primary channel-create-btn",onClick:this.handleNewChannel},M.createElement(V.Z,{id:"more_channels.create",defaultMessage:"Create Channel"}))),m=M.createElement(vs.Z,{teamId:s,permissions:[Ps.Z.CREATE_PUBLIC_CHANNEL,Ps.Z.CREATE_PRIVATE_CHANNEL]},M.createElement("p",{className:"secondary-message"},M.createElement(V.Z,{id:"more_channels.createClick",defaultMessage:"Click 'Create New Channel' to make a new one"}))),g=M.createElement(M.Fragment,null,M.createElement(Wr,{channels:h,channelsPerPage:50,nextPage:this.nextPage,isSearch:i,search:this.search,handleJoin:this.handleJoin,noResultsText:m,loading:i?c:n,createChannelButton:a&&u,toggleArchivedChannels:this.toggleArchivedChannels,shouldShowArchivedChannels:this.state.shouldShowArchivedChannels,canShowArchivedChannels:this.props.canShowArchivedChannels}),p);return a?g:M.createElement(G.Z,{dialogClassName:"a11y__modal more-modal more-modal--action",show:l,onHide:this.handleHide,onExited:this.handleExit,role:"dialog",id:"moreChannelsModal","aria-labelledby":"moreChannelsModalLabel"},M.createElement(G.Z.Header,{id:"moreChannelsModalHeader",closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"moreChannelsModalLabel"},M.createElement(V.Z,{id:"more_channels.title",defaultMessage:"More Channels"})),u),M.createElement(G.Z.Body,null,g))}}zr(Jr,"propTypes",{channels:y().array.isRequired,archivedChannels:y().array.isRequired,currentUserId:y().string.isRequired,teamId:y().string.isRequired,teamName:y().string.isRequired,channelsRequestStarted:y().bool,bodyOnly:y().bool,canShowArchivedChannels:y().bool,morePublicChannelsModalType:y().string,actions:y().shape({getChannels:y().func.isRequired,getArchivedChannels:y().func.isRequired,joinChannel:y().func.isRequired,searchMoreChannels:y().func.isRequired,openModal:y().func.isRequired,closeModal:y().func.isRequired}).isRequired});const Xr=(0,Jt.P1)(m.Gc,(e=>e&&e.filter((e=>0===e.delete_at)))),Qr=(0,Jt.P1)(m.zE,(e=>e&&e.filter((e=>0!==e.delete_at)))),$r=(0,n.connect)((function(e){const t=(0,u.kA)(e)||{};return{channels:Xr(e)||[],archivedChannels:Qr(e)||[],currentUserId:(0,p.rc)(e),teamId:t.id,teamName:t.name,channelsRequestStarted:e.requests.channels.getChannels.status===D.eE.STARTED,canShowArchivedChannels:"true"===(0,h.iE)(e).ExperimentalViewArchivedChannels}}),(function(e){return{actions:(0,a.bindActionCreators)({getChannels:o.Ky,getArchivedChannels:o.ey,joinChannel:o.JJ,searchMoreChannels:Ii.Hy,openModal:H.h,closeModal:H.M},e)}}))(Jr);var eo=s(2913),to=s(84827),so=s(81214),no=s(46919),ao=s(37060),io=s(49671),ro=s(13516);function oo(e){return M.createElement("div",{className:"FilesFilterMenu"},M.createElement(Os.Z,null,M.createElement("span",{className:"action-icon dots-icon"},"all"!==e.selectedFilter&&M.createElement("i",{className:"icon-dot"}),M.createElement("i",{className:"icon icon-filter-variant"})),M.createElement(Is.Z,{ariaLabel:"file menu",openLeft:!0},M.createElement(Is.Z.ItemAction,{ariaLabel:"All file types",text:"All file types",onClick:()=>e.onFilter("all"),icon:"all"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}),M.createElement(Is.Z.ItemAction,{ariaLabel:"Documents",text:"Documents",onClick:()=>e.onFilter("documents"),icon:"documents"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}),M.createElement(Is.Z.ItemAction,{ariaLabel:"Spreadsheets",text:"Spreadsheets",onClick:()=>e.onFilter("spreadsheets"),icon:"spreadsheets"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}),M.createElement(Is.Z.ItemAction,{ariaLabel:"Presentations",text:"Presentations",onClick:()=>e.onFilter("presentations"),icon:"presentations"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}),M.createElement(Is.Z.ItemAction,{ariaLabel:"Code",text:"Code",onClick:()=>e.onFilter("code"),icon:"code"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}),M.createElement(Is.Z.ItemAction,{ariaLabel:"Images",text:"Images",onClick:()=>e.onFilter("images"),icon:"images"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}),M.createElement(Is.Z.ItemAction,{ariaLabel:"Audio",text:"Audio",onClick:()=>e.onFilter("audio"),icon:"audio"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}),M.createElement(Is.Z.ItemAction,{ariaLabel:"Videos",text:"Videos",onClick:()=>e.onFilter("video"),icon:"video"===e.selectedFilter?M.createElement("i",{className:"icon icon-check"}):null}))))}oo.propTypes={selectedFilter:y().string.isRequired,onFilter:y().func.isRequired};const{KeyCodes:lo}=N.ZP;function co(e){return M.createElement("div",{className:"MessagesOrFilesSelector"},M.createElement("div",{className:"buttons-container"},M.createElement("button",{onClick:()=>e.onChange("messages"),onKeyDown:t=>I.pD(t,lo.ENTER)&&e.onChange("messages"),className:"messages"===e.selected?"active tab messages-tab":"tab messages-tab"},M.createElement(V.Z,{id:"search_bar.messages_tab",defaultMessage:"Messages"}),M.createElement("span",{className:"counter"},e.messagesCounter)),M.createElement("button",{onClick:()=>e.onChange("files"),onKeyDown:t=>I.pD(t,lo.ENTER)&&e.onChange("files"),className:"files"===e.selected?"active tab files-tab":"tab files-tab"},M.createElement(V.Z,{id:"search_bar.files_tab",defaultMessage:"Files"}),M.createElement("span",{className:"counter"},e.filesCounter))),"files"===e.selected&&M.createElement(oo,{selectedFilter:e.selectedFilter,onFilter:e.onFilter}))}co.propTypes={selected:y().string.isRequired,messagesCounter:y().string.isRequired,filesCounter:y().string.isRequired,onChange:y().func.isRequired,onFilter:y().func.isRequired};const ho="files",po="messages",uo=e=>M.createElement("div",Object.assign({},e,{className:"scrollbar--view"})),mo=e=>M.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"})),go=e=>M.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"})),fo=e=>{const t=(0,M.useRef)(null),[s,n]=(0,M.useState)(e.searchType),a=(0,Ys.Z)();(0,M.useEffect)((()=>{var s;"all"!==e.searchFilterType&&e.setSearchFilterType("all"),n(e.searchType),null===(s=t.current)||void 0===s||s.scrollToTop()}),[e.searchTerms]),(0,M.useEffect)((()=>{0!==e.searchPage||e.isChannelFiles||setTimeout((()=>{e.getMorePostsForSearch()}),100)}),[e.searchPage,e.searchTerms]);const i=(0,cn.Ds)((()=>{e.getMoreFlaggedPosts()}),100,!1,(()=>{})),{results:r,fileResults:o,isSearchAtEnd:l,isSearchFilesAtEnd:c,isFlaggedPosts:d,isSearchingFlaggedPost:h,isFlaggedGettingMore:p,handleSearchHintSelection:u,searchFilterType:m,setSearchFilterType:g}=e,f=!r||!Array.isArray(r)||0===r.length,E=!o||!Array.isArray(o)||0===o.length,C=h&&!p,b=!(s===po&&l||s===ho&&c)&&p,_=!d;let v,y,P=r;const w={},S={variant:ro.U.ChannelSearch};d?(S.variant=ro.U.FlaggedPosts,S.subtitleValues={icon:M.createElement(ao.Z,{className:"icon  no-results__mini_icon"})},w.id="search_header.title3",w.defaultMessage="Saved Posts"):f&&E?(w.id="search_header.search",w.defaultMessage="Search"):(w.id="search_header.results",w.defaultMessage="Search Results");const T=a.formatMessage(w),R=()=>{u()};switch(!0){case C:v=M.createElement("div",{className:"sidebar--right__subheader a11y__section"},M.createElement("div",{className:"sidebar--right__loading"},M.createElement(Gr.Z,{text:I._u("search_header.loading","Searching")})));break;case f&&!d:v=M.createElement("div",{className:"sidebar--right__subheader search__hints a11y__section"},M.createElement(no.Z,{onOptionSelected:R,options:N.M9}));break;default:s===ho&&(P=o),v=P.map(((t,n)=>s!==po||e.isChannelFiles?M.createElement(io.Z,{key:t.id,fileInfo:t,teamName:e.currentTeamName,channelType:e.channels[t.channel_id]&&e.channels[t.channel_id].type,channelDisplayName:e.channels[t.channel_id]&&e.channels[t.channel_id].display_name}):M.createElement(so.Z,{key:t.id,compactDisplay:e.compactDisplay,post:t,channelName:e.channels[t.channel_id]&&e.channels[t.channel_id].display_name,channelType:e.channels[t.channel_id]&&e.channels[t.channel_id].type,channelIsArchived:e.channels[t.channel_id]&&0!==e.channels[t.channel_id].delete_at,matches:e.matches[t.id],term:"",isMentionSearch:!1,a11yIndex:n,isFlaggedPosts:e.isFlaggedPosts,isPinnedPosts:!1}))),y=b?M.createElement("div",{className:"loading-screen"},M.createElement("div",{className:"loading__content"},M.createElement("div",{className:"round round-1"}),M.createElement("div",{className:"round round-2"}),M.createElement("div",{className:"round round-3"}))):null}return M.createElement("div",{id:"searchContainer",className:"SearchResults sidebar-right__body"},M.createElement(Rt.Z,null,T,e.channelDisplayName&&M.createElement("div",{className:"sidebar--right__title__channel"},e.channelDisplayName)),_&&M.createElement(co,{selected:s,selectedFilter:m,messagesCounter:l||0===e.searchPage?"".concat(r.length):"".concat(r.length,"+"),filesCounter:c||0===e.searchPage?"".concat(o.length):"".concat(o.length,"+"),onChange:n,onFilter:g}),M.createElement(dt.ZP,{ref:t,autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:mo,renderThumbVertical:go,renderView:uo,onScroll:()=>{if(e.isFlaggedPosts&&!e.isFlaggedGettingMore&&!e.isSearchAtEnd){var s,n,a;const e=(null===(s=t.current)||void 0===s?void 0:s.getScrollHeight())||0;((null===(n=t.current)||void 0===n?void 0:n.getScrollTop())||0)+((null===(a=t.current)||void 0===a?void 0:a.getClientHeight())||0)+30>=e&&i()}}},M.createElement("div",{id:"search-items-container",role:"application",className:W()(["search-items-container post-list__table a11y__region",{"no-results":f&&s===po||E&&s===ho,"channel-files-container":!1}]),"data-a11y-sort-order":"3","data-a11y-focus-child":!0,"data-a11y-loop-navigation":!1,"aria-label":a.formatMessage({id:"accessibility.sections.rhs",defaultMessage:"{regionTitle} complimentary region"},{regionTitle:T})},v,y)))};fo.defaultProps={isCard:!1,isOpened:!1,channelDisplayName:"",children:null};const Eo=(e,t)=>{for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&"results"!==s&&Object.prototype.hasOwnProperty.call(t,s)&&"fileResults"!==s&&t[s]!==e[s])return!1;const{results:s}=e,{results:n}=t;if(s.length!==n.length)return!1;for(let e=0;e<s.length;e++)if(s[e]!==n[e])return!1;const{fileResults:a}=e,{fileResults:i}=t;if(a.length!==i.length)return!1;for(let e=0;e<a.length;e++)if(a[e]!==i[e])return!1;return!0},Co=M.memo(fo,Eo),bo=(0,n.connect)((function(){let e,t,s,n=[];return function(a){var i;const r="true"===(0,h.iE)(a).ExperimentalViewArchivedChannels,o=(0,Qe.ud)(a),l={};o&&o!==e&&(e=o,s=[],e.forEach((e=>{if(!e)return;const t=(0,m.mr)(a,e.channel_id);t&&0!==t.delete_at&&!r||(l[e.channel_id]=t,s.push(e))})));const c=(0,ue.lJ)(a);c&&c!==t&&(t=c,n=[],t.forEach((e=>{if(!e)return;const t=(0,m.mr)(a,e.channel_id);t&&0!==t.delete_at&&!r||n.push(e)}))),t.forEach((e=>{if(!e)return;const t=(0,m.mr)(a,e.channel_id);l[e.channel_id]=t})),e.forEach((e=>{if(!e)return;const t=(0,m.mr)(a,e.channel_id);l[e.channel_id]=t}));const p=(0,to.xV)(a)||{};return{results:o,fileResults:n,channels:l,matches:(0,Qe.Or)(a),searchTerms:"",isSearchingFlaggedPost:(0,Ke.Nz)(a),isFlaggedGettingMore:(0,Ke.ni)(a),isSearchAtEnd:p.isEnd,isSearchFilesAtEnd:p.isFilesEnd,searchPage:null===(i=p.params)||void 0===i?void 0:i.page,compactDisplay:d.U2(a,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.MESSAGE_DISPLAY,N.uP.MESSAGE_DISPLAY_DEFAULT)===N.uP.MESSAGE_DISPLAY_COMPACT,currentTeamName:(0,u.kA)(a).name}}}))(Co),_o=e=>{const{actions:t}=e;return(0,M.useEffect)((()=>{e.show&&t.getFlaggedPosts()}),[e.show]),M.createElement("div",{className:"sidebar--saved-post"},M.createElement("div",{className:"sidebar--right-container"},M.createElement("div",{className:"sidebar--right__content"},M.createElement(bo,{isFlaggedPosts:!0,isChannelFiles:!1,shrink:()=>{},channelDisplayName:e.channelDisplayName,isOpened:!0,updateSearchTerms:()=>{},handleSearchHintSelection:()=>{},getMoreFlaggedPosts:e.actions.getMoreFlaggedPosts,searchFilterType:"all",setSearchType:()=>{},searchType:"messages"}))))};_o.defaultProps={channelDisplayName:"",show:!1};const vo=M.memo(_o),yo=(0,n.connect)((function(e){return{currentChannel:(0,m.TB)(e),searchType:"",isFlaggedPosts:!0,isSearchingFlaggedPost:(0,Ke.Nz)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getFlaggedPosts:eo.jP,getMoreFlaggedPosts:eo.u$},e)}}))(vo);var Mo=s(29361),Po=s(79247);class wo extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 640 512",fill:"none",stroke:"currentColor"},M.createElement("path",{fill:"currentColor",d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"})))}}function So(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function To(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const No={useTime:!1,style:"long",ranges:[{within:["minute",-1],display:["second",0]},{within:["hour",-1],display:["minute"]},{within:["hour",-24],display:["hour"]},{within:["day",-30],display:["day"]},{within:["month",-11],display:["month"]},{within:["year",-1e3],display:["year"]}]};function Ro(e){return"G"===(null==e?void 0:e.type)}function Io(e){return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?So(Object(s),!0).forEach((function(t){To(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):So(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({value:e.id,label:Ro(e)?e.display_name:e.username},e)}class Oo extends M.PureComponent{constructor(e){super(e),To(this,"searchTimeoutId",void 0),To(this,"exitToChannel",void 0),To(this,"multiselect",void 0),To(this,"selectedItemRef",void 0),To(this,"loadModalData",(()=>{this.setState({loadingUsers:!1})})),To(this,"loadProfilesMissingStatus",((e=[],t={})=>{const s=e.filter((e=>!t[e.id])).map((e=>e.id));s.length>0&&this.props.actions.getStatusesByIds(s)})),To(this,"handleHide",(e=>{this.props.actions.setModalSearchTerm(""),this.setState({show:!1}),this.props.bodyOnly&&this.handleExit(e)})),To(this,"setUsersLoadingState",(e=>{this.setState({loadingUsers:e})})),To(this,"handleExit",(e=>{var t,s,n,a;this.exitToChannel&&st.m.push(this.exitToChannel),null===(t=(s=this.props).onModalDismissed)||void 0===t||t.call(s,e),null===(n=(a=this.props).onHide)||void 0===n||n.call(a)})),To(this,"handleSubmit",((e=this.state.values)=>{const{actions:t}=this.props;if(this.state.saving)return;const s=e.map((e=>e.id));if(0===s.length)return;this.setState({saving:!0});const n=e=>{const{data:t,error:s}=e;this.setState({saving:!1}),s||(this.exitToChannel="/"+this.props.currentTeamName+"/group/"+t.name,this.handleHide())};1===s.length?t.openDirectChannelToUserId(s[0]).then(n):t.openGroupChannelToUserIds(s).then(n)})),To(this,"addValue",(e=>{this.handleExit(e)})),To(this,"addUsers",(e=>{const t=Object.assign([],this.state.values),s=t.map((e=>e.id));for(const n of e)-1===s.indexOf(n.id)&&t.push(Io(n));this.setState({values:t})})),To(this,"getUserProfiles",(e=>{const t=e?e+1:0;"any"===this.props.restrictDirectMessage?this.props.actions.getProfiles(t,100).then((()=>{this.setUsersLoadingState(!1)})):this.props.actions.getProfilesInTeam(this.props.currentTeamId,t,100).then((()=>{this.setUsersLoadingState(!1)}))})),To(this,"handlePageChange",((e,t)=>{e>t&&(this.setUsersLoadingState(!0),this.getUserProfiles(e))})),To(this,"resetPaging",(()=>{var e;null===(e=this.multiselect.current)||void 0===e||e.resetPaging()})),To(this,"search",rr()((e=>{this.props.actions.setModalSearchTerm(e)}),250)),To(this,"handleDelete",(e=>{this.setState({values:e})})),To(this,"renderAriaLabel",(e=>{var t;return null!==(t=null==e?void 0:e.username)&&void 0!==t?t:""})),To(this,"optionDisplayParts",(e=>{if(Ro(e))return M.createElement(M.Fragment,null,M.createElement("div",{className:"more-modal__gm-icon bg-text-200"},e.profiles.length),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},M.createElement("span",null,e.profiles.map((e=>"@".concat(e.username))).join(", ")))));const{id:t,delete_at:s,is_bot:n=!1,last_picture_update:a}=e,i=(0,I.bj)(e);let r=i;return e.id===this.props.currentUserId?r=M.createElement(V.Z,{id:"more_direct_channels.directchannel.you",defaultMessage:"{displayname} (you)",values:{displayname:i}}):e.delete_at&&(r=M.createElement(V.Z,{id:"more_direct_channels.directchannel.deactivated",defaultMessage:"{displayname} - Deactivated",values:{displayname:i}})),M.createElement(M.Fragment,null,M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(t,a),status:s||n?void 0:this.props.statuses[t],size:"md"}),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},r,M.createElement(Cn.Z,{show:n,className:"badge-popoverlist"}),M.createElement(En.Z,{show:(0,I.a_)(e),className:"badge-popoverlist"}),M.createElement(cr.Z,{userID:e.id,showTooltip:!0,emojiSize:15})),!n&&M.createElement("div",{className:"more-modal__description"},e.email)))})),To(this,"handleSubmitImmediatelyOn",(e=>e.id===this.props.currentUserId||Boolean(e.delete_at))),To(this,"note",(()=>{let e;return this.props.currentChannelMembers&&(this.state.values&&this.state.values.length>=1?e=M.createElement(V.Z,{id:"more_direct_channels.new_convo_note.full",defaultMessage:"You've reached the maximum number of people for this conversation. Consider creating a private channel instead."}):this.props.isExistingChannel&&(e=M.createElement(V.Z,{id:"more_direct_channels.new_convo_note",defaultMessage:"This will start a new conversation. If you're adding a lot of people, consider creating a private channel instead."}))),e})),To(this,"renderOptionValue",((e,t,s,n)=>{const{id:a,last_post_at:i}=e;return M.createElement("div",{key:a,ref:t?this.selectedItemRef:e.id,className:W()("more-modal__row clickable",{"more-modal__row--selected":t}),onClick:()=>s(e),onMouseEnter:()=>n(e)},this.optionDisplayParts(e),!(0,I.tq)()&&Boolean(i)&&M.createElement("div",{className:"more-modal__lastPostAt"},M.createElement(lr.ZP,Object.assign({},No,{value:i}))),M.createElement("div",{className:"more-modal__actions"},M.createElement("div",{className:"more-modal__actions--round"},M.createElement(Za.Z,null))))})),To(this,"computeOptions",(()=>{const{currentUserId:e,searchTerm:t,myDirectChannels:s,recentDMUsers:n=[]}=this.props,{values:a}=this.state,[i,r]=ar()(this.props.users,(({delete_at:e})=>0===e)),o=this.props.groupChannels.filter((({profiles:e})=>sr()(e,a,"id").length)),[l,c]=ar()(o,"last_post_at");let d=a.length?i.filter((({id:t})=>t!==e)):i.concat(r);d=d.filter((e=>(0===e.delete_at||s.some((({name:t})=>t.includes(e.id))))&&!n.some((({id:t})=>t===e.id))));const h=[...a.length?n.filter((({id:t})=>t!==e)):n,...l].sort(((e,t)=>t.last_post_at-e.last_post_at));return h.length&&!t?h.slice(0,20):[...h,...d,...c]})),this.searchTimeoutId=0,this.multiselect=M.createRef(),this.selectedItemRef=M.createRef();const t=[];if(e.currentChannelMembers)for(let s=0;s<e.currentChannelMembers.length;s++){const n=Object.assign({},e.currentChannelMembers[s]);n.id!==e.currentUserId&&t.push(Io(n))}this.state={values:t,show:!0,search:!1,saving:!1,loadingUsers:!0}}updateFromProps(e){if(e.searchTerm!==this.props.searchTerm){clearTimeout(this.searchTimeoutId);const e=this.props.searchTerm;if(""===e)this.resetPaging();else{const t="any"===this.props.restrictDirectMessage?"":this.props.currentTeamId;this.searchTimeoutId=setTimeout((async()=>{this.setUsersLoadingState(!0);const[{data:s},{data:n}]=await Promise.all([this.props.actions.searchProfiles(e,{team_id:t}),this.props.actions.searchGroupChannels(e)]);s&&this.props.actions.loadStatusesForProfilesList(s),n&&this.props.actions.loadProfilesForGroupChannels(n),this.resetPaging(),this.setUsersLoadingState(!1)}),N.ZP.SEARCH_TIMEOUT_MILLISECONDS)}}e.users.length===this.props.users.length&&Object.keys(e.statuses).length===Object.keys(this.props.statuses).length||this.loadProfilesMissingStatus(this.props.users,this.props.statuses)}componentDidUpdate(e){this.updateFromProps(e)}renderValue(e){return e.data.username}render(){const{bodyOnly:e}=this.props,{values:t}=this.state,s=(0,I._u)("multiselect.go","Find"),n=(0,I._u)("multiselect.loading","Loading..."),a=M.createElement(V.Z,{id:"multiselect.oneselect",defaultMessage:"Use ↑↓ to browse, ↵ to select.",values:{num:1-t.length}}),i=M.createElement(xa.Z,{key:"moreDirectChannelsList",ref:this.multiselect,options:this.computeOptions().map(Io),optionRenderer:this.renderOptionValue,selectedItemRef:this.selectedItemRef,values:this.state.values,valueRenderer:this.renderValue,ariaLabelRenderer:this.renderAriaLabel,perPage:50,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,noteText:this.note(),maxValues:1,numRemainingText:a,buttonSubmitText:s,buttonSubmitLoadingText:n,submitImmediatelyOn:this.handleSubmitImmediatelyOn,saving:this.state.saving,loading:this.state.loadingUsers,users:this.props.users,totalCount:this.props.totalCount,placeholderText:(0,I._u)("multiselect.placeholder","Search and add members")});return e?i:M.createElement(G.Z,{dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:()=>this.handleHide(),onExited:()=>this.handleExit(),onEntered:this.loadModalData,role:"dialog","aria-labelledby":"moreDmModalLabel",id:"moreDmModal"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"moreDmModalLabel"},M.createElement(V.Z,{id:"contacts.modal_search.title",defaultMessage:"Find users"}))),M.createElement(G.Z.Body,{role:"application"},i),M.createElement(G.Z.Footer,{className:"modal-footer--invisible"},M.createElement("button",{id:"closeModalButton",type:"button",className:"btn btn-link"},M.createElement(V.Z,{id:"general_button.close",defaultMessage:"Close"}))))}}function Lo(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Ao(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(s),!0).forEach((function(t){ko(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Lo(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ko(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}To(Oo,"propTypes",{currentUserId:y().string.isRequired,currentTeamId:y().string.isRequired,currentTeamName:y().string.isRequired,searchTerm:y().string.isRequired,users:y().array.isRequired,groupChannels:y().array.isRequired,myDirectChannels:y().array.isRequired,totalCount:y().number,currentChannelMembers:y().array.isRequired,isExistingChannel:y().bool.isRequired,restrictDirectMessage:y().string,onModalDismissed:y().func.isRequired,onHide:y().func,bodyOnly:y().bool,actions:y().shape({getProfiles:y().func.isRequired,getProfilesInTeam:y().func.isRequired,getStatusesByIds:y().func.isRequired,getTotalUsersStats:y().func.isRequired,loadStatusesForProfilesList:y().func.isRequired,loadProfilesForGroupChannels:y().func.isRequired,openDirectChannelToUserId:y().func.isRequired,openGroupChannelToUserIds:y().func.isRequired,searchProfiles:y().func.isRequired,searchGroupChannels:y().func.isRequired,setModalSearchTerm:y().func.isRequired}).isRequired});const xo=(0,dn.GA)(((e,t)=>e.filter((e=>(0,er.vI)(e.profiles,t).length>0)))),Do=(0,dn.GA)(((e,t)=>Object.values(e).filter((e=>e.type===N.gT.DM_CHANNEL&&e.name.includes(t))))),Zo=(0,n.connect)((()=>{const e=(0,p.uZ)();return(t,s)=>{const n=(0,p.rc)(t);let a=[];s.isExistingChannel&&(a=(0,p.OX)(t));const i=(0,h.iE)(t).RestrictDirectMessage,r=t.views.search.modalSearch;let o;o=r?"any"===i?e(t,r,!1):(0,p.lo)(t,r,!1):"any"===i?(0,p.cp)(t,{}):(0,p.fv)(t);const l=xo((0,m.P6)(t),r),c=Do((0,m.IU)(t),n);let d=c.reduce(((e,s)=>{if(!s.last_post_at)return e;const a=(0,p.PR)(t,(0,$i.aU)(n,s.name));return a&&e.push(Ao(Ao({},a),{},{last_post_at:s.last_post_at})),e}),[]);r&&(d=Qi()(d,o,"id"));const g=(0,u.kA)(t),f=(0,p.S1)(t)||{total_users_count:0};return{currentTeamId:g.id,currentTeamName:g.name,searchTerm:r,users:o.sort(er.gh),myDirectChannels:c,groupChannels:l,recentDMUsers:d,statuses:t.entities.users.statuses,currentChannelMembers:a,currentUserId:n,restrictDirectMessage:i,totalCount:f.total_users_count}}}),(function(e){return{actions:(0,a.bindActionCreators)({getProfiles:r.cp,getProfilesInTeam:r.gV,getStatusesByIds:r.W7,getTotalUsersStats:r.S1,loadStatusesForProfilesList:E.xO,loadProfilesForGroupChannels:Le.Tg,openDirectChannelToUserId:Ii.Pn,openGroupChannelToUserIds:Ii.iU,searchProfiles:r.t6,searchGroupChannels:o.PP,setModalSearchTerm:ws.Gl},e)}}))(Oo);var Ho=s(2535),qo=s(62831);const jo=M.forwardRef(((e,t)=>M.createElement("div",{className:"SidebarChannelGroupHeader SidebarChannelGroupHeader--static"},M.createElement("div",{ref:t,className:"SidebarChannelGroupHeader_groupButton"},M.createElement("div",{className:"SidebarChannelGroupHeader_text"},(0,qo.Y)(e.displayName)),e.children))));jo.propTypes={children:y().node,displayName:y().string.isRequired},jo.displayName="SidebarCategoryHeaderStatic";const Uo=M.forwardRef(((e,t)=>M.createElement("div",{className:W()("SidebarChannelGroupHeader",{muted:e.muted})},M.createElement("button",{ref:t,className:W()("SidebarChannelGroupHeader_groupButton",{dragging:e.isDragging}),"aria-label":e.displayName,onClick:e.onClick},M.createElement("i",{className:W()("icon icon-chevron-down",{"icon-rotate-minus-90":e.isCollapsed,"hide-arrow":!e.isCollapsible})}),M.createElement("div",Object.assign({className:"SidebarChannelGroupHeader_text"},e.dragHandleProps),(0,qo.Y)(e.displayName))),e.children)));Uo.propTypes={children:y().node,displayName:y().string.isRequired,isCollapsed:y().bool.isRequired,isCollapsible:y().bool,isDragging:y().bool,isDraggingOver:y().bool,muted:y().bool.isRequired,onClick:y().func.isRequired},Uo.defaultProps={isCollapsible:!0,isDragging:!1,isDraggingOver:!1},Uo.displayName="SidebarCategoryHeader";class Fo extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})))}}function Bo(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function Go(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function Vo(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--verticalTrack"}))}function Ko(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}function Yo(e){var t,s;const n=(0,Ys.Z)(),a=(0,M.createRef)(),[i,r]=(0,M.useState)(!1),o=rr()((()=>{}),100),l=()=>{e.actions.toggleLhs()};let c=null;0===(null===(t=e.contacts)||void 0===t?void 0:t.length)&&(c=M.createElement("div",{className:"no-contact"},M.createElement(Fo,{className:"icon",classIcon:"contact-empty"}),M.createElement(V.Z,{id:"sidebar_left.contacts.empty",defaultMessage:"Chưa có liên hệ."}),M.createElement(vs.Z,{teamId:e.currentTeam.id,permissions:[D.Pl.CREATE_PRIVATE_CHANNEL,D.Pl.CREATE_PUBLIC_CHANNEL]},M.createElement("button",{className:"btn btn-primary add-contact",onClick:()=>e.onNewContact()},M.createElement(V.Z,{id:"sidebar_left.contacts.add_button",defaultMessage:"Thêm Liên hệ"})))));const d="/".concat(e.currentTeam.name,"/messages/");return M.createElement("div",{className:W()("SidebarContactGroup a11y__section",{dropDisabled:!0,isCollapsed:i})},M.createElement(Uo,{displayName:n.formatMessage({id:"sidebar_left.sidebar_contact.title",defaultMessage:"Danh bạ"}),isCollapsed:i,isCollapsible:!0,muted:!1,onClick:()=>r((e=>!e))}),M.createElement("div",{className:"SidebarContactGroup_content"},M.createElement("div",{className:W()("ContactItems animating",{collapsed:i})},c,M.createElement(dt.ZP,{ref:a,autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:Go,renderThumbVertical:Ko,renderTrackVertical:Vo,renderView:Bo,onScroll:o,style:{position:"absolute"}},M.createElement("ul",{role:"list",className:"NavGroupContent"},null===(s=e.contacts)||void 0===s?void 0:s.map((t=>M.createElement("li",{key:t.id,className:"contact-item"},M.createElement(ht.Link,{className:"contact-item",to:"".concat(d).concat(t.user_id),onClick:l},M.createElement("span",{className:"avatar"},M.createElement("img",{className:"Avatar Avatar-xl",alt:"user profile image",src:"/api/v1/users/".concat(t.user_id,"/image"),loading:"lazy"})),M.createElement("span",{className:"contact-name"},t.display_name),M.createElement("button",{className:"SidebarMenu_menuButton","aria-label":"Edit channel menu",onClick:s=>((t,s)=>{t.preventDefault(),e.onEditContact(s)})(s,t)},M.createElement("i",{className:"icon-dots-vertical"})))))))))))}Yo.propTypes={userId:y().string,isOpen:y().bool,hasSeenModal:y().bool,contacts:y().array.isRequired,onNewContact:y().func.isRequired,onEditContact:y().func.isRequired,actions:y().shape({toggleLhs:y().func.isRequired,fetchMyContacts:y().func.isRequired,openModal:y().func.isRequired}).isRequired};const Wo=(0,n.connect)((function(e){return{currentTeam:(0,u.kA)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({fetchMyContacts:()=>{},openModal:H.h,toggleLhs:Ho.ZN},e)}}))(Yo);var zo=s(37584);function Jo(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Xo extends M.PureComponent{constructor(e){super(e),Jo(this,"handleNewContact",(()=>{this.setState({enableModal:!0})})),Jo(this,"handleEditContact",(e=>{this.setState({enableModalDetail:!0,contact:e})})),Jo(this,"hideModal",(e=>{null!=e&&e.id?this.setState({enableModal:!1,enableModalDetail:!0,user:e}):this.setState({enableModal:!1})})),Jo(this,"hideDetailModal",(()=>{this.setState({enableModalDetail:!1,contact:void 0})})),Jo(this,"renderModals",(()=>{let e;return this.state.enableModal&&(e=M.createElement(Zo,{onModalDismissed:this.hideModal,isExistingChannel:!1})),M.createElement(M.Fragment,null,e)})),Jo(this,"renderModalDetail",(()=>{const{enableModalDetail:e,user:t,contact:s}=this.state,{createContact:n,updateContact:a,deleteContact:i}=this.props.actions;let r;return e&&(r=M.createElement(zo.Z,{onModalDismissed:this.hideDetailModal,user:t,contact:s,onCreate:n,onUpdate:a,onDelete:i})),M.createElement(M.Fragment,null,r)})),this.state={enableModal:!1,enableModalDetail:!1}}componentDidMount(){this.props.actions.getData(0)}render(){const{contacts:e,currentTeamId:t}=this.props;return M.createElement("div",{className:"sidebar-contacts"},M.createElement(vs.Z,{teamId:t,permissions:[D.Pl.CREATE_PRIVATE_CHANNEL,D.Pl.CREATE_PUBLIC_CHANNEL]},M.createElement("div",{className:"contact-actions"},M.createElement("button",{className:"new-contact",onClick:this.handleNewContact},M.createElement(wo,{className:"icon-add",classIcon:"icon-add-contact"}),M.createElement(V.Z,{id:"sidebar_left.contacts.add_button",defaultMessage:"Thêm Liên hệ"})))),M.createElement(Wo,{userId:this.props.userId,onNewContact:this.handleNewContact,onEditContact:this.handleEditContact,contacts:e}),this.renderModals(),this.renderModalDetail())}}Jo(Xo,"propTypes",{userId:y().string,contacts:y().array.isRequired,currentTeamId:y().string.isRequired,actions:y().shape({createContact:y().func.isRequired,updateContact:y().func.isRequired,deleteContact:y().func.isRequired,getData:y().func.isRequired}).isRequired});const Qo=(0,Jt.P1)(Po.K2,(e=>Object.values(e).sort(((e,t)=>e.display_name.localeCompare(t.display_name))))),$o=(0,n.connect)((function(e){const t=(0,u.ev)(e);return{userId:(0,Mr.rc)(e),contacts:Qo(e),currentTeamId:t}}),(function(e){return{actions:(0,a.bindActionCreators)({getData:(e,t)=>(0,Mo.K2)(e,t),createContact:Mo.rE,updateContact:e=>(0,Mo._n)(e.id,e),deleteContact:e=>(0,Mo.GK)(e)},e)}}))(Xo);var el=s(89922);function tl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class sl extends M.PureComponent{constructor(...e){super(...e),tl(this,"renderDropdownItems",(()=>{const{intl:e,canCreateChannel:t,canJoinPublicChannel:s}=this.props;let n,a;return s&&(n=M.createElement(Is.Z.ItemAction,{id:"showMoreChannels",onClick:this.props.showMoreChannelsModal,icon:M.createElement("i",{className:"icon-globe"}),text:e.formatMessage({id:"sidebar_left.add_channel_dropdown.browseChannels",defaultMessage:"Browse Channels"})})),t&&(a=M.createElement(Is.Z.ItemAction,{id:"showNewChannel",onClick:this.props.showNewChannelModal,icon:M.createElement("i",{className:"icon-plus"}),text:e.formatMessage({id:"sidebar_left.add_channel_dropdown.createNewChannel",defaultMessage:"Create New Channel"})})),M.createElement(M.Fragment,null,M.createElement(Is.Z.Group,null,n,a))}))}render(){const{intl:e,canCreateChannel:t,canJoinPublicChannel:s}=this.props;if(!t&&!s)return null;const n=M.createElement(et.Z,{id:"new-group-tooltip",className:"hidden-xs"},M.createElement(V.Z,{id:"sidebar_left.add_channel_dropdown.browseOrCreateChannels",defaultMessage:"Browse or create channels"}));return M.createElement(Os.Z,{className:"AddChannelDropdown"},M.createElement(tt.Z,{delayShow:500,placement:"bottom",overlay:n},M.createElement("button",{className:"AddChannelDropdown_dropdownButton","aria-label":e.formatMessage({id:"sidebar_left.add_channel_dropdown.dropdownAriaLabel",defaultMessage:"Add Channel Dropdown"})},M.createElement("i",{className:"icon-plus"}))),M.createElement(Is.Z,{id:"AddChannelDropdown",ariaLabel:e.formatMessage({id:"sidebar_left.add_channel_dropdown.dropdownAriaLabel",defaultMessage:"Add Channel Dropdown"})},this.renderDropdownItems()))}}tl(sl,"propTypes",{canCreateChannel:y().bool.isRequired,canJoinPublicChannel:y().bool.isRequired,showMoreChannelsModal:y().func.isRequired,showNewChannelModal:y().func.isRequired,showCreateCategoryModal:y().func.isRequired,handleOpenDirectMessagesModal:y().func.isRequired,unreadFilterEnabled:y().bool.isRequired});const nl=(0,K.ZP)(sl);function al(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class il extends M.PureComponent{constructor(...e){super(...e),al(this,"openQuickSwitcher",(e=>{e.preventDefault(),(0,Ye.L9)("ui","ui_sidebar_open_channel_switcher_v2"),this.props.actions.openModal({modalId:N.r8.QUICK_SWITCH,dialogType:el.Z})})),al(this,"goBack",(()=>{(0,Ye.L9)("ui","ui_history_back"),this.props.actions.goBack()})),al(this,"goForward",(()=>{(0,Ye.L9)("ui","ui_history_forward"),this.props.actions.goForward()}))}render(){let e="Ctrl+K";I.V5()&&(e="⌘K");const t=M.createElement("button",{className:"SidebarChannelNavigator_jumpToButton",onClick:this.openQuickSwitcher,"aria-label":I._u("sidebar_left.channel_navigator.channelSwitcherLabel","Channel Switcher")},M.createElement("i",{className:"icon icon-magnify"}),M.createElement(V.Z,{id:"sidebar_left.channel_navigator.jumpTo",defaultMessage:"Find channel"}),M.createElement("div",{className:"SidebarChannelNavigator_shortcutText"},e)),s=M.createElement(nl,{showNewChannelModal:this.props.showNewChannelModal,showMoreChannelsModal:this.props.showMoreChannelsModal,showCreateCategoryModal:this.props.showCreateCategoryModal,canCreateChannel:this.props.canCreateChannel,canJoinPublicChannel:this.props.canJoinPublicChannel,handleOpenDirectMessagesModal:this.props.handleOpenDirectMessagesModal,unreadFilterEnabled:this.props.unreadFilterEnabled});let n;if((0,R.P)()){const e=M.createElement(M.Fragment,null,M.createElement("button",{className:W()("SidebarChannelNavigator_backButton",{disabled:!this.props.canGoBack}),disabled:!this.props.canGoBack,onClick:this.goBack,"aria-label":I._u("sidebar_left.channel_navigator.goBackLabel","Back")},M.createElement("i",{className:"icon icon-arrow-left"})),M.createElement("button",{className:W()("SidebarChannelNavigator_forwardButton",{disabled:!this.props.canGoForward}),disabled:!this.props.canGoForward,onClick:this.goForward,"aria-label":I._u("sidebar_left.channel_navigator.goForwardLabel","Forward")},M.createElement("i",{className:"icon icon-arrow-right"})));n=M.createElement("div",{className:"SidebarChannelNavigator desktop"},t,M.createElement("div",{className:"SidebarContainer_filterAddChannel desktop"},M.createElement("div",{className:"SidebarContainer_rightContainer"},e),s))}else n=M.createElement("div",{className:"SidebarChannelNavigator webapp"},t,s);return n}}function rl(){return()=>(st.m.goBack(),{data:null})}function ol(){return()=>(st.m.goForward(),{data:null})}al(il,"propTypes",{canGoForward:y().bool.isRequired,canGoBack:y().bool.isRequired,canJoinPublicChannel:y().bool.isRequired,showMoreChannelsModal:y().func.isRequired,showNewChannelModal:y().func.isRequired,showCreateCategoryModal:y().func.isRequired,handleOpenDirectMessagesModal:y().func.isRequired,unreadFilterEnabled:y().bool.isRequired,canCreateChannel:y().bool.isRequired,showUnreadsCategory:y().bool.isRequired,actions:y().shape({openModal:y().func.isRequired,goBack:y().func.isRequired,goForward:y().func.isRequired}).isRequired});const ll=(0,n.connect)((function(e){return{canGoBack:!0,canGoForward:!0,showUnreadsCategory:(0,d.hC)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h,goBack:rl,goForward:ol},e)}}))(il);var cl=s(47244),dl=(s(65069),s(78233)),hl=s(47667),pl=s(94163),ul=s(40943);class ml extends M.PureComponent{render(){return this.props.unreadMentions>0?M.createElement("span",{id:"unreadMentions",className:"badge"},this.props.unreadMentions):null}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(ml,"propTypes",{unreadMentions:y().number.isRequired});class gl extends M.PureComponent{render(){return 0!==this.props.channel.delete_at?M.createElement("i",{className:"icon icon-archive-outline"}):this.props.hasDraft?M.createElement("i",{"data-testid":"draftIcon",className:"icon icon-pencil-outline"}):this.props.icon}}function fl(e,t,s){return e&&Boolean(e.message.trim()||e.fileInfos.length||e.uploadsInProgress.length)&&t!==(null==s?void 0:s.id)}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(gl,"propTypes",{icon:y().oneOfType([y().element,y().oneOf([null])]),hasDraft:y().bool.isRequired});const El=(0,n.connect)((function(e,t){var s;const n=(0,m.gO)(e);return{hasDraft:fl(!(null===(s=t.channel)||void 0===s||!s.id)&&(0,Ke.HG)(e,N.hC.DRAFT,t.channel.id),n,t.channel)}}),(function(e){return{actions:(0,a.bindActionCreators)({},e)}}))(gl);var Cl=s(95688);function bl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _l extends M.PureComponent{constructor(e){super(e),bl(this,"menuWrapperRef",void 0),bl(this,"menuRef",void 0),bl(this,"menuButtonRef",void 0),bl(this,"closeMenu",(()=>{this.menuWrapperRef.current&&this.menuWrapperRef.current.close(),this.props.onToggleMenu(!1)})),bl(this,"disableScrollbar",(()=>{const e=document.querySelectorAll("#SidebarContainer .SidebarNavContainer .scrollbar--view");e&&e[0]&&(e[0].style.zIndex=this.props.isMenuOpen?"3":"unset")})),bl(this,"refCallback",(e=>{if(e){var t;this.menuRef=e;const s=e.rect(),n=null===(t=this.menuButtonRef.current)||void 0===t?void 0:t.getBoundingClientRect(),a=(void 0===(null==n?void 0:n.y)?null==n?void 0:n.top:n.y)||0,i=window.innerHeight-80-a;this.setState({openUp:a>i,width:(null==s?void 0:s.width)||0},(()=>{this.props.refCallback&&this.props.refCallback(this)}))}})),bl(this,"setMenuPosition",(()=>{if(this.menuButtonRef.current&&this.menuRef){var e;const t=null===(e=this.menuRef.node.current)||void 0===e?void 0:e.parentElement,s=this.state.openUp?-this.menuButtonRef.current.getBoundingClientRect().height:0;t.style.top="".concat(window.scrollY+this.menuButtonRef.current.getBoundingClientRect().top+this.menuButtonRef.current.clientHeight+s,"px")}})),this.state={openUp:!1,width:0},this.menuWrapperRef=M.createRef(),this.menuButtonRef=M.createRef()}componentDidUpdate(e){e.draggingState.state!==this.props.draggingState.state&&this.props.draggingState.state===N.bb.CAPTURE&&this.closeMenu(),this.props.isMenuOpen&&!e.isMenuOpen&&(this.setMenuPosition(),this.disableScrollbar())}render(){const{ariaLabel:e,buttonAriaLabel:t,children:s,isMenuOpen:n,tooltipText:a,id:i,additionalClass:r}=this.props,o=M.createElement(et.Z,{id:"new-group-tooltip",className:"hidden-xs"},a);return M.createElement(Os.Z,{ref:this.menuWrapperRef,className:W()("SidebarMenu",{menuOpen:n}),onToggle:this.props.onToggleMenu,stopPropagationOnToggle:!0},M.createElement(tt.Z,{delayShow:500,placement:"top",overlay:o,disabled:n},M.createElement("button",{ref:this.menuButtonRef,className:W()(["SidebarMenu_menuButton",{additionalClass:r}]),"aria-label":t,tabIndex:this.props.tabIndex},M.createElement("i",{className:"icon-dots-vertical"}))),M.createElement(Is.Z,{ref:this.refCallback,openUp:this.state.openUp,id:"SidebarMenu-".concat(i),ariaLabel:e},s))}}bl(_l,"propTypes",{id:y().string.isRequired,children:y().node,tooltipText:y().string.isRequired,buttonAriaLabel:y().string.isRequired,ariaLabel:y().string.isRequired,refCallback:y().func,isMenuOpen:y().bool.isRequired,onToggleMenu:y().func.isRequired,tabIndex:y().number,additionalClass:y().string});const vl=(0,n.connect)((function(e){return{draggingState:(0,xi.Qy)(e)}}))(_l);function yl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ml extends M.PureComponent{constructor(e){super(e),yl(this,"isLeaving",void 0),yl(this,"markAsRead",(()=>{this.props.actions.markChannelAsRead(this.props.channel.id),(0,Ye.L9)("ui","ui_sidebar_channel_menu_markAsRead")})),yl(this,"favoriteChannel",(()=>{this.props.actions.favoriteChannel(this.props.channel.id),(0,Ye.L9)("ui","ui_sidebar_channel_menu_favorite")})),yl(this,"unfavoriteChannel",(()=>{this.props.actions.unfavoriteChannel(this.props.channel.id),(0,Ye.L9)("ui","ui_sidebar_channel_menu_unfavorite")})),yl(this,"unmuteChannel",(()=>{this.props.actions.unmuteChannel(this.props.currentUserId,this.props.channel.id)})),yl(this,"muteChannel",(()=>{this.props.actions.muteChannel(this.props.currentUserId,this.props.channel.id)})),yl(this,"moveToCategory",(e=>()=>{this.props.actions.addChannelsInSidebar(e,this.props.channel.id),(0,Ye.L9)("ui","ui_sidebar_channel_menu_moveToExistingCategory")})),yl(this,"moveToNewCategory",(()=>{const{actions:e,multiSelectedChannelIds:t,channel:s}=this.props;e.openModal({modalId:N.r8.EDIT_CATEGORY,dialogType:Ji,dialogProps:{channelIdsToAdd:-1===t.indexOf(s.id)?[s.id]:t}}),(0,Ye.L9)("ui","ui_sidebar_channel_menu_createCategory")})),yl(this,"copyLink",(()=>{(0,I.vQ)(this.props.channelLink)})),yl(this,"handleLeaveChannel",(e=>{e.preventDefault(),e.stopPropagation(),!this.isLeaving&&this.props.closeHandler&&(this.isLeaving=!0,(0,Ye.L9)("ui","ui_sidebar_channel_menu_leave"),this.props.closeHandler((()=>{this.isLeaving=!1})))})),yl(this,"addMembers",(()=>{const{channel:e,actions:t}=this.props;t.openModal({modalId:N.r8.CHANNEL_INVITE,dialogType:Cl.Z,dialogProps:{channel:e}}),(0,Ye.L9)("ui","ui_sidebar_channel_menu_addMembers")})),yl(this,"renderDropdownItems",(()=>{const{intl:e,isUnread:t,isFavorite:s,isMuted:n,channel:a,categories:i,displayedChannels:r,multiSelectedChannelIds:o}=this.props;if(!i)return null;let l,c,d;if(t&&(l=M.createElement(Is.Z.ItemAction,{id:"markAsRead-".concat(a.id),onClick:this.markAsRead,icon:M.createElement("i",{className:"icon-mark-as-unread"}),text:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.markAsRead",defaultMessage:"Mark as Read"})})),c=s?M.createElement(Is.Z.ItemAction,{id:"unfavorite-".concat(a.id),onClick:this.unfavoriteChannel,icon:M.createElement("i",{className:"icon-star"}),text:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.unfavoriteChannel",defaultMessage:"Unfavorite"})}):M.createElement(Is.Z.ItemAction,{id:"favorite-".concat(a.id),onClick:this.favoriteChannel,icon:M.createElement("i",{className:"icon-star-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.favoriteChannel",defaultMessage:"Favorite"})}),n){let t=e.formatMessage({id:"sidebar_left.sidebar_channel_menu.unmuteChannel",defaultMessage:"Unmute Channel"});a.type!==N.ZP.DM_CHANNEL&&a.type!==N.ZP.GM_CHANNEL||(t=e.formatMessage({id:"sidebar_left.sidebar_channel_menu.unmuteConversation",defaultMessage:"Unmute Conversation"})),d=M.createElement(Is.Z.ItemAction,{id:"unmute-".concat(a.id),onClick:this.unmuteChannel,icon:M.createElement("i",{className:"icon-bell-off-outline"}),text:t})}else{let t=e.formatMessage({id:"sidebar_left.sidebar_channel_menu.muteChannel",defaultMessage:"Mute Channel"});a.type!==N.ZP.DM_CHANNEL&&a.type!==N.ZP.GM_CHANNEL||(t=e.formatMessage({id:"sidebar_left.sidebar_channel_menu.muteConversation",defaultMessage:"Mute Conversation"})),d=M.createElement(Is.Z.ItemAction,{id:"mute-".concat(a.id),onClick:this.muteChannel,icon:M.createElement("i",{className:"icon-bell-outline"}),text:t})}const h=-1===o.indexOf(a.id)?[a]:r.filter((e=>-1!==o.indexOf(e.id))),p=h.every((e=>e.type===N.ZP.DM_CHANNEL||e.type===N.ZP.GM_CHANNEL)),u=h.every((e=>e.type!==N.ZP.DM_CHANNEL&&e.type!==N.ZP.GM_CHANNEL)),m=i.filter((e=>{var t;return e.id!==(null===(t=this.props.currentCategory)||void 0===t?void 0:t.id)&&(p?e.type!==Oi.y.CHANNELS:!u||e.type!==Oi.y.DIRECT_MESSAGES)})).map((e=>({id:"moveToCategory-".concat(a.id,"-").concat(e.id),icon:e.type===Oi.y.FAVORITES?M.createElement("i",{className:"icon-star-outline"}):M.createElement("i",{className:"icon-folder-outline"}),direction:"right",text:e.display_name,action:this.moveToCategory(e.id)})));let g,f;m.push({id:"SidebarChannelMenu-moveToDivider",text:M.createElement("li",{className:"MenuGroup menu-divider"})},{id:"moveToNewCategory-".concat(a.id),icon:M.createElement("i",{className:"icon-folder-move-outline"}),direction:"right",text:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.moveToNewCategory",defaultMessage:"New Category"}),action:this.moveToNewCategory}),a.type!==N.ZP.OPEN_CHANNEL&&a.type!==N.ZP.PRIVATE_CHANNEL||(g=M.createElement(Is.Z.ItemAction,{id:"copyLink-".concat(a.id),onClick:this.copyLink,icon:M.createElement("i",{className:"icon-link-variant"}),text:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.copyLink",defaultMessage:"Copy Link"})})),(a.type===N.ZP.PRIVATE_CHANNEL&&this.props.managePrivateChannelMembers||a.type===N.ZP.OPEN_CHANNEL&&this.props.managePublicChannelMembers)&&(f=M.createElement(Is.Z.ItemAction,{id:"addMembers-".concat(a.id),onClick:this.addMembers,icon:M.createElement("i",{className:"icon-account-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.addMembers",defaultMessage:"Add Members"})}));let E,C=e.formatMessage({id:"sidebar_left.sidebar_channel_menu.leaveChannel",defaultMessage:"Leave Channel"});return a.type!==N.ZP.DM_CHANNEL&&a.type!==N.ZP.GM_CHANNEL||(C=e.formatMessage({id:"sidebar_left.sidebar_channel_menu.leaveConversation",defaultMessage:"Close Conversation"})),a.name!==N.ZP.DEFAULT_CHANNEL&&(E=M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{id:"leave-".concat(a.id),onClick:this.handleLeaveChannel,icon:M.createElement("i",{className:"icon-close"}),text:C}))),M.createElement(M.Fragment,null,M.createElement(Is.Z.Group,null,l,c,d),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemSubMenu,{id:"moveTo-".concat(a.id),subMenu:m,text:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.moveTo",defaultMessage:"Move to"}),icon:M.createElement("i",{className:"icon-folder-move-outline"}),direction:"right",openUp:this.state.openUp})),M.createElement(Is.Z.Group,null,g,f),E)})),yl(this,"refCallback",(e=>{e&&this.setState({openUp:e.state.openUp})})),yl(this,"onToggleMenu",(e=>{this.props.onToggleMenu(e),e&&(0,Ye.L9)("ui","ui_sidebar_channel_menu_opened")})),this.state={openUp:!1},this.isLeaving=!1}render(){const{channel:e,intl:t,isCollapsed:s,isMenuOpen:n}=this.props;return M.createElement(vl,{refCallback:this.refCallback,id:"SidebarChannelMenu-".concat(e.id),ariaLabel:t.formatMessage({id:"sidebar_left.sidebar_channel_menu.dropdownAriaLabel",defaultMessage:"Channel Menu"}),buttonAriaLabel:t.formatMessage({id:"sidebar_left.sidebar_channel_menu.dropdownAriaLabel",defaultMessage:"Channel Menu"}),isMenuOpen:n,onToggleMenu:this.onToggleMenu,tooltipText:t.formatMessage({id:"sidebar_left.sidebar_channel_menu.editChannel",defaultMessage:"Channel options"}),tabIndex:s?-1:0},n&&this.renderDropdownItems())}}yl(Ml,"propTypes",{channelLink:y().string.isRequired,categories:y().array,currentUserId:y().string.isRequired,currentTeamId:y().string.isRequired,isUnread:y().bool.isRequired,isFavorite:y().bool.isRequired,isMuted:y().bool.isRequired,managePublicChannelMembers:y().bool.isRequired,managePrivateChannelMembers:y().bool.isRequired,closeHandler:y().func,isCollapsed:y().bool.isRequired,isMenuOpen:y().bool.isRequired,onToggleMenu:y().func.isRequired,multiSelectedChannelIds:y().arrayOf(y().string).isRequired,displayedChannels:y().array.isRequired,actions:y().shape({markChannelAsRead:y().func.isRequired,favoriteChannel:y().func.isRequired,unfavoriteChannel:y().func.isRequired,muteChannel:y().func.isRequired,unmuteChannel:y().func.isRequired,openModal:y().func.isRequired,addChannelsInSidebar:y().func.isRequired}).isRequired});const Pl=(0,K.ZP)(Ml),wl=(0,n.connect)((function(e,t){const s=(0,Mr.h4)(e)[t.channel.id],n=(0,u.kA)(e);let a,i,r=!1,o=!1;return n&&(r=(0,Z.Ai)(e,{channel:t.channel.id,team:n.id,permission:Ps.Z.MANAGE_PUBLIC_CHANNEL_MEMBERS}),o=(0,Z.Ai)(e,{channel:t.channel.id,team:n.id,permission:Ps.Z.MANAGE_PRIVATE_CHANNEL_MEMBERS}),a=(0,xi.Yy)(e),i=(0,Li.Me)(e,n.id,t.channel.id)),{currentTeamId:n.id,currentUserId:(0,Mr.rc)(e),categories:a,currentCategory:i,isFavorite:(0,m.Dp)(e,t.channel.id),isMuted:(0,$i.Mm)(s),channelLink:"".concat((0,Sn.fO)()).concat(t.channelLink),managePublicChannelMembers:r,managePrivateChannelMembers:o,displayedChannels:(0,xi.ER)(e),multiSelectedChannelIds:e.views.channelSidebar.multiSelectedChannelIds}}),(function(e){return{actions:(0,a.bindActionCreators)({markChannelAsRead:o.Eo,favoriteChannel:o.ZE,unfavoriteChannel:o.Dn,muteChannel:Ii.D0,unmuteChannel:Ii.rA,openModal:H.h,addChannelsInSidebar:qi},e)}}))(Pl);var Sl=s(55200);function Tl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Nl extends M.PureComponent{constructor(e){super(e),Tl(this,"labelRef",void 0),Tl(this,"gmItemRef",void 0),Tl(this,"enableToolTipIfNeeded",(()=>{const e=this.gmItemRef.current||this.labelRef.current,t=e&&e.offsetWidth<e.scrollWidth;this.setState({showTooltip:Boolean(t)})})),Tl(this,"getAriaLabel",(()=>{const{label:e,ariaLabelPrefix:t,unreadMentions:s}=this.props;let n=e;return t&&(n+=" ".concat(t)),1===s?n+=" ".concat(s," ").concat((0,I._u)("accessibility.sidebar.types.mention","mention")):s>1&&(n+=" ".concat(s," ").concat((0,I._u)("accessibility.sidebar.types.mentions","mentions"))),this.showChannelAsUnread()&&0===s&&(n+=" ".concat((0,I._u)("accessibility.sidebar.types.unread","unread"))),n.toLowerCase()})),Tl(this,"removeTooltipLink",(()=>{var e,t;return null===(e=this.gmItemRef.current)||void 0===e||null===(t=e.removeAttribute)||void 0===t?void 0:t.call(e,"aria-describedby")})),Tl(this,"handleChannelClick",(e=>{(0,Ye.B1)("SidebarLink#click"),(0,Ye.L9)("ui","ui_channel_selected_v2"),this.handleSelectChannel(e)})),Tl(this,"handleSelectChannel",(e=>{e.defaultPrevented||0!==e.button||((0,I._E)(e)?(e.preventDefault(),this.props.actions.multiSelectChannelAdd(this.props.channel.id)):e.shiftKey?(e.preventDefault(),this.props.actions.multiSelectChannelTo(this.props.channel.id)):this.props.actions.clearChannelSelection())})),Tl(this,"handleMenuToggle",(e=>this.setState({isMenuOpen:e}))),Tl(this,"showChannelAsUnread",(()=>this.props.unreadMentions>0||this.props.unreadMsgs>0&&this.props.showUnreadForMsgs)),this.labelRef=M.createRef(),this.gmItemRef=M.createRef(),this.state={isMenuOpen:!1,showTooltip:!0}}componentDidMount(){this.enableToolTipIfNeeded()}componentDidUpdate(e){e.label!==this.props.label&&this.enableToolTipIfNeeded()}render(){const{link:e,label:t,channel:s,unreadMentions:n,icon:a,isMuted:i,isChannelSelected:r,verified:o}=this.props;let l=M.createElement("span",{className:W()("SidebarChannelLinkLabel",{truncated:this.state.showTooltip})},(0,qo.Y)(t));if(this.state.showTooltip){const e=M.createElement(et.Z,{id:"channel-displayname__tooltip"},t);l=M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:e,onEntering:this.removeTooltipLink},M.createElement("div",{ref:this.gmItemRef},l))}const c=this.props.teammateId?M.createElement(cr.Z,{userID:this.props.teammateId,showTooltip:!0,spanStyle:{height:18},emojiStyle:{marginTop:-4,marginLeft:6,marginBottom:0,opacity:.8}}):null,d=M.createElement(M.Fragment,null,M.createElement(El,{channel:s,icon:a}),M.createElement("div",{className:"SidebarChannelLinkLabel_wrapper",ref:this.labelRef},M.createElement("div",{className:"SidebarChannelLinkLabel_main"},l,c,o?M.createElement(Sl.Z,{show:o,className:"user-verified"}):null)),M.createElement("div",{className:"SidebarChannelLinkLabel_actions"},M.createElement("div",{className:"SidebarLastPostAt"},M.createElement(lr.ZP,{value:s.last_post_at||s.create_at,className:"post__time",useSemanticOutput:!0,useTime:!1,units:["now","second","minute","hour","Today","Yesterday"]})),M.createElement("div",{className:"SidebarMore"},M.createElement(wl,{channel:s,isUnread:this.showChannelAsUnread(),isCollapsed:this.props.isCollapsed,closeHandler:this.props.closeHandler,channelLink:e,isMenuOpen:this.state.isMenuOpen,onToggleMenu:this.handleMenuToggle}),M.createElement(ml,{unreadMentions:n})))),h=W()(["SidebarLink",{menuOpen:this.state.isMenuOpen,muted:i,"unread-title":this.showChannelAsUnread(),selected:r}]);let p=M.createElement(ht.Link,{className:h,id:"sidebarItem_".concat(s.name),"aria-label":this.getAriaLabel(),to:e,tabIndex:this.props.isCollapsed?-1:0},d);return(0,R.P)()&&(p=M.createElement(Ci,{link:this.props.link,menuId:s.id},p)),p}}Tl(Nl,"propTypes",{link:y().string.isRequired,label:y().string.isRequired,ariaLabelPrefix:y().string,closeHandler:y().func,icon:y().oneOfType([y().element,y().oneOf([null])]),unreadMentions:y().number.isRequired,unreadMsgs:y().number.isRequired,showUnreadForMsgs:y().bool.isRequired,isMuted:y().bool.isRequired,isCollapsed:y().bool.isRequired,isChannelSelected:y().bool.isRequired,teammateId:y().string,verified:y().bool,actions:y().shape({clearChannelSelection:y().func.isRequired,multiSelectChannelTo:y().func.isRequired,multiSelectChannelAdd:y().func.isRequired}).isRequired});const Rl=(0,n.connect)((function(e,t){const s=(0,Mr.h4)(e)[t.channel.id];let n=0,a=0,i=!0;const r=(0,d.ym)(e);return s&&(n=r?s.mention_count_root:s.mention_count,t.channel&&(a=(0,$i._R)(r,t.channel,s)),s.notify_props&&(i=s.notify_props.mark_unread!==N.XH.MENTION)),{unreadMentions:n,unreadMsgs:a,showUnreadForMsgs:i,isMuted:(0,$i.Mm)(s),isChannelSelected:(0,xi.mF)(e,t.channel.id)}}),(function(e){return{actions:(0,a.bindActionCreators)({clearChannelSelection:Ui,multiSelectChannelTo:Bi,multiSelectChannelAdd:Fi},e)}}))(Nl);function Il(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ol extends M.PureComponent{constructor(...e){super(...e),Il(this,"handleLeavePublicChannel",(()=>{this.props.actions.leaveChannel(this.props.channel.id),(0,Ye.L9)("ui","ui_public_channel_x_button_clicked")})),Il(this,"handleLeavePrivateChannel",(()=>{T.EK({id:this.props.channel.id,display_name:this.props.channel.display_name}),(0,Ye.L9)("ui","ui_private_channel_x_button_clicked")})),Il(this,"getCloseHandler",(()=>{const{channel:e}=this.props;return e.type===N.ZP.OPEN_CHANNEL&&e.name!==N.ZP.DEFAULT_CHANNEL?this.handleLeavePublicChannel:e.type===N.ZP.PRIVATE_CHANNEL?this.handleLeavePrivateChannel:null})),Il(this,"getIcon",(()=>{const{channel:e}=this.props;return e.shared?M.createElement(Kr.Z,{className:"icon",channelType:e.type,withTooltip:!0}):M.createElement(or.Z,{src:Ws.je.getChannelPictureUrl(e.id,e.last_picture_update),size:"xl",status:"",wrapperClass:"DirectChannel__profile-picture",newStatusIcon:!0})}))}render(){const{channel:e,currentTeamName:t}=this.props;let s;return e.type===N.ZP.OPEN_CHANNEL?s=(0,I._u)("accessibility.sidebar.types.public","public channel"):e.type===N.ZP.PRIVATE_CHANNEL&&(s=(0,I._u)("accessibility.sidebar.types.private","private channel")),M.createElement(Rl,{channel:e,link:"/".concat(t,"/group/").concat(e.name),label:e.display_name,ariaLabelPrefix:s,closeHandler:this.getCloseHandler(),icon:this.getIcon(),isCollapsed:this.props.isCollapsed})}}Il(Ol,"propTypes",{currentTeamName:y().string.isRequired,isCollapsed:y().bool.isRequired,actions:y().shape({leaveChannel:y().func.isRequired}).isRequired});const Ll=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({leaveChannel:b.TL},e)}}))(Ol);function Al(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class kl extends M.PureComponent{constructor(e){super(e),Al(this,"handleLeaveChannel",(e=>{const t=this.props.channel.teammate_id,s=N.gT.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,n=this.props.currentUserId;this.props.actions.savePreferences(n,[{user_id:n,category:s,name:t,value:"false"}]).then(e),this.props.actions.leaveDirectChannel(this.props.channel.name),(0,Ye.L9)("ui","ui_direct_channel_x_button_clicked"),this.props.active&&st.m.push("/".concat(this.props.currentTeamName,"/group/").concat(this.props.redirectChannel))})),Al(this,"onSvgLoadError",(()=>{this.setState({svgErrorUrl:this.props.botIconUrl})})),Al(this,"onSvgLoad",(()=>{this.setState({svgErrorUrl:null})})),Al(this,"getIcon",(()=>{const{channel:e,teammate:t}=this.props;if(!t)return null;if(t.id&&t.delete_at)return M.createElement("i",{className:"icon icon-archive-outline"});let s="";return"online"===e.status?s="status-online":"away"===e.status?s="status-away":"dnd"===e.status&&(s="status-dnd"),M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(t.id,t.last_picture_update),size:"xl",status:t.is_bot?"":e.status,wrapperClass:"DirectChannel__profile-picture",newStatusIcon:!1,statusClass:"DirectChannel__status-icon ".concat(s)})})),this.state={svgErrorUrl:null}}render(){const{channel:e,teammate:t,currentTeamName:s,contactName:n}=this.props;if(!t)return null;let a=n||e.display_name;return this.props.currentUserId===t.id&&(a=this.props.intl.formatMessage({id:"sidebar.directchannel.you",defaultMessage:"{displayname} (you)"},{displayname:a})),M.createElement(Rl,{teammateId:t.id,channel:e,link:"/".concat(s,"/messages/@").concat(t.username),label:a,closeHandler:this.handleLeaveChannel,icon:this.getIcon(),isCollapsed:this.props.isCollapsed,verified:t.verified})}}Al(kl,"propTypes",{currentTeamName:y().string.isRequired,currentUserId:y().string.isRequired,redirectChannel:y().string.isRequired,contactName:y().string,active:y().bool.isRequired,botIconUrl:y().oneOfType([y().string,y().oneOf([null])]),isCollapsed:y().bool.isRequired,actions:y().shape({savePreferences:y().func.isRequired,leaveDirectChannel:y().func.isRequired}).isRequired});const xl=(0,K.ZP)(kl),Dl=(0,n.connect)((function(e,t){const s=(0,p.PR)(e,t.channel.teammate_id),n=(0,p.ts)(e),a=(0,u.kA)(e),i=(0,m.fG)(e,a.id),r=(0,m.gO)(e),o=t.channel.id===r,l=(0,Po.No)(e,null==s?void 0:s.id);return{teammate:s,currentUserId:n.id,redirectChannel:i,active:o,botIconUrl:(c=s,c&&c.is_bot&&c.bot_last_icon_update?"".concat(Ws.je.getBotRoute(c.id),"/icon?_=").concat(c.bot_last_icon_update||0):null),contactName:l};var c}),(function(e){return{actions:(0,a.bindActionCreators)({savePreferences:Oe.$A,leaveDirectChannel:b.e2},e)}}))(xl);function Zl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Hl extends M.PureComponent{constructor(...e){super(...e),Zl(this,"handleLeaveChannel",(e=>{const t=this.props.channel.id,s=N.ZP.Preferences.CATEGORY_GROUP_CHANNEL_SHOW,n=this.props.currentUserId;this.props.actions.savePreferences(n,[{user_id:n,category:s,name:t,value:"false"}]).then(e),(0,Ye.L9)("ui","ui_direct_channel_x_button_clicked"),this.props.active&&st.m.push("/".concat(this.props.currentTeamName,"/group/").concat(this.props.redirectChannel))})),Zl(this,"getIcon",(()=>M.createElement("div",{className:"status status--group"},this.props.membersCount)))}render(){const{channel:e,currentTeamName:t}=this.props;return M.createElement(Rl,{channel:e,link:"/".concat(t,"/messages/").concat(e.name),label:e.display_name,closeHandler:this.handleLeaveChannel,icon:this.getIcon(),isCollapsed:this.props.isCollapsed})}}Zl(Hl,"propTypes",{currentTeamName:y().string.isRequired,currentUserId:y().string.isRequired,redirectChannel:y().string.isRequired,active:y().bool.isRequired,membersCount:y().number.isRequired,isCollapsed:y().bool.isRequired,actions:y().shape({savePreferences:y().func.isRequired}).isRequired});const ql=(0,n.connect)((function(e,t){const s=(0,p.ts)(e),n=(0,u.kA)(e),a=(0,m.fG)(e,n.id),i=(0,m.gO)(e),r=t.channel.id===i,o=(0,p.ZQ)(e);let l=0;if(o&&o[t.channel.id]){const e=o[t.channel.id];l=e.size,e.has(s.id)&&l--}return{currentUserId:s.id,redirectChannel:a,active:r,membersCount:l}}),(function(e){return{actions:(0,a.bindActionCreators)({savePreferences:Oe.$A},e)}}))(Hl);function jl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ul extends M.PureComponent{constructor(...e){super(...e),jl(this,"isUnread",(()=>this.props.unreadMentions>0||this.props.unreadMsgs>0&&this.props.showUnreadForMsgs)),jl(this,"isCollapsed",(e=>e.isCategoryDragged||e.isCategoryCollapsed&&!this.isUnread()&&!e.isCurrentChannel)),jl(this,"removeAnimation",(()=>{const e=this.getRef();e&&e.classList.remove("animating")})),jl(this,"getRef",(()=>this.props.getChannelRef(this.props.channel.id))),jl(this,"setRef",(e=>t=>{this.props.setChannelRef(this.props.channel.id,t),null==e||e(t)}))}componentDidUpdate(e){if(this.isCollapsed(this.props)!==this.isCollapsed(e)&&this.props.draggingState.state!==N.bb.CAPTURE&&this.props.draggingState.state!==N.bb.BEFORE){const e=this.getRef();e&&e.classList.add("animating")}}render(){const{channel:e,channelIndex:t,currentTeamName:s,isCurrentChannel:n,isDraggable:a,isAutoSortedCategory:i,isChannelSelected:r,draggingState:o,multiSelectedChannelIds:l,autoSortedCategoryIds:c}=this.props;if(!e)return M.createElement("div",null);let d=Ll;e.type===N.ZP.DM_CHANNEL?d=Dl:e.type===N.ZP.GM_CHANNEL&&(d=ql);const h=M.createElement(d,{isCollapsed:!1,channel:e,currentTeamName:s});let p;if(a){let s;r&&o.state&&o.id===e.id&&l.length>1&&(s=M.createElement("div",{className:"SidebarChannel__selectedCount"},M.createElement(Dt.Z,{id:"sidebar_left.sidebar_channel.selectedCount",defaultMessage:"{count} selected",values:{count:l.length}}))),p=M.createElement(ui._l,{draggableId:e.id,index:t},((t,a)=>M.createElement("li",Object.assign({draggable:"false",ref:this.setRef(t.innerRef),className:W()("SidebarChannel",{collapsed:this.isCollapsed(this.props),unread:this.isUnread(),active:n,dragging:a.isDragging,selectedDragging:r&&o.state&&o.id!==e.id,fadeOnDrop:a.isDropAnimating&&a.draggingOver&&c.has(a.draggingOver),noFloat:i&&!a.isDragging}),onTransitionEnd:this.removeAnimation},t.draggableProps,t.dragHandleProps,{role:"listitem",tabIndex:-1}),h,s)))}else p=M.createElement("li",{ref:this.setRef(),className:W()("SidebarChannel",{collapsed:!1,unread:this.isUnread(),active:n}),role:"listitem"},h);return p}}jl(Ul,"propTypes",{channelIndex:y().number.isRequired,teammateUsername:y().string,currentTeamName:y().string.isRequired,unreadMentions:y().number.isRequired,unreadMsgs:y().number.isRequired,showUnreadForMsgs:y().bool.isRequired,getChannelRef:y().func.isRequired,setChannelRef:y().func.isRequired,isCategoryCollapsed:y().bool.isRequired,isCurrentChannel:y().bool.isRequired,isAutoSortedCategory:y().bool.isRequired,isDraggable:y().bool,isCategoryDragged:y().bool.isRequired,isDropDisabled:y().bool.isRequired,isChannelSelected:y().bool.isRequired,multiSelectedChannelIds:y().arrayOf(y().string).isRequired,autoSortedCategoryIds:y().instanceOf(Set).isRequired}),jl(Ul,"defaultProps",{isDraggable:!0});const Fl=(0,n.connect)((function(){const e=(0,m.kL)();return(t,s)=>{const n=e(t,{id:s.channelId}),a=(0,u.kA)(t),i=(0,Mr.h4)(t)[s.channelId],r=(0,m.gO)(t),o=(0,d.ym)(t);let l=0,c=0,h=!0;return i&&(l=o?i.mention_count_root:i.mention_count,n&&(c=(0,$i._R)(o,n,i)),i.notify_props&&(h=i.notify_props.mark_unread!==N.XH.MENTION)),{channel:n,isCurrentChannel:n.id===r,currentTeamName:a.name,unreadMentions:l,unreadMsgs:c,showUnreadForMsgs:h,draggingState:(0,xi.Qy)(t),isChannelSelected:(0,xi.mF)(t,s.channelId),multiSelectedChannelIds:t.views.channelSidebar.multiSelectedChannelIds,autoSortedCategoryIds:(0,xi.n7)(t)}}}))(Ul);function Bl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Gl extends M.PureComponent{constructor(e){super(e),Bl(this,"handleSortDirectMessages",(e=>{const{category:t}=this.props;this.props.actions.setCategorySorting(t.id,e),(0,Ye.L9)("ui","ui_sidebar_sort_dm_".concat(e))})),Bl(this,"handlelimitVisibleDMsGMs",(e=>{const{currentUserId:t}=this.props;this.props.actions.savePreferences(t,[{user_id:t,category:N.ZP.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:D.uP.LIMIT_VISIBLE_DMS_GMS,value:e.toString()}])})),Bl(this,"renderDropdownItems",(()=>{const{intl:e,category:t}=this.props,s=[{id:"sortAlphabetical",direction:"right",text:e.formatMessage({id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),action:()=>this.handleSortDirectMessages(pl.r.Alphabetical)},{id:"sortByMostRecent",direction:"right",text:e.formatMessage({id:"sidebar.sortedByRecencyLabel",defaultMessage:"Recent Activity"}),action:()=>this.handleSortDirectMessages(pl.r.Recency)}],n=[10,15,20,40].map((e=>({id:"SidebarCategorySortingMenu-dmCount-".concat(e),direction:"right",text:e,action:()=>this.handlelimitVisibleDMsGMs(e)}))),a=[];a.push({id:"showAllDms",direction:"right",text:e.formatMessage({id:"sidebar.allDirectMessages",defaultMessage:"All direct messages"}),action:()=>this.handlelimitVisibleDMsGMs(1e4)},{id:"SidebarChannelMenu-moveToDivider",text:M.createElement("li",{className:"MenuGroup menu-divider"})},...n);const i=M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{id:"browseDirectMessages",onClick:this.props.handleOpenDirectMessagesModal,icon:M.createElement("i",{className:"icon-account-plus-outline"}),text:e.formatMessage({id:"sidebar.openDirectMessage",defaultMessage:"Open a direct message"})}));return M.createElement(M.Fragment,null,M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemSubMenu,{id:"sortDirectMessages",subMenu:s,text:e.formatMessage({id:"sidebar.sort",defaultMessage:"Sort"}),selectedValueText:t.sorting===pl.r.Alphabetical?e.formatMessage({id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}):e.formatMessage({id:"user.settings.sidebar.recent",defaultMessage:"Recent Activity"}),icon:t.sorting===pl.r.Alphabetical?M.createElement("i",{className:"icon-sort-alphabetical-ascending"}):M.createElement("i",{className:"icon-clock-outline"}),direction:"right",openUp:this.state.openUp,styleSelectableItem:!0}),M.createElement(Is.Z.ItemSubMenu,{id:"showMessageCount",subMenu:a,text:e.formatMessage({id:"sidebar.show",defaultMessage:"Show"}),selectedValueText:1e4===this.props.selectedDmNumber?e.formatMessage({id:"channel_notifications.levels.all",defaultMessage:"All"}):this.props.selectedDmNumber,icon:M.createElement("i",{className:"icon-account-multiple-outline"}),direction:"right",openUp:this.state.openUp,styleSelectableItem:!0})),i)})),Bl(this,"refCallback",(e=>{e&&this.setState({openUp:e.state.openUp})})),Bl(this,"onToggleMenu",(e=>{this.props.onToggleMenu(e),e&&(0,Ye.L9)("ui","ui_sidebar_channel_menu_opened")})),this.state={openUp:!1}}render(){const{intl:e,isCollapsed:t,isMenuOpen:s}=this.props;return M.createElement(vl,{refCallback:this.refCallback,id:"SidebarCategorySortingMenu",ariaLabel:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.dropdownAriaLabel",defaultMessage:"Channel Menu"}),buttonAriaLabel:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.dropdownAriaLabel",defaultMessage:"Channel Menu"}),isMenuOpen:s,onToggleMenu:this.onToggleMenu,tooltipText:e.formatMessage({id:"sidebar_left.sidebar_channel_menu.editChannel",defaultMessage:"Channel options"}),tabIndex:t?-1:0,additionalClass:"additionalClass"},this.renderDropdownItems())}}Bl(Gl,"propTypes",{handleOpenDirectMessagesModal:y().func.isRequired,isCollapsed:y().bool.isRequired,isMenuOpen:y().bool.isRequired,onToggleMenu:y().func.isRequired,currentUserId:y().string.isRequired,selectedDmNumber:y().number.isRequired,actions:y().shape({setCategorySorting:y().func.isRequired,savePreferences:y().func.isRequired}).isRequired});const Vl=(0,K.ZP)(Gl),Kl=(0,n.connect)((function(){return e=>({selectedDmNumber:(0,d.wS)(e,D.uP.CATEGORY_SIDEBAR_SETTINGS,D.uP.LIMIT_VISIBLE_DMS_GMS,20),currentUserId:(0,p.rc)(e)})}),(function(e){return{actions:(0,a.bindActionCreators)({setCategorySorting:Ri.Wp,savePreferences:Oe.$A},e)}}))(Vl);function Yl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Wl extends M.PureComponent{constructor(e){super(e),Yl(this,"handleConfirm",(()=>{this.props.actions.deleteCategory(this.props.category.id)})),this.state={show:!0}}render(){return M.createElement(Yi.Z,{onHide:this.props.onHide,modalHeaderText:M.createElement(V.Z,{id:"delete_category_modal.deleteCategory",defaultMessage:"Delete this category?"}),handleConfirm:this.handleConfirm,confirmButtonText:M.createElement(V.Z,{id:"delete_category_modal.delete",defaultMessage:"Delete"}),confirmButtonClassName:"delete"},M.createElement("span",{className:"delete-category__helpText"},M.createElement(Dt.Z,{id:"delete_category_modal.helpText",defaultMessage:"Channels in **{category_name}** will move back to the Channels and Direct messages categories. You're not removed from any channels.",values:{category_name:this.props.category.display_name}})))}}Yl(Wl,"propTypes",{onHide:y().func.isRequired,actions:y().shape({deleteCategory:y().func.isRequired}).isRequired});const zl=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({deleteCategory:Ri.uu},e)}}))(Wl);function Jl(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Xl extends M.PureComponent{constructor(e){super(e),Jl(this,"toggleCategoryMute",(()=>{this.props.actions.setCategoryMuted(this.props.category.id,!this.props.category.muted)})),Jl(this,"deleteCategory",(()=>{this.props.actions.openModal({modalId:N.r8.DELETE_CATEGORY,dialogType:zl,dialogProps:{category:this.props.category}})})),Jl(this,"renameCategory",(()=>{this.props.actions.openModal({modalId:N.r8.EDIT_CATEGORY,dialogType:Ji,dialogProps:{categoryId:this.props.category.id,initialCategoryName:this.props.category.display_name}})})),Jl(this,"createCategory",(()=>{this.props.actions.openModal({modalId:N.r8.EDIT_CATEGORY,dialogType:Ji}),(0,Ye.L9)("ui","ui_sidebar_category_menu_createCategory")})),Jl(this,"handleSortChannels",(e=>{const{category:t}=this.props;this.props.actions.setCategorySorting(t.id,e),(0,Ye.L9)("ui","ui_sidebar_sort_dm_".concat(e))})),Jl(this,"onToggleMenu",(e=>{this.props.onToggleMenu(e),e&&(0,Ye.L9)("ui","ui_sidebar_category_menu_opened")})),Jl(this,"renderDropdownItems",(()=>{const{intl:e,category:t}=this.props;let s;if(t.type!==Oi.y.DIRECT_MESSAGES){let n;n=t.muted?e.formatMessage({id:"sidebar_left.sidebar_category_menu.unmuteCategory",defaultMessage:"Unmute Category"}):e.formatMessage({id:"sidebar_left.sidebar_category_menu.muteCategory",defaultMessage:"Mute Category"}),s=M.createElement(Is.Z.ItemAction,{id:"mute-".concat(t.id),onClick:this.toggleCategoryMute,icon:M.createElement("i",{className:"icon-bell-outline"}),text:n})}const n=[{id:"sortAlphabetical",direction:"right",text:e.formatMessage({id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),action:()=>this.handleSortChannels(pl.r.Alphabetical)},{id:"sortByMostRecent",direction:"right",text:e.formatMessage({id:"sidebar.sortedByRecencyLabel",defaultMessage:"Recent Activity"}),action:()=>this.handleSortChannels(pl.r.Recency)},{id:"sortManual",direction:"right",text:e.formatMessage({id:"sidebar.sortedManually",defaultMessage:"Manually"}),action:()=>this.handleSortChannels(pl.r.Manual)}];let a,i,r,o;switch(t.type===Oi.y.CUSTOM&&(a=M.createElement(Is.Z.ItemAction,{isDangerous:!0,id:"delete-".concat(t.id),onClick:this.deleteCategory,icon:M.createElement("i",{className:"icon-trash-can-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_category_menu.deleteCategory",defaultMessage:"Delete Category"})}),i=M.createElement(Is.Z.ItemAction,{id:"rename-".concat(t.id),onClick:this.renameCategory,icon:M.createElement("i",{className:"icon-pencil-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_category_menu.renameCategory",defaultMessage:"Rename Category"})})),t.sorting){case pl.r.Alphabetical:r=e.formatMessage({id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"});break;case pl.r.Recency:r=e.formatMessage({id:"user.settings.sidebar.recent",defaultMessage:"Recent Activity"});break;default:r=e.formatMessage({id:"sidebar.sortedManually",defaultMessage:"Manually"})}switch(t.sorting){case pl.r.Alphabetical:o=M.createElement("i",{className:"icon-sort-alphabetical-ascending"});break;case pl.r.Recency:o=M.createElement("i",{className:"icon-clock-outline"});break;default:o=M.createElement("i",{className:"icon-format-list-bulleted"})}return M.createElement(M.Fragment,null,M.createElement(Is.Z.Group,null,s,i,a),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemSubMenu,{id:"sortChannels",subMenu:n,text:e.formatMessage({id:"sidebar.sort",defaultMessage:"Sort"}),selectedValueText:r,icon:o,direction:"right",openUp:this.state.openUp,styleSelectableItem:!0})),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{id:"create-".concat(t.id),onClick:this.createCategory,icon:M.createElement("i",{className:"icon-folder-plus-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_category_menu.createCategory",defaultMessage:"Create New Category"})})))})),Jl(this,"refCallback",(e=>{e&&this.setState({openUp:e.state.openUp})})),this.state={showDeleteCategoryModal:!1,openUp:!1}}render(){const{intl:e,category:t}=this.props;return M.createElement(M.Fragment,null,M.createElement(vl,{refCallback:this.refCallback,id:"SidebarCategoryMenu-".concat(t.id),ariaLabel:e.formatMessage({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Category Menu"}),buttonAriaLabel:e.formatMessage({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Category Menu"}),isMenuOpen:this.props.isMenuOpen,onToggleMenu:this.onToggleMenu,tooltipText:e.formatMessage({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"})},this.renderDropdownItems()))}}Jl(Xl,"propTypes",{currentTeamId:y().string.isRequired,isMenuOpen:y().bool.isRequired,onToggleMenu:y().func.isRequired,actions:y().shape({openModal:y().func.isRequired,setCategoryMuted:y().func.isRequired,setCategorySorting:y().func.isRequired}).isRequired});const Ql=(0,K.ZP)(Xl),$l=(0,n.connect)((function(){return e=>({currentTeamId:(0,u.kA)(e).id})}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h,setCategoryMuted:Ri.uN,setCategorySorting:Ri.Wp},e)}}))(Ql);function ec(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class tc extends M.PureComponent{constructor(e){super(e),ec(this,"categoryTitleRef",void 0),ec(this,"newDropBoxRef",void 0),ec(this,"handleA11yActivateEvent",(()=>{this.categoryTitleRef.current&&this.categoryTitleRef.current.addEventListener("keydown",this.handleA11yKeyDown)})),ec(this,"handleA11yDeactivateEvent",(()=>{this.categoryTitleRef.current&&this.categoryTitleRef.current.removeEventListener("keydown",this.handleA11yKeyDown)})),ec(this,"handleA11yKeyDown",(e=>{(0,I.pD)(e,N.ZP.KeyCodes.ENTER)&&this.handleCollapse()})),ec(this,"renderChannel",((e,t)=>{const{setChannelRef:s,getChannelRef:n,category:a,draggingState:i}=this.props;return M.createElement(Fl,{key:e,channelIndex:t,channelId:e,setChannelRef:s,getChannelRef:n,isCategoryCollapsed:a.collapsed,isCategoryDragged:i.type===N.Hl.CATEGORY&&i.id===a.id,isDropDisabled:this.isDropDisabled(),isAutoSortedCategory:a.sorting===pl.r.Alphabetical||a.sorting===pl.r.Recency})})),ec(this,"handleCollapse",(()=>{const{category:e}=this.props;e.collapsed?(0,Ye.L9)("ui","ui_sidebar_expand_category"):(0,Ye.L9)("ui","ui_sidebar_collapse_category"),this.props.actions.setCategoryCollapsed(e.id,!e.collapsed)})),ec(this,"handleSortDirectMessages",(e=>{const{category:t}=this.props;e.stopPropagation();const s=t.sorting===pl.r.Recency?pl.r.Alphabetical:pl.r.Recency;this.props.actions.setCategorySorting(t.id,s),(0,Ye.L9)("ui","ui_sidebar_sort_dm_".concat(s))})),ec(this,"removeAnimation",(()=>{this.newDropBoxRef.current&&this.newDropBoxRef.current.classList.remove("animating")})),ec(this,"handleOpenDirectMessagesModal",(e=>{e.stopPropagation(),this.props.handleOpenMoreDirectChannelsModal(e.nativeEvent),(0,Ye.L9)("ui","ui_sidebar_create_direct_message")})),ec(this,"handleMenuToggle",(e=>{this.setState({isMenuOpen:e})})),ec(this,"isDropDisabled",(()=>{const{draggingState:e,category:t}=this.props;return t.type===Oi.y.DIRECT_MESSAGES?e.type===N.Hl.CHANNEL:t.type===Oi.y.CHANNELS&&e.type===N.Hl.DM})),ec(this,"renderNewDropBox",(e=>{const{draggingState:t,category:s,isNewCategory:n,channelIds:a}=this.props;return!n||null!=a&&a.length?null:M.createElement(M.Fragment,null,M.createElement(ui._l,{draggableId:"NEW_CHANNEL_SPACER__".concat(s.id),isDragDisabled:!0,index:0},(e=>M.createElement("li",Object.assign({ref:e.innerRef,draggable:"false",className:"SidebarChannel noFloat newChannelSpacer"},e.draggableProps,{role:"listitem",tabIndex:-1})))),M.createElement("div",{ref:this.newDropBoxRef,className:W()("SidebarCategory_newDropBox",{collapsed:s.collapsed||t.type===N.Hl.CATEGORY&&t.id===s.id,isDraggingOver:e}),onTransitionEnd:this.removeAnimation},M.createElement("i",{className:"icon-hand-right"}),M.createElement("span",{className:"SidebarCategory_newDropBox-label"},M.createElement(V.Z,{id:"sidebar_left.sidebar_category.newDropBoxLabel",defaultMessage:"Drag channels here..."}))))})),ec(this,"showPlaceholder",(()=>{const{channelIds:e,draggingState:t,category:s,isNewCategory:n}=this.props;return s.sorting!==pl.r.Alphabetical&&s.sorting!==pl.r.Recency&&!n||!!e.find((e=>e===t.id))})),this.categoryTitleRef=M.createRef(),this.newDropBoxRef=M.createRef(),this.state={isMenuOpen:!1}}componentDidUpdate(e){this.props.category.collapsed!==e.category.collapsed&&this.newDropBoxRef.current&&this.newDropBoxRef.current.classList.add("animating")}componentDidMount(){this.categoryTitleRef.current&&(this.categoryTitleRef.current.addEventListener(N.sp.ACTIVATE,this.handleA11yActivateEvent),this.categoryTitleRef.current.addEventListener(N.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}componentWillUnmount(){this.categoryTitleRef.current&&(this.categoryTitleRef.current.removeEventListener(N.sp.ACTIVATE,this.handleA11yActivateEvent),this.categoryTitleRef.current.removeEventListener(N.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}render(){const{category:e,categoryIndex:t,channelIds:s,isNewCategory:n}=this.props;if(!e)return null;if(e.type===Oi.y.FAVORITES&&(null==s||!s.length))return null;const a=s.map(this.renderChannel);let i,r,o=!0;if(n)r=M.createElement("div",{className:"SidebarCategory_newLabel"},M.createElement(V.Z,{id:"sidebar_left.sidebar_category.newLabel",defaultMessage:"new"})),i=M.createElement($l,{category:e,isMenuOpen:this.state.isMenuOpen,onToggleMenu:this.handleMenuToggle});else if(e.type===Oi.y.DIRECT_MESSAGES){const t=(0,ul._)("sidebar.createDirectMessage","Create new direct message"),n=M.createElement(et.Z,{id:"new-group-tooltip",className:"hidden-xs"},t);i=M.createElement(M.Fragment,null,M.createElement(Kl,{category:e,handleOpenDirectMessagesModal:this.handleOpenDirectMessagesModal,isCollapsed:e.collapsed,isMenuOpen:this.state.isMenuOpen,onToggleMenu:this.handleMenuToggle}),M.createElement(tt.Z,{delayShow:500,placement:"top",overlay:n},M.createElement("button",{className:"SidebarChannelGroupHeader_addButton",onClick:this.handleOpenDirectMessagesModal,"aria-label":t},M.createElement("i",{className:"icon-plus"})))),s&&s.length||(o=!1)}else i=M.createElement($l,{category:e,isMenuOpen:this.state.isMenuOpen,onToggleMenu:this.handleMenuToggle});let l=e.display_name;return e.type!==Oi.y.CUSTOM&&(l=(0,ul._)("sidebar.types.".concat(e.type),e.display_name)),M.createElement(ui._l,{draggableId:e.id,index:t,disableInteractiveElementBlocking:!0},((t,s)=>M.createElement("div",Object.assign({className:W()("SidebarChannelGroup a11y__section",{autoSortedCategory:e.sorting===pl.r.Alphabetical||e.sorting===pl.r.Recency,dropDisabled:this.isDropDisabled(),menuIsOpen:this.state.isMenuOpen,capture:this.props.draggingState.state===N.bb.CAPTURE,isCollapsed:e.collapsed}),ref:t.innerRef},t.draggableProps),M.createElement(ui.bK,{droppableId:e.id,type:"SIDEBAR_CHANNEL",isDropDisabled:this.isDropDisabled()},((n,c)=>M.createElement("div",Object.assign({},n.droppableProps,{ref:n.innerRef,className:W()({draggingOver:c.isDraggingOver})}),M.createElement(Uo,{ref:this.categoryTitleRef,displayName:l,dragHandleProps:t.dragHandleProps,isCollapsed:e.collapsed,isCollapsible:o,isDragging:s.isDragging,isDraggingOver:c.isDraggingOver,muted:e.muted,onClick:this.handleCollapse},r,void 0,i),M.createElement("div",{className:"SidebarChannelGroup_content"},M.createElement("ul",{role:"list",className:"NavGroupContent"},this.renderNewDropBox(c.isDraggingOver),a,this.showPlaceholder()?n.placeholder:null))))))))}}ec(tc,"propTypes",{categoryIndex:y().number.isRequired,channelIds:y().arrayOf(y().string).isRequired,setChannelRef:y().func.isRequired,handleOpenMoreDirectChannelsModal:y().func.isRequired,getChannelRef:y().func.isRequired,isNewCategory:y().bool.isRequired,actions:y().shape({setCategoryCollapsed:y().func.isRequired,setCategorySorting:y().func.isRequired}).isRequired}),(0,Ae.t)("sidebar.types.channels"),(0,Ae.t)("sidebar.types.direct_messages"),(0,Ae.t)("sidebar.types.favorites");const sc=(0,n.connect)((function(){const e=(0,xi.kS)();return(t,s)=>({channelIds:e(t,s.category),draggingState:(0,xi.Qy)(t)})}),(function(e){return{actions:(0,a.bindActionCreators)({setCategoryCollapsed:Ri.No,setCategorySorting:Ri.Wp},e)}}))(tc);function nc(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",role:"img","aria-label":t({id:"generic_icons.arrow.down",defaultMessage:"Down Arrow Icon"})},M.createElement("path",{d:"M8.696 2H7.184V11L3.062 6.878L2 7.94L7.94 13.88L13.88 7.94L12.818 6.878L8.696 11V2Z"})))}function ac(e){return M.createElement("div",{id:"unreadIndicator"+e.name,className:W()("nav-pills__unread-indicator",{"nav-pills__unread-indicator--visible":e.show},e.extraClass),onClick:e.onClick},M.createElement(nc,{className:"icon icon__unread"}),e.content)}ac.propTypes={onClick:y().func.isRequired,show:y().bool,extraClass:y().string,content:y().node,name:y().string},ac.defaultProps={show:!1,extraClass:"",content:""};const ic=ac;function rc(e){const t=(0,Ys.Z)();return 0===e.unreadChannels.length?null:M.createElement("div",{className:"SidebarChannelGroup dropDisabled a11y__section"},M.createElement(jo,{displayName:t.formatMessage({id:"sidebar.types.unreads",defaultMessage:"UNREADS"})}),M.createElement("div",{className:"SidebarChannelGroup_content"},M.createElement("ul",{role:"list",className:"NavGroupContent"},e.unreadChannels.map(((t,s)=>M.createElement(Fl,{key:t.id,channelIndex:s,channelId:t.id,setChannelRef:e.setChannelRef,getChannelRef:e.getChannelRef,isCategoryCollapsed:!1,isCategoryDragged:!1,isDraggable:!1,isDropDisabled:!0,isAutoSortedCategory:!0}))))))}rc.propTypes={getChannelRef:y().func.isRequired,setChannelRef:y().func.isRequired,unreadChannels:y().array.isRequired};const oc=(0,n.connect)((function(e){return{unreadChannels:(0,xi.Xn)(e)}}))(rc);function lc(e){var t;const s=(0,Ys.Z)();if(e.categoryLoading&&0===e.sidebarIndex)return M.createElement("div",{className:"channel-loaidng"},M.createElement(Ga.Z,{message:"--"}));var n;if(0===e.channelIds.length&&null!==(t=e.category)&&void 0!==t&&t.display_name)return M.createElement("div",{className:"no-channels"},s.formatMessage({id:"sidebar.no_channels",defaultMessage:"Không tìm thấy Nhóm nào phù hợp với ".concat(null===(n=e.category)||void 0===n?void 0:n.display_name)}));let a;return 0!==e.channelIds.length&&(a=M.createElement(jo,{displayName:s.formatMessage({id:"sidebar.types.all_messages",defaultMessage:"Danh sách tin nhắn"})})),M.createElement(M.Fragment,null,M.createElement("div",{className:"SidebarChannelGroup dropDisabled a11y__section"},a,M.createElement("div",{className:"SidebarChannelGroup_content"},M.createElement("ul",{role:"list",className:"NavGroupContent"},e.channelIds.map(((t,s)=>M.createElement(Fl,{key:t,channelIndex:s,channelId:t,setChannelRef:e.setChannelRef,getChannelRef:e.getChannelRef,isCategoryCollapsed:!1,isCategoryDragged:!1,isDraggable:!1,isDropDisabled:!0,isAutoSortedCategory:!0})))))),e.categoryLoading&&e.sidebarIndex?M.createElement("div",{className:"channel-loaidng"},M.createElement(Ga.Z,{message:"--"})):null)}lc.propTypes={getChannelRef:y().func.isRequired,setChannelRef:y().func.isRequired,channelIds:y().arrayOf(y().string).isRequired,sidebarIndex:y().number.isRequired};const cc=(0,n.connect)((function(){const e=(0,Li.KK)(),t=(0,Li.bc)(),s=(0,Li.n9)();return n=>{const a=(0,xi.Ul)(n),i=(0,h.xJ)(n,a),r=(0,Li.n3)(n,a),o=(0,m.UY)(n,a),l=1===(0,h.dd)(n),c=(0,Mr.h4)(n);if("all"===a||r.type===Oi.y.DIRECT_MESSAGES){let a=o.reduce(((e,t)=>{const s=(0,m.mr)(n,t);return s&&e.push(s),e}),[]);return a=a.filter((e=>!!e&&!(0,$i.I)(c,e))),a=e(n,a),a=t(n,a),a=s(n,a),{channelIds:a.map((e=>e.id)),category:r,categoryLoading:l,sidebarIndex:i}}return{channelIds:r.channel_ids,category:r,categoryLoading:l,sidebarIndex:i}}}))(lc);function dc(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class hc extends M.PureComponent{constructor(e){super(e),dc(this,"toggleCategoryMute",(()=>{this.props.actions.setCategoryMuted(this.props.category.id,!this.props.category.muted)})),dc(this,"deleteCategory",(()=>{this.props.actions.openModal({modalId:N.r8.DELETE_CATEGORY,dialogType:zl,dialogProps:{category:this.props.category}})})),dc(this,"renameCategory",(()=>{this.props.actions.openModal({modalId:N.r8.EDIT_CATEGORY,dialogType:Ji,dialogProps:{categoryId:this.props.category.id,initialCategoryName:this.props.category.display_name}})})),dc(this,"createCategory",(()=>{this.props.actions.openModal({modalId:N.r8.EDIT_CATEGORY,dialogType:Ji}),(0,Ye.L9)("ui","ui_sidebar_category_menu_createCategory")})),dc(this,"handleSortChannels",(e=>{const{category:t}=this.props;this.props.actions.setCategorySorting(t.id,e),(0,Ye.L9)("ui","ui_sidebar_sort_dm_".concat(e))})),dc(this,"onToggleMenu",(e=>{this.props.onToggleMenu(e),e&&(0,Ye.L9)("ui","ui_sidebar_category_menu_opened")})),dc(this,"renderDropdownItems",(()=>{const{intl:e,category:t}=this.props;let s;if(t.type!==Oi.y.DIRECT_MESSAGES){let n;n=t.muted?e.formatMessage({id:"sidebar_left.sidebar_category_menu.unmuteCategory",defaultMessage:"Unmute Category"}):e.formatMessage({id:"sidebar_left.sidebar_category_menu.muteCategory",defaultMessage:"Mute Category"}),s=M.createElement(Is.Z.ItemAction,{id:"mute-".concat(t.id),onClick:this.toggleCategoryMute,icon:M.createElement("i",{className:"icon-bell-outline"}),text:n})}const n=[{id:"sortAlphabetical",direction:"right",text:e.formatMessage({id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}),action:()=>this.handleSortChannels(pl.r.Alphabetical)},{id:"sortByMostRecent",direction:"right",text:e.formatMessage({id:"sidebar.sortedByRecencyLabel",defaultMessage:"Recent Activity"}),action:()=>this.handleSortChannels(pl.r.Recency)},{id:"sortManual",direction:"right",text:e.formatMessage({id:"sidebar.sortedManually",defaultMessage:"Manually"}),action:()=>this.handleSortChannels(pl.r.Manual)}];let a,i,r,o;switch(t.type===Oi.y.CUSTOM&&(a=M.createElement(Is.Z.ItemAction,{isDangerous:!0,id:"delete-".concat(t.id),onClick:this.deleteCategory,icon:M.createElement("i",{className:"icon-trash-can-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_category_menu.deleteCategory",defaultMessage:"Delete Category"})}),i=M.createElement(Is.Z.ItemAction,{id:"rename-".concat(t.id),onClick:this.renameCategory,icon:M.createElement("i",{className:"icon-pencil-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_category_menu.renameCategory",defaultMessage:"Rename Category"})})),t.sorting){case pl.r.Alphabetical:r=e.formatMessage({id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"});break;case pl.r.Recency:r=e.formatMessage({id:"user.settings.sidebar.recent",defaultMessage:"Recent Activity"});break;default:r=e.formatMessage({id:"sidebar.sortedManually",defaultMessage:"Manually"})}switch(t.sorting){case pl.r.Alphabetical:o=M.createElement("i",{className:"icon-sort-alphabetical-ascending"});break;case pl.r.Recency:o=M.createElement("i",{className:"icon-clock-outline"});break;default:o=M.createElement("i",{className:"icon-format-list-bulleted"})}return M.createElement(M.Fragment,null,M.createElement(Is.Z.Group,null,s,i,a),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemSubMenu,{id:"sortChannels",subMenu:n,text:e.formatMessage({id:"sidebar.sort",defaultMessage:"Sort"}),selectedValueText:r,icon:o,direction:"right",openUp:this.state.openUp,styleSelectableItem:!0})),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{id:"create-".concat(t.id),onClick:this.createCategory,icon:M.createElement("i",{className:"icon-folder-plus-outline"}),text:e.formatMessage({id:"sidebar_left.sidebar_category_menu.createCategory",defaultMessage:"Create New Category"})})))})),dc(this,"refCallback",(e=>{e&&this.setState({openUp:e.state.openUp})})),this.state={showDeleteCategoryModal:!1,openUp:!1}}render(){const{intl:e,category:t}=this.props;return M.createElement(M.Fragment,null,M.createElement(vl,{refCallback:this.refCallback,id:"SidebarCategoryMenu-".concat(t.id),ariaLabel:e.formatMessage({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Category Menu"}),buttonAriaLabel:e.formatMessage({id:"sidebar_left.sidebar_category_menu.dropdownAriaLabel",defaultMessage:"Category Menu"}),isMenuOpen:this.props.isMenuOpen,onToggleMenu:this.onToggleMenu,tooltipText:e.formatMessage({id:"sidebar_left.sidebar_category_menu.editCategory",defaultMessage:"Category options"})},this.renderDropdownItems()))}}dc(hc,"propTypes",{currentTeamId:y().string.isRequired,isMenuOpen:y().bool.isRequired,onToggleMenu:y().func.isRequired,actions:y().shape({openModal:y().func.isRequired,setCategoryMuted:y().func.isRequired,setCategorySorting:y().func.isRequired}).isRequired});const pc=(0,K.ZP)(hc),uc=(0,n.connect)((function(){return e=>({currentTeamId:(0,u.kA)(e).id})}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h,setCategoryMuted:Ri.uN,setCategorySorting:Ri.Wp},e)}}))(pc),mc=e=>{const[t,s]=(0,M.useState)(!1);return M.createElement("div",{className:W()("category-filter-item",e.wrapClass)},M.createElement("button",{className:W()("btn category-btn",e.className),onClick:e.onClick},e.name),e.allowEdit?M.createElement(M.Fragment,null,M.createElement(uc,{category:e.category,isMenuOpen:t,onToggleMenu:()=>s((e=>!e))})):null)};mc.propTypes={name:y().string.isRequired,wrapClass:y().string,className:y().string,allowEdit:y().bool.isRequired,onClick:y().func.isRequired,onEdit:y().func};const gc=(0,n.connect)((function(e){return{currentCategory:(0,xi.Ul)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({setCurrentCategory:Gi,resetSidebarIndex:Vi,loadChannelsForCurrentCategory:Ii.k6,loadChannelsForCurrentUser2:Ii.Hc},e)}}))((e=>{const t=(0,Ys.Z)(),[s,n]=(0,M.useState)(!1),a=async(t,s)=>{e.actions.setCurrentCategory(t),e.actions.resetSidebarIndex(s),"all"!==t&&e.actions.loadChannelsForCurrentUser2()};return M.createElement("div",{className:W()("SidebarCategories a11y__section",{dropDisabled:!0,isCollapsed:s})},M.createElement(Uo,{displayName:t.formatMessage({id:"sidebar_left.sidebar_category_menu.category",defaultMessage:"Phân loại"}),isCollapsed:s,isCollapsible:!0,muted:!1,onClick:()=>n((e=>!e))}),M.createElement("div",{className:W()("SidebarChannelGroup_content SidebarCategories_content animating",{collapsed:s})},M.createElement("div",{className:W()("ChannelFilterItems animating",{collapsed:s})},M.createElement(mc,{wrapClass:W()({active:"all"===e.currentCategory}),className:W()({"btn-primary":"all"===e.currentCategory}),name:"Tất cả",onClick:()=>a("all",""),allowEdit:!1}),e.categories.map((s=>{let n=s.display_name;return s.type!==Oi.y.CUSTOM&&(n=t.formatMessage({id:"sidebar.types.".concat(s.type),defaultMessage:s.display_name})),M.createElement(mc,{key:s.id,wrapClass:W()({active:e.currentCategory===s.id}),className:W()({"btn-primary":e.currentCategory===s.id}),name:n,onClick:()=>a(s.id,s.type),allowEdit:!0,category:s})})))))}));var fc=s(55165),Ec=s(82704);const Cc=e=>M.createElement("svg",Object.assign({width:"14",height:"13",viewBox:"0 0 14 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),M.createElement("path",{d:"M11.7952 0.00524884C12.1312 0.00524884 12.4144 0.125249 12.6448 0.365248C12.8848 0.595648 13.0048 0.878848 13.0048 1.21485V8.41485C13.0048 8.75085 12.8848 9.03405 12.6448 9.26445C12.4144 9.49485 12.1312 9.61005 11.7952 9.61005H3.4L0.9952 12.0148V1.21485C0.9952 0.878848 1.1104 0.595648 1.3408 0.365248C1.5808 0.125249 1.8688 0.00524884 2.2048 0.00524884H11.7952ZM2.2048 1.21485V9.10605L2.896 8.41485H11.7952V1.21485H2.2048ZM3.4 3.01485H10.6V4.21005H3.4V3.01485ZM3.4 5.40525H8.8V6.61485H3.4V5.40525Z"})),bc=()=>{const{formatMessage:e}=(0,Ys.Z)(),t=(0,n.useDispatch)(),s=(0,n.useSelector)(d.ym),{url:a}=(0,i.$B)(),{pathname:r}=(0,i.TH)(),o=null!=(0,i.LX)(r,{path:"/:team/threads/:threadIdentifier?"}),{currentTeamId:l,currentUserId:c}=(0,Ec.Q)(),h=(0,n.useSelector)(pi.Pd),p=(0,n.useSelector)(xi.fI),u=null==h?void 0:h.total_unread_threads;return(0,M.useEffect)((()=>{s&&t((0,fc.hr)(c,l,{perPage:5}))}),[l]),!s||p&&!o&&!u?null:M.createElement("ul",{className:"SidebarGlobalThreads NavGroupContent nav nav-pills__container"},M.createElement("li",{className:W()("SidebarChannel",{active:o,unread:u}),tabIndex:-1},M.createElement(ht.Link,{to:"".concat(a,"/threads"),draggable:"false",className:W()("SidebarLink sidebar-item",{"unread-title":Boolean(u)}),role:"listitem",tabIndex:0},M.createElement("span",{className:"icon"},M.createElement(Cc,null)),M.createElement("div",{className:"SidebarChannelLinkLabel_wrapper"},M.createElement("span",{className:"SidebarChannelLinkLabel sidebar-item__name"},e({id:(0,Ae.t)("globalThreads.sidebarLink"),defaultMessage:"Threads"}))),(null==h?void 0:h.total_unread_mentions)>0&&M.createElement(ml,{unreadMentions:h.total_unread_mentions}))))};function _c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function vc(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function yc(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"}))}function Mc(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--verticalTrack"}))}function Pc(e){return M.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}class wc extends M.PureComponent{constructor(e){super(e),_c(this,"channelRefs",void 0),_c(this,"scrollbar",void 0),_c(this,"animate",void 0),_c(this,"scrollAnimation",void 0),_c(this,"scrollDebounced",void 0),_c(this,"updateMore",void 0),_c(this,"loadMore",void 0),_c(this,"loaded",void 0),_c(this,"getDisplayedChannelIds",(()=>this.props.displayedChannels.map((e=>e.id)))),_c(this,"getChannelRef",(e=>this.channelRefs.get(e))),_c(this,"setChannelRef",((e,t)=>{t?this.channelRefs.set(e,t):this.channelRefs.delete(e)})),_c(this,"getFirstUnreadChannelFromChannelIdArray",(e=>this.props.currentChannelId?e.find((e=>e!==this.props.currentChannelId&&this.props.unreadChannelIds.includes(e))):null)),_c(this,"handleScrollAnimationUpdate",(e=>{const t=e.getCurrentValue();this.scrollbar.current.scrollTop(t)})),_c(this,"scrollToFirstUnreadChannel",(()=>{this.scrollToChannel(this.getFirstUnreadChannel(),!0)})),_c(this,"scrollToLastUnreadChannel",(()=>{this.scrollToChannel(this.getLastUnreadChannel(),!0)})),_c(this,"scrollToChannel",((e,t=!1)=>{if(!e)return;const s=this.channelRefs.get(e);if(!s)return;const n=s.offsetTop,a=n+s.offsetHeight,i=this.scrollbar.current.getScrollTop(),r=this.scrollbar.current.getClientHeight();if(n<i+32){const s=t||!this.state.showTopUnread?10:72;let a;const i=this.getDisplayedChannelIds();a=i.length>0&&i[0]===e?0:n-s-32,this.scrollToPosition(a)}else if(a>i+r){const e=a-r+(t||!this.state.showBottomUnread?10:72);this.scrollToPosition(e)}})),_c(this,"scrollToPosition",(e=>{this.scrollAnimation.setCurrentValue(this.scrollbar.current.getScrollTop()).setAtRest(),this.scrollAnimation.setEndValue(e)})),_c(this,"updateUnreadIndicators",(()=>{if(this.props.draggingState.state)return void this.setState({showTopUnread:!1,showBottomUnread:!1});let e=!1,t=!1;const s=this.getFirstUnreadChannel(),n=this.getLastUnreadChannel();if(s){const t=this.channelRefs.get(s);t&&t.offsetTop+t.offsetHeight-10-32<this.scrollbar.current.getScrollTop()&&(e=!0)}if(n){const e=this.channelRefs.get(n);e&&e.offsetTop+10>this.scrollbar.current.getScrollTop()+this.scrollbar.current.getClientHeight()&&(t=!0)}e===this.state.showTopUnread&&t===this.state.showBottomUnread||this.setState({showTopUnread:e,showBottomUnread:t})})),_c(this,"getFirstUnreadChannel",(()=>this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds()))),_c(this,"getLastUnreadChannel",(()=>this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds().reverse()))),_c(this,"navigateChannelShortcut",(e=>{if(!e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||!I.pD(e,N.gT.KeyCodes.UP)&&!I.pD(e,N.gT.KeyCodes.DOWN))I._E(e)&&e.shiftKey&&I.pD(e,N.gT.KeyCodes.K)&&this.props.handleOpenMoreDirectChannelsModal(e);else{e.preventDefault();const t=this.getDisplayedChannelIds(),s=this.props.currentChannelId;let n=-1;for(let e=0;e<t.length;e++)t[e]===s&&(n=e);let a=n;a=I.pD(e,N.gT.KeyCodes.DOWN)?n+1:n-1;const i=t[I.wQ(a,t.length)];this.props.actions.switchToChannelById(i),this.scrollToChannel(i)}})),_c(this,"navigateUnreadChannelShortcut",(e=>{if(e.altKey&&e.shiftKey&&!e.ctrlKey&&!e.metaKey&&(I.pD(e,N.gT.KeyCodes.UP)||I.pD(e,N.gT.KeyCodes.DOWN))){e.preventDefault();const t=this.getDisplayedChannelIds();let s=0;s=I.pD(e,N.gT.KeyCodes.UP)?-1:1;const n=hl.MX(this.props.currentChannelId,t,this.props.unreadChannelIds,s);if(-1!==n){const e=t[n];this.props.actions.switchToChannelById(e),this.scrollToChannel(e)}}})),_c(this,"renderCategory",((e,t)=>M.createElement(sc,{key:e.id,category:e,categoryIndex:t,setChannelRef:this.setChannelRef,handleOpenMoreDirectChannelsModal:this.props.handleOpenMoreDirectChannelsModal,getChannelRef:this.getChannelRef,isNewCategory:this.props.newCategoryIds.includes(e.id)}))),_c(this,"onScroll",(async()=>{var e,t,s;this.scrollDebounced&&this.scrollDebounced();const n=(null===(e=this.scrollbar.current)||void 0===e?void 0:e.getScrollHeight())||0;((null===(t=this.scrollbar.current)||void 0===t?void 0:t.getScrollTop())||0)+((null===(s=this.scrollbar.current)||void 0===s?void 0:s.getClientHeight())||0)+216>=n&&this.props.allowLoadmore&&!this.state.loadMore&&(this.setState({loadMore:!0}),this.handleLoadMore())})),_c(this,"handleLoadMore",(async()=>{this.loadMore&&-1===this.props.sidebarIndex||(this.loadMore=!0,await this.props.actions.loadMoreChannelsForCurrentUser(this.props.sidebarIndex+1,this.updateMore),this.setState({loadMore:!0}),this.loadMore=!1)})),_c(this,"onTransitionEnd",rr()((()=>{this.updateUnreadIndicators()}),100)),_c(this,"onBeforeCapture",(e=>{this.channelRefs.forEach((e=>e.classList.remove("animating")));const t=[...document.querySelectorAll('[data-rbd-droppable-id*="droppable-categories"]')];t[0].style.height="".concat(t[0].scrollHeight,"px"),this.props.multiSelectedChannelIds.find((t=>e.draggableId===t))||this.props.actions.clearChannelSelection();const s={state:N.bb.CAPTURE,id:e.draggableId};if(this.props.categories.some((t=>t.id===e.draggableId)))s.type=N.Hl.CATEGORY;else{const t=this.props.displayedChannels.filter((t=>-1!==this.props.multiSelectedChannelIds.indexOf(t.id)||t.id===e.draggableId));t.every((e=>e.type===D.LQ.DM_CHANNEL||e.type===D.LQ.GM_CHANNEL))?s.type=N.Hl.DM:t.every((e=>e.type!==D.LQ.DM_CHANNEL&&e.type!==D.LQ.GM_CHANNEL))?s.type=N.Hl.CHANNEL:s.type=N.Hl.MIXED_CHANNELS}this.props.actions.setDraggingState(s)})),_c(this,"onBeforeDragStart",(()=>{this.props.actions.setDraggingState({state:N.bb.BEFORE})})),_c(this,"onDragStart",(e=>{this.props.onDragStart(e),this.props.actions.setDraggingState({state:N.bb.DURING}),[...document.querySelectorAll('[data-rbd-droppable-id*="droppable-categories"]')][0].style.height=""})),_c(this,"onDragEnd",(e=>{this.props.onDragEnd(e),"DROP"===e.reason&&e.destination&&("SIDEBAR_CHANNEL"===e.type?(this.props.actions.moveChannelsInSidebar(e.destination.droppableId,e.destination.index,e.draggableId),(0,Ye.L9)("ui","ui_sidebar_dragdrop_dropped_channel")):"SIDEBAR_CATEGORY"===e.type&&(this.props.actions.moveCategory(this.props.currentTeam.id,e.draggableId,e.destination.index),(0,Ye.L9)("ui","ui_sidebar_dragdrop_dropped_category"))),this.props.actions.stopDragging()})),this.channelRefs=new Map,this.state={showTopUnread:!1,showBottomUnread:!1,loadMore:!1},this.loadMore=!1,this.loaded=!1,this.scrollbar=M.createRef(),this.animate=new dl.SpringSystem,this.scrollAnimation=this.animate.createSpring(),this.scrollAnimation.setOvershootClampingEnabled(!0),this.scrollAnimation.addListener({onSpringUpdate:this.handleScrollAnimationUpdate}),this.scrollDebounced=rr()((()=>{this.updateUnreadIndicators()}),100),this.updateMore=rr()((()=>{this.setState({loadMore:!1})}),2e3)}componentDidMount(){this.loaded=!0,document.addEventListener("keydown",this.navigateChannelShortcut),document.addEventListener("keydown",this.navigateUnreadChannelShortcut)}componentWillUnmount(){this.loaded=!1,document.removeEventListener("keydown",this.navigateChannelShortcut),document.removeEventListener("keydown",this.navigateUnreadChannelShortcut)}componentDidUpdate(e){this.props.currentChannelId&&e.currentChannelId&&(this.props.currentTeam!==e.currentTeam&&this.scrollbar.current.scrollToTop(),this.props.currentChannelId,e.currentChannelId,this.props.currentChannelId!==e.currentChannelId&&this.props.actions.close(),this.updateUnreadIndicators())}render(){const{categories:e,isCategoryAll:t}=this.props;let s;this.props.showUnreadsCategory&&t&&(s=M.createElement(oc,{getChannelRef:this.getChannelRef,setChannelRef:this.setChannelRef}));const n=M.createElement(M.Fragment,null,s,M.createElement(cc,{getChannelRef:this.getChannelRef,setChannelRef:this.setChannelRef})),a=M.createElement(V.Z,{id:"sidebar.unreads",defaultMessage:"More unreads"}),i=M.createElement(V.Z,{id:"sidebar.unreads",defaultMessage:"More unreads"}),r=I._u("accessibility.sections.lhsList","channel sidebar region");return M.createElement("div",{id:"sidebar-left",role:"application","aria-label":r,className:W()("SidebarNavContainer a11y__region",{disabled:this.props.isUnreadFilterEnabled}),"data-a11y-disable-nav":Boolean(this.props.draggingState.type),"data-a11y-sort-order":"7",onTransitionEnd:this.onTransitionEnd},M.createElement(gc,{categories:e}),M.createElement(ic,{name:"Top",show:this.state.showTopUnread,onClick:this.scrollToFirstUnreadChannel,extraClass:"nav-pills__unread-indicator-top",content:a}),M.createElement(ic,{name:"Bottom",show:this.state.showBottomUnread,onClick:this.scrollToLastUnreadChannel,extraClass:"nav-pills__unread-indicator-bottom",content:i}),M.createElement("div",{className:"channel__list-container"},M.createElement(dt.ZP,{ref:this.scrollbar,autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:yc,renderThumbVertical:Pc,renderTrackVertical:Mc,renderView:vc,onScroll:this.onScroll,style:{position:"absolute"}},M.createElement(bc,null),n,this.props.allowLoadmore&&!this.props.sidebarLoading&&this.props.sidebarIndex>0?M.createElement("div",{className:"sidebar__load-more"},M.createElement("p",{onClick:this.handleLoadMore},"Xem thêm")):null)))}}_c(wc,"propTypes",{currentChannelId:y().string.isRequired,categories:y().array.isRequired,unreadChannelIds:y().arrayOf(y().string).isRequired,isUnreadFilterEnabled:y().bool.isRequired,displayedChannels:y().array.isRequired,newCategoryIds:y().arrayOf(y().string).isRequired,multiSelectedChannelIds:y().arrayOf(y().string).isRequired,showUnreadsCategory:y().bool.isRequired,isCategoryAll:y().bool.isRequired,sidebarIndex:y().number.isRequired,allowLoadmore:y().bool.isRequired,sidebarLoading:y().bool.isRequired,handleOpenMoreDirectChannelsModal:y().func.isRequired,onDragStart:y().func.isRequired,onDragEnd:y().func.isRequired,actions:y().shape({moveChannelsInSidebar:y().func.isRequired,moveCategory:y().func.isRequired,switchToChannelById:y().func.isRequired,close:y().func.isRequired,setDraggingState:y().func.isRequired,stopDragging:y().func.isRequired,clearChannelSelection:y().func.isRequired,multiSelectChannelAdd:y().func.isRequired,sidebarGetMore:y().func.isRequired,loadChannelsForCurrentUser:y().func.isRequired,loadChannelsForCurrentUser2:y().func.isRequired,loadChannelsForCurrentCategory:y().func.isRequired,loadMoreChannelsForCurrentUser:y().func.isRequired}).isRequired});const Sc=(0,n.connect)((function(e){const t=(0,u.kA)(e),s=(0,xi.Ul)(e),n=(0,Li.n3)(e,s),a=!n||n&&n.type===Oi.y.DIRECT_MESSAGES,i=1===(0,h.dd)(e);return{currentTeam:t,currentChannelId:(0,m.gO)(e),categories:(0,xi.Yy)(e),isUnreadFilterEnabled:(0,xi.fI)(e),unreadChannelIds:(0,m.pb)(e),displayedChannels:(0,xi.ER)(e),draggingState:(0,xi.Qy)(e),newCategoryIds:e.views.channelSidebar.newCategoryIds,multiSelectedChannelIds:e.views.channelSidebar.multiSelectedChannelIds,showUnreadsCategory:(0,d.hC)(e),isCategoryAll:"all"===s,sidebarIndex:(0,h.xJ)(e,s),allowLoadmore:a,sidebarLoading:i}}),(function(e){return{actions:(0,a.bindActionCreators)({close:Ho.xv,switchToChannelById:b.j9,moveChannelsInSidebar:ji,moveCategory:Ri.Wr,setDraggingState:Di,stopDragging:Zi,clearChannelSelection:Ui,multiSelectChannelAdd:Fi,sidebarGetMore:cl.Qq,loadChannelsForCurrentUser:Ii.b9,loadChannelsForCurrentUser2:Ii.Hc,loadMoreChannelsForCurrentUser:Ii.Ey,loadChannelsForCurrentCategory:Ii.k6},e)}}))(wc);class Tc extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})))}}class Nc extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 20 20",fill:"currentColor"},M.createElement("path",{fillRule:"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z",clipRule:"evenodd"})))}}var Rc=s(88835);class Ic extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"none",stroke:"currentColor"},M.createElement("path",{fill:"currentColor",d:"M436 160c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h320c26.5 0 48-21.5 48-48v-48h20c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20v-64h20c6.6 0 12-5.4 12-12v-40c0-6.6-5.4-12-12-12h-20v-64h20zm-228-32c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zm112 236.8c0 10.6-10 19.2-22.4 19.2H118.4C106 384 96 375.4 96 364.8v-19.2c0-31.8 30.1-57.6 67.2-57.6h5c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h5c37.1 0 67.2 25.8 67.2 57.6v19.2z"})))}}class Oc extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 384 512",stroke:"currentColor"},M.createElement("path",{fill:"currentColor",d:"M336 0H48C21.49 0 0 21.49 0 48v464l192-112 192 112V48c0-26.51-21.49-48-48-48zm0 428.43l-144-84-144 84V54a6 6 0 0 1 6-6h276c3.314 0 6 2.683 6 5.996V428.43z"})))}}class Lc extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{className:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",fill:"currentColor",stroke:"currentColor"},M.createElement("path",{fill:"currentColor",d:"M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400 0 512z"})))}}class Ac extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"star",className:t,role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},M.createElement("path",{fill:"currentColor",d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"})))}}class kc extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})))}}var xc=s(10806);const Dc={day:"1",week:"7",month:"30"};function Zc(e){return async(t,s)=>{let n;const a=Dc[e]||"";try{n=await Ws.je.getRanks(a,"hot")}catch(e){return(0,cn._f)(e,t,s),{error:e}}return t((0,xc.$C)([{type:Ai.TI.RECEIVED_RANKS,data:{period:e,ranks:n.ranks}},{type:Ai.bZ.RECEIVED_PROFILES_LIST,data:n.users}])),{data:n}}}function Hc(e){return async(t,s)=>{let n;const a=Dc[e]||"";try{n=await Ws.je.getRanks(a,"commit")}catch(e){return(0,cn._f)(e,t,s),{error:e}}return t((0,xc.$C)([{type:Ai.TI.RECEIVED_RANKS2,data:{period:e,ranks:n.ranks}},{type:Ai.bZ.RECEIVED_PROFILES_LIST,data:n.users}])),{data:n}}}function qc(e){return String(e).replace(/(.)(?=(\d{3})+$)/g,"$1.")}const jc=e=>{const t=e.data[0],s=e.data[1],n=e.data[2];let a="Bảng xếp hạng";return"hot"===e.type&&(a="Hạng cao thủ"),"commit"===e.type&&(a="Bảng cống hiến"),M.createElement("div",{className:W()("user-rank-modal__switch-tab-item",{active:e.selected})},M.createElement("div",{className:W()("user-rank-modal__switch-tab-item-content")},M.createElement("div",{className:W()("user-rank-modal__switch-tab-item-highlight",e.type)},M.createElement("div",{className:"action-bar"},M.createElement("h3",{className:"title"},a),M.createElement("button",{className:W()("button-item",{active:"month"===e.period}),onClick:()=>e.onChangePeriod(e.type,"month")},"Tháng"),M.createElement("button",{className:W()("button-item",{active:"week"===e.period}),onClick:()=>e.onChangePeriod(e.type,"week")},"Tuần"),M.createElement("button",{className:W()("button-item",{active:"day"===e.period}),onClick:()=>e.onChangePeriod(e.type,"day")},"Ngày")),M.createElement("div",{className:"top-list"},M.createElement("div",{className:W()("top-list-item","top-2")},M.createElement("div",{className:W()("top-list-col")},M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(s.id,s.last_picture_update),size:"xxl",userId:s.id,hasMention:!1,username:s.username}),M.createElement("div",{className:"top-list-col-wrapname"},M.createElement("div",{className:W()("top-list-col-name",e.type)},M.createElement(Et.Z,{userId:s.id,channelId:"",hideStatus:!0,disablePopover:!0}))),M.createElement("div",{className:W()("top-list-col-score",e.type)},qc(s.score)))),M.createElement("div",{className:W()("top-list-item","top-1")},M.createElement("div",{className:W()("top-list-col")},M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(t.id,t.last_picture_update),size:"xxl",userId:t.id,hasMention:!1,username:t.username}),M.createElement("div",{className:"top-list-col-wrapname"},M.createElement("div",{className:W()("top-list-col-name",e.type)},M.createElement(Et.Z,{userId:t.id,channelId:"",hideStatus:!0,disablePopover:!0}))),M.createElement("div",{className:W()("top-list-col-score",e.type)},qc(t.score)))),M.createElement("div",{className:W()("top-list-item","top-3")},M.createElement("div",{className:W()("top-list-col")},M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(n.id,n.last_picture_update),size:"xxl",userId:n.id,hasMention:!1,username:n.username}),M.createElement("div",{className:"top-list-col-wrapname"},M.createElement("div",{className:W()("top-list-col-name",e.type)},M.createElement(Et.Z,{userId:n.id,channelId:"",hideStatus:!0,disablePopover:!0}))),M.createElement("div",{className:W()("top-list-col-score",e.type)},qc(n.score)))))),M.createElement("div",{className:"user-rank-modal__switch-tab-item-list"},M.createElement("div",{className:"user-rank-modal__switch-tab-item-list-content"},e.data.map(((e,t)=>t<3?M.createElement(M.Fragment,{key:"rank-commit-".concat(e.id)}):M.createElement("div",{key:"rank-commit-".concat(e.id),className:"rank-col-item"},M.createElement("div",{className:"rank-col-number"},t+1),M.createElement("div",{className:"rank-col-avatar"},M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(e.id,e.last_picture_update),size:"xl",userId:e.id,hasMention:!1,username:e.username})),M.createElement("div",{className:"rank-col-name"},M.createElement(Et.Z,{userId:e.id,channelId:"",hideStatus:!0,disablePopover:!0})),M.createElement("div",{className:"rank-col-score"},qc(e.score)))))))))};function Uc(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Fc(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(s),!0).forEach((function(t){Bc(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Uc(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Bc(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Gc extends M.PureComponent{constructor(e){super(e),Bc(this,"doHide",(()=>{this.setState({show:!1})})),Bc(this,"handleExit",(()=>{this.props.onHide()})),Bc(this,"switchRank",(e=>{this.setState({picked:e})})),Bc(this,"handleChangePeriod",((e,t)=>{"hot"===e&&(this.setState({loading:!0}),this.props.actions.fetchRanks(t)),"commit"===e&&(this.setState({loading2:!0}),this.props.actions.fetchRanks2(t))})),this.state={show:!0,loading:!0,loading2:!0,picked:"hot"}}static getDerivedStateFromProps(e,t){return e.isLoading!==t.loading||e.isLoading2!==t.loading2?Fc(Fc({},t),{},{loading:e.isLoading,loading2:e.isLoading2}):null}componentDidMount(){this.props.actions.fetchRanks("day"),this.props.actions.fetchRanks2("day")}render(){const{picked:e,loading:t,loading2:s}=this.state,{period:n,ranksData:a,period2:i,ranksData2:r}=this.props,o=[];return t?o.push(M.createElement("div",{key:"user-rank-hot",className:W()("user-rank-modal__switch-tab-item",{active:"hot"===e})},M.createElement("p",{className:"text-center text-loading"},"Đang tải..."))):o.push(M.createElement(jc,{key:"user-rank-hot",type:"hot",period:n,data:a,selected:"hot"===e,onChangePeriod:this.handleChangePeriod})),s?o.push(M.createElement("div",{key:"user-rank-commit",className:W()("user-rank-modal__switch-tab-item",{active:"commit"===e})},M.createElement("p",{className:"text-center text-loading"},"Đang tải..."))):o.push(M.createElement(jc,{key:"user-rank-commit",type:"commit",period:i,data:r,selected:"commit"===e,onChangePeriod:this.handleChangePeriod})),M.createElement(G.Z,{dialogClassName:"a11y__modal about-modal UserRankModal",show:this.state.show,onHide:this.doHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"userRankModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"userRankModalLabel"},M.createElement(V.Z,{id:"user_rank.title",defaultMessage:"Bảng xếp hạng"}))),M.createElement(G.Z.Body,null,M.createElement("div",{className:"user-rank-modal__content"},M.createElement("div",{key:"switch-bar",className:"user-rank-modal__switch-bar"},M.createElement("div",{className:"user-rank-modal__switch-bar-content"},M.createElement("button",{className:W()("user-rank-modal__switch-bar-btn",{active:"hot"===e}),onClick:()=>this.switchRank("hot")},"Hạng cao thủ"),M.createElement("button",{className:W()("user-rank-modal__switch-bar-btn",{active:"commit"===e}),onClick:()=>this.switchRank("commit")},"Bảng cống hiến"))),M.createElement("div",{className:"user-rank-modal__switch-tab"},o))))}}function Vc(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Kc(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Vc(Object(s),!0).forEach((function(t){Yc(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Vc(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Yc(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Bc(Gc,"propTypes",{onHide:y().func.isRequired,show:y().bool,ranksData:y().any.isRequired,ranksData2:y().any.isRequired,period:y().any.isRequired,period2:y().any.isRequired,isLoading:y().bool.isRequired,isLoading2:y().bool.isRequired,actions:y().shape({fetchRanks:y().func.isRequired,fetchRanks2:y().func.isRequired}).isRequired});const Wc=(0,n.connect)((function(e){const t=N.r8.USER_RANK,s=function(e){return e.entities.ranks.ranks}(e),n=function(e){return e.entities.ranks.ranks2}(e),a=s.current||"",i=n.current||"";let r=[],o=[];a&&(r=s[a]||[]),i&&(o=n[i]||[]);const l=!a,c=!i;return!l&&r.length&&(r=r.map((t=>Kc(Kc({},(0,p.PR)(e,t.user_id)),{},{score:t.score})))),!c&&o.length&&(o=o.map((t=>Kc(Kc({},(0,p.PR)(e,t.user_id)),{},{score:t.score})))),{show:(0,Ms.g)(e,t),ranksData:r,ranksData2:o,period:a,period2:i,isLoading:l,isLoading2:c}}),(function(e){return{actions:(0,a.bindActionCreators)({fetchRanks:Zc,fetchRanks2:Hc},e)}}))(Gc);var zc=s(76938);function Jc(e){return{type:N.MF.STATUS_DROPDOWN_TOGGLE,open:e}}var Xc=s(13776),Qc=s(95421),$c=s(84220),ed=s(50928),td=s(12341),sd=s(8696),nd=s(93065),ad=s(86733),id=s(85175);function rd(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function od(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?rd(Object(s),!0).forEach((function(t){ld(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):rd(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ld(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class cd extends M.PureComponent{constructor(e){super(e),ld(this,"formatDate",(e=>{const t=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0");return[e.getFullYear().toString(),t,s].join("-")})),ld(this,"getText",(()=>({modalHeaderText:M.createElement(V.Z,{id:"dnd_custom_time_picker_modal.defaultMsg",defaultMessage:"Disable notifications until"}),confirmButtonText:M.createElement(V.Z,{id:"dnd_custom_time_picker_modal.submitButton",defaultMessage:"Disable Notifications"})}))),ld(this,"handleConfirm",(e=>{e.preventDefault();const t=parseInt(this.state.selectedTime.split(":")[0],10),s=parseInt(this.state.selectedTime.split(":")[1],10),n=new Date(this.state.selectedDate);n.setHours(t,s),n<new Date||(this.props.actions.setStatus({user_id:this.props.userId,status:N.gg.DND,dnd_end_time:(0,id.J5)(n),manual:!0,last_activity_at:(0,id.J5)(this.props.currentDate)}),this.props.onHide())})),ld(this,"handleDaySelection",(e=>{this.setState(od({selectedDate:e},this.makeTimeMenuList(e)))})),ld(this,"makeTimeMenuList",(e=>{const t=[];let s=0,n=0;const a=this.props.currentDate;this.formatDate(a)===this.formatDate(e)&&(s=a.getHours(),n=a.getMinutes(),n>20?(s++,n=0):n=30);for(let e=s;e<24;e++)for(let s=n/30;s<2;s++){const n=e.toString().padStart(2,"0")+":"+(30*s).toString().padStart(2,"0");t.push(n)}return{timeMenuList:t,selectedTime:t[0]}}));const{currentDate:t}=this.props,s=new Date(t);23===t.getHours()&&t.getMinutes()>20&&s.setDate(t.getDate()+1),this.state=od({selectedDate:s,dayPickerStartDate:s},this.makeTimeMenuList(s))}render(){const{modalHeaderText:e,confirmButtonText:t}=this.getText(),{timeMenuList:s,selectedTime:n,selectedDate:a,dayPickerStartDate:i}=this.state,r=s.map((e=>M.createElement(Is.Z.ItemAction,{id:"dndTime_dropdown_".concat(e),key:e,text:e,ariaLabel:"".concat(e," hours"),onClick:()=>{this.setState({selectedTime:e})}},e)));return M.createElement(Yi.Z,{onHide:this.props.onHide,modalHeaderText:e,confirmButtonText:t,id:"dndCustomTimePickerModal",className:"DndModal modal-overflow"},M.createElement("div",{className:"DndModal__content"},M.createElement("div",null,M.createElement("div",{className:"DndModal__input DndModal__input--no-border"},M.createElement("div",{className:"DndModal__input__label"},M.createElement(V.Z,{id:"dnd_custom_time_picker_modal.date",defaultMessage:"Date"})),M.createElement("i",{className:"icon icon--no-spacing icon-calendar-outline icon--xs icon-14"}),M.createElement(ad.default,{value:this.formatDate(a),onDayChange:this.handleDaySelection,dayPickerProps:{selectedDays:a,disabledDays:{before:i}}}))),M.createElement(Os.Z,{id:"dropdown-no-caret",stopPropagationOnToggle:!0},M.createElement("button",{className:"DndModal__input",type:"button"},M.createElement("div",{className:"DndModal__input__label"},M.createElement(V.Z,{id:"dnd_custom_time_picker_modal.time",defaultMessage:"Time"})),M.createElement("i",{className:"icon icon--no-spacing icon-clock-outline icon--xs icon-14"}),M.createElement("span",null,n)),M.createElement(Is.Z,{openLeft:!1,ariaLabel:"Clear custom status after"},r))),M.createElement("div",{className:"DndModal__footer"},M.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleConfirm},t)))}}ld(cd,"propTypes",{onHide:y().func.isRequired,userId:y().string.isRequired,currentDate:y().instanceOf(Date).isRequired,actions:y().shape({setStatus:y().func.isRequired}).isRequired});const dd=(0,n.connect)((function(e){return{userId:(0,p.rc)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({setStatus:r.Tf},e)}}))(cd);var hd=s(58367),pd=s(36356);function ud(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class md extends M.PureComponent{constructor(e){super(e),ud(this,"getCurrentDateTime",((e,t)=>{let s=new Date;return t&&(s=e.useAutomaticTimezone?(0,hd.uH)(e.automaticTimezone):(0,hd.uH)(e.manualTimezone)),s})),ud(this,"dndTimes",["30 mins","1 hour","2 hours","Tomorrow","Custom"]),ud(this,"isUserOutOfOffice",(()=>this.props.status===N.gg.OUT_OF_OFFICE)),ud(this,"setStatus",((e,t)=>{this.props.actions.setStatus({user_id:this.props.userId,status:e,dnd_end_time:t})})),ud(this,"setOnline",(e=>{e.preventDefault(),this.setStatus(N.gg.ONLINE,"")})),ud(this,"setOffline",(e=>{e.preventDefault(),this.setStatus(N.gg.OFFLINE,"")})),ud(this,"setAway",(e=>{e.preventDefault(),this.setStatus(N.gg.AWAY,"")})),ud(this,"setDnd",((e,t)=>{e.preventDefault();const s=this.getCurrentDateTime(this.props.userTimezone,this.props.isTimezoneEnabled),n=s.getTime();let a;switch(t){case 0:a=new Date(n+18e5);break;case 1:a=new Date(n+36e5);break;case 2:a=new Date(n+72e5);break;case 3:a=new Date(s.getDate()+1),a.setHours(23,59,59,999)}var i=(0,id.J5)(a);this.setStatus(N.gg.DND,i)})),ud(this,"setCustomTimedDnd",(()=>{const e={ModalId:N.r8.DND_CUSTOM_TIME_PICKER,dialogType:dd,dialogProps:{userId:this.props.userId,currentDate:this.getCurrentDateTime(this.props.userTimezone,this.props.isTimezoneEnabled)}};this.props.actions.openModal(e)})),ud(this,"showStatusChangeConfirmation",(e=>{const t={ModalId:N.r8.RESET_STATUS,dialogType:He,dialogProps:{newStatus:e}};this.props.actions.openModal(t)})),ud(this,"renderProfilePicture",(()=>this.props.profilePicture?M.createElement(_n.Z,{size:"lg",url:this.props.profilePicture}):null)),ud(this,"renderDropdownIcon",(()=>M.createElement(V.Z,{id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"},(e=>M.createElement("i",{className:"fa fa-caret-down","aria-label":e}))))),ud(this,"handleClearStatus",(e=>{e.stopPropagation(),e.preventDefault(),this.props.actions.unsetCustomStatus()})),ud(this,"onToggle",(e=>this.props.actions.setStatusDropdown(e))),ud(this,"renderCustomStatus",(()=>{if(!this.props.isCustomStatusEnabled)return null;const e=this.props.customStatus,t=e&&(e.text||e.emoji),s=t?e.text:(0,I._u)("status_dropdown.set_custom","Set a Custom Status"),n=t?M.createElement("span",{className:"d-flex"},M.createElement(cr.Z,{showTooltip:!1,emojiStyle:{marginLeft:0}})):M.createElement(ee.Z,{className:"custom-status-emoji"}),a=t&&M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:M.createElement(et.Z,{id:"clear-custom-status"},M.createElement(V.Z,{id:"status_dropdown.custom_status.tooltip_clear",defaultMessage:"Clear"}))},M.createElement("button",{className:"style--none input-clear-x",id:"custom_status__clear",onClick:this.handleClearStatus},M.createElement("i",{className:"icon icon-close-circle"}))),i=!t&&this.props.showCustomStatusPulsatingDot&&M.createElement("span",{className:"pulsating_dot"});return M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemToggleModalRedux,{accessibilityLabel:"Custom Status",modalId:N.r8.CUSTOM_STATUS,dialogType:$c.Z,className:"MenuItem__primary-text custom_status__row",id:"status-menu-custom-status",sibling:a},M.createElement("span",{className:"custom_status__icon"},n),M.createElement(pd.Z,{text:s,className:"custom_status__text"}),i))})),ud(this,"refCallback",(e=>{e&&this.setState({width:e.state.width,open:e.state.open})})),this.state={openUp:!1,width:0}}render(){const e=this.isUserOutOfOffice()&&""===this.props.autoResetPref,t=this.renderProfilePicture(),s=this.renderDropdownIcon(),n=e?()=>this.showStatusChangeConfirmation("online"):this.setOnline,a=e?()=>this.showStatusChangeConfirmation("dnd"):this.setDnd,i=e?()=>this.showStatusChangeConfirmation("away"):this.setAway,r=e?()=>this.showStatusChangeConfirmation("offline"):this.setOffline,o=e?()=>this.showStatusChangeConfirmation("dnd"):this.setCustomTimedDnd,l=[{id:"dndSubMenu-header",direction:"right",text:(0,I._u)("status_dropdown.dnd_sub_menu_header","Disable notifications until:")}].concat(this.dndTimes.map(((e,t)=>({id:"dndTime-".concat(e.split(" ").join("")),direction:"right",text:(0,I._u)("status_dropdown.dnd_sub_menu_item.time",e),action:4===t?()=>o():()=>a(event,t)})))),c=this.renderCustomStatus();return M.createElement(Os.Z,{onToggle:this.onToggle,style:this.props.style,open:this.props.isStatusDropdownOpen,className:"status-dropdown-menu",ref:this.refCallback},M.createElement("div",{className:"status-wrapper status-selector"},t,M.createElement("button",{className:"status style--none","aria-label":(0,I._u)("status_dropdown.menuAriaLabel","Set a status")},M.createElement(Qc.Z,{status:this.props.status,button:!0})),M.createElement("span",{className:"status status-edit edit"},s)),M.createElement(Is.Z,{ariaLabel:(0,I._u)("status_dropdown.menuAriaLabel","Set a status"),id:"statusDropdownMenu"},!this.props.isCustomStatusEnabled&&M.createElement(Is.Z.Header,null,M.createElement(V.Z,{id:"status_dropdown.set_your_status",defaultMessage:"Status"})),M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{show:this.isUserOutOfOffice(),onClick:()=>null,ariaLabel:(0,I._u)("status_dropdown.set_ooo","Out of office").toLowerCase(),text:(0,I._u)("status_dropdown.set_ooo","Out of office"),extraText:(0,I._u)("status_dropdown.set_ooo.extra","Automatic Replies are enabled")})),c,M.createElement(Is.Z.Group,null,M.createElement(Is.Z.ItemAction,{onClick:n,ariaLabel:(0,I._u)("status_dropdown.set_online","Online").toLowerCase(),text:(0,I._u)("status_dropdown.set_online","Online"),icon:M.createElement(td.Z,{className:"online--icon"}),id:"status-menu-online"}),M.createElement(Is.Z.ItemAction,{onClick:i,ariaLabel:(0,I._u)("status_dropdown.set_away","Away").toLowerCase(),text:(0,I._u)("status_dropdown.set_away","Away"),icon:M.createElement(ed.Z,{className:"away--icon"}),id:"status-menu-away"}),M.createElement(Is.Z.ItemSubMenu,{subMenu:l,ariaLabel:"".concat((0,I._u)("status_dropdown.set_dnd","Do not disturb").toLowerCase(),". ").concat((0,I._u)("status_dropdown.set_dnd.extra","Disables desktop, email and push notifications").toLowerCase()),text:(0,I._u)("status_dropdown.set_dnd","Do not disturb"),extraText:(0,I._u)("status_dropdown.set_dnd.extra","Disables all notifications"),icon:M.createElement(sd.Z,{className:"dnd--icon"}),direction:"right",openUp:this.state.openUp,id:"status-menu-dnd"}),M.createElement(Is.Z.ItemAction,{onClick:r,ariaLabel:(0,I._u)("status_dropdown.set_offline","Offline").toLowerCase(),text:(0,I._u)("status_dropdown.set_offline","Offline"),icon:M.createElement(nd.Z,null),id:"status-menu-offline"}))))}}ud(md,"propTypes",{style:y().object,status:y().string,userId:y().string.isRequired,userTimezone:y().object,isTimezoneEnabled:y().bool,profilePicture:y().string,autoResetPref:y().string,actions:y().shape({openModal:y().func.isRequired,setStatus:y().func.isRequired,unsetCustomStatus:y().func.isRequired,setStatusDropdown:y().func.isRequired}).isRequired,customStatus:y().object,isCustomStatusEnabled:y().bool.isRequired,isStatusDropdownOpen:y().bool.isRequired,showCustomStatusPulsatingDot:y().bool.isRequired}),ud(md,"defaultProps",{userId:"",profilePicture:"",status:N.gg.OFFLINE,customStatus:{}});var gd=s(5445);function fd(e){return e.views.statusDropdown.isOpen}const Ed=(0,n.connect)((function(e){const t=(0,p.ts)(e),s=(0,gd.yC)();if(!t)return{};const n=t.id;return{userId:n,profilePicture:Ws.je.getProfilePictureUrl(n,t.last_picture_update),autoResetPref:(0,d.U2)(e,D.uP.CATEGORY_AUTO_RESET_MANUAL_STATUS,n,""),status:(0,p.ZO)(e,n),userTimezone:(0,zc.S)(e,n),isTimezoneEnabled:(0,Xc.Y)(e),customStatus:s(e,n),isCustomStatusEnabled:(0,gd.uD)(e),isStatusDropdownOpen:fd(e),showCustomStatusPulsatingDot:(0,gd.Ed)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h,setStatus:r.Tf,unsetCustomStatus:r.Nc,setStatusDropdown:Jc},e)}}))(md);class Cd extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),M.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})))}}class bd extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 20 20",fill:"currentColor"},M.createElement("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})))}}function _d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class vd extends M.PureComponent{constructor(...e){super(...e),_d(this,"toggleShortcutsModal",(e=>{e.preventDefault(),T.kk()})),_d(this,"handleKeyDown",(e=>{(0,I._E)(e)&&e.shiftKey&&(0,I.pD)(e,N.gT.KeyCodes.A)&&this.props.actions.openModal({ModalId:N.r8.USER_SETTINGS,dialogType:cs.Z})})),_d(this,"handleEmitUserLoggedOutEvent",(()=>{T.gc()}))}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}render(){if(!this.props.currentUser)return null;const e=M.createElement(et.Z,{id:"channelMembersTooltip"},M.createElement(V.Z,{id:"channel_header.user_header.settings",defaultMessage:"Cài đặt"}));return M.createElement(Os.Z,{className:"main-menu"},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"right",disabled:!1,overlay:e},M.createElement("button",{"aria-label":"button setiings",className:"member-popover__trigger user-header__icon"},M.createElement(Cd,{className:"icon icon__cog_outline",classIcon:"icon-md"}),M.createElement(bd,{className:"icon icon__cog_solid",classIcon:"icon-md"}))),M.createElement(ei,{id:"sidebarDropdownMenu"}))}}_d(vd,"propTypes",{teamDescription:y().string.isRequired,teamDisplayName:y().string.isRequired,teamId:y().string.isRequired,currentUser:y().object,showTutorialTip:y().bool.isRequired,firstAdminVisitMarketplaceStatus:y().bool.isRequired,actions:y().shape({openModal:y().func.isRequired,getFirstAdminVisitMarketplaceStatus:y().func.isRequired}).isRequired}),_d(vd,"defaultProps",{teamType:"",pluginMenuItems:[]});const yd=(0,n.connect)((function(e){const t=(0,u.kA)(e),s=(0,p.ts)(e),n=(0,d.wS)(e,N.uP.TUTORIAL_STEP,s.id)===N.PN.MENU_POPOVER&&!I.tq();return{currentUser:s,teamDescription:t.description,teamDisplayName:t.display_name,teamId:t.id,showTutorialTip:n,firstAdminVisitMarketplaceStatus:(0,h.zv)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h,getFirstAdminVisitMarketplaceStatus:cl.zv},e)}}))(vd);function Md(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Pd extends M.PureComponent{constructor(e){super(e),Md(this,"handleResize",(()=>{const e=I.tq();this.setState({isMobile:e})})),Md(this,"handleSelectItem",((e,t)=>{e.preventDefault(),this.props.onActive(t)})),this.state={isMobile:I.tq()}}componentDidMount(){window.addEventListener("resize",this.handleResize)}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}render(){const{selected:e}=this.props,t=I._u("accessibility.sections.lhsHeader","team menu region"),s=M.createElement(et.Z,{id:"channelMembersTooltip"},M.createElement(V.Z,{id:"channel_header.user_header.channelMembers",defaultMessage:"Tin nhắn"})),n=M.createElement(et.Z,{id:"channelMembersTooltip"},M.createElement(V.Z,{id:"channel_header.user_header.channelContacts",defaultMessage:"Danh bạ"})),a=M.createElement(et.Z,{id:"channelMembersTooltip"},M.createElement(V.Z,{id:"channel_header.user_header.savedPosts",defaultMessage:"Tin nhắn đã lưu"})),i=M.createElement(et.Z,{id:"channelMembersTooltip"},M.createElement(V.Z,{id:"channel_header.user_header.user_rank",defaultMessage:"Bảng xếp hạng"}));return M.createElement("div",{id:"lhsHeader","aria-label":t,tabIndex:-1,role:"application",className:"SidebarHeader user__header theme a11y__region","data-a11y-sort-order":"5"},M.createElement("div",{className:"d-flex"},M.createElement(Ed,null)),M.createElement("div",{className:"user__header-nav"},M.createElement("div",{className:"button-item button-messages"},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"right",disabled:!1,overlay:s},M.createElement("button",{"aria-label":t,className:W()({"member-popover__trigger":!0,"user-header__icon":!0,active:"messages"===e}),onClick:e=>this.handleSelectItem(e,"messages")},"messages"===e?M.createElement(Nc,{className:"icon icon__chat",classIcon:"icon-md"}):M.createElement(Tc,{className:"icon icon__chat",classIcon:"icon-md"})))),M.createElement("div",{className:"button-item button-contacts"},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"right",disabled:!1,overlay:n},M.createElement("button",{"aria-label":t,className:W()({"member-popover__trigger":!0,"user-header__icon":!0,active:"contacts"===e}),onClick:e=>this.handleSelectItem(e,"contacts")},"contacts"===e?M.createElement(Ic,{className:"icon icon__chat",classIcon:"fa icon-md"}):M.createElement(Rc.Z,{className:"icon icon__chat",classIcon:"fa icon-md"})))),M.createElement("div",{className:"button-item button-saved-posts"},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"right",disabled:!1,overlay:a},M.createElement("button",{"aria-label":t,className:W()({"member-popover__trigger":!0,"user-header__icon":!0,active:"saved"===e}),onClick:e=>this.handleSelectItem(e,"saved")},"saved"===e?M.createElement(Lc,{className:"icon icon__chat",classIcon:"fa icon-md"}):M.createElement(Oc,{className:"icon icon__chat",classIcon:"fa icon-md"})))),M.createElement("div",{className:"button-item button-user-rank"},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"right",disabled:!1,overlay:i},M.createElement(Is.Z.ItemToggleModalRedux,{id:"user-rank",modalId:N.r8.USER_RANK,dialogType:Wc,text:"",className:W()({"member-popover__trigger":!0,"user-header__icon":!0}),title:"Bảng xếp hạng",icon:M.createElement(Ac,{className:"icon icon__chat",classIcon:"fa icon-md"})}))),M.createElement("div",{className:"button-item button-settings"},!this.state.isMobile&&M.createElement(yd,null),this.state.isMobile&&M.createElement("button",{"aria-label":t,className:"member-popover__trigger user-header__icon",onClick:this.props.actions.toggleLhs},M.createElement(kc,{className:"icon icon__close",classIcon:"fa icon-md"})))))}}Md(Pd,"propTypes",{onActive:y().func.isRequired,selected:y().string,actions:y().shape({toggleLhs:y().func.isRequired}).isRequired});const wd=(0,n.connect)((function(e){const t=(0,h.iE)(e),s=(0,p.ts)(e);return{enableTutorial:"true"===t.EnableTutorial,showTutorialTip:(0,d.wS)(e,N.uP.TUTORIAL_STEP,s.id)===N.PN.MENU_POPOVER&&!I.tq()}}),(e=>({actions:(0,a.bindActionCreators)({toggleLhs:Ho.ZN},e)})))(Pd),Sd=e=>M.createElement("div",{className:"ProgressBar"},M.createElement("div",{className:"ProgressBar__progress",style:{flexBasis:e.basePercentage?"".concat(e.basePercentage,"%"):"",flexGrow:e.current/e.total}}));Sd.propTypes={total:y().number.isRequired,current:y().number.isRequired,basePercentage:y().number};const Td=Sd,Nd=s.p+"files/4e8057cd6539f1927c7c20b9c160037a.svg";function Rd(e){const{onConfirm:t,onCancel:s,screenTitle:n}=e;return M.createElement(M.Fragment,null,oa.createPortal(M.createElement("div",{className:"RemoveNextStepsModal__helpBox"},M.createElement("span",{className:"RemoveNextStepsModal__helpText"},M.createElement(Dt.Z,{id:"remove_next_steps_modal.helpText",defaultMessage:"Access {title} any time through the Main Menu",values:{title:n}})),M.createElement("img",{className:"RemoveNextStepsModal__arrow",src:Nd,loading:"lazy"})),document.body),M.createElement(Yi.Z,{className:"RemoveNextStepsModal",show:!0,onHide:s,handleConfirm:t,handleCancel:s,modalHeaderText:M.createElement(Dt.Z,{id:"remove_next_steps_modal.header",defaultMessage:"Remove {title}?",values:{title:n}}),confirmButtonText:M.createElement(V.Z,{id:"remove_next_steps_modal.confirm",defaultMessage:"Remove"})},M.createElement(V.Z,{id:"remove_next_steps_modal.mainText",defaultMessage:"This will remove this section from your sidebar, but you can access it later in the Help section of the Main Menu."})))}function Id(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Rd.propTypes={screenTitle:y().string.isRequired,onConfirm:y().func.isRequired,onCancel:y().func.isRequired};class Od extends M.PureComponent{constructor(e){super(e),Id(this,"closeNextSteps",(e=>{e.stopPropagation(),this.props.showNextSteps?(0,Ye.L9)(Xt(this.props.isAdmin),"click_skip_getting_started",{channel_sidebar:!0}):(0,Ye.L9)(Xt(this.props.isAdmin),"click_skip_tips");const t=this.props.showNextSteps?(0,I._u)("sidebar_next_steps.gettingStarted","Getting Started"):(0,I._u)("sidebar_next_steps.tipsAndNextSteps","Tips & Next Steps");this.props.actions.openModal({modalId:N.r8.REMOVE_NEXT_STEPS_MODAL,dialogType:Rd,dialogProps:{screenTitle:t,onConfirm:this.onConfirmModal,onCancel:this.onCloseModal}})})),Id(this,"showNextSteps",(()=>{this.props.showNextSteps?(0,Ye.L9)(Xt(this.props.isAdmin),"click_getting_started"):(0,Ye.L9)(Xt(this.props.isAdmin),"click_tips"),this.props.actions.setShowNextStepsView(!0)})),Id(this,"onCloseModal",(()=>{this.props.actions.closeModal(N.r8.REMOVE_NEXT_STEPS_MODAL)})),Id(this,"onConfirmModal",(()=>{this.props.actions.savePreferences(this.props.currentUserId,[{user_id:this.props.currentUserId,category:N.uP.RECOMMENDED_NEXT_STEPS,name:N.jm.HIDE,value:"true"}]),this.props.showNextSteps||(0,Ye.L9)(Xt(this.props.isAdmin),"click_confirm_remove_tips"),this.props.actions.setShowNextStepsView(!1),this.onCloseModal()})),this.state={complete:0}}render(){if(this.props.preferences.some((e=>e.name===N.jm.HIDE&&"true"===e.value)))return null;const e=this.props.steps.length,t=this.props.preferences.filter((e=>e.name!==N.jm.HIDE&&"true"===e.value)).length;let s=M.createElement(V.Z,{id:"sidebar_next_steps.gettingStarted",defaultMessage:"Getting Started"});this.props.showNextSteps||(s=M.createElement(V.Z,{id:"sidebar_next_steps.tipsAndNextSteps",defaultMessage:"Tips & Next Steps"}));let n=M.createElement(Dt.Z,{id:"sidebar_next_steps.stepsComplete",defaultMessage:"{complete} / {total} steps complete",values:{complete:t,total:e}});return this.props.showNextSteps||(n=M.createElement(V.Z,{id:"sidebar_next_steps.otherAreasToExplore",defaultMessage:"A few other areas to explore"})),M.createElement("div",{className:W()("SidebarNextSteps",{active:this.props.active,tips:!this.props.showNextSteps}),onClick:this.showNextSteps},M.createElement("div",{className:"SidebarNextSteps__top"},M.createElement("span",null,s),M.createElement("button",{className:"SidebarNextSteps__close",onClick:this.closeNextSteps},M.createElement("i",{className:"icon icon-close"}))),M.createElement("div",{className:"SidebarNextSteps__middle"},M.createElement("span",null,n)),this.props.showNextSteps&&M.createElement("div",{className:"SidebarNextSteps__progressBar"},M.createElement(Td,{current:t,total:e,basePercentage:4})))}}Id(Od,"propTypes",{active:y().bool.isRequired,showNextSteps:y().bool.isRequired,currentUserId:y().string.isRequired,preferences:y().array.isRequired,steps:y().array.isRequired,isAdmin:y().bool.isRequired,actions:y().shape({savePreferences:y().func.isRequired,openModal:y().func.isRequired,closeModal:y().func.isRequired,setShowNextStepsView:y().func.isRequired}).isRequired});const Ld=(0,n.connect)((function(){const e=(0,d.YX)();return t=>({active:t.views.nextSteps.show,steps:ms(t),showNextSteps:Cs(t),showNextStepsTips:bs(t),currentUser:(0,p.ts)(t),currentUserId:(0,p.rc)(t),preferences:e(t,N.uP.RECOMMENDED_NEXT_STEPS),isAdmin:(0,p.BW)(t)})}),(function(e){return{actions:(0,a.bindActionCreators)({savePreferences:Oe.$A,openModal:H.h,closeModal:H.M,setShowNextStepsView:Wt},e)}}))(Od);function Ad(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class kd extends M.PureComponent{constructor(e){super(e),Ad(this,"handleClickClearChannelSelection",(e=>{e.defaultPrevented||this.props.actions.clearChannelSelection()})),Ad(this,"handleKeyDownClearChannelSelection",(e=>{I.pD(e,N.ZP.KeyCodes.ESCAPE)&&this.props.actions.clearChannelSelection()})),Ad(this,"showMoreDirectChannelsModal",(()=>{this.setState({showDirectChannelsModal:!0}),(0,Ye.L9)("ui","ui_channels_more_direct_v2")})),Ad(this,"hideMoreDirectChannelsModal",(()=>{this.setState({showDirectChannelsModal:!1})})),Ad(this,"showCreateCategoryModal",(()=>{this.props.actions.openModal({modalId:N.r8.EDIT_CATEGORY,dialogType:Ji}),(0,Ye.L9)("ui","ui_sidebar_menu_createCategory")})),Ad(this,"handleCreateCategory",(e=>{this.props.actions.createCategory(this.props.teamId,e)})),Ad(this,"showMoreChannelsModal",(()=>{this.props.actions.openModal({modalId:N.r8.MORE_CHANNELS,dialogType:$r,dialogProps:{morePublicChannelsModalType:"public"}}),(0,Ye.L9)("ui","ui_channels_more_public_v2")})),Ad(this,"showNewChannelModal",(()=>{this.props.actions.openModal({modalId:N.r8.NEW_CHANNEL_FLOW,dialogType:Br}),(0,Ye.L9)("ui","ui_channels_create_channel_v2")})),Ad(this,"handleOpenMoreDirectChannelsModal",(e=>{e.preventDefault(),this.state.showDirectChannelsModal?this.hideMoreDirectChannelsModal():this.showMoreDirectChannelsModal()})),Ad(this,"onDragStart",(()=>{this.setState({isDragging:!0})})),Ad(this,"onDragEnd",(()=>{this.setState({isDragging:!1})})),Ad(this,"onActiveLeftbar",(e=>{this.setState({sidebarLeftSelected:e})})),Ad(this,"renderModals",(()=>{let e;return this.state.showDirectChannelsModal&&(e=M.createElement(yr,{onModalDismissed:this.hideMoreDirectChannelsModal,isExistingChannel:!1})),M.createElement(M.Fragment,null,e)})),this.state={showDirectChannelsModal:!1,isDragging:!1,sidebarLeftSelected:"messages"}}async componentDidMount(){this.props.teamId&&(await this.props.actions.fetchMyCategories(this.props.teamId),this.props.actions.loadChannelsForCurrentUser2(),this.props.actions.loadFirstDirect(this.props.teamId)),window.addEventListener("click",this.handleClickClearChannelSelection),window.addEventListener("keydown",this.handleKeyDownClearChannelSelection)}componentDidUpdate(e){this.props.teamId&&e.teamId!==this.props.teamId&&this.props.actions.fetchMyCategories(this.props.teamId)}componentWillUnmount(){window.removeEventListener("click",this.handleClickClearChannelSelection),window.removeEventListener("keydown",this.handleKeyDownClearChannelSelection)}render(){if(!this.props.teamId)return M.createElement("div",null);const{sidebarLeftSelected:e}=this.state,t=I._u("accessibility.sections.lhsNavigator","channel navigator region");return M.createElement("div",{id:"SidebarContainer",className:W()({"move--right":this.props.isOpen&&I.tq(),dragging:this.state.isDragging})},M.createElement("div",{className:"SidebarContainerL"},M.createElement(wd,{onActive:this.onActiveLeftbar,selected:e})),M.createElement("div",{className:"SidebarContainerR"},M.createElement("div",{id:"lhsNavigator",role:"application","aria-label":t,className:"a11y__region","data-a11y-sort-order":"6"},M.createElement(ll,{showNewChannelModal:this.showNewChannelModal,showMoreChannelsModal:this.showMoreChannelsModal,showCreateCategoryModal:this.showCreateCategoryModal,canCreateChannel:this.props.canCreatePrivateChannel||this.props.canCreatePublicChannel,canJoinPublicChannel:this.props.canJoinPublicChannel,handleOpenDirectMessagesModal:this.handleOpenMoreDirectChannelsModal,unreadFilterEnabled:this.props.unreadFilterEnabled})),M.createElement(A.Z,{pluggableName:"LeftSidebarHeader"}),"messages"===e?M.createElement(Sc,{handleOpenMoreDirectChannelsModal:this.handleOpenMoreDirectChannelsModal,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd}):null,"contacts"===e?M.createElement($o,null):null,"saved"===e?M.createElement(yo,{show:!0}):null,M.createElement(Ar,null),this.props.isCloud&&M.createElement(Ld,null)),this.renderModals())}}Ad(kd,"propTypes",{teamId:y().string.isRequired,canCreatePublicChannel:y().bool.isRequired,canCreatePrivateChannel:y().bool.isRequired,canJoinPublicChannel:y().bool.isRequired,isOpen:y().bool.isRequired,hasSeenModal:y().bool.isRequired,actions:y().shape({fetchMyCategories:y().func.isRequired,loadFirstDirect:y().func.isRequired,loadChannelsForCurrentUser2:y().func.isRequired,createCategory:y().func.isRequired,openModal:y().func.isRequired,clearChannelSelection:y().func.isRequired}).isRequired,isCloud:y().bool.isRequired,unreadFilterEnabled:y().bool.isRequired});const xd=(0,n.connect)((function(e){const t=(0,u.kA)(e),s=(0,m.gO)(e),n=(0,xi.fI)(e);let a=!1,i=!1,r=!1;return t&&(a=(0,Z.Ai)(e,{channel:s,team:t.id,permission:Ps.Z.CREATE_PUBLIC_CHANNEL}),i=(0,Z.Ai)(e,{channel:s,team:t.id,permission:Ps.Z.CREATE_PRIVATE_CHANNEL}),r=(0,Z.Ai)(e,{channel:s,team:t.id,permission:Ps.Z.JOIN_PUBLIC_CHANNELS})),{teamId:t?t.id:"",canCreatePrivateChannel:i,canCreatePublicChannel:a,canJoinPublicChannel:r,isOpen:hi(e),hasSeenModal:(0,d.o4)(e,D.uP.CATEGORY_WHATS_NEW_MODAL,D.uP.HAS_SEEN_SIDEBAR_WHATS_NEW_MODAL,!1),isCloud:"true"===(0,h.lJ)(e).Cloud,unreadFilterEnabled:n}}),(function(e){return{actions:(0,a.bindActionCreators)({clearChannelSelection:Ui,createCategory:Hi,fetchMyCategories:Ri.cN,loadFirstDirect:Ii.t7,loadChannelsForCurrentUser2:Ii.Hc,openModal:H.h},e)}}))(kd);let Dd=!1;function Zd(e,t="",s){return async(n,a)=>{if(Dd)return;const{data:i}=await n((0,x.ct)(e));if(!i)return void st.m.replace("/error?type=".concat(N.vU.PERMALINK_NOT_FOUND,"&returnTo=").concat(t));const r=a(),l=i.posts[i.order[0]].channel_id;let c=r.entities.channels.channels[l];const d=(0,u.kA)(r),h=d.id;if(!c){const{data:e}=await n((0,o.mr)(l));if(!e)return void st.m.replace("/error?type=".concat(N.vU.PERMALINK_NOT_FOUND,"&returnTo=").concat(t));c=e}let m=r.entities.channels.myMembers[l];if(!m){if(c.type===N.gT.DM_CHANNEL||c.type===N.gT.GM_CHANNEL)return void st.m.replace("/error?type=".concat(N.vU.PERMALINK_NOT_FOUND,"&returnTo=").concat(t));const e=await n((0,o.hg)(c.id,s));if("data"in e&&(m=e.data),!m){const e=(0,p.ts)(r);if(c.type===N.gT.PRIVATE_CHANNEL&&(0,I.$O)(e.roles)){Dd=!0;const e=await n((0,hl.Jf)(d,c));if(Dd=!1,"data"in e&&!e.data.join)return}await n((0,o.JJ)(s,null,l))}}if(c.team_id&&c.team_id!==h)return void st.m.replace("/error?type=".concat(N.vU.PERMALINK_NOT_FOUND,"&returnTo=").concat(t));c&&c.type===N.gT.DM_CHANNEL?n((0,Le.hH)(c.id)):c&&c.type===N.gT.GM_CHANNEL&&n((0,Le.Vo)(c.id)),n((0,o.QE)(l)),n({type:N.MF.RECEIVED_FOCUSED_POST,data:e,channelId:l});const g=(0,u.VP)(r,c.team_id||h);if(c.type===N.gT.DM_CHANNEL){const t=(0,I.uD)(c.name),s=(0,p.PR)(r,t);st.m.replace("/".concat(g.name,"/messages/@").concat(s.username,"/").concat(e))}else c.type===N.gT.GM_CHANNEL?st.m.replace("/".concat(g.name,"/messages/").concat(c.name,"/").concat(e)):st.m.replace("/".concat(g.name,"/group/").concat(c.name,"/").concat(e));n((0,Ii.b9)()),n((0,o.mx)(l))}}function Hd(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function qd(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Hd(Object(s),!0).forEach((function(t){jd(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Hd(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function jd(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ud extends M.PureComponent{static getDerivedStateFromProps(e,t){let s={postid:e.match.params.postid};return t.postid!==e.match.params.postid&&(s=qd(qd({},s),{},{valid:!1})),s}constructor(e){super(e),jd(this,"doPermalinkEvent",(async e=>{const t=e.match.params.postid;await this.props.actions.focusPost(t,this.props.returnTo,this.props.currentUserId),this.mounted&&this.setState({valid:!0})})),jd(this,"isStateValid",(()=>this.state.valid&&this.props.channelId&&this.props.teamName)),jd(this,"onShortcutKeyDown",(e=>{e.shiftKey&&I._E(e)&&I.pD(e,N.ZP.KeyCodes.L)&&this.permalink.current&&this.permalink.current.focus()})),this.state={valid:!1}}componentDidMount(){this.mounted=!0,this.doPermalinkEvent(this.props),document.body.classList.add("app__body")}componentDidUpdate(){this.state.valid||this.doPermalinkEvent(this.props)}componentWillUnmount(){this.mounted=!1}render(){return this.isStateValid()?null:M.createElement("div",{id:"app-content",className:"app__content"})}}jd(Ud,"propTypes",{channelId:y().string,match:y().shape({params:y().shape({postid:y().string.isRequired}).isRequired}).isRequired,returnTo:y().string.isRequired,teamName:y().string,actions:y().shape({focusPost:y().func.isRequired}).isRequired,currentUserId:y().string.isRequired});const Fd=(0,n.connect)((function(e){const t=(0,u.kA)(e),s=(0,m.TB)(e),n=(0,p.rc)(e);return{channelId:s?s.id:"",teamName:t?t.name:"",currentUserId:n}}),(function(e){return{actions:(0,a.bindActionCreators)({focusPost:Zd},e)}}))(Ud);class Bd extends M.PureComponent{render(){return M.createElement(Is.Z,{id:"channelHeaderDropdownMenu",ariaLabel:(0,I._u)("channel_header.menuAriaLabel","Channel Menu").toLowerCase()},M.createElement(Vp,{isMobile:!1}))}}var Gd=s(62696),Vd=s(50766),Kd=s(4205),Yd=s(93183);function Wd(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class zd extends M.PureComponent{constructor(...e){super(...e),Wd(this,"createAppButton",(e=>{const t=()=>this.fireAppAction(e);return this.props.isDropdown?M.createElement("li",{key:"mobileChannelHeaderItem"+e.app_id+e.location,role:"presentation",className:"MenuItem"},M.createElement("a",{role:"menuitem",href:"#",onClick:t},e.label)):M.createElement("li",{className:"flex-parent--center"},M.createElement("button",{className:"navbar-toggle navbar-right__icon",onClick:t},M.createElement("span",{className:"icon navbar-plugin-button"},M.createElement("img",{src:e.icon,width:"16",height:"16",loading:"lazy"}))))})),Wd(this,"createButton",(e=>{const t=()=>this.fireAction(e);return this.props.isDropdown?M.createElement("li",{key:"mobileChannelHeaderItem"+e.id,role:"presentation",className:"MenuItem"},M.createElement("a",{role:"menuitem",href:"#",onClick:t},e.dropdownText)):M.createElement("li",{className:"flex-parent--center"},M.createElement("button",{className:"navbar-toggle navbar-right__icon",onClick:t},M.createElement("span",{className:"icon navbar-plugin-button"},e.icon)))})),Wd(this,"fireAppAction",(async e=>{if(!e.call)return;const t=(0,Yd.qM)(e.app_id,e.location,this.props.channel.id,this.props.channel.team_id),s=(0,Yd.Zw)(e.call,t),n=(await this.props.actions.doAppCall(s,Vd._L.SUBMIT,this.props.intl)).data,a=e=>{var t;return(0,T.Cl)(e,this.props.channel.id,"",null===(t=n.app_metadata)||void 0===t?void 0:t.bot_user_id)};switch(n.type){case Vd.Bp.OK:n.markdown&&a(n.markdown);break;case Vd.Bp.ERROR:a(n.error||this.props.intl.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error happened"}));break;case Vd.Bp.NAVIGATE:case Vd.Bp.FORM:break;default:a(this.props.intl.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:n.type}))}}))}createList(e){return e.map(this.createButton)}createAppList(e){return e.map(this.createAppButton)}fireAction(e){var t;return null===(t=e.action)||void 0===t?void 0:t.call(e,this.props.channel,this.props.channelMember)}render(){const e=this.props.components||[],t=this.props.appBindings||[];if(0===e.length&&0===t.length)return null;if(1===e.length&&0===t.length)return this.createButton(e[0]);if(0===e.length&&1===t.length)return this.createAppButton(t[0]);if(!this.props.isDropdown)return null;const s=this.createList(e),n=this.createAppList(t);return M.createElement(M.Fragment,null,s,n)}}Wd(zd,"propTypes",{components:y().array,isDropdown:y().bool.isRequired,appBindings:y().array.isRequired,appsEnabled:y().bool.isRequired,actions:y().shape({doAppCall:y().func.isRequired}).isRequired});const Jd=(0,K.ZP)(zd),Xd=(0,Gd.W)(Vd.NR.CHANNEL_HEADER_ICON),Qd=(0,n.connect)((function(e){const t=(0,Gd.D)(e);return{appBindings:Xd(e),appsEnabled:t,channelMember:(0,m.HU)(e),components:e.plugins.components.MobileChannelHeaderButton,theme:(0,d.gh)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({doAppCall:Kd.cW},e)}}))(Jd);function $d({section:e,isCollapsed:t,memberNotifyLevel:s,globalNotifyLevel:n,ignoreChannelMentions:a}){if(s===N.XH.DEFAULT&&n){(0,Ae.t)("channel_notifications.levels.default"),(0,Ae.t)("channel_notifications.levels.all"),(0,Ae.t)("channel_notifications.levels.mention"),(0,Ae.t)("channel_notifications.levels.none");const e="channel_notifications.levels."+n,t=M.createElement(V.Z,{id:e,defaultMessage:n});return M.createElement(V.Z,{id:"channel_notifications.globalDefault",defaultMessage:"Global default ({notifyLevel})",values:{notifyLevel:t}})}return s===N.XH.MENTION&&e===N.nB.MARK_UNREAD?t?M.createElement(V.Z,{id:"channel_notifications.muteChannel.on.title.collapse",defaultMessage:"Mute is enabled. Desktop, email and push notifications will not be sent for this channel."}):M.createElement(V.Z,{id:"channel_notifications.muteChannel.on.title",defaultMessage:"On"}):e===N.nB.IGNORE_CHANNEL_MENTIONS&&a===N.Xi.ON?M.createElement(V.Z,{id:"channel_notifications.ignoreChannelMentions.on.title",defaultMessage:"On"}):e===N.nB.IGNORE_CHANNEL_MENTIONS&&a===N.Xi.OFF?M.createElement(V.Z,{id:"channel_notifications.ignoreChannelMentions.off.title",defaultMessage:"Off"}):s===N.XH.MENTION?M.createElement(V.Z,{id:"channel_notifications.onlyMentions",defaultMessage:"Only for mentions"}):e!==N.nB.DESKTOP&&e!==N.nB.PUSH||s!==N.XH.ALL?e===N.nB.MARK_UNREAD&&s===N.XH.ALL?M.createElement(V.Z,{id:"channel_notifications.muteChannel.off.title",defaultMessage:"Off"}):M.createElement(V.Z,{id:"channel_notifications.never",defaultMessage:"Never"}):M.createElement(V.Z,{id:"channel_notifications.allActivity",defaultMessage:"For all activity"})}function eh({section:e}){return e===N.nB.DESKTOP?M.createElement(V.Z,{id:"channel_notifications.sendDesktop",defaultMessage:"Send desktop notifications"}):e===N.nB.PUSH?M.createElement(V.Z,{id:"channel_notifications.push",defaultMessage:"Send mobile push notifications"}):e===N.nB.MARK_UNREAD?M.createElement(V.Z,{id:"channel_notifications.muteChannel.settings",defaultMessage:"Mute Channel"}):e===N.nB.IGNORE_CHANNEL_MENTIONS?M.createElement(V.Z,{id:"channel_notifications.ignoreChannelMentions",defaultMessage:"Ignore mentions for @group, @here and @all"}):null}function th({onExpandSection:e,globalNotifyLevel:t,memberNotifyLevel:s,section:n,ignoreChannelMentions:a}){return M.createElement(ca.Z,{title:M.createElement(eh,{section:n}),describe:M.createElement($d,{section:n,ignoreChannelMentions:a,memberNotifyLevel:s,globalNotifyLevel:t,isCollapsed:!0}),updateSection:e,section:n})}function sh({section:e}){switch(e){case N.nB.DESKTOP:return M.createElement("span",null,M.createElement(V.Z,{id:"channel_notifications.override",defaultMessage:'Selecting an option other than "Default" will override the global notification settings. Desktop notifications are available on Firefox, Safari, and Chrome.'}));case N.nB.PUSH:return M.createElement("span",null,M.createElement(V.Z,{id:"channel_notifications.overridePush",defaultMessage:'Selecting an option other than "Global default" will override the global notification settings for mobile push notifications in account settings. Push notifications must be enabled by the System Admin.'}));case N.nB.MARK_UNREAD:return M.createElement("span",null,M.createElement(V.Z,{id:"channel_notifications.muteChannel.help",defaultMessage:"Muting turns off desktop, email and push notifications for this channel. The channel will not be marked as unread unless you are mentioned."}));case N.nB.IGNORE_CHANNEL_MENTIONS:return M.createElement("span",null,M.createElement(V.Z,{id:"channel_notifications.ignoreChannelMentions.help",defaultMessage:"When enabled, @group, @here and @all will not trigger mentions or mention notifications in this channel."}));default:return null}}function nh({section:e,memberNotifyLevel:t,globalNotifyLevel:s,onChange:n,onSubmit:a,serverError:i,onCollapseSection:r,ignoreChannelMentions:o}){const l=[M.createElement("div",{key:"channel-notification-level-radio"},(e===N.nB.DESKTOP||e===N.nB.PUSH)&&M.createElement("fieldset",null,M.createElement("div",{className:"radio"},M.createElement("label",{className:""},M.createElement("input",{id:"channelNotificationGlobalDefault",name:"channelDesktopNotifications",type:"radio",value:N.XH.DEFAULT,checked:t===N.XH.DEFAULT,onChange:n}),M.createElement($d,{section:e,memberNotifyLevel:N.XH.DEFAULT,globalNotifyLevel:s}))),M.createElement("div",{className:"radio"},M.createElement("label",{className:""},M.createElement("input",{id:"channelNotificationAllActivity",name:"channelDesktopNotifications",type:"radio",value:N.XH.ALL,checked:t===N.XH.ALL,onChange:n}),M.createElement($d,{section:e,memberNotifyLevel:N.XH.ALL}))),M.createElement("div",{className:"radio"},M.createElement("label",{className:""},M.createElement("input",{id:"channelNotificationMentions",name:"channelDesktopNotifications",type:"radio",value:N.XH.MENTION,checked:t===N.XH.MENTION,onChange:n}),M.createElement($d,{section:e,memberNotifyLevel:N.XH.MENTION}))),M.createElement("div",{className:"radio"},M.createElement("label",null,M.createElement("input",{id:"channelNotificationNever",name:"channelDesktopNotifications",type:"radio",value:N.XH.NONE,checked:t===N.XH.NONE,onChange:n}),M.createElement($d,{section:e,memberNotifyLevel:N.XH.NONE})))),e===N.nB.IGNORE_CHANNEL_MENTIONS&&M.createElement("fieldset",null,M.createElement("div",{className:"radio"},M.createElement("label",null,M.createElement("input",{id:"ignoreChannelMentionsOn",name:"ignoreChannelMentions",type:"radio",value:N.Xi.ON,checked:o===N.Xi.ON,onChange:n}),M.createElement($d,{section:e,ignoreChannelMentions:N.Xi.ON,memberNotifyLevel:t,globalNotifyLevel:s}))),M.createElement("div",{className:"radio"},M.createElement("label",null,M.createElement("input",{id:"ignoreChannelMentionsOff",name:"ignoreChannelMentions",type:"radio",value:N.Xi.OFF,checked:o===N.Xi.OFF,onChange:n}),M.createElement($d,{section:e,ignoreChannelMentions:N.Xi.OFF,memberNotifyLevel:t,globalNotifyLevel:s})))),e===N.nB.MARK_UNREAD&&M.createElement("fieldset",null,M.createElement("div",{className:"radio"},M.createElement("label",{className:""},M.createElement("input",{id:"channelNotificationUnmute",name:"channelNotificationMute",type:"radio",value:N.XH.MENTION,checked:t===N.XH.MENTION,onChange:n}),M.createElement($d,{section:e,memberNotifyLevel:N.XH.MENTION}))),M.createElement("div",{className:"radio"},M.createElement("label",{className:""},M.createElement("input",{id:"channelNotificationMute",name:"channelNotificationMute",type:"radio",value:N.XH.ALL,checked:t===N.XH.ALL,onChange:n}),M.createElement($d,{section:e,memberNotifyLevel:N.XH.ALL})))))];return M.createElement(la.Z,{title:M.createElement(eh,{section:e}),inputs:l,submit:a,server_error:i,updateSection:r,extraInfo:M.createElement(sh,{section:e})})}function ah(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}$d.propTypes={globalNotifyLevel:y().string,ignoreChannelMentions:y().string,memberNotifyLevel:y().string.isRequired,section:y().string.isRequired,isCollapsed:y().bool},eh.propTypes={section:y().string.isRequired},th.propTypes={ignoreChannelMentions:y().string,onExpandSection:y().func.isRequired,globalNotifyLevel:y().string,memberNotifyLevel:y().string.isRequired,section:y().string.isRequired},sh.propTypes={section:y().string.isRequired},nh.propTypes={ignoreChannelMentions:y().string,onChange:y().func.isRequired,onCollapseSection:y().func.isRequired,onSubmit:y().func.isRequired,globalNotifyLevel:y().string,memberNotifyLevel:y().string.isRequired,section:y().string.isRequired,serverError:y().string};class ih extends M.PureComponent{constructor(...e){super(...e),ah(this,"handleOnChange",(e=>{this.props.onChange(e.target.value)})),ah(this,"handleExpandSection",(()=>{this.props.onUpdateSection(this.props.section)})),ah(this,"handleCollapseSection",(()=>{this.props.onUpdateSection(N.nB.NONE)}))}render(){const{expand:e,globalNotificationLevel:t,memberNotificationLevel:s,ignoreChannelMentions:n,onSubmit:a,section:i,serverError:r}=this.props;return e?M.createElement(nh,{section:i,memberNotifyLevel:s,globalNotifyLevel:t,ignoreChannelMentions:n,onChange:this.handleOnChange,onSubmit:a,serverError:r,onCollapseSection:this.handleCollapseSection}):M.createElement(th,{section:i,onExpandSection:this.handleExpandSection,memberNotifyLevel:s,globalNotifyLevel:t,ignoreChannelMentions:n})}}function rh(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function oh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}ah(ih,"propTypes",{section:y().string.isRequired,expand:y().bool.isRequired,memberNotificationLevel:y().string.isRequired,ignoreChannelMentions:y().string,globalNotificationLevel:y().string,onChange:y().func.isRequired,onSubmit:y().func.isRequired,onUpdateSection:y().func.isRequired,serverError:y().string});class lh extends M.PureComponent{constructor(e){super(e),oh(this,"handleHide",(()=>{this.setState({show:!1})})),oh(this,"handleExit",(()=>{this.updateSection(N.nB.NONE),this.props.onHide()})),oh(this,"updateSection",((e=N.nB.NONE)=>{if(this.setState({activeSection:e}),e===N.nB.NONE){const e=this.props.channelMember&&this.props.channelMember.notify_props;this.resetStateFromNotifyProps(e,this.props.currentUser.notify_props)}})),oh(this,"handleUpdateChannelNotifyProps",(async e=>{const{actions:t,channel:s,currentUser:n}=this.props,{error:a}=await t.updateChannelNotifyProps(n.id,s.id,e);a?this.setState({serverError:a.message}):this.updateSection(N.nB.NONE)})),oh(this,"handleSubmitDesktopNotifyLevel",(()=>{const e=this.props.channelMember&&this.props.channelMember.notify_props,{desktopNotifyLevel:t}=this.state;if(e.desktop===t)return void this.updateSection(N.nB.NONE);const s={desktop:t};this.handleUpdateChannelNotifyProps(s)})),oh(this,"handleUpdateDesktopNotifyLevel",(e=>{this.setState({desktopNotifyLevel:e})})),oh(this,"handleSubmitMarkUnreadLevel",(()=>{const e=this.props.channelMember&&this.props.channelMember.notify_props,{markUnreadNotifyLevel:t}=this.state;if(e.mark_unread===t)return void this.updateSection(N.nB.NONE);const s={mark_unread:t};this.handleUpdateChannelNotifyProps(s)})),oh(this,"handleUpdateMarkUnreadLevel",(e=>{this.setState({markUnreadNotifyLevel:e})})),oh(this,"handleSubmitPushNotificationLevel",(()=>{const e=this.props.channelMember&&this.props.channelMember.notify_props,{pushNotifyLevel:t}=this.state;if(e.push===t)return void this.updateSection(N.nB.NONE);const s={push:t};this.handleUpdateChannelNotifyProps(s)})),oh(this,"handleUpdatePushNotificationLevel",(e=>{this.setState({pushNotifyLevel:e})})),oh(this,"handleUpdateIgnoreChannelMentions",(e=>{this.setState({ignoreChannelMentions:e})})),oh(this,"handleSubmitIgnoreChannelMentions",(()=>{const e=this.props.channelMember&&this.props.channelMember.notify_props,{ignoreChannelMentions:t}=this.state;if(e.ignore_channel_mentions===t)return void this.updateSection("");const s={ignore_channel_mentions:t};this.handleUpdateChannelNotifyProps(s)}));const t=e.channelMember&&e.channelMember.notify_props;this.state=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?rh(Object(s),!0).forEach((function(t){oh(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):rh(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({show:!0,activeSection:N.nB.NONE,serverError:null},this.getStateFromNotifyProps(t,e.currentUser.notify_props))}componentDidUpdate(e){const t=e.channelMember&&e.channelMember.notify_props,s=this.props.channelMember&&this.props.channelMember.notify_props;I.JB(s,t)||this.resetStateFromNotifyProps(s,this.props.currentUser.notify_props)}resetStateFromNotifyProps(e,t){this.setState(this.getStateFromNotifyProps(e,t))}getStateFromNotifyProps(e,t){let s=N.Xi.OFF;(e.mark_unread===N.XH.MENTION||t.channel&&"false"===t.channel)&&(s=N.Xi.ON);let n=e.ignore_channel_mentions;return n&&n!==N.Xi.DEFAULT||(n=s),{desktopNotifyLevel:e.desktop||N.XH.DEFAULT,markUnreadNotifyLevel:e.mark_unread||N.XH.ALL,pushNotifyLevel:e.push||N.XH.DEFAULT,ignoreChannelMentions:n}}render(){const{activeSection:e,desktopNotifyLevel:t,markUnreadNotifyLevel:s,ignoreChannelMentions:n,serverError:a}=this.state,{channel:i,channelMember:r,currentUser:o}=this.props;let l=null;return a&&(l=M.createElement("div",{className:"form-group has-error"},M.createElement("label",{className:"control-label"},a))),M.createElement(G.Z,{dialogClassName:"a11y__modal settings-modal settings-modal--tabless",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"channelNotificationModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"channelNotificationModalLabel"},M.createElement(V.Z,{id:"channel_notifications.preferences",defaultMessage:"Notification Preferences for "}),M.createElement("span",{className:"name"},i.display_name))),M.createElement(G.Z.Body,null,M.createElement("div",{className:"settings-table"},M.createElement("div",{className:"settings-content"},M.createElement("div",{ref:"wrapper",className:"user-settings"},M.createElement("br",null),M.createElement("div",{className:"divider-dark first"}),M.createElement(ih,{section:N.nB.MARK_UNREAD,expand:e===N.nB.MARK_UNREAD,memberNotificationLevel:s,onChange:this.handleUpdateMarkUnreadLevel,onSubmit:this.handleSubmitMarkUnreadLevel,onUpdateSection:this.updateSection,serverError:a}),M.createElement("div",{className:"divider-light"}),M.createElement(ih,{section:N.nB.IGNORE_CHANNEL_MENTIONS,expand:e===N.nB.IGNORE_CHANNEL_MENTIONS,memberNotificationLevel:s,ignoreChannelMentions:n,onChange:this.handleUpdateIgnoreChannelMentions,onSubmit:this.handleSubmitIgnoreChannelMentions,onUpdateSection:this.updateSection,serverError:a}),!(0,$i.Mm)(r)&&M.createElement("div",null,M.createElement("div",{className:"divider-light"}),M.createElement(ih,{section:N.nB.DESKTOP,expand:e===N.nB.DESKTOP,memberNotificationLevel:t,globalNotificationLevel:o.notify_props?o.notify_props.desktop:N.XH.ALL,onChange:this.handleUpdateDesktopNotifyLevel,onSubmit:this.handleSubmitDesktopNotifyLevel,onUpdateSection:this.updateSection,serverError:a})),M.createElement("div",{className:"divider-dark"})))),l))}}oh(lh,"propTypes",{onHide:y().func.isRequired,channel:y().object.isRequired,channelMember:y().object.isRequired,currentUser:y().object.isRequired,sendPushNotifications:y().bool.isRequired,actions:y().shape({updateChannelNotifyProps:y().func.isRequired})});const ch=(0,n.connect)((e=>({channelMember:(0,m.HU)(e),sendPushNotifications:"true"===(0,h.iE)(e).SendPushNotifications})),(e=>({actions:(0,a.bindActionCreators)({updateChannelNotifyProps:o.n$},e)})))(lh);function dh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class hh extends M.PureComponent{constructor(e){super(e),dh(this,"handleRemoveFromChannel",(()=>{if(this.state.removing)return;const{actions:e,channel:t,user:s}=this.props;this.setState({removing:!0}),e.removeChannelMember(t.id,s.id).then((s=>{s.error?this.setState({serverError:s.error.message,removing:!1}):(this.setState({removing:!1}),e.getChannelStats(t.id))}))})),dh(this,"handleMakeChannelMember",(async()=>{const{error:e}=await this.props.actions.updateChannelMemberSchemeRoles(this.props.channel.id,this.props.user.id,!0,!1,!1);e?this.setState({serverError:e.message}):(this.props.actions.getChannelStats(this.props.channel.id),this.props.actions.getChannelMember(this.props.channel.id,this.props.user.id))})),dh(this,"handleMakeChannelMod",(async()=>{const{error:e}=await this.props.actions.updateChannelMemberSchemeRoles(this.props.channel.id,this.props.user.id,!0,!0,!1);e?this.setState({serverError:e.message}):(this.props.actions.getChannelStats(this.props.channel.id),this.props.actions.getChannelMember(this.props.channel.id,this.props.user.id))})),dh(this,"handleMakeChannelAdmin",(async()=>{const{error:e}=await this.props.actions.updateChannelMemberSchemeRoles(this.props.channel.id,this.props.user.id,!0,!1,!0);e?this.setState({serverError:e.message}):(this.props.actions.getChannelStats(this.props.channel.id),this.props.actions.getChannelMember(this.props.channel.id,this.props.user.id))})),this.state={serverError:null,removing:!1}}renderRole(e,t,s){return e?M.createElement(V.Z,{id:"channel_members_dropdown.channel_admin",defaultMessage:"Group Admin"}):t?M.createElement(V.Z,{id:"channel_members_dropdown.channel_mod",defaultMessage:"Group Mod"}):s?M.createElement(V.Z,{id:"channel_members_dropdown.channel_guest",defaultMessage:"Channel Guest"}):M.createElement(V.Z,{id:"channel_members_dropdown.channel_member",defaultMessage:"Channel Member"})}render(){const{index:e,totalUsers:t,isLicensed:s,channelMember:n,user:a,channel:i,currentUserId:r,canChangeMemberRoles:o,canRemoveMember:l,myChannelRoles:c}=this.props,{serverError:d}=this.state,h=I.Nf(s,n.roles,n.scheme_admin),p=I.Nk(s,n.roles,n.scheme_mod),u=I.a_(a),m=!h&&!p&&!u,g=i.name===N.gT.DEFAULT_CHANNEL,f=this.renderRole(h,p,u);if(a.id===r)return null;const E=I.qu(c,a.roles);if(a.remote_id){const e=M.createElement(et.Z,{id:"sharedTooltip"},M.createElement(V.Z,{id:"shared_user_indicator.tooltip",defaultMessage:"From trusted organizations"}));return M.createElement("div",{className:"more-modal__shared-actions"},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"bottom",overlay:e},M.createElement("span",null,M.createElement(V.Z,{id:"channel_members_dropdown.shared_member",defaultMessage:"Shared Member"}),M.createElement("i",{className:"shared-user-icon icon-circle-multiple-outline"}))))}const C=E&&o&&(h||p),b=E&&o&&s&&(m||h),_=E&&o&&s&&(m||p),v=E&&l&&(!i.group_constrained||a.is_bot)&&(!g||u);if(C||_||v){const s=M.createElement(Is.Z.ItemAction,{show:v,onClick:this.handleRemoveFromChannel,text:I._u("channel_members_dropdown.remove_from_channel","Remove from Channel")}),n=M.createElement(Is.Z.ItemAction,{id:"".concat(a.username,"-make-channel-admin"),show:_,onClick:this.handleMakeChannelAdmin,text:I._u("channel_members_dropdown.make_channel_admin","Make Channel Admin")}),i=M.createElement(Is.Z.ItemAction,{id:"".concat(a.username,"-make-channel-mod"),show:b,onClick:this.handleMakeChannelMod,text:I._u("channel_members_dropdown.make_channel_mod","Make Group Mod")}),r=M.createElement(Is.Z.ItemAction,{id:"".concat(a.username,"-make-channel-member"),show:C,onClick:this.handleMakeChannelMember,text:I._u("channel_members_dropdown.make_channel_member","Make Channel Member")});return M.createElement(Os.Z,null,M.createElement("button",{className:"dropdown-toggle theme color--link style--none",type:"button"},M.createElement("span",{className:"sr-only"},a.username),M.createElement("span",null,f," "),M.createElement(Rs.Z,null)),M.createElement(Is.Z,{openLeft:!0,openUp:t>3&&t-e<=3,ariaLabel:I._u("channel_members_dropdown.menuAriaLabel","Change the role of channel member")},C?r:null,b?i:null,_?n:null,v?s:null,d&&M.createElement("div",{className:"has-error"},M.createElement("label",{className:"has-error control-label"},d))))}return g?M.createElement("div",null):M.createElement("div",null,f)}}dh(hh,"propTypes",{channel:y().object.isRequired,user:y().object.isRequired,currentUserId:y().string.isRequired,channelMember:y().object.isRequired,isLicensed:y().bool.isRequired,canChangeMemberRoles:y().bool.isRequired,canRemoveMember:y().bool.isRequired,myChannelRoles:y().object.isRequired,index:y().number.isRequired,totalUsers:y().number.isRequired,actions:y().shape({getChannelStats:y().func.isRequired,updateChannelMemberSchemeRoles:y().func.isRequired,removeChannelMember:y().func.isRequired,getChannelMember:y().func.isRequired}).isRequired});const ph=(0,n.connect)((function(e,t){const{channel:s}=t,n=(0,Z.Ai)(e,{channel:s.id,team:s.team_id,permission:D.Pl.MANAGE_CHANNEL_ROLES})&&(0,hl.sz)(e,s),a="true"===(0,h.lJ)(e).IsLicensed,i=(0,hl.sz)(e,s),r=(0,Z.TL)(e)[s.id];return{currentUserId:(0,p.rc)(e),isLicensed:a,canChangeMemberRoles:n,canRemoveMember:i,myChannelRoles:r}}),(function(e){return{actions:(0,a.bindActionCreators)({getChannelMember:o.hg,getChannelStats:o.mx,updateChannelMemberSchemeRoles:o.Ar,removeChannelMember:o.O0},e)}}))(hh);function uh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class mh extends M.PureComponent{constructor(e){super(e),uh(this,"searchTimeoutId",void 0),uh(this,"loadComplete",(()=>{this.setState({loading:!1})})),uh(this,"nextPage",(e=>{this.props.actions.loadProfilesAndTeamMembersAndChannelMembers(e+1,50,void 0,void 0,{active:!0})})),uh(this,"handleSearch",(e=>{this.props.actions.setModalSearchTerm(e)})),this.searchTimeoutId=0,this.state={loading:!0}}async componentDidMount(){const{actions:e,currentChannelId:t,currentTeamId:s}=this.props;await Promise.all([e.loadProfilesAndTeamMembersAndChannelMembers(0,N.ZP.PROFILE_CHUNK_SIZE,s,t,{active:!0}),e.getChannelMembers(t),e.getChannelStats(t)]),this.loadComplete()}componentWillUnmount(){this.props.actions.setModalSearchTerm("")}componentDidUpdate(e){if(e.searchTerm!==this.props.searchTerm){clearTimeout(this.searchTimeoutId);const t=this.props.searchTerm;if(""===t)return this.loadComplete(),void(this.searchTimeoutId=0);const s=window.setTimeout((async()=>{const{data:n}=await e.actions.searchProfiles(t,{team_id:this.props.currentTeamId,in_channel_id:this.props.currentChannelId});s===this.searchTimeoutId&&(this.props.actions.loadStatusesForProfilesList(n),this.props.actions.loadTeamMembersAndChannelMembersForProfilesList(n,this.props.currentTeamId,this.props.currentChannelId).then((({data:e})=>{e&&this.loadComplete()})))}),N.ZP.SEARCH_TIMEOUT_MILLISECONDS);this.searchTimeoutId=s}}render(){if(this.state.loading)return M.createElement(Ga.Z,null);const e=0!==this.props.channel.delete_at;return M.createElement(Ns,{users:this.props.usersToDisplay,usersPerPage:50,total:this.props.totalChannelMembers,nextPage:this.nextPage,search:this.handleSearch,actions:e?[()=>{}]:[ph],actionUserProps:this.props.actionUserProps,focusOnMount:!R.tq()})}}function gh(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function fh(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?gh(Object(s),!0).forEach((function(t){Eh(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):gh(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Eh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}uh(mh,"propTypes",{currentTeamId:y().string.isRequired,currentChannelId:y().string.isRequired,searchTerm:y().string.isRequired,usersToDisplay:y().array.isRequired,actionUserProps:y().objectOf(y().shape({teamMember:y().any.isRequired})).isRequired,totalChannelMembers:y().number.isRequired,actions:y().shape({searchProfiles:y().func.isRequired,getChannelMembers:y().func.isRequired,getChannelStats:y().func.isRequired,setModalSearchTerm:y().func.isRequired,loadProfilesAndTeamMembersAndChannelMembers:y().func.isRequired,loadStatusesForProfilesList:y().func.isRequired,loadTeamMembersAndChannelMembersForProfilesList:y().func.isRequired}).isRequired});const Ch=(0,Jt.P1)(((e,t)=>t),u.or,m.ii,m.TB,((e=[],t={},s={},n)=>{const a={},i=[];for(let r=0;r<e.length;r++){const o=e[r];t[o.id]&&s[o.id]&&0===o.delete_at&&(i.push(o),a[o.id]={channel:n,teamMember:t[o.id],channelMember:s[o.id]})}return{usersToDisplay:i.sort(er.gh),actionUserProps:a}})),bh=(0,n.connect)((function(e){const t=e.views.search.modalSearch;let s;s=t?(0,p.r_)(e,t):(0,p.OX)(e);const n=(0,m.Bw)(e)||{member_count:0};return fh(fh({},Ch(e,s)),{},{currentTeamId:e.entities.teams.currentTeamId,currentChannelId:e.entities.channels.currentChannelId,searchTerm:t,totalChannelMembers:n.member_count})}),(function(e){return{actions:(0,a.bindActionCreators)({getChannelMembers:o.Fk,searchProfiles:r.t6,getChannelStats:o.mx,setModalSearchTerm:ws.Gl,loadProfilesAndTeamMembersAndChannelMembers:Le.RO,loadStatusesForProfilesList:E.xO,loadTeamMembersAndChannelMembersForProfilesList:Le.v8},e)}}))(mh);function _h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class vh extends M.PureComponent{constructor(e){super(e),_h(this,"handleHide",(()=>{this.setState({show:!1})})),_h(this,"handleExit",(()=>{this.props.onHide()})),_h(this,"onAddNewMembersButton",(()=>{const{channel:e,actions:t}=this.props;t.openModal({modalId:N.r8.CHANNEL_INVITE,dialogType:Cl.Z,dialogProps:{channel:e}}),this.handleExit()})),this.state={show:!0}}render(){const e=0!==this.props.channel.delete_at;return M.createElement("div",null,M.createElement(G.Z,{dialogClassName:"a11y__modal more-modal more-modal--action",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit,role:"dialog","aria-labelledby":"channelMembersModalLabel",id:"channelMembersModal"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"channelMembersModalLabel"},M.createElement("span",{className:"name"},this.props.channel.display_name),M.createElement(V.Z,{id:"channel_members_modal.members",defaultMessage:" Members"})),this.props.canManageChannelMembers&&!e&&M.createElement("a",{id:"showInviteModal",className:"btn btn-md btn-primary",href:"#",onClick:this.onAddNewMembersButton},M.createElement(V.Z,{id:"channel_members_modal.addNew",defaultMessage:" Add Members"}))),M.createElement(G.Z.Body,null,M.createElement(bh,{channel:this.props.channel}))))}}_h(vh,"propTypes",{canManageChannelMembers:y().bool.isRequired,onHide:y().func.isRequired,actions:y().shape({openModal:y().func.isRequired}).isRequired});const yh=(0,n.connect)((e=>({canManageChannelMembers:(0,m.n0)(e)})),(e=>({actions:(0,a.bindActionCreators)({openModal:H.h},e)})))(vh);function Mh(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Ph(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Mh(Object(s),!0).forEach((function(t){wh(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Mh(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function wh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Sh={singleline:!1,mentionHighlight:!1};class Th extends M.PureComponent{constructor(e){super(e),wh(this,"onHide",(()=>{this.setState({show:!1})})),wh(this,"handleFormattedTextClick",(e=>I.QJ(e,this.props.currentRelativeTeamUrl))),wh(this,"getHeaderMarkdownOptions",(0,dn.GA)((e=>Ph(Ph({},Sh),{},{channelNamesMap:e})))),this.state={show:!0}}componentDidUpdate(e){var t,s;const n=!e.isRHSOpen&&this.props.isRHSOpen,a=(null===(t=e.channel)||void 0===t?void 0:t.id)!==(null===(s=this.props.currentChannel)||void 0===s?void 0:s.id);(n||a)&&this.onHide()}render(){let e=this.props.channel;const t=0!==e.delete_at;let s;if(!e){const t=I._u("channel_info.notFound","No Channel Found");e={display_name:t,name:t,purpose:t,header:t,id:t,team_id:t,type:t,delete_at:0,create_at:0,update_at:0,last_post_at:0,total_msg_count:0,total_msg_count_root:0,extra_update_at:0,creator_id:t,scheme_id:t,group_constrained:!1}}const n=this.props.channel.props&&this.props.channel.props.channel_mentions;t?s=M.createElement(Vr.Z,{className:"icon icon__archive svg-text-color"}):e.shared?s=M.createElement(Kr.Z,{className:"shared-channel-icon",channelType:e.type,withTooltip:!0}):"O"===e.type?s=M.createElement(kn.Z,{className:"icon icon__globe icon--body"}):"P"===e.type&&(s=M.createElement(xn.Z,{className:"icon icon__globe icon--body"}));const a=(0,Sn.fO)()+"/"+this.props.currentTeam.name+"/group/"+e.name;let i,r;e.purpose?i=e.purpose:e.name===N.ZP.DEFAULT_CHANNEL&&(i=M.createElement(V.Z,{id:"default_channel.purpose",defaultMessage:"Post messages here that you want everyone to see. Everyone automatically becomes a permanent member of this channel when they join the team."})),i&&(r=M.createElement("div",{className:"form-group"},M.createElement("div",{className:"info__label"},M.createElement(V.Z,{id:"channel_info.purpose",defaultMessage:"Purpose:"})),M.createElement("div",{className:"info__value"},i)));let o=null;return e.header&&(o=M.createElement("div",{className:"form-group"},M.createElement("div",{className:"info__label"},M.createElement(V.Z,{id:"channel_info.header",defaultMessage:"Header:"})),M.createElement("div",{onClick:this.handleFormattedTextClick,className:"info__value"},M.createElement(ft.Z,{message:e.header,options:this.getHeaderMarkdownOptions(n)})))),M.createElement(G.Z,{dialogClassName:"a11y__modal about-modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"channelInfoModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"channelInfoModalLabel"},M.createElement(V.Z,{id:"channel_info.about",defaultMessage:"About"}),M.createElement("strong",null,s,e.display_name))),M.createElement(G.Z.Body,null,r,o,M.createElement("div",{className:"form-group"},M.createElement("div",{className:"info__label"},M.createElement(V.Z,{id:"channel_info.url",defaultMessage:"URL:"})),M.createElement("div",{className:"info__value"},a)),M.createElement("div",{className:"about-modal__hash form-group pt-3"},M.createElement("p",null,M.createElement(V.Z,{id:"channel_info.id",defaultMessage:"ID: "}),e.id))))}}wh(Th,"propTypes",{onHide:y().func.isRequired,channel:y().object.isRequired,currentChannel:y().object.isRequired,currentTeam:y().object.isRequired,isRHSOpen:y().bool,currentRelativeTeamUrl:y().string});const Nh=(0,n.connect)((function(e){return{isRHSOpen:(0,Ke.aC)(e),currentRelativeTeamUrl:(0,u.gm)(e),currentChannel:(0,m.TB)(e),currentTeam:(0,u.kA)(e)}}))(Th);function Rh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ih=N.ZP.KeyCodes;class Oh extends M.PureComponent{constructor(e){super(e),Rh(this,"handleModalKeyDown",(e=>{(0,I.pD)(e,Ih.ESCAPE)&&this.hideModal()})),Rh(this,"setShowPreview",(e=>{this.props.actions.setShowPreview(e)})),Rh(this,"handleChange",(e=>{this.setState({header:e.target.value})})),Rh(this,"handleSave",(async()=>{const{header:e}=this.state;if(e===this.props.channel.header)return void this.hideModal();this.setState({saving:!0});const{channel:t,actions:s}=this.props,{error:n}=await s.patchChannel(t.id,{header:e});n?this.setState({serverError:n,saving:!1}):this.hideModal()})),Rh(this,"hideModal",(()=>{this.props.actions.closeModal(N.r8.EDIT_CHANNEL_HEADER)})),Rh(this,"focusTextbox",(()=>{this.editChannelHeaderTextboxRef.current&&this.editChannelHeaderTextboxRef.current.focus()})),Rh(this,"blurTextbox",(()=>{this.editChannelHeaderTextboxRef.current&&this.editChannelHeaderTextboxRef.current.blur()})),Rh(this,"handleEntering",(()=>{this.focusTextbox()})),Rh(this,"handleTargetInput",(e=>{console.info("e",e),e.stopPropagation(),e.preventDefault()})),Rh(this,"handleKeyDown",(e=>{const{ctrlSend:t}=this.props;(0,I.m)(e)?this.setState({header:(0,I.V4)(e)}):t&&(0,I.pD)(e,Ih.ENTER)&&!0===e.ctrlKey&&this.handleKeyPress(e)})),Rh(this,"handleKeyPress",(e=>{const{ctrlSend:t}=this.props;!(0,R.tq)()&&(t&&e.ctrlKey||!t)&&(!(0,I.pD)(e,Ih.ENTER)||e.shiftKey||e.altKey||(e.preventDefault(),this.blurTextbox(),this.handleSave(e)))})),Rh(this,"renderError",(()=>{const{serverError:e}=this.state;if(!e)return null;let t;return t="model.channel.is_valid.header.app_error"===e.server_error_id?M.createElement(V.Z,{id:"edit_channel_header_modal.error",defaultMessage:"The text entered exceeds the character limit. The channel header is limited to {maxLength} characters.",values:{maxLength:1024}}):e.message,M.createElement("div",{className:"form-group has-error"},M.createElement("br",null),M.createElement("label",{className:"control-label"},t))})),this.state={header:e.channel.header,saving:!1},this.editChannelHeaderTextboxRef=M.createRef()}render(){let e=null;return e=this.props.channel.type===N.ZP.DM_CHANNEL?M.createElement(V.Z,{id:"edit_channel_header_modal.title_dm",defaultMessage:"Edit Header"}):M.createElement(V.Z,{id:"edit_channel_header_modal.title",defaultMessage:"Edit Header for {channel}",values:{channel:this.props.channel.display_name}}),M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.props.show,keyboard:!1,onKeyDown:this.handleModalKeyDown,onHide:this.hideModal,onEntering:this.handleEntering,onExited:this.hideModal,role:"dialog","aria-labelledby":"editChannelHeaderModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"editChannelHeaderModalLabel"},e)),M.createElement(G.Z.Body,{bsClass:"modal-body edit-modal-body"},M.createElement("div",null,M.createElement("p",null,M.createElement(V.Z,{id:"edit_channel_header_modal.description",defaultMessage:"Edit the text appearing next to the channel name in the channel header."})),M.createElement("div",{className:"textarea-wrapper"},M.createElement(te.Z,{value:this.state.header,onChange:this.handleChange,onKeyPress:this.handleKeyPress,onKeyDown:this.handleKeyDown,handleFocus:this.handleTargetInput,supportsCommands:!1,suggestionListStyle:"bottom",createMessage:(0,I._u)("edit_channel_header.editHeader","Edit the Channel Header..."),previewMessageLink:(0,I._u)("edit_channel_header.previewHeader","Edit Header"),handlePostError:this.handlePostError,channelId:this.props.channel.id,id:"edit_textbox",ref:this.editChannelHeaderTextboxRef,characterLimit:1024,preview:!1})),M.createElement("div",{className:"post-create-footer"},M.createElement(se.Z,{characterLimit:1024,showPreview:!0,ref:this.setTextboxLinksRef,updatePreview:this.setShowPreview,message:this.state.header})),M.createElement("br",null),this.renderError())),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link cancel-button",onClick:this.hideModal},M.createElement(V.Z,{id:"edit_channel_header_modal.cancel",defaultMessage:"Cancel"})),M.createElement("button",{disabled:this.state.saving,type:"button",className:"btn btn-primary save-button",onClick:this.handleSave},M.createElement(V.Z,{id:"edit_channel_header_modal.save",defaultMessage:"Save"}))))}}Rh(Oh,"propTypes",{channel:y().object.isRequired,show:y().bool.isRequired,ctrlSend:y().bool.isRequired,shouldShowPreview:y().bool.isRequired,actions:y().shape({closeModal:y().func.isRequired,patchChannel:y().func.isRequired,setShowPreview:y().func.isRequired}).isRequired});const Lh=(0,n.connect)((function(e){return{shouldShowPreview:(0,j.a7)(e),show:(0,Ms.g)(e,N.r8.EDIT_CHANNEL_HEADER),ctrlSend:(0,d.o4)(e,D.uP.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter")}}),(function(e){return{actions:(0,a.bindActionCreators)({closeModal:H.M,patchChannel:o.aO,setShowPreview:q.aw},e)}}))(Oh);function Ah(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class kh extends M.PureComponent{constructor(e){super(e),Ah(this,"handleEntering",(()=>{I.e6(this.purpose)})),Ah(this,"onHide",(()=>{this.setState({show:!1})})),Ah(this,"handleKeyDown",(e=>{const{ctrlSend:t}=this.props;I.m(e)?(e.preventDefault(),this.setState({purpose:I.V4(e)})):t&&I.pD(e,N.ZP.KeyCodes.ENTER)&&e.ctrlKey?(e.preventDefault(),this.handleSave(e)):t||!I.pD(e,N.ZP.KeyCodes.ENTER)||e.shiftKey||e.altKey||(e.preventDefault(),this.handleSave(e))})),Ah(this,"handleSave",(async()=>{const{channel:e,actions:{patchChannel:t}}=this.props,{purpose:s}=this.state;if(!e)return;this.setState({requestStarted:!0});const{data:n,error:a}=await t(e.id,{purpose:s});this.setState({serverError:a,requestStarted:!1}),n&&this.onHide()})),Ah(this,"handleChange",(e=>{e.preventDefault(),this.setState({purpose:e.target.value})})),Ah(this,"getPurpose",(e=>{this.purpose=e})),this.state={purpose:e.channel.purpose||"",serverError:null,show:!0,submitted:!1,requestStarted:!1}}render(){let e=null;const{formatMessage:t}=this.props.intl;this.state.serverError&&(e=M.createElement("div",{className:"form-group has-error"},M.createElement("br",null),M.createElement("label",{className:"control-label"},this.state.serverError.message)));let s=M.createElement("span",null,M.createElement(V.Z,{id:"edit_channel_purpose_modal.title1",defaultMessage:"Edit Purpose"}));this.props.channel.display_name&&(s=M.createElement("span",null,M.createElement(V.Z,{id:"edit_channel_purpose_modal.title2",defaultMessage:"Edit Purpose for "}),M.createElement("span",{className:"name"},this.props.channel.display_name)));let n=M.createElement(V.Z,{id:"edit_channel_purpose_modal.body",defaultMessage:'Describe how this channel should be used. This text appears in the channel list in the "More..." menu and helps others decide whether to join.'});"P"===this.props.channel.type&&(n=M.createElement(V.Z,{id:"edit_channel_private_purpose_modal.body",defaultMessage:'This text appears in the \\"View Info\\" modal of the private channel.'}));const a=t({id:"edit_channel_purpose_modal.title1",defaultMessage:"Edit Purpose"}).toLowerCase();return M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onEntering:this.handleEntering,onExited:this.props.onHide,role:"dialog","aria-labelledby":"editChannelPurposeModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"editChannelPurposeModalLabel"},s)),M.createElement(G.Z.Body,null,M.createElement("p",null,n),M.createElement("textarea",{ref:this.getPurpose,className:"form-control no-resize",rows:"6",maxLength:250,value:this.state.purpose,onKeyDown:this.handleKeyDown,onChange:this.handleChange,"aria-label":a}),e),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link cancel-button",onClick:this.onHide},M.createElement(V.Z,{id:"edit_channel_purpose_modal.cancel",defaultMessage:"Cancel"})),M.createElement("button",{type:"button",className:"btn btn-primary save-button",disabled:this.state.requestStarted,onClick:this.handleSave},M.createElement(V.Z,{id:"edit_channel_purpose_modal.save",defaultMessage:"Save"}))))}}Ah(kh,"propTypes",{onHide:y().func.isRequired,channel:y().object,ctrlSend:y().bool.isRequired,intl:y().any,actions:y().shape({patchChannel:y().func.isRequired}).isRequired});const xh=(0,K.ZP)(kh),Dh=(0,n.connect)((function(e){return{ctrlSend:(0,d.o4)(e,N.ZP.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter")}}),(function(e){return{actions:{patchChannel:(0,a.bindActionCreators)(o.aO,e)}}}))(xh);function Zh(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Hh(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Zh(Object(s),!0).forEach((function(t){qh(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Zh(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function qh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const jh=(0,qe.vU)({maxLength:{id:(0,Ae.t)("rename_channel.maxLength"),defaultMessage:"This field must be less than {maxLength, number} characters"},url:{id:(0,Ae.t)("rename_channel.url"),defaultMessage:"URL"},defaultError:{id:(0,Ae.t)("rename_channel.defaultError"),defaultMessage:" - Cannot be changed for the default channel"},displayNameHolder:{id:(0,Ae.t)("rename_channel.displayNameHolder"),defaultMessage:"Enter display name"},groupPicture:{id:(0,Ae.t)("rename_channel.groupPicture"),defaultMessage:"Hình đại diện"},validImage:{id:(0,Ae.t)("user.settings.general.validImage"),defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"},imageTooLarge:{id:(0,Ae.t)("user.settings.general.imageTooLarge"),defaultMessage:"Unable to upload profile image. File is too large."}});class Uh extends M.PureComponent{constructor(e){super(e),qh(this,"textbox",void 0),qh(this,"submitActive",void 0),qh(this,"setError",(e=>{this.setState({serverError:e.message})})),qh(this,"unsetError",(()=>{this.setState({serverError:""})})),qh(this,"handleEntering",(()=>{I.e6(this.textbox)})),qh(this,"handleHide",(e=>{e&&e.preventDefault(),this.setState({serverError:"",urlErrors:[],displayNameError:"",invalid:!1,show:!1})})),qh(this,"handleSubmit",(async e=>{e&&e.preventDefault();const t=Object.assign({},this.props.channel),s=t.name,n=t.display_name,a=Hh(Hh({},this.state),{},{serverError:""}),{formatMessage:i}=this.props.intl,{actions:{patchChannel:r}}=this.props;t.display_name=this.state.displayName.trim(),!t.display_name||t.display_name.length<N.ZP.MIN_CHANNELNAME_LENGTH?(a.displayNameError=M.createElement(V.Z,{id:"rename_channel.minLength",defaultMessage:"Display name must have at least {minLength, number} characters.",values:{minLength:N.ZP.MIN_CHANNELNAME_LENGTH}}),a.invalid=!0):t.display_name.length>N.ZP.MAX_CHANNELNAME_LENGTH?(a.displayNameError=i(jh.maxLength,{maxLength:N.ZP.MAX_CHANNELNAME_LENGTH}),a.invalid=!0):a.displayNameError="",t.name=this.state.channelName.trim();const o=(0,Sn.pj)(t.name);if(o.length>0&&(a.invalid=!0),a.urlErrors=o,this.setState(a),a.invalid)return;if(s===t.name&&n===t.display_name)return void this.onSaveSuccess();const{data:l,error:c}=await r(t.id,t);l?this.onSaveSuccess():c&&this.setError(c)})),qh(this,"onSaveSuccess",(()=>{this.handleHide(),this.unsetError(),st.m.push("/"+this.props.team.name+"/group/"+this.state.channelName)})),qh(this,"handleCancel",(e=>{this.setState({displayName:this.props.channel.display_name,channelName:this.props.channel.name}),this.handleHide(e)})),qh(this,"onNameChange",(e=>{const t=e.target.value.trim().replace(/[^A-Za-z0-9-_]/g,"").toLowerCase();this.setState({channelName:t})})),qh(this,"onDisplayNameChange",(e=>{this.setState({displayName:e.target.value})})),qh(this,"getTextbox",(e=>{this.textbox=e})),qh(this,"setDefaultPicture",(()=>{})),qh(this,"updatePicture",(e=>{e.target.files&&e.target.files[0]?(this.setState({pictureFile:e.target.files[0]}),this.submitActive=!0,this.setState({clientError:null})):this.setState({pictureFile:null})})),qh(this,"submitPicture",(()=>{if(!this.state.pictureFile)return;if(!this.submitActive)return;const{formatMessage:e}=this.props.intl,t=this.state.pictureFile;N.Ec.includes(t.type)?t.size>this.props.maxFileSize?this.setState({clientError:e(jh.imageTooLarge),serverError:""}):this.setState({loadingPicture:!0}):this.setState({clientError:e(jh.validImage),serverError:""})})),this.submitActive=!1,this.state={displayName:e.channel.display_name,channelName:e.channel.name,serverError:"",urlErrors:[],displayNameError:"",invalid:!1,show:!0,pictureFile:null,loadingPicture:!1}}render(){let e=null;this.state.displayNameError&&(e=M.createElement("p",{className:"input__help error"},this.state.displayNameError));let t=null,s=null,n="input-group input-group--limit";this.state.urlErrors.length>0?(t=M.createElement("p",{className:"input__help error"},this.state.urlErrors),n+=" has-error"):s=M.createElement("p",{className:"input__help"},M.createElement(V.Z,{id:"change_url.helpText",defaultMessage:"You can use lowercase letters, numbers, dashes, and underscores."}));let a=null;this.state.serverError&&(a=M.createElement("div",{className:"form-group has-error"},M.createElement("label",{className:"control-label"},this.state.serverError)));const{formatMessage:i}=this.props.intl;let r=i(jh.url),o=!1;this.props.channel.name===N.ZP.DEFAULT_CHANNEL&&(r+=i(jh.defaultError),o=!0);const l=this.props.currentTeamUrl+"/group",c=(0,Sn.ZC)(l,35),d=M.createElement(et.Z,{id:"urlTooltip"},l);return M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.handleCancel,onEntering:this.handleEntering,onExited:this.props.onHide,role:"dialog","aria-labelledby":"renameChannelModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"renameChannelModalLabel"},M.createElement(V.Z,{id:"rename_channel.title",defaultMessage:"Edit Group Info"}))),M.createElement("form",{role:"form"},M.createElement(G.Z.Body,null,M.createElement("div",{className:"form-group"},M.createElement("label",{className:"control-label"},M.createElement(V.Z,{id:"rename_channel.displayName",defaultMessage:"Display Name"})),M.createElement(pa.Z,{onChange:this.onDisplayNameChange,type:"text",ref:this.getTextbox,id:"display_name",className:"form-control",placeholder:jh.displayNameHolder,value:this.state.displayName,maxLength:N.ZP.MAX_CHANNELNAME_LENGTH,"aria-label":i({id:"rename_channel.displayName",defaultMessage:"Display Name"}).toLowerCase()}),e),M.createElement("div",{className:"form-group"},M.createElement("label",{className:"control-label"},r),M.createElement("div",{className:n},M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:d},M.createElement("span",{className:"input-group-addon"},c)),M.createElement("input",{onChange:this.onNameChange,type:"text",className:"form-control",id:"channel_name",value:this.state.channelName,maxLength:N.ZP.MAX_CHANNELNAME_LENGTH,readOnly:o,"aria-label":i({id:"rename_channel.title",defaultMessage:"Rename Channel"}).toLowerCase()})),s,t),a),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link",onClick:this.handleCancel},M.createElement(V.Z,{id:"rename_channel.cancel",defaultMessage:"Cancel"})),M.createElement("button",{onClick:this.handleSubmit,type:"submit",id:"save-button",className:"btn btn-primary"},M.createElement(V.Z,{id:"rename_channel.save",defaultMessage:"Save"})))))}}qh(Uh,"propTypes",{onHide:y().func.isRequired,currentTeamUrl:y().string.isRequired,maxFileSize:y().number.isRequired,actions:y().shape({patchChannel:y().func.isRequired}).isRequired});const Fh=(0,K.ZP)(Uh);function Bh(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Gh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Vh=(0,Jt.P1)((e=>{const t=(0,h.iE)(e),s=e.entities.teams.currentTeamId,n=(0,u.VP)(e,s);return{currentTeamUrl:"".concat((0,Sn.fO)(),"/").concat(n.name),team:n,maxFileSize:parseInt(t.MaxFileSize,10)}}),(e=>function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Bh(Object(s),!0).forEach((function(t){Gh(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Bh(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e))),Kh=(0,n.connect)(Vh,(function(e){return{actions:(0,a.bindActionCreators)({patchChannel:o.aO},e)}}))(Fh);function Yh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Wh extends M.PureComponent{constructor(e){super(e),Yh(this,"handleConvert",(()=>{const{actions:e,channelId:t}=this.props;t.length===N.ZP.CHANNEL_ID_LENGTH&&(e.convertChannelToPrivate(t),(0,Ye.L9)("actions","convert_to_private_channel",{channel_id:t}),this.onHide())})),Yh(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){const{channelDisplayName:e,onHide:t}=this.props;return M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:t,role:"dialog","aria-labelledby":"convertChannelModalLabel"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"convertChannelModalLabel"},M.createElement(V.Z,{id:"convert_channel.title",defaultMessage:"Convert {display_name} to a Private Channel?",values:{display_name:e}}))),M.createElement(G.Z.Body,null,M.createElement("p",null,M.createElement(Dt.Z,{id:"convert_channel.question1",defaultMessage:"When you convert **{display_name}** to a private channel, history and membership are preserved. Publicly shared files remain accessible to anyone with the link. Membership in a private channel is by invitation only.",values:{display_name:e}})),M.createElement("p",null,M.createElement(V.Z,{id:"convert_channel.question2",defaultMessage:"The change is permanent and cannot be undone."})),M.createElement("p",null,M.createElement(Dt.Z,{id:"convert_channel.question3",defaultMessage:"Are you sure you want to convert **{display_name}** to a private channel?",values:{display_name:e}}))),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide},M.createElement(V.Z,{id:"convert_channel.cancel",defaultMessage:"No, cancel"})),M.createElement("button",{type:"button",className:"btn btn-primary","data-dismiss":"modal",onClick:this.handleConvert,autoFocus:!0,"data-testid":"convertChannelConfirm"},M.createElement(V.Z,{id:"convert_channel.confirm",defaultMessage:"Yes, convert to private channel"}))))}}Yh(Wh,"propTypes",{onHide:y().func.isRequired,channelId:y().string.isRequired,channelDisplayName:y().string.isRequired,actions:y().shape({convertChannelToPrivate:y().func.isRequired})});const zh=(0,n.connect)((function(e){return{currentTeamDetails:(0,u.kA)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({convertChannelToPrivate:o.yT},e)}}))(Wh);function Jh(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Xh extends M.PureComponent{constructor(e){super(e),Jh(this,"handleDelete",(()=>{if(this.props.channel.id.length===N.ZP.CHANNEL_ID_LENGTH){if(!this.props.canViewArchivedChannels){const{penultimateViewedChannelName:e}=this.props;st.m.push("/"+this.props.currentTeamDetails.name+"/group/"+e)}this.props.actions.deleteChannel(this.props.channel.id),this.onHide()}})),Jh(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){const{canViewArchivedChannels:e}=this.props;return M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"deleteChannelModalLabel",id:"deleteChannelModal"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"deleteChannelModalLabel"},M.createElement(V.Z,{id:"delete_channel.confirm",defaultMessage:"Confirm ARCHIVE Channel"}))),M.createElement(G.Z.Body,null,M.createElement("div",{className:"alert alert-danger"},!e&&M.createElement(Dt.Z,{id:"delete_channel.question",defaultMessage:"This will archive the channel from the team and remove it from the user interface. Archived channels can be unarchived if needed again. \\n \\nAre you sure you wish to archive the {display_name} channel?",values:{display_name:this.props.channel.display_name}}),e&&M.createElement(Dt.Z,{id:"delete_channel.viewArchived.question",defaultMessage:"This will archive the channel from the team. Channel contents will still be accessible by channel members.\n \nAre you sure you wish to archive the **{display_name}** channel?",values:{display_name:this.props.channel.display_name}}))),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide},M.createElement(V.Z,{id:"delete_channel.cancel",defaultMessage:"Cancel"})),M.createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:this.handleDelete,autoFocus:!0,id:"deleteChannelModalDeleteButton"},M.createElement(V.Z,{id:"delete_channel.del",defaultMessage:"Archive"}))))}}Jh(Xh,"propTypes",{onHide:y().func.isRequired,currentTeamDetails:y().shape({name:y().string.isRequired}).isRequired,canViewArchivedChannels:y().bool,penultimateViewedChannelName:y().string.isRequired,actions:y().shape({deleteChannel:y().func.isRequired}).isRequired});const Qh=(0,n.connect)((function(e){return{canViewArchivedChannels:"true"===(0,h.iE)(e).ExperimentalViewArchivedChannels,currentTeamDetails:(0,u.kA)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({deleteChannel:o.zz},e)}}))(Xh);function $h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ep extends M.PureComponent{constructor(e){super(e),$h(this,"handleUnarchive",(()=>{this.props.channel.id.length===N.ZP.CHANNEL_ID_LENGTH&&(this.props.actions.unarchiveChannel(this.props.channel.id),this.onHide())})),$h(this,"onHide",(()=>{this.setState({show:!1})})),this.state={show:!0}}render(){return M.createElement(G.Z,{dialogClassName:"a11y__modal",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,role:"dialog","aria-labelledby":"unarchiveChannelModalLabel",id:"unarchiveChannelModal"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"unarchiveChannelModalLabel"},M.createElement(V.Z,{id:"unarchive_channel.confirm",defaultMessage:"Confirm UNARCHIVE Channel"}))),M.createElement(G.Z.Body,null,M.createElement("div",{className:"alert alert-danger"},M.createElement(Dt.Z,{id:"unarchive_channel.viewArchived.question",defaultMessage:"Are you sure you wish to unarchive the **{display_name}** channel?",values:{display_name:this.props.channel.display_name}}))),M.createElement(G.Z.Footer,null,M.createElement("button",{type:"button",className:"btn btn-link",onClick:this.onHide},M.createElement(V.Z,{id:"unarchive_channel.cancel",defaultMessage:"Cancel"})),M.createElement("button",{type:"button",className:"btn btn-danger","data-dismiss":"modal",onClick:this.handleUnarchive,autoFocus:!0,id:"unarchiveChannelModalDeleteButton"},M.createElement(V.Z,{id:"unarchive_channel.del",defaultMessage:"Unarchive"}))))}}$h(ep,"propTypes",{onHide:y().func.isRequired,actions:y().shape({unarchiveChannel:y().func.isRequired}).isRequired});const tp=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({unarchiveChannel:o.Ny},e)}}))(ep);function sp(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function np(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ap extends M.PureComponent{constructor(e){super(e),np(this,"searchTimeoutId",void 0),np(this,"selectedItemRef",void 0),np(this,"handleHide",(()=>{this.props.actions.setModalSearchTerm(""),this.setState({show:!1})})),np(this,"handleExit",(()=>{this.props.onHide&&this.props.onHide()})),np(this,"handleResponse",(e=>{let t=null;e&&e.message&&(t=e.message),this.setState({saving:!1,addError:t})})),np(this,"handleSubmit",(async()=>{const e=this.state.values.map((e=>e.id));if(0!==e.length){if(this.props.skipCommit)return this.props.onAddCallback&&this.props.onAddCallback(e),void this.handleHide();this.setState({saving:!0}),await Promise.all(e.map((async e=>{const{error:t}=await this.props.actions.linkGroupSyncable(e,this.props.currentChannelId,D.Fl.SYNCABLE_TYPE_CHANNEL,{auto_add:!0});this.handleResponse(t),t||this.handleHide()})))}})),np(this,"addValue",(e=>{const t=Object.assign([],this.state.values),s=t.map((e=>e.id));e&&e.id&&-1===s.indexOf(e.id)&&t.push(e),this.setState({values:t})})),np(this,"setGroupsLoadingState",(e=>{this.setState({loadingGroups:e})})),np(this,"handlePageChange",((e,t)=>{e>t&&(this.setGroupsLoadingState(!0),this.props.actions.getGroupsNotAssociatedToChannel(this.props.currentChannelId,this.props.searchTerm,e,51,!0).then((()=>{this.setGroupsLoadingState(!1)})))})),np(this,"handleDelete",(e=>{this.setState({values:e})})),np(this,"search",(e=>{this.props.actions.setModalSearchTerm(e)})),np(this,"renderOption",((e,t,s,n)=>{const a=t?"more-modal__row--selected":"";return M.createElement("div",{key:e.id,ref:t?this.selectedItemRef:e.id,className:"more-modal__row clickable "+a,onClick:()=>s(e),onMouseMove:()=>n?n(e):void 0},M.createElement("img",{className:"more-modal__image",src:Da,alt:"group picture",width:"32",height:"32",loading:"lazy"}),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},e.display_name," - ",M.createElement("span",{className:"more-modal__name_sub"},M.createElement(V.Z,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),M.createElement("div",{className:"more-modal__actions"},M.createElement("div",{className:"more-modal__actions--round"},M.createElement(Za.Z,null))))})),this.searchTimeoutId=0,this.state={values:[],show:!0,search:!1,saving:!1,addError:null,loadingGroups:!0},this.selectedItemRef=M.createRef()}componentDidMount(){Promise.all([this.props.actions.getTeam(this.props.teamID),this.props.actions.getAllGroupsAssociatedToTeam(this.props.teamID,!1,!0),this.props.actions.getGroupsNotAssociatedToChannel(this.props.currentChannelId,"",0,51,!0),this.props.actions.getAllGroupsAssociatedToChannel(this.props.currentChannelId,!1,!0)]).then((()=>{this.setGroupsLoadingState(!1)}))}componentDidUpdate(e){if(this.props.searchTerm!==e.searchTerm){clearTimeout(this.searchTimeoutId);const e=this.props.searchTerm;if(""===e)return;this.searchTimeoutId=window.setTimeout((async()=>{this.setGroupsLoadingState(!0),await this.props.actions.getGroupsNotAssociatedToChannel(this.props.currentChannelId,e,null,null,!0),this.setGroupsLoadingState(!1)}),N.ZP.SEARCH_TIMEOUT_MILLISECONDS)}}renderValue(e){return e.data.display_name}render(){const e=M.createElement("div",{id:"numGroupsRemaining"},M.createElement(V.Z,{id:"multiselect.numGroupsRemaining",defaultMessage:"Use ↑↓ to browse, ↵ to select. You can add {num, number} more {num, plural, one {group} other {groups}}. ",values:{num:10-this.state.values.length}})),t=(0,I._u)("multiselect.add","Add"),s=(0,I._u)("multiselect.adding","Adding...");let n=null;this.state.addError&&(n=M.createElement("div",{className:"has-error col-sm-12"},M.createElement("label",{className:"control-label font-weight--normal"},this.state.addError)));let a=this.props.groups;if(this.props.excludeGroups){const e=e=>!this.props.excludeGroups.find((t=>t.id===e.id));a=a.filter(e)}if(this.props.includeGroups){const e=e=>this.props.includeGroups.find((t=>t.id===e.id));a=[...a,...this.props.includeGroups.filter(e)]}const i=a.map((e=>function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?sp(Object(s),!0).forEach((function(t){np(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):sp(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({label:e.display_name,value:e.id},e)));return M.createElement(G.Z,{id:"addGroupsToChannelModal",dialogClassName:"a11y__modal more-modal more-direct-channels",show:this.state.show,onHide:this.handleHide,onExited:this.handleExit},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,null,M.createElement(V.Z,{id:"add_groups_to_channel.title",defaultMessage:"Add New Groups to {channelName} Channel",values:{channelName:M.createElement("strong",null,this.props.currentChannelName)}}))),M.createElement(G.Z.Body,null,n,M.createElement(xa.Z,{key:"addGroupsToChannelKey",options:i,optionRenderer:this.renderOption,selectedItemRef:this.selectedItemRef,values:this.state.values,valueRenderer:this.renderValue,perPage:50,handlePageChange:this.handlePageChange,handleInput:this.search,handleDelete:this.handleDelete,handleAdd:this.addValue,handleSubmit:this.handleSubmit,maxValues:10,numRemainingText:e,buttonSubmitText:t,buttonSubmitLoadingText:s,saving:this.state.saving,loading:this.state.loadingGroups,placeholderText:(0,I._u)("multiselect.addGroupsPlaceholder","Search and add groups")})))}}np(ap,"propTypes",{currentChannelName:y().string.isRequired,currentChannelId:y().string.isRequired,teamID:y().string.isRequired,searchTerm:y().string.isRequired,groups:y().array.isRequired,excludeGroups:y().array,includeGroups:y().array,onHide:y().func,skipCommit:y().bool,onAddCallback:y().func,actions:y().shape({getGroupsNotAssociatedToChannel:y().func.isRequired,setModalSearchTerm:y().func.isRequired,linkGroupSyncable:y().func.isRequired,getAllGroupsAssociatedToChannel:y().func.isRequired,getTeam:y().func.isRequired,getAllGroupsAssociatedToTeam:y().func.isRequired}).isRequired});const ip=(0,n.connect)((function(e,t){const s=e.views.search.modalSearch,n=t.channel||(0,m.TB)(e)||{};let a=(0,ka.$5)(e,n.id,n.team_id);if(s){const e=RegExp(s,"i");a=a.filter((t=>e.test(t.display_name)||e.test(t.name)))}return{currentChannelName:n.display_name,currentChannelId:n.id,skipCommit:t.skipCommit,onAddCallback:t.onAddCallback,excludeGroups:t.excludeGroups,searchTerm:s,groups:a,teamID:n.team_id}}),(function(e){return{actions:(0,a.bindActionCreators)({getGroupsNotAssociatedToChannel:c.$5,setModalSearchTerm:ws.Gl,linkGroupSyncable:c.Bh,getAllGroupsAssociatedToChannel:c.n0,getTeam:l.VP,getAllGroupsAssociatedToTeam:c.K9},e)}}))(ap);var rp=s(22131);function op(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class lp extends M.PureComponent{constructor(...e){super(...e),op(this,"loadItems",(async(e,t)=>{const{data:s}=await this.props.actions.getGroupsAssociatedToChannel(this.props.channel.id,t,e,50);return{items:s.groups,totalCount:s.totalGroupCount}})),op(this,"onClickRemoveGroup",((e,t)=>this.props.actions.unlinkGroupSyncable(e.id,this.props.channel.id,rp.Z.SYNCABLE_TYPE_CHANNEL).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:s}=await t.props.loadItems(t.setState.page,t.state.searchTerm);t.setState({loading:!1,items:e,totalCount:s})})))),op(this,"onHide",(()=>{this.props.actions.closeModal(N.r8.MANAGE_CHANNEL_GROUPS)})),op(this,"titleButtonOnClick",(()=>{this.onHide(),this.props.actions.openModal({modalId:N.r8.ADD_GROUPS_TO_TEAM,dialogType:ip})})),op(this,"setChannelMemberStatus",(async(e,t,s)=>{this.props.actions.patchGroupSyncable(e.id,this.props.channel.id,rp.Z.SYNCABLE_TYPE_CHANNEL,{scheme_admin:s}).then((async()=>{t.setState({loading:!0});const{items:e,totalCount:s}=await t.props.loadItems(t.setState.page,t.state.searchTerm);await this.props.actions.getMyChannelMember(this.props.channel.id),t.setState({loading:!1,items:e,totalCount:s})}))})),op(this,"renderRow",((e,t)=>{let s;return s=e.scheme_admin?I._u("channel_members_dropdown.channel_admins","Group Admins"):e.scheme_mod?I._u("channel_members_dropdown.channel_mods","Group Mods"):I._u("channel_members_dropdown.channel_members","Group Members"),M.createElement("div",{key:e.id,className:"more-modal__row"},M.createElement("img",{className:"more-modal__image",src:Da,alt:"group picture",width:"32",height:"32"}),M.createElement("div",{className:"more-modal__details"},M.createElement("div",{className:"more-modal__name"},e.display_name," ","-"," ",M.createElement("span",{className:"more-modal__name_count"},M.createElement(V.Z,{id:"numMembers",defaultMessage:"{num, number} {num, plural, one {member} other {members}}",values:{num:e.member_count}})))),M.createElement("div",{className:"more-modal__actions"},M.createElement(Os.Z,null,M.createElement("button",{id:"teamGroupsDropdown_".concat(e.display_name),className:"dropdown-toggle theme color--link style--none",type:"button","aria-expanded":"true"},M.createElement("span",null,s," "),M.createElement(Rs.Z,null)),M.createElement(Is.Z,{openLeft:!0,ariaLabel:I._u("channel_members_dropdown.menuAriaLabel","Change the role of channel member")},M.createElement(Is.Z.ItemAction,{show:!e.scheme_admin,onClick:()=>this.setChannelMemberStatus(e,t,!0),text:I._u("channel_members_dropdown.make_channel_admins","Make Channel Admins")}),M.createElement(Is.Z.ItemAction,{show:!e.scheme_mod,onClick:()=>this.setChannelMemberStatus(e,t,!0),text:I._u("channel_members_dropdown.make_channel_mods","Make Channel Mods")}),M.createElement(Is.Z.ItemAction,{show:Boolean(e.scheme_admin)||Boolean(e.scheme_mod),onClick:()=>this.setChannelMemberStatus(e,t,!1),text:I._u("channel_members_dropdown.make_channel_members","Make Channel Members")}),M.createElement(Is.Z.ItemAction,{onClick:()=>this.onClickRemoveGroup(e,t),text:I._u("group_list_modal.removeGroupButton","Remove Group")})))))}))}render(){const{formatMessage:e}=this.props.intl;return M.createElement(Ka,{titleText:e({id:"groups",defaultMessage:"{channel} Groups"},{channel:this.props.channel.display_name}),searchPlaceholderText:e({id:"manage_channel_groups_modal.search_placeholder",defaultMessage:"Search groups"}),renderRow:this.renderRow,loadItems:this.loadItems,onHide:this.onHide,titleBarButtonText:e({id:"group_list_modal.addGroupButton",defaultMessage:"Add Groups"}),titleBarButtonOnClick:this.titleButtonOnClick})}}op(lp,"propTypes",{actions:y().shape({getGroupsAssociatedToChannel:y().func.isRequired,unlinkGroupSyncable:y().func.isRequired,patchGroupSyncable:y().func.isRequired,getMyChannelMember:y().func.isRequired,closeModal:y().func.isRequired,openModal:y().func.isRequired}).isRequired});const cp=(0,K.ZP)(lp),dp=(0,n.connect)(((e,t)=>({channel:e.entities.channels.channels[t.channelID]})),(e=>({actions:(0,a.bindActionCreators)({getGroupsAssociatedToChannel:c.k0,closeModal:H.M,openModal:H.h,unlinkGroupSyncable:c.je,patchGroupSyncable:c.B2,getMyChannelMember:o.Or},e)})))(cp);function hp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const pp=(0,qe.vU)({maxLength:{id:(0,Ae.t)("rename_channel.maxLength"),defaultMessage:"This field must be less than {maxLength, number} characters"},url:{id:(0,Ae.t)("rename_channel.url"),defaultMessage:"URL"},defaultError:{id:(0,Ae.t)("rename_channel.defaultError"),defaultMessage:" - Cannot be changed for the default channel"},displayNameHolder:{id:(0,Ae.t)("rename_channel.displayNameHolder"),defaultMessage:"Enter display name"},groupPicture:{id:(0,Ae.t)("rename_channel.groupPicture"),defaultMessage:"Hình đại diện"},validImage:{id:(0,Ae.t)("user.settings.general.validImage"),defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"},imageTooLarge:{id:(0,Ae.t)("user.settings.general.imageTooLarge"),defaultMessage:"Unable to upload profile image. File is too large."}});class up extends M.PureComponent{constructor(e){super(e),hp(this,"submitActive",void 0),hp(this,"setError",(e=>{this.setState({serverError:e.message})})),hp(this,"unsetError",(()=>{this.setState({serverError:""})})),hp(this,"handleHide",(e=>{e&&e.preventDefault(),this.setState({serverError:"",urlErrors:[],invalid:!1,show:!1})})),hp(this,"onSaveSuccess",(()=>{this.handleHide(),this.unsetError()})),hp(this,"handleCancel",(e=>{this.handleHide(e)})),hp(this,"setDefaultPicture",(()=>{this.setState({loadingPicture:!0}),this.props.actions.removeChannelImage(this.props.channel.id).then((({data:e,error:t})=>{e?(this.submitActive=!1,this.onSaveSuccess()):t&&this.setState({serverError:t.message})}))})),hp(this,"updatePicture",(e=>{e.target.files&&e.target.files[0]?(this.submitActive=!0,this.setState({clientError:null,pictureFile:e.target.files[0]})):this.setState({pictureFile:null})})),hp(this,"submitPicture",(()=>{if(!this.state.pictureFile)return;if(!this.submitActive)return;const{formatMessage:e}=this.props.intl,t=this.state.pictureFile;N.Ec.includes(t.type)?t.size>this.props.maxFileSize?this.setState({clientError:e(pp.imageTooLarge),serverError:""}):(this.setState({loadingPicture:!0}),this.props.actions.setChannelImage(this.props.channel.id,t).then((({data:e,error:t})=>{e?(this.submitActive=!1,this.onSaveSuccess()):t&&this.setState({serverError:t.message})}))):this.setState({clientError:e(pp.validImage),serverError:""})})),this.submitActive=!1,this.state={serverError:"",urlErrors:[],invalid:!1,show:!0,pictureFile:null,loadingPicture:!1}}render(){const{channel:e,maxFileSize:t}=this.props,{pictureFile:s,serverError:n,clientError:a,loadingPicture:i}=this.state,r=e.last_picture_update>0?this.setDefaultPicture:null,o=M.createElement(Dt.Z,{id:"setting_picture.help.team",defaultMessage:"Upload a team icon in BMP, JPG or PNG format.\\nSquare images with a solid background color are recommended."}),l=I.Xv(e.id,e.last_picture_update);return M.createElement(G.Z,{dialogClassName:"a11y__modal settings-modal",show:this.state.show,onHide:this.handleCancel,onExited:this.props.onHide,role:"dialog","aria-labelledby":"channelEditImageModalLabel",className:"channel__edit_image"},M.createElement(G.Z.Header,{closeButton:!0},M.createElement(G.Z.Title,{componentClass:"h1",id:"channelEditImageModalLabel"},M.createElement(V.Z,{id:"update_channel_image.title",defaultMessage:"Cập nhật Hình đại diện"}))),M.createElement(G.Z.Body,null,M.createElement(da.Z,{title:"",onSubmit:this.submitPicture,onSetDefault:r,src:l,defaultImageSrc:I.i5(this.props.channel.id),serverError:n,clientError:a,updateSection:e=>{e.preventDefault(),this.handleCancel()},file:s,onFileChange:this.updatePicture,submitActive:this.submitActive,loadingPicture:i,maxFileSize:t,helpText:o})))}}hp(up,"propTypes",{maxFileSize:y().number.isRequired,onHide:y().func.isRequired,actions:y().shape({}).isRequired});const mp=(0,K.ZP)(up);function gp(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function fp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ep=(0,Jt.P1)((e=>{const t=(0,h.iE)(e);return{maxFileSize:parseInt(t.MaxFileSize,10)}}),(e=>function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?gp(Object(s),!0).forEach((function(t){fp(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):gp(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e))),Cp=(0,n.connect)(Ep,(function(e){return{actions:(0,a.bindActionCreators)({removeChannelImage:o.Th,setChannelImage:o.M},e)}}))(mp);var bp=s(80020);function _p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class vp extends M.PureComponent{constructor(...e){super(...e),_p(this,"handleLeave",(e=>{e.preventDefault();const{channel:t,actions:{leaveChannel:s}}=this.props;t.type===N.gT.PRIVATE_CHANNEL?(0,T.EK)(t):s(t.id)}))}render(){const{channel:e,isDefault:t,isGuestUser:s,id:n}=this.props;return M.createElement(Is.Z.ItemAction,{id:n,show:(!t||s)&&e.type!==N.gT.DM_CHANNEL&&e.type!==N.gT.GM_CHANNEL,onClick:this.handleLeave,text:(0,I._u)("channel_header.leave","Leave Channel")})}}_p(vp,"propTypes",{isDefault:y().bool,isGuestUser:y().bool,id:y().string,actions:y().shape({leaveChannel:y().func.isRequired}).isRequired}),_p(vp,"defaultProps",{isDefault:!0,isGuestUser:!1});const yp=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({leaveChannel:b.TL},e)})))(vp);function Mp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Pp extends M.PureComponent{constructor(...e){super(...e),Mp(this,"handleClose",(()=>{this.props.actions.goToLastViewedChannel()}))}render(){return M.createElement(Is.Z.ItemAction,{show:this.props.isArchived,onClick:this.handleClose,text:(0,I._u)("center_panel.archived.closeChannel","Close Channel")})}}Mp(Pp,"propTypes",{isArchived:y().bool.isRequired,actions:y().shape({goToLastViewedChannel:y().func.isRequired}).isRequired});const wp=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({goToLastViewedChannel:b.NL},e)})))(Pp);function Sp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Tp extends M.PureComponent{constructor(...e){super(...e),Sp(this,"handleClose",(e=>{e.preventDefault();const{channel:t,currentUser:s,currentTeam:n,redirectChannel:a,actions:{savePreferences:i,leaveDirectChannel:r}}=this.props;let o,l;t.type===N.gT.DM_CHANNEL?(l=N.gT.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW,o=t.teammate_id):(l=N.gT.Preferences.CATEGORY_GROUP_CHANNEL_SHOW,o=t.id),r(t.name),i(s.id,[{user_id:s.id,category:l,name:o,value:"false"}]),st.m.push("/".concat(n.name,"/group/").concat(a))}))}render(){const{id:e,channel:t}=this.props;let s;return t.type===N.gT.DM_CHANNEL?s=(0,I._u)("center_panel.direct.closeDirectMessage","Close Direct Message"):t.type===N.gT.GM_CHANNEL&&(s=(0,I._u)("center_panel.direct.closeGroupMessage","Close Group Message")),M.createElement(Is.Z.ItemAction,{id:e,show:t.type===N.gT.DM_CHANNEL||t.type===N.gT.GM_CHANNEL,onClick:this.handleClose,text:s})}}Sp(Tp,"propTypes",{redirectChannel:y().string.isRequired,id:y().string,actions:y().shape({savePreferences:y().func.isRequired,leaveDirectChannel:y().func.isRequired}).isRequired});const Np=(0,n.connect)((e=>({currentTeam:(0,u.kA)(e),redirectChannel:(0,m.fG)(e,(0,u.ev)(e))})),(e=>({actions:(0,a.bindActionCreators)({savePreferences:Oe.$A,leaveDirectChannel:b.e2},e)})))(Tp);function Rp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ip extends M.PureComponent{constructor(...e){super(...e),Rp(this,"handleClick",(()=>{const{user:e,channel:t,isMuted:s,actions:{updateChannelNotifyProps:n}}=this.props;n(e.id,t.id,{mark_unread:s?N.XH.ALL:N.XH.MENTION})}))}render(){const{id:e,isMuted:t}=this.props;let s;return s=t?(0,I._u)("channel_header.unmute","Unmute Channel"):(0,I._u)("channel_header.mute","Mute Channel"),M.createElement(Is.Z.ItemAction,{id:e,onClick:this.handleClick,text:s})}}Rp(Ip,"propTypes",{isMuted:y().bool.isRequired,id:y().string,actions:y().shape({}).isRequired});const Op=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({updateChannelNotifyProps:o.n$},e)})))(Ip);function Lp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ap extends M.PureComponent{constructor(...e){super(...e),Lp(this,"toggleFavoriteChannel",(e=>{const{isFavorite:t,actions:{favoriteChannel:s,unfavoriteChannel:n}}=this.props;return t?n(e):s(e)})),Lp(this,"handleClick",(e=>{e.preventDefault(),this.toggleFavoriteChannel(this.props.channel.id)}))}render(){let e;return e=this.props.isFavorite?(0,I._u)("channelHeader.removeFromFavorites","Remove from Favorites"):(0,I._u)("channelHeader.addToFavorites","Add to Favorites"),M.createElement(Is.Z.ItemAction,{show:this.props.show,onClick:this.handleClick,text:e})}}Lp(Ap,"propTypes",{show:y().bool,isFavorite:y().bool.isRequired,actions:y().shape({favoriteChannel:y().func.isRequired,unfavoriteChannel:y().func.isRequired}).isRequired}),Lp(Ap,"defaultProps",{show:!0});const kp=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({favoriteChannel:o.ZE,unfavoriteChannel:o.Dn},e)})))(Ap);function xp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Dp extends M.PureComponent{constructor(...e){super(...e),xp(this,"handleClick",(e=>{e.preventDefault();const{channel:t,hasPinnedPosts:s,actions:{closeRightHandSide:n,showPinnedPosts:a}}=this.props;s?n():a(t.id)}))}render(){return M.createElement(Is.Z.ItemAction,{show:this.props.show,onClick:this.handleClick,text:(0,I._u)("navbar.viewPinnedPosts","View Pinned Posts")})}}xp(Dp,"propTypes",{show:y().bool,channel:y().any.isRequired,hasPinnedPosts:y().bool.isRequired,actions:y().shape({closeRightHandSide:y().func.isRequired,showPinnedPosts:y().func.isRequired}).isRequired});const Zp=(0,n.connect)((e=>({hasPinnedPosts:(0,Ke.kV)(e)===N.Hp.PIN})),(e=>({actions:(0,a.bindActionCreators)({closeRightHandSide:Ve.Lg,showPinnedPosts:Ve.B7},e)})))(Dp);class Hp extends M.PureComponent{render(){const{user:e,channel:t,isDefault:s,isFavorite:n,isMuted:a,isReadonly:i,isArchived:r,isMobile:o,penultimateViewedChannelName:l,isLicensedForLDAPGroups:c}=this.props,d=t.type===N.gT.PRIVATE_CHANNEL,h=!0===t.group_constrained,p=d?D.Pl.MANAGE_PRIVATE_CHANNEL_MEMBERS:D.Pl.MANAGE_PUBLIC_CHANNEL_MEMBERS,u=d?D.Pl.MANAGE_PRIVATE_CHANNEL_PROPERTIES:D.Pl.MANAGE_PUBLIC_CHANNEL_PROPERTIES,m=d?D.Pl.DELETE_PRIVATE_CHANNEL:D.Pl.DELETE_PUBLIC_CHANNEL,g=D.Pl.MANAGE_TEAM;let f;o&&(f=M.createElement("li",{className:"MenuGroup mobile-menu-divider"},M.createElement("hr",null)));const E=this.props.pluginMenuItems.map((e=>M.createElement(Is.Z.ItemAction,{id:e.id+"_pluginmenuitem",key:e.id+"_pluginmenuitem",onClick:()=>{e.action&&e.action(this.props.channel.id)},text:e.text})));return M.createElement(M.Fragment,null,M.createElement(Is.Z.Group,{divider:f},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelViewInfo",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL,modalId:N.r8.CHANNEL_INFO,dialogType:Nh,dialogProps:{channel:t},text:(0,I._u)("navbar.viewInfo","View Info")}),M.createElement(kp,{id:"channelToggleFavorite",show:o,channel:t,isFavorite:n}),M.createElement(Zp,{id:"channelViewPinnedPosts",show:o,channel:t}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelNotificationPreferences",show:t.type!==N.gT.DM_CHANNEL&&!r,modalId:N.r8.CHANNEL_NOTIFICATIONS,dialogType:ch,dialogProps:{channel:t,currentUser:e},text:(0,I._u)("navbar.preferences","Notification Preferences")}),M.createElement(Op,{id:"channelToggleMuteChannel",user:e,channel:t,isMuted:a,isArchived:r})),M.createElement(Is.Z.Group,{divider:f},M.createElement(bp.Z,{channelId:t.id,teamId:t.team_id,permissions:[p]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelAddMembers",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&!r&&!s&&!h,modalId:N.r8.CHANNEL_INVITE,dialogType:Cl.Z,dialogProps:{channel:t},text:(0,I._u)("navbar.addMembers","Add Members")}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelAddMembers",show:t.type===N.gT.GM_CHANNEL&&!r&&!h,modalId:N.r8.CREATE_DM_CHANNEL,dialogType:yr,dialogProps:{isExistingChannel:!0},text:(0,I._u)("navbar.addMembers","Add Members")})),M.createElement(bp.Z,{channelId:t.id,teamId:t.team_id,permissions:[p]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelViewMembers",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&(r||s),modalId:N.r8.CHANNEL_MEMBERS,dialogType:yh,dialogProps:{channel:t},text:(0,I._u)("channel_header.viewMembers","View Members")}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelAddGroups",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&!r&&!s&&h&&c,modalId:N.r8.ADD_GROUPS_TO_CHANNEL,dialogType:ip,text:(0,I._u)("navbar.addGroups","Add Groups")}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelManageGroups",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&!r&&!s&&h&&c,modalId:N.r8.MANAGE_CHANNEL_GROUPS,dialogType:dp,dialogProps:{channelID:t.id},text:(0,I._u)("navbar_dropdown.manageGroups","Manage Groups")}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelManageMembers",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&!r&&!s,modalId:N.r8.CHANNEL_MEMBERS,dialogType:yh,dialogProps:{channel:t},text:(0,I._u)("channel_header.manageMembers","Manage Members")})),M.createElement(bp.Z,{channelId:t.id,teamId:t.team_id,permissions:[p],invert:!0},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelViewMembers",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&!r&&!s,modalId:N.r8.CHANNEL_MEMBERS,dialogType:yh,dialogProps:{channel:t},text:(0,I._u)("channel_header.viewMembers","View Members")}))),M.createElement(Is.Z.Group,{divider:f},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelEditHeader",show:!(t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL||r||i),modalId:N.r8.EDIT_CHANNEL_HEADER,dialogType:Lh,dialogProps:{channel:t},text:(0,I._u)("channel_header.setHeader","Edit Banner")}),M.createElement(bp.Z,{channelId:t.id,teamId:t.team_id,permissions:[u]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelEditImage",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&!r&&!i,modalId:N.r8.EDIT_CHANNEL_IMAGE,dialogType:Cp,dialogProps:{channel:t},text:(0,I._u)("channel_header.setImage","Đổi ảnh nhóm")}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelEditHeader",show:t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL&&!r&&!i,modalId:N.r8.EDIT_CHANNEL_HEADER,dialogType:Lh,dialogProps:{channel:t},text:(0,I._u)("channel_header.setHeader","Edit Banner")}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelEditPurpose",show:!r&&!i&&t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL,modalId:N.r8.EDIT_CHANNEL_PURPOSE,dialogType:Dh,dialogProps:{channel:t},text:(0,I._u)("channel_header.setPurpose","Edit Purpose")}),M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelRename",show:!r&&t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL,modalId:N.r8.RENAME_CHANNEL,dialogType:Kh,dialogProps:{channel:t},text:(0,I._u)("channel_header.rename","Rename")})),M.createElement(bp.Z,{channelId:t.id,teamId:t.team_id,permissions:[D.Pl.CONVERT_PUBLIC_CHANNEL_TO_PRIVATE]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelConvertToPrivate",show:!r&&!s&&t.type===N.gT.OPEN_CHANNEL,modalId:N.r8.CONVERT_CHANNEL,dialogType:zh,dialogProps:{channelId:t.id,channelDisplayName:t.display_name},text:(0,I._u)("channel_header.convert","Convert to Private")})),M.createElement(bp.Z,{channelId:t.id,teamId:t.team_id,permissions:[m]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelArchiveChannel",show:!r&&!s&&t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL,modalId:N.r8.DELETE_CHANNEL,dialogType:Qh,dialogProps:{channel:t,penultimateViewedChannelName:l},text:(0,I._u)("channel_header.delete","Archive Channel")}))),M.createElement(Is.Z.Group,null,E),M.createElement(Is.Z.Group,{divider:f},o&&M.createElement(Qd,{channel:t,isDropdown:!0}),M.createElement(yp,{id:"channelLeaveChannel",channel:t,isDefault:s,isGuestUser:(0,I.a_)(e)}),M.createElement(Np,{id:"channelCloseMessage",channel:t,currentUser:e}),M.createElement(wp,{id:"channelCloseChannel",isArchived:r})),M.createElement(Is.Z.Group,{divider:f},M.createElement(bp.Z,{channelId:t.id,teamId:t.team_id,permissions:[g]},M.createElement(Is.Z.ItemToggleModalRedux,{id:"channelUnarchiveChannel",show:r&&!s&&t.type!==N.gT.DM_CHANNEL&&t.type!==N.gT.GM_CHANNEL,modalId:N.r8.UNARCHIVE_CHANNEL,dialogType:tp,dialogProps:{channel:t},text:(0,I._u)("channel_header.unarchive","Unarchive Channel")}))))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(Hp,"propTypes",{user:y().object.isRequired,channel:y().object.isRequired,isDefault:y().bool.isRequired,isFavorite:y().bool.isRequired,isReadonly:y().bool.isRequired,isMuted:y().bool.isRequired,isArchived:y().bool.isRequired,isMobile:y().bool.isRequired,penultimateViewedChannelName:y().string.isRequired,pluginMenuItems:y().arrayOf(y().object),isLicensedForLDAPGroups:y().bool});class qp extends M.PureComponent{render(){return M.createElement(xt.Z,{in:this.props.show,classNames:"mobile-channel-header-dropdown",enter:!0,exit:!0,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:350,exit:350}},this.props.children)}}function jp(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(qp,"propTypes",{children:y().node,show:y().bool.isRequired});class Up extends M.PureComponent{constructor(...e){super(...e),jp(this,"getChannelTitle",(()=>{const{user:e,channel:t,teammateId:s,displayName:n}=this.props;return t.type===N.gT.DM_CHANNEL?e.id===s?M.createElement(V.Z,{id:"channel_header.directchannel.you",defaultMessage:"{displayname} (you)",values:{displayname:n}}):n:t.display_name}))}render(){const{teammateIsBot:e,teammateStatus:t}=this.props;let s;return e||(s=M.createElement(Qc.Z,{status:t})),M.createElement(Os.Z,{animationComponent:qp},M.createElement("a",null,M.createElement("span",{className:"heading"},s,this.getChannelTitle()),M.createElement(V.Z,{id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"},(e=>M.createElement("span",{className:"fa fa-angle-down header-dropdown__icon",title:e})))),M.createElement(V.Z,{id:"channel_header.menuAriaLabel",defaultMessage:"Channel Menu"},(e=>M.createElement(Is.Z,{ariaLabel:e},M.createElement(Vp,{isMobile:!0}),M.createElement("div",{className:"Menu__close visible-xs-block"},"×")))))}}jp(Up,"propTypes",{user:y().object.isRequired,channel:y().object.isRequired,teammateId:y().string,teammateIsBot:y().bool,teammateStatus:y().string,displayName:y().string.isRequired});const Fp=(0,Jt.P1)(m.TB,p.rc,((e,t)=>e.type!==N.gT.DM_CHANNEL?null:I.uD(e.name,t))),Bp=(0,Jt.P1)(p.aH,Fp,((e,t)=>t?e[t]:null)),Gp=Bd,Vp=(0,n.connect)((e=>({user:(0,p.ts)(e),channel:(0,m.TB)(e),isDefault:(0,m.r4)(e),isFavorite:(0,m.CA)(e),isMuted:(0,m.D7)(e),isReadonly:(0,m.ui)(e),isArchived:(0,m.Vl)(e),penultimateViewedChannelName:(0,f.TS)(e)||(0,m.fG)(e,(0,u.ev)(e)),pluginMenuItems:e.plugins.components.ChannelHeader||[],isLicensedForLDAPGroups:"true"===e.entities.general.license.LDAPGroups})))(Hp),Kp=(0,n.connect)((e=>{const t=(0,p.ts)(e),s=(0,m.TB)(e),n=Fp(e);let a=!1,i="";if(n){const t=(0,p.PR)(e,n);a=t&&t.is_bot,i=I.hI(e,t)}return{user:t,channel:s,teammateId:n,teammateIsBot:a,teammateStatus:Bp(e),displayName:i}}))(Up);class Yp extends M.PureComponent{render(){return this.props.mentionCount?M.createElement("span",{className:"badge badge-notify"},this.props.mentionCount):this.props.messageCount?M.createElement("span",{className:"badge badge-notify"},"•"):null}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(Yp,"propTypes",{mentionCount:y().number.isRequired,messageCount:y().number.isRequired});const Wp=(0,n.connect)((function(e){const{mentionCount:t,messageCount:s}=(0,m.i8)(e);return{mentionCount:t,messageCount:s}}))(Yp);var zp=s(69113);const Jp=e=>M.createElement("button",{key:"navbar-toggle-sidebar",type:"button",className:"navbar-toggle","data-toggle":"collapse","data-target":"#sidebar-nav",onClick:e.actions.toggleLhs},M.createElement("span",{className:"sr-only"},M.createElement(V.Z,{id:"navbar.toggle2",defaultMessage:"Toggle sidebar"})),M.createElement(zp.Z,{className:"style--none icon icon__menu icon--sidebarHeaderTextColor"}),M.createElement(Wp,null));Jp.propTypes={actions:y().shape({toggleLhs:y().func.isRequired}).isRequired};const Xp=Jp,Qp=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({toggleLhs:Ho.ZN},e)})))(Xp),$p=e=>M.createElement("button",{key:"navbar-toggle-menu",type:"button",className:"navbar-toggle navbar-right__icon menu-toggle pull-right","data-toggle":"collapse","data-target":"#sidebar-nav",onClick:e.actions.toggleRhsMenu},M.createElement(zp.Z,null));$p.propTypes={actions:y().shape({toggleRhsMenu:y().func.isRequired}).isRequired};const eu=$p,tu=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({toggleRhsMenu:Ve.js},e)})))(eu);function su(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 22 22",role:"img","aria-label":t({id:"generic_icons.info",defaultMessage:"Info Icon"})},M.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},M.createElement("g",{transform:"translate(-388.000000, -18.000000)",fill:"inherit"},M.createElement("g",null,M.createElement("g",{transform:"translate(381.000000, 11.000000)"},M.createElement("g",{transform:"translate(7.000000, 7.000000)"},M.createElement("path",{d:"M11,22 C4.92486775,22 0,17.0751322 0,11 C0,4.92486775 4.92486775,0 11,0 C17.0751322,0 22,4.92486775 22,11 C22,17.0751322 17.0751322,22 11,22 Z M11,20.7924685 C16.408231,20.7924685 20.7924685,16.408231 20.7924685,11 C20.7924685,5.59176898 16.408231,1.20753149 11,1.20753149 C5.59176898,1.20753149 1.20753149,5.59176898 1.20753149,11 C1.20753149,16.408231 5.59176898,20.7924685 11,20.7924685 Z M10.1572266,16.0625 L10.1572266,8.69335938 L11.3466797,8.69335938 L11.3466797,16.0625 L10.1572266,16.0625 Z M10.7519531,7.50390625 C10.3417969,7.50390625 10,7.16210938 10,6.75195312 C10,6.33496094 10.3417969,6 10.7519531,6 C11.1689453,6 11.5039062,6.33496094 11.5039062,6.75195312 C11.5039062,7.16210938 11.1689453,7.50390625 10.7519531,7.50390625 Z"}))))))))}var nu=s(6429);function au(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const iu={mentionHighlight:!1};class ru extends M.PureComponent{constructor(...e){super(...e),au(this,"headerOverlayRef",M.createRef()),au(this,"showEditChannelHeaderModal",(()=>{this.hide();const{actions:e,channel:t}=this.props,s={modalId:N.r8.EDIT_CHANNEL_HEADER,dialogType:Lh,dialogProps:{channel:t}};e.openModal(s)})),au(this,"hide",(()=>{this.headerOverlayRef.current&&this.headerOverlayRef.current.hide()})),au(this,"handleFormattedTextClick",(e=>I.QJ(e,this.props.currentRelativeTeamUrl)))}componentDidUpdate(e){var t,s;const n=!e.isRHSOpen&&this.props.isRHSOpen,a=(null===(t=e.channel)||void 0===t?void 0:t.id)!==(null===(s=this.props.channel)||void 0===s?void 0:s.id);(n||a)&&this.hide()}render(){const{channel:e,isReadOnly:t}=this.props;let s=null;if(e.header)s=M.createElement(ft.Z,{message:e.header,options:iu});else{let e;if(!t){const t=M.createElement("a",{href:"#",onClick:this.showEditChannelHeaderModal},M.createElement(V.Z,{id:"navbar.click",defaultMessage:"Click here"}));e=M.createElement(M.Fragment,null,M.createElement("br",null),M.createElement(V.Z,{id:"navbar.clickToAddHeader",defaultMessage:"{clickHere} to add one.",values:{clickHere:t}}))}s=M.createElement("div",null,M.createElement(V.Z,{id:"navbar.noHeader",defaultMessage:"No channel header yet."}),e)}const n=M.createElement(nu.Z,{popoverStyle:"info",placement:"bottom",className:"navbar__popover",id:"header-popover"},M.createElement("span",{onClick:this.handleFormattedTextClick},s),M.createElement("div",{className:"close visible-xs-block",onClick:this.hide},"×"));return M.createElement(tt.Z,{ref:this.headerOverlayRef,trigger:"click",placement:"bottom",overlay:n,className:"description",rootClose:!0},M.createElement("button",{className:"navbar-toggle navbar-right__icon navbar-info-button pull-right","aria-label":I._u("accessibility.button.Info","Info")},M.createElement(su,{className:"icon icon__info","aria-hidden":"true"})))}}au(ru,"propTypes",{channel:y().object.isRequired,isReadOnly:y().bool.isRequired,isRHSOpen:y().bool,currentRelativeTeamUrl:y().string,actions:y().shape({openModal:y().func.isRequired}).isRequired});const ou=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h},e)}}))(ru);var lu=s(2192);function cu(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class du extends M.PureComponent{constructor(...e){super(...e),cu(this,"handleClick",(()=>{this.props.actions.openRHSSearch()}))}render(){return M.createElement("button",{type:"button",className:"navbar-toggle navbar-right__icon navbar-search pull-right",onClick:this.handleClick,"aria-label":(0,I._u)("accessibility.button.Search","Search")},M.createElement(lu.Z,{className:"icon icon__search","aria-hidden":"true"}))}}cu(du,"propTypes",{actions:y().shape({openRHSSearch:y().func.isRequired}).isRequired});const hu=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({openRHSSearch:Ve.Xv},e)})))(du);function pu(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class uu extends M.PureComponent{constructor(...e){super(...e),pu(this,"handleClick",(()=>{const{user:e,channel:t,actions:{updateChannelNotifyProps:s}}=this.props;s(e.id,t.id,{mark_unread:N.XH.ALL})}))}render(){return M.createElement("button",{type:"button",className:"navbar-toggle icon icon__mute",onClick:this.handleClick},M.createElement("span",{className:"fa fa-bell-slash-o icon"}))}}pu(uu,"propTypes",{user:y().shape({id:y().string.isRequired}).isRequired,channel:y().shape({id:y().string.isRequired}).isRequired,actions:y().shape({updateChannelNotifyProps:y().func.isRequired}).isRequired});const mu=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({updateChannelNotifyProps:o.n$},e)})))(uu);function gu(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class fu extends M.PureComponent{constructor(...e){super(...e),gu(this,"hideSidebars",(e=>{I.tq()&&(this.props.actions.closeRhs(),"navbar-toggle"!==e.target.className&&"icon-bar"!==e.target.className&&(this.props.actions.closeLhs(),this.props.actions.closeRhsMenu()))}))}componentDidMount(){document.querySelector(".inner-wrap").addEventListener("click",this.hideSidebars)}componentWillUnmount(){document.querySelector(".inner-wrap").removeEventListener("click",this.hideSidebars)}render(){const{user:e,channel:t,isMuted:s,isReadOnly:n,isRHSOpen:a,currentRelativeTeamUrl:i,inGlobalThreads:r}=this.props;let o;return r?o=M.createElement(V.Z,{id:"globalThreads.heading",defaultMessage:"Followed threads"}):t&&(o=M.createElement(M.Fragment,null,M.createElement(Kp,null),s&&M.createElement(mu,{user:e,channel:t}))),M.createElement("nav",{id:"navbar",className:"navbar navbar-default navbar-fixed-top",role:"navigation"},M.createElement("div",{className:"container-fluid theme"},M.createElement("div",{className:"navbar-header"},M.createElement(Qp,null),M.createElement("div",{className:W()("navbar-brand",{GlobalThreads___title:r})},o),M.createElement("div",{className:"spacer"}),t&&M.createElement(ou,{channel:t,isReadOnly:n,isRHSOpen:a,currentRelativeTeamUrl:i}),M.createElement(hu,null),t&&M.createElement(Qd,{channel:t,isDropdown:!1}),M.createElement(tu,null))))}}gu(fu,"propTypes",{user:y().object.isRequired,channel:y().object,isReadOnly:y().bool,isMuted:y().bool,isRHSOpen:y().bool,currentRelativeTeamUrl:y().string,inGlobalThreads:y().bool,actions:y().shape({closeLhs:y().func.isRequired,closeRhs:y().func.isRequired,closeRhsMenu:y().func.isRequired}).isRequired});const Eu=(0,Jt.P1)(m.HU,(e=>(0,$i.Mm)(e))),Cu=(0,i.EN)((0,n.connect)(((e,{location:{pathname:t}})=>({user:(0,p.ts)(e),channel:(0,m.TB)(e),isMuted:Eu(e),isReadOnly:(0,m.ui)(e),isRHSOpen:(0,Ke.aC)(e),currentRelativeTeamUrl:(0,u.gm)(e),inGlobalThreads:Boolean((0,i.LX)(t,{path:"/:team/threads/:threadIdentifier?"}))})),(e=>({actions:(0,a.bindActionCreators)({closeLhs:Ho.xv,closeRhs:Ve.Lg,closeRhsMenu:Ve.Wj},e)})))(fu)),bu=new RegExp("^[a-zA-Z0-9]{".concat(26,"}__[a-zA-Z0-9]{").concat(26,"}$"));function _u({match:e,history:t}){return async(s,n)=>{const a=n(),{path:i,identifier:l,team:c}=e.params;if(!l)return{data:void 0};const d=(0,u.Xv)(a,c);if(!d)return{data:void 0};switch(function(e,t,s){if("group"===t){const t=(0,m.ZO)(e,s),n=(0,m.Gc)(e).find((e=>e.name===s));return 26===s.length?t||n?"channel_name":"channel_id":!t&&!n&&40===s.length||t&&t.type===N.gT.GM_CHANNEL||n&&n.type===N.gT.GM_CHANNEL?"group_channel_group_id":function(e){return 54===e.length&&bu.test(e)}(s)?"direct_channel_user_ids":"channel_name"}return"messages"===t?0===s.indexOf("@")?"direct_channel_username":s.indexOf("@")>0?"direct_channel_email":26===s.length?"direct_channel_user_id":40===s.length?"group_channel_group_id":"error":"error"}(a,i,l)){case"channel_name":await s(function(e,t){return async(s,n)=>{const a=n(),{team:i,identifier:r}=e.params,l=r.toLowerCase(),c=(0,u.Xv)(a,i);if(!c)return{data:void 0};let d,h=(0,m.iC)(a,c.id)[l];if(!h){const e=await s((0,o.Ft)(i,l,!0));"data"in e&&(h=e.data)}if(h&&(d=a.entities.channels.myMembers[h.id],!d)){const e=await s((0,o.hg)(h.id,(0,p.rc)(a)));"data"in e&&(d=e.data)}if(!h||!d){const r=(0,p.ts)(n());if(I.$O(null==r?void 0:r.roles)&&h.type===N.gT.PRIVATE_CHANNEL){const e=await s((0,hl.Jf)(c,h));if("data"in e&&!e.data.join)return{data:void 0}}const d=await s((0,o.JJ)((0,p.rc)(a),c.id,"",l));if("error"in d){if(!h){const n=await s((0,o.Ft)(i,l,!0));if("error"in n||0===n.data.delete_at)return await s((0,o.oO)(c.id,0,20)),wu(e,t,(0,m.fG)(a,c.id)),{data:void 0};h=n.data}}else h=d.data.channel}return h.type===N.gT.DM_CHANNEL?s(yu(e,t)):h.type===N.gT.GM_CHANNEL?t.replace("/".concat(i,"/messages/").concat(h.name)):Mu(h),{data:void 0}}}(e,t));break;case"channel_id":await s(function(e,t){return async(s,n)=>{const a=n(),{team:i,identifier:r}=e.params,l=r.toLowerCase();let c=(0,m.mr)(a,l);const d=a.entities.channels.myMembers[l],h=(0,u.Xv)(a,i);if(!c||!d){const n=await s((0,o.JJ)((0,p.rc)(a),h.id,l,""));if("error"in n)return await s((0,o.oO)(h.id,0,20)),wu(e,t,(0,m.fG)(a,h.id)),{data:void 0};c=n.data.channel}return c.type===N.gT.DM_CHANNEL?s(vu(e,t,I.uD(c.name,(0,p.rc)(a)))):c.type===N.gT.GM_CHANNEL?t.replace("/".concat(i,"/messages/").concat(c.name)):t.replace("/".concat(i,"/group/").concat(c.name)),{data:void 0}}}(e,t));break;case"group_channel_group_id":await s(function(e,t){return async(s,n)=>{const a=n(),{identifier:i,team:r}=e.params,l=i.toLowerCase();t.replace(e.url.replace("/group/","/messages/"));let c=(0,m.ZO)(a,l);const d=(0,u.Xv)(a,r);if(!c){const n=await s((0,o.JJ)((0,p.rc)(a),d.id,"",l));if("error"in n)return await s((0,o.oO)(d.id,0,20)),Pu(e,t,(0,m.fG)(a,d.id)),{data:void 0};c=n.data.channel}return s((0,o.xO)(c.id)),Mu(c),{data:void 0}}}(e,t));break;case"direct_channel_username":await s(function(e,t){return async(s,n)=>{const a=n(),{team:i,identifier:l}=e.params,c=l.slice(1,l.length).toLowerCase(),d=(0,u.Xv)(a,i);let h=(0,p.dQ)(a,c);if(!h){const n=await s((0,r.dQ)(c));if("error"in n)return await s((0,o.oO)(d.id,0,20)),Pu(e,t,(0,m.fG)(a,d.id)),{data:void 0};h=n.data}const g=await s((0,Ii.Pn)(h.id));return"error"in g?(await s((0,o.oO)(d.id,0,20)),Pu(e,t,(0,m.fG)(a,d.id)),{data:void 0}):(Mu(g.data),{data:void 0})}}(e,t));break;case"direct_channel_email":await s(function(e,t){return async(s,n)=>{const a=n(),{team:i,identifier:l}=e.params,c=l.toLowerCase(),d=(0,u.Xv)(a,i);let h=(0,p.CX)(a,c);if(!h){const n=await s((0,r.CX)(c));if("error"in n)return await s((0,o.oO)(d.id,0,20)),Pu(e,t,(0,m.fG)(a,d.id)),{data:void 0};h=n.data}return t.replace("/".concat(i,"/messages/@").concat(h.username)),{data:void 0}}}(e,t));break;case"direct_channel_user_ids":await s(yu(e,t));break;case"direct_channel_user_id":await s(vu(e,t,l));break;case"error":await s((0,o.oO)(d.id,0,20)),Pu(e,t,(0,m.fG)(a,d.id))}return{data:void 0}}}function vu(e,t,s){return async(n,a)=>{const i=a(),{team:l}=e.params,c=(0,u.Xv)(i,l);let d=(0,p.PR)(i,s);if(!d){const a=await n((0,r.PR)(s));if("error"in a)return await n((0,o.oO)(c.id,0,20)),Pu(e,t,(0,m.fG)(i,c.id)),{data:void 0};d=a.data}return t.replace("/".concat(l,"/messages/@").concat(d.username)),{data:void 0}}}function yu(e,t){return async(s,n)=>{const a=n(),{team:i,identifier:l}=e.params,c=I.uD(l.toLowerCase(),(0,p.rc)(n())),d=(0,u.Xv)(a,i);let h=(0,p.PR)(a,c);if(!h){const n=await s((0,r.PR)(c));if("error"in n)return await s((0,o.oO)(d.id,0,20)),Pu(e,t,(0,m.fG)(a,d.id)),{data:void 0};h=n.data}return t.replace("/".concat(i,"/messages/@").concat(h.username)),{data:void 0}}}function Mu(e){T.Gx(e)}function Pu(e,t,s){const{team:n}=e.params;t.push(n?"/".concat(n,"/group/").concat(s):"/")}async function wu(e,t,s){const{team:n}=e.params;t.push(n?"/error?type=channel_not_found&returnTo=/".concat(n,"/group/").concat(s):"/")}var Su=s(62047),Tu=s(18572),Nu=s(8679),Ru=s.n(Nu),Iu=s(39730),Ou=s(33693);function Lu(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("button",Object.assign({},e,{"aria-label":t({id:"members_popover.button.message",defaultMessage:"message"}),className:"style--none icon icon__message",tabIndex:-1}),M.createElement("svg",{width:"18px",height:"16px",viewBox:"0 0 18 16",role:"img","aria-label":t({id:"generic_icons.message",defaultMessage:"Message Icon"})},M.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},M.createElement("g",{transform:"translate(-200.000000, -174.000000)",fill:"inherit"},M.createElement("g",{transform:"translate(200.000000, 174.000000)"},M.createElement("path",{d:"M7.2546625,1.42801356 C10.458475,1.42801356 12.999475,3.24528136 12.999475,5.52023729 C12.9895,8.04188475 10.6062625,9.89326102 7.40245,9.89326102 C7.40245,9.89326102 6.9134125,9.91229831 6.4115125,9.83747119 L5.82535,9.79622373 L5.15335,10.3586169 C4.997425,10.5397356 4.3199125,11.1095322 3.736375,11.4794373 C4.0915375,10.4598847 4.07605,10.1370441 4.07605,10.1370441 L4.1251375,9.49004068 L3.55315,9.19549153 C2.0986375,8.44616271 1.4444875,6.88616271 1.4444875,5.52023729 C1.4444875,3.24528136 4.05085,1.42801356 7.2546625,1.42801356 M7.2546625,0.370386441 C3.465475,0.370386441 0.3944875,2.65829831 0.3944875,5.52023729 C0.3944875,7.3028678 1.2623125,9.20342373 3.0751375,10.1370441 C3.0751375,10.1478847 3.07225,10.1560814 3.07225,10.1679797 C3.07225,10.9426915 2.43175,12.0048136 2.1794875,12.4429356 L2.1805375,12.4429356 C2.1605875,12.4902644 2.148775,12.5420881 2.148775,12.5973492 C2.148775,12.8141627 2.322025,12.9881424 2.5375375,12.9881424 C2.5693,12.9881424 2.6210125,12.9815322 2.6393875,12.9815322 C2.6446375,12.9815322 2.6467375,12.9815322 2.6462125,12.9831186 C3.986275,12.762339 5.9642125,11.2435864 6.2576875,10.8837288 C6.5585125,10.928678 6.761425,10.9358169 7.0136875,10.9358169 C7.120525,10.9358169 7.2347125,10.9342305 7.3696375,10.9342305 C11.1583,10.9342305 14.094625,8.75446102 14.049475,5.52023729 C14.049475,2.65829831 11.0435875,0.370386441 7.2546625,0.370386441"}),M.createElement("path",{d:"M17.2055125,9.79172881 C17.2055125,8.35811525 16.6498,7.26532203 15.2624875,6.4451322 C15.228625,6.82614237 15.120475,7.23517966 15.0031375,7.59477288 C15.8998375,8.21903729 16.1555125,8.85995932 16.1555125,9.79172881 C16.1555125,10.9323797 15.62815,11.7597085 14.40175,12.3919051 L13.879375,12.653139 C13.879375,12.653139 13.9337125,14.0082237 14.0140375,14.3511593 C12.9895,13.5946915 12.6374875,12.9630237 12.6374875,12.9630237 L12.08545,13.0486915 C11.86705,13.0809492 11.276425,13.0812136 11.276425,13.0812136 C9.85,13.0812136 8.7929125,12.7388068 7.8909625,12.0278169 C8.135875,12.0124814 6.42805,12.0132746 6.3899875,12.0468542 C7.4326375,13.3297559 9.1373125,14.1388407 11.276425,14.1388407 C11.3927125,14.1388407 11.49115,14.1398983 11.58355,14.1398983 C11.801425,14.1398983 11.9773,14.1338169 12.237175,14.095478 C12.491275,14.4058915 13.914025,15.7728746 15.0724375,15.9629831 C15.0719125,15.9619254 15.073225,15.9619254 15.078475,15.9619254 C15.0939625,15.9619254 15.13885,15.967478 15.16615,15.967478 C15.3522625,15.967478 15.5024125,15.8167661 15.5024125,15.6293017 C15.5024125,15.5817085 15.49165,15.5367593 15.47485,15.4960407 L15.4759,15.4960407 C15.258025,15.117939 14.9159875,14.0129831 14.9159875,13.3435051 C14.9159875,13.3331932 14.9128375,13.3260542 14.9128375,13.3168 C16.4797,12.5095661 17.2055125,11.3321627 17.2055125,9.79172881"}))))))}s(57915);var Au=s(58423);function ku(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class xu extends M.PureComponent{constructor(...e){super(...e),ku(this,"handleClick",(()=>{this.props.onItemClick(this.props.user)}))}render(){if(!this.props.user)return null;if(!this.props.displayName)return null;let e,t;this.props.showMessageIcon&&(e=M.createElement(Lu,{"aria-hidden":"true"})),this.props.user.remote_id&&(t=M.createElement(Au.Z,{className:"shared-user-icon",withTooltip:!0}));const s=this.props.user.is_bot?" more-modal__row--bot":"",n=this.props.user.is_bot?null:this.props.status;return M.createElement("div",{"data-testid":"popoverListMembersItem",tabIndex:"0","aria-label":this.props.displayName.toLowerCase(),className:"more-modal__row"+s,onClick:this.handleClick},M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(this.props.user.id,this.props.user.last_picture_update),status:n,size:"md"}),M.createElement("div",{className:"more-modal__details d-flex whitespace--nowrap"},M.createElement("div",{className:"more-modal__name"},M.createElement("span",null,this.props.displayName),M.createElement(Cn.Z,{show:Boolean(this.props.user.is_bot),className:"badge-popoverlist"}),M.createElement(En.Z,{show:I.a_(this.props.user),className:"badge-popoverlist"})),M.createElement(cr.Z,{userID:this.props.user.id,showTooltip:!0,emojiSize:15,emojiStyle:{marginBottom:-3,marginLeft:4}}),t),M.createElement("div",{className:"more-modal__actions"},e))}}ku(xu,"propTypes",{showMessageIcon:y().bool.isRequired,onItemClick:y().func.isRequired,status:y().string.isRequired,user:y().object.isRequired,displayName:y().string.isRequired}),ku(xu,"defaultProps",{status:N.gg.OFFLINE});const Du=(0,n.connect)((function(e,t){return{displayName:(0,I.hI)(e,t.user)}}))(xu);function Zu(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Hu extends M.PureComponent{constructor(e){super(e),Zu(this,"handleShowDirectChannel",(e=>{const{actions:t}=this.props,s=e.id;s&&t.openDirectChannelToUserId(s).then((({data:e})=>{e&&st.m.push(this.props.teamUrl+"/group/"+e.name),this.closePopover()}))})),Zu(this,"closePopover",(()=>{this.setState({showPopover:!1})})),Zu(this,"showMembersModal",(e=>{e.preventDefault(),this.closePopover();const t={modalId:N.r8.CHANNEL_MEMBERS,dialogProps:this.props,dialogType:yh};this.props.actions.openModal(t)})),Zu(this,"handleGetProfilesInChannel",(e=>e.preventDefault())),Zu(this,"getTargetPopover",(()=>(this.membersList.current.focus(),this.refs.member_popover_target))),this.membersList=M.createRef(),this.state={showPopover:!1,users:e.users,statuses:e.statuses}}static getDerivedStateFromProps(e,t){return e.users!==t.users||e.statuses!==t.statuses?{users:e.users,statuses:e.statuses}:null}render(){const e=this.props.channel.type===N.gT.DM_CHANNEL,t=this.props.sortedUsers.map((t=>M.createElement(Du,{key:t.id,onItemClick:this.handleShowDirectChannel,showMessageIcon:this.props.currentUserId!==t.id&&!e,status:this.props.statuses[t.id],user:t}))),s=0!==this.props.channel.delete_at;let n;if(this.props.channel.type!==N.gT.GM_CHANNEL&&!s){let e=M.createElement(V.Z,{id:"members_popover.manageMembers",defaultMessage:"Manage Members"});!(this.props.channel.name===N.gT.DEFAULT_CHANNEL)&&this.props.manageMembers||(e=M.createElement(V.Z,{id:"members_popover.viewMembers",defaultMessage:"View Members"})),n=M.createElement("div",{className:"more-modal__button",key:"popover-member-more"},M.createElement("button",{className:"btn btn-link","data-testid":"membersModal",onClick:this.showMembersModal},e))}const a=this.props.memberCount;let i="-";a>0&&(i=a.toString());const r=M.createElement(V.Z,{id:"members_popover.title",defaultMessage:"Channel Members"}),o=M.createElement(et.Z,{id:"channelMembersTooltip"},M.createElement(V.Z,{id:"channel_header.channelMembers",defaultMessage:"Members"})),l="".concat(I._u("channel_header.channelMembers","Members")).toLowerCase();return M.createElement("div",{id:"channelMember"},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"bottom",disabled:this.state.showPopover,overlay:o},M.createElement("button",{id:"member_popover","aria-label":l,className:"member-popover__trigger channel-header__icon channel-header__icon--left channel-header__icon--wide "+(this.state.showPopover?"channel-header__icon--active":""),ref:"member_popover_target",onClick:this.handleGetProfilesInChannel},M.createElement("div",{className:"d-flex align-items-center"},M.createElement("i",{"aria-hidden":"true",className:"icon icon-account-outline channel-header__members"}),M.createElement("span",{id:"channelMemberCountText",className:"icon__text"},i)))),M.createElement(Zt.Z,{rootClose:!0,onHide:this.closePopover,show:this.state.showPopover,target:this.getTargetPopover,placement:"bottom"},M.createElement(nu.Z,{id:"member-list-popover",className:"a11y__popup member-list__popover"},M.createElement("div",{className:"more-modal__header"},r,this.props.channel.group_constrained&&M.createElement("div",{className:"subhead"},M.createElement(V.Z,{id:"channel_header.groupConstrained",defaultMessage:"Members managed by linked groups."}))),M.createElement("div",{className:"more-modal__body"},M.createElement("div",{tabIndex:"-1",role:"presentation",ref:this.membersList,className:"more-modal__list"},t)),n)))}}Zu(Hu,"propTypes",{channel:y().object.isRequired,statuses:y().object.isRequired,users:y().array.isRequired,memberCount:y().number,currentUserId:y().string.isRequired,teamUrl:y().string,manageMembers:y().bool.isRequired,actions:y().shape({openModal:y().func.isRequired,loadProfilesAndStatusesInChannel:y().func.isRequired,openDirectChannelToUserId:y().func.isRequired}).isRequired,sortedUsers:y().array});const qu=(0,n.connect)((function(){const e=(0,p.T5)(),t=(e=>(0,Jt.P1)(((t,s)=>e(t,s,!0)),p.aH,d.kl,((e,t,s)=>(0,I.Sv)(e,t,s))))(e);return function(s,n){const a=(0,m.e7)(s)[n.channel.id]||{},i=e(s,n.channel.id,!0),r=(0,p.aH)(s);return{currentUserId:(0,p.rc)(s),memberCount:a.member_count,users:i,statuses:r,teamUrl:(0,u.gm)(s),manageMembers:(0,hl.sz)(s,n.channel),sortedUsers:t(s,n.channel.id)}}}),(function(e){return{actions:(0,a.bindActionCreators)({openModal:H.h,loadProfilesAndStatusesInChannel:Le.gz,openDirectChannelToUserId:Ii.Pn},e)}}))(Hu);var ju=s(50512),Uu=s(50499),Fu=s(56936),Bu=s(57006);function Gu(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 18 18",version:"1.1",role:"img","aria-label":t({id:"generic_icons.plugins",defaultMessage:"Plugins"})},M.createElement("path",{d:"M14.58 9.14399L17.136 6.60599C17.304 6.42599 17.388 6.20999 17.388 5.95799C17.388 5.70599 17.298 5.49599 17.118 5.32799C16.95 5.14799 16.74 5.05799 16.488 5.05799C16.236 5.05799 16.026 5.14799 15.858 5.32799L13.302 7.86599L10.134 4.69799L12.672 2.14199C12.852 1.97399 12.942 1.76399 12.942 1.51199C12.942 1.25999 12.852 1.04999 12.672 0.881987C12.504 0.701987 12.294 0.611987 12.042 0.611987C11.79 0.611987 11.574 0.695987 11.394 0.863987L8.856 3.41999L6.318 0.863987C6.138 0.695987 5.922 0.611987 5.67 0.611987C5.418 0.611987 5.208 0.695987 5.04 0.863987V0.881987C4.86 1.04999 4.77 1.25999 4.77 1.51199C4.77 1.76399 4.86 1.97399 5.04 2.14199L5.67 2.78999L2.808 5.65199C2.016 6.44399 1.458 7.36799 1.134 8.42399C0.81 9.45599 0.744 10.512 0.936 11.592C1.128 12.66 1.56 13.632 2.232 14.508L0.27 16.47C0.09 16.638 0 16.848 0 17.1C0 17.352 0.09 17.562 0.27 17.73C0.45 17.898 0.66 17.982 0.9 17.982C1.152 17.994 1.362 17.91 1.53 17.73L3.492 15.768C4.368 16.44 5.34 16.872 6.408 17.064C7.488 17.256 8.544 17.19 9.576 16.866C10.632 16.542 11.556 15.984 12.348 15.192L15.21 12.33L15.858 12.96C16.026 13.14 16.236 13.23 16.488 13.23C16.74 13.23 16.95 13.14 17.118 12.96H17.136C17.304 12.792 17.388 12.582 17.388 12.33C17.388 12.078 17.304 11.862 17.136 11.682L14.58 9.14399ZM11.088 13.914C10.452 14.55 9.702 14.976 8.838 15.192C8.01 15.408 7.176 15.408 6.336 15.192C5.472 14.976 4.722 14.55 4.086 13.914C3.45 13.278 3.024 12.528 2.808 11.664C2.592 10.824 2.592 9.98999 2.808 9.16199C3.024 8.29799 3.45 7.54799 4.086 6.91199L6.948 4.04999L13.95 11.052L11.088 13.914Z"})))}function Vu(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Ku extends M.PureComponent{constructor(...e){super(...e),Vu(this,"handleRootClose",(()=>{this.props.onClose()}))}render(){const{open:e,rootCloseEvent:t,children:s}=this.props;return M.createElement(Fu.zx,{disabled:!e,onRootClose:this.handleRootClose,event:t},M.createElement("ul",{role:"menu",className:"dropdown-menu channel-header_plugin-dropdown"},s))}}Vu(Ku,"propTypes",{open:y().bool,children:y().node,onClose:y().func.isRequired,rootCloseEvent:y().oneOf(["click","mousedown"]),bsRole:y().string.isRequired});class Yu extends M.PureComponent{constructor(...e){super(...e),Vu(this,"handleClick",(e=>{this.props.onClick&&this.props.onClick(e)}))}render(){const{children:e}=this.props;let t="";return this.props.dropdownOpen&&(t=" channel-header__icon--active"),M.createElement("button",{id:"pluginChannelHeaderButtonDropdown",className:"channel-header__icon channel-header__icon--wide "+t,type:"button",onClick:this.handleClick},e)}}Vu(Yu,"propTypes",{children:y().node,dropdownOpen:y().bool,onClick:y().func,bsRole:y().string.isRequired});class Wu extends M.PureComponent{constructor(e){super(e),Vu(this,"toggleDropdown",(e=>{this.setState({dropdownOpen:e})})),Vu(this,"onClose",(()=>{this.toggleDropdown(!1)})),Vu(this,"fireActionAndClose",(e=>{e(this.props.channel,this.props.channelMember),this.onClose()})),Vu(this,"createComponentButton",(e=>M.createElement(Bu.Z,{key:"channelHeaderButton"+e.id,buttonClass:"channel-header__icon",iconComponent:e.icon,onClick:()=>e.action(this.props.channel,this.props.channelMember),buttonId:e.id,tooltipKey:"plugin",tooltipText:e.tooltipText?e.tooltipText:e.dropdownText}))),Vu(this,"onBindingClick",(async e=>{const{channel:t,intl:s}=this.props;if(!e.call)return;const n=(0,Yd.qM)(e.app_id,e.location,this.props.channel.id,this.props.channel.team_id),a=(0,Yd.Zw)(e.call,n),i=await this.props.actions.doAppCall(a,Vd._L.SUBMIT,s);if(i.error){const e=i.error,n=e.error||s.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForChannel(e,n,t.id)}const r=i.data;switch(r.type){case Vd.Bp.OK:r.markdown&&this.props.actions.postEphemeralCallResponseForChannel(r,r.markdown,t.id);break;case Vd.Bp.NAVIGATE:case Vd.Bp.FORM:break;default:{const e=this.props.intl.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:r.type});this.props.actions.postEphemeralCallResponseForChannel(r,e,t.id)}}})),Vu(this,"createAppBindingButton",(e=>M.createElement(Bu.Z,{key:"channelHeaderButton_".concat(e.app_id,"_").concat(e.location),buttonClass:"channel-header__icon style--none",iconComponent:M.createElement("img",{src:e.icon,width:"24",height:"24",loading:"lazy"}),onClick:()=>this.onBindingClick(e),buttonId:e.location||"",tooltipKey:"plugin",tooltipText:e.label}))),Vu(this,"createDropdown",((e,t)=>{const s=e.filter((e=>e.action)).map((e=>M.createElement("li",{key:"channelHeaderPlug"+e.id},M.createElement("a",{href:"#",className:"d-flex align-items-center",onClick:()=>this.fireActionAndClose(e.action)},M.createElement("span",{className:"d-flex align-items-center overflow--ellipsis"},e.icon),M.createElement("span",null,e.dropdownText)))));let n=s;return this.props.appsEnabled&&(n=s.concat(t.filter((e=>e.call)).map((e=>M.createElement("li",{key:"channelHeaderPlug"+e.app_id+e.location},M.createElement("a",{href:"#",className:"d-flex align-items-center",onClick:()=>this.fireActionAndClose((()=>this.onBindingClick(e)))},M.createElement("span",{className:"d-flex align-items-center overflow--ellipsis icon"},M.createElement("img",{src:e.icon})),M.createElement("span",null,e.label))))))),M.createElement("div",{className:"flex-child"},M.createElement(Uu.Z,{id:"channelHeaderPlugDropdown",onToggle:this.toggleDropdown,open:this.state.dropdownOpen},M.createElement(Yu,{bsRole:"toggle",dropdownOpen:this.state.dropdownOpen},M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"bottom",overlay:this.state.dropdownOpen?M.createElement(M.Fragment,null):M.createElement(et.Z,{id:"removeIcon"},M.createElement("div",{"aria-hidden":!0},M.createElement(V.Z,{id:"generic_icons.plugins",defaultMessage:"Plugins"})))},M.createElement(M.Fragment,null,M.createElement(Gu,{id:"pluginChannelHeaderIcon",className:"icon icon--standard icon__pluginChannelHeader","aria-hidden":"true"}),M.createElement("span",{id:"pluginCount",className:"icon__text"},n.length)))),M.createElement(Ku,{bsRole:"menu",open:this.state.dropdownOpen,onClose:this.onClose},n)))})),this.state={dropdownOpen:!1}}render(){const e=this.props.components||[],t=this.props.appsEnabled&&this.props.appBindings||[];if(0===e.length&&0===t.length)return null;if(e.length+t.length<=15){let s=e.filter((e=>e.icon&&e.action)).map(this.createComponentButton);return this.props.appsEnabled&&(s=s.concat(t.map(this.createAppBindingButton))),s}return this.createDropdown(e,t)}}Vu(Wu,"propTypes",{components:y().array,appBindings:y().array,appsEnabled:y().bool.isRequired,actions:y().shape({}).isRequired}),Vu(Wu,"defaultProps",{components:[],appBindings:[]});const zu=(0,K.ZP)(Wu),Ju=(0,Gd.W)(Vd.NR.CHANNEL_HEADER_ICON),Xu=(0,n.connect)((function(e){const t=(0,Gd.D)(e);return{components:e.plugins.components.ChannelHeaderButton,appBindings:Ju(e),appsEnabled:t,theme:(0,d.gh)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({doAppCall:Kd.cW,postEphemeralCallResponseForChannel:Kd.H7},e)}}))(zu);var Qu=s(80562),$u=s(35856),em=s(42897),tm=s(1823);class sm extends M.PureComponent{render(){const e=this.props,{classIcon:t}=e,s=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["classIcon"]);return M.createElement("span",s,M.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:t,viewBox:"0 0 20 20",fill:"currentColor"},M.createElement("path",{fillRule:"evenodd",d:"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z",clipRule:"evenodd"})))}}const nm=e=>{(0,M.useEffect)((()=>{(!e.pinnedPost||e.pinnedPost&&!e.pinnedPost.id)&&e.actions.fetchPinnedPosts(e.currentChannel.id)}));const t=t=>{t.preventDefault(),e.actions.selectPost(e.pinnedPost)};if(e.pinnedPost){const s=e.pinnedPost;let n=M.createElement(Lu,{className:"icon-type",onClick:t});s.file_ids&&s.file_ids.length>0&&(n=M.createElement(tm.Z,{className:"icon-type"}));const a=()=>{const t=e.pinnedPost;return M.createElement(em.Z,{isPermalink:!1,eventTime:t.create_at,postId:t.id||""})},i=s.message?M.createElement(Qu.Z,{post:s,actions:{toggleEmbedVisibility:()=>{}},appsEnabled:!1},M.createElement($u.Z,{post:s,isRHS:!0})):M.createElement("span",{className:"file-attachment-no-message"},M.createElement(V.Z,{id:"pinned.no_messages",defaultMessage:"Đính kèm tập tin"}));return M.createElement("div",{role:"pinned-application",className:"pinned-item post__content"},M.createElement("div",{className:"post-type"},n,M.createElement("a",{href:"#",onClick:t,className:"post-item__jump"},M.createElement(sm,{className:"jump-icon"}))),M.createElement("div",{className:"post-content"},M.createElement("div",{className:"post__header"},M.createElement("div",{className:"col__name"},M.createElement(Et.Z,{userId:e.pinnedPost.user_id||"",overwriteName:!1,disablePopover:!0,isRHS:!0})),M.createElement("div",{className:"col__time"},a())),M.createElement("div",{className:"post__body"},i)))}return M.createElement(M.Fragment,null)},am=M.memo(nm),im=(0,n.connect)((function(e){return{currentChannel:(0,m.TB)(e),currentTeamName:(0,u.kA)(e).name,pinnedPost:(0,Qe.Ye)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({fetchPinnedPosts:eo.Hp,selectPost:Ve.F8},e)}}))(am);function rm(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function om(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?rm(Object(s),!0).forEach((function(t){lm(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):rm(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function lm(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const cm={singleline:!0,mentionHighlight:!1,atMentions:!0},dm={singleline:!1,mentionHighlight:!1,atMentions:!0};class hm extends M.PureComponent{constructor(e){super(e),lm(this,"handleClose",(()=>{this.props.actions.goToLastViewedChannel()})),lm(this,"toggleFavorite",(e=>{e.stopPropagation(),this.props.isFavorite?this.props.actions.unfavoriteChannel(this.props.channel.id):this.props.actions.favoriteChannel(this.props.channel.id)})),lm(this,"unmute",(()=>{const{actions:e,channel:t,channelMember:s,currentUser:n}=this.props;if(!s||!n||!t)return;const a={mark_unread:N.XH.ALL};e.updateChannelNotifyProps(n.id,t.id,a)})),lm(this,"mute",(()=>{const{actions:e,channel:t,channelMember:s,currentUser:n}=this.props;if(!s||!n||!t)return;const a={mark_unread:N.XH.MENTION};e.updateChannelNotifyProps(n.id,t.id,a)})),lm(this,"showPinnedPosts",(e=>{e.preventDefault(),this.props.rhsState===N.Hp.PIN?this.props.actions.closeRightHandSide():this.props.actions.showPinnedPosts()})),lm(this,"showChannelFiles",(()=>{this.props.rhsState===N.Hp.CHANNEL_FILES?this.props.actions.closeRightHandSide():this.props.actions.showChannelFiles(this.props.channel.id)})),lm(this,"removeTooltipLink",(()=>{this.toggleFavoriteRef.current.removeAttribute("aria-describedby")})),lm(this,"setTitleMenuOpen",(e=>{this.setState({titleMenuOpen:e})})),lm(this,"showEditChannelHeaderModal",(()=>{this.headerOverlayRef.current&&this.headerOverlayRef.current.hide();const{actions:e,channel:t}=this.props,s={modalId:N.r8.EDIT_CHANNEL_HEADER,dialogType:Lh,dialogProps:{channel:t}};e.openModal(s)})),lm(this,"showChannelHeaderPopover",(e=>{const t=this.headerDescriptionRef.current.getBoundingClientRect();(this.headerPopoverTextMeasurerRef.current.getBoundingClientRect().width>t.width||e.match(/\n{2,}/g))&&this.setState({showChannelHeaderPopover:!0,leftOffset:this.headerDescriptionRef.current.offsetLeft}),this.setState({topOffset:40*this.props.announcementBarCount})})),lm(this,"setPopoverOverlayWidth",(()=>{const e=this.headerDescriptionRef.current.getBoundingClientRect();this.setState({popoverOverlayWidth:e.width+10})})),lm(this,"handleFormattedTextClick",(e=>I.QJ(e,this.props.currentRelativeTeamUrl))),lm(this,"renderCustomStatus",(()=>{const{customStatus:e}=this.props,t=e&&(e.text||e.emoji);return this.props.isCustomStatusEnabled&&t?M.createElement(M.Fragment,null,M.createElement(cr.Z,{userID:this.props.dmUser.id,emojiStyle:{verticalAlign:"top",margin:"0 4px 1px"}}),M.createElement(pd.Z,{text:e.text})):null})),this.toggleFavoriteRef=M.createRef(),this.headerDescriptionRef=M.createRef(),this.headerPopoverTextMeasurerRef=M.createRef(),this.headerOverlayRef=M.createRef(),this.state={popoverOverlayWidth:0,showChannelHeaderPopover:!1,leftOffset:0,topOffset:0,titleMenuOpen:!1},this.getHeaderMarkdownOptions=(0,dn.GA)((e=>om(om({},cm),{},{channelNamesMap:e}))),this.getPopoverMarkdownOptions=(0,dn.GA)((e=>om(om({},dm),{},{channelNamesMap:e})))}componentDidMount(){this.props.actions.getCustomEmojisInText(this.props.channel?this.props.channel.header:"")}componentDidUpdate(e){const t=this.props.channel?this.props.channel.header:"";t!==(e.channel?e.channel.header:"")&&this.props.actions.getCustomEmojisInText(t)}render(){const{currentUser:e,gmMembers:t,channel:s,channelMember:n,isMuted:a,isFavorite:i,dmUser:r,rhsState:o,hasGuests:l,teammateNameDisplaySetting:c,contactName:d}=this.props,{formatMessage:h}=this.props.intl,p=I._u("accessibility.sections.channelHeader","channel header region");let u="";l&&(u=M.createElement("span",{className:"has-guest-header"},M.createElement(V.Z,{id:"channel_header.channelHasGuests",defaultMessage:"This channel has guests"})));const m=0!==s.delete_at;if(I.Qr(s)||I.Qr(n)||I.Qr(e)||!r&&s.type===N.gT.DM_CHANNEL)return M.createElement("div",{className:"channel-header"});const g=s.props&&s.props.channel_mentions;let f=s.display_name,E=null;m&&(E=M.createElement(Vr.Z,{className:"icon icon__archive icon channel-header-archived-icon svg-text-color"}));let C=null;s.shared&&(C=M.createElement(Kr.Z,{className:"shared-channel-icon",channelType:s.type,withTooltip:!0}));const b=s.type===N.gT.DM_CHANNEL,_=s.type===N.gT.GM_CHANNEL;if(b){const t=r.id;f=e.id===t?M.createElement(V.Z,{id:"channel_header.directchannel.you",defaultMessage:"{displayname} (you) ",values:{displayname:d||(0,er.fw)(r,c)}}):d||(0,er.fw)(r,c)+" ",f=M.createElement(M.Fragment,null,f,M.createElement(En.Z,{show:I.a_(r)}))}if(_){const n={};for(const s of t){if(s.id===e.id)continue;const t=(0,er.fw)(s,this.props.teammateNameDisplaySetting);n[t]||(n[t]=[]),n[t].push(s)}f=s.display_name.split(", ").map(((e,t)=>{if(!n[e])return e;const s=n[e].shift();return M.createElement(M.Fragment,{key:s.id},t>0&&", ",e,M.createElement(En.Z,{show:I.a_(s)}))})),l&&(u=M.createElement("span",{className:"has-guest-header"},M.createElement(V.Z,{id:"channel_header.groupMessageHasGuests",defaultMessage:"This group message has guests"})))}let v,y,P;b||(v=M.createElement(qu,{channel:s})),!b||r.delete_at||r.is_bot||(y=M.createElement(Qc.Z,{status:s.status}),P=M.createElement("span",{className:"header-status__text"},M.createElement(V.Z,{id:"status_dropdown.set_".concat(s.status),defaultMessage:I.cv(s.status)}),this.renderCustomStatus()));let w="channel-header__icon channel-header__icon--wide channel-header__icon--left";o===N.Hp.CHANNEL_FILES&&(w+=" channel-header__icon--active");const S=M.createElement("i",{className:"icon icon-file-document-outline"});let T="channel-header__icon channel-header__icon--wide channel-header__icon--left";o===N.Hp.PIN&&(T+=" channel-header__icon--active");const R=this.props.pinnedPostsCount?M.createElement(M.Fragment,null,M.createElement("i",{"aria-hidden":"true",className:"icon icon-pin-outline channel-header__pin"}),M.createElement("span",{id:"channelPinnedPostCountText",className:"icon__text"},this.props.pinnedPostsCount)):M.createElement("i",{"aria-hidden":"true",className:"icon icon-pin-outline channel-header__pin"});let O;const L=b&&r.is_bot?r.bot_description:s.header;let A;O=L?M.createElement("div",{id:"channelHeaderDescription",className:"channel-header__description",dir:"auto"},y,P,v,M.createElement(Bu.Z,{iconComponent:R,ariaLabel:!0,buttonClass:T,buttonId:"channelHeaderPinButton",onClick:this.showPinnedPosts,tooltipKey:"pinnedPosts"}),M.createElement(Bu.Z,{iconComponent:S,ariaLabel:!0,buttonClass:w,buttonId:"channelHeaderFilesButton",onClick:this.showChannelFiles,tooltipKey:"channelFiles"}),u):M.createElement("div",{id:"channelHeaderDescription",className:"channel-header__description light"},y,P,v,M.createElement(Bu.Z,{iconComponent:R,ariaLabel:!0,buttonClass:T,buttonId:"channelHeaderPinButton",onClick:this.showPinnedPosts,tooltipKey:"pinnedPosts"}),M.createElement(Bu.Z,{iconComponent:S,ariaLabel:!0,buttonClass:w,buttonId:"channelHeaderFilesButton",onClick:this.showChannelFiles,tooltipKey:"channelFiles"}),u);let k=null,x="";if(!m){const e=i?{id:"channelHeader.removeFromFavorites",defaultMessage:"Remove from Favorites"}:{id:"channelHeader.addToFavorites",defaultMessage:"Add to Favorites"};x=h(e).toLowerCase(),A=M.createElement(et.Z,{id:"favoriteTooltip"},M.createElement(V.Z,e)),k=M.createElement(tt.Z,{key:"isFavorite-".concat(i),delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"bottom",overlay:A,onEntering:this.removeTooltipLink},M.createElement("button",{id:"toggleFavorite",ref:this.toggleFavoriteRef,onClick:this.toggleFavorite,className:"style--none color--link channel-header__favorites "+(this.props.isFavorite?"active":"inactive"),"aria-label":x},M.createElement("i",{className:"icon "+(this.props.isFavorite?"icon-star":"icon-star-outline")})))}const D=M.createElement(et.Z,{id:"channelMutedTooltip"},M.createElement(V.Z,{id:"channelHeader.unmute",defaultMessage:"Unmute"}));let Z;a&&(Z=M.createElement(tt.Z,{delayShow:N.gT.OVERLAY_TIME_DELAY,placement:"bottom",overlay:D},M.createElement("button",{id:"toggleMute",onClick:this.unmute,className:"style--none color--link channel-header__mute inactive","aria-label":h({id:"generic_icons.muted",defaultMessage:"Muted Icon"})},M.createElement("i",{className:"icon icon-bell-off-outline"}))));let H,q,j=M.createElement(M.Fragment,null,M.createElement(Os.Z,{onToggle:this.setTitleMenuOpen},M.createElement("div",{id:"channelHeaderDropdownButton",className:"channel-header__top"},M.createElement("button",{className:"channel-header__trigger style--none ".concat(this.state.titleMenuOpen?"active":""),"aria-label":h({id:"channel_header.menuAriaLabel",defaultMessage:"Channel Menu"}).toLowerCase()},M.createElement("strong",{role:"heading","aria-level":"2",id:"channelHeaderTitle",className:"heading"},M.createElement("span",null,E,f,C)),M.createElement("span",{id:"channelHeaderDropdownIcon",className:"icon icon-chevron-down header-dropdown-chevron-icon","aria-label":h({id:"generic_icons.dropdown",defaultMessage:"Dropdown Icon"}).toLowerCase()}))),M.createElement(Gp,null)),k),U=M.createElement(or.Z,{src:Ws.je.getChannelPictureUrl(s.id,s.last_picture_update),size:"xl",status:"",wrapperClass:"ChannelHeader_img",newStatusIcon:!1});return b&&(U=M.createElement(or.Z,{src:Ws.je.getProfilePictureUrl(r.id,r.last_picture_update),size:"xl",status:"",wrapperClass:"ChannelHeader_img",newStatusIcon:!1})),b&&r.is_bot&&(j=M.createElement("div",{id:"channelHeaderDropdownButton",className:"channel-header__top channel-header__bot"},M.createElement("strong",{role:"heading","aria-level":"2",id:"channelHeaderTitle",className:"heading"},M.createElement("span",null,E,f)),M.createElement(Cn.Z,{className:"badge-popoverlist"}),k)),L&&(H=M.createElement("div",{key:"channel-header-description",className:"channel-header-description"},M.createElement(ft.Z,{message:L,options:this.getPopoverMarkdownOptions(g)}))),this.props.pinnedPostsCount&&(q=M.createElement("div",{key:"channel-header-pinned",className:"channel-header-description channel-header-pinned"},M.createElement(im,{count:this.props.pinnedPostsCount}))),[M.createElement("div",{id:"channel-header",key:"channel-header","aria-label":p,role:"banner",tabIndex:"-1","data-channelid":"".concat(s.id),className:"channel-header alt a11y__region","data-a11y-sort-order":"8"},M.createElement("div",{className:"flex-parent"},M.createElement("div",{className:"flex-child"},M.createElement("div",{id:"channeHeaderImage",className:"channel-header__image"},U),M.createElement("div",{id:"channelHeaderInfo",className:"channel-header__info"},M.createElement("div",{className:"channel-header__title dropdown"},M.createElement("div",null,j),Z),O)),M.createElement(Xu,{channel:s,channelMember:n}),M.createElement(ju.Z,null))),H,q]}}lm(hm,"propTypes",{teamId:y().string.isRequired,currentUser:y().object.isRequired,channel:y().object,channelMember:y().object,dmUser:y().object,gmMembers:y().array,isFavorite:y().bool,isReadOnly:y().bool,isMuted:y().bool,hasGuests:y().bool,rhsState:y().oneOf(Object.values(N.Hp)),rhsOpen:y().bool,isQuickSwitcherOpen:y().bool,intl:J.gm.isRequired,pinnedPostsCount:y().number,hasMoreThanOneTeam:y().bool,actions:y().shape({favoriteChannel:y().func.isRequired,unfavoriteChannel:y().func.isRequired,showFlaggedPosts:y().func.isRequired,showPinnedPosts:y().func.isRequired,showChannelFiles:y().func.isRequired,showMentions:y().func.isRequired,closeRightHandSide:y().func.isRequired,getCustomEmojisInText:y().func.isRequired,updateChannelNotifyProps:y().func.isRequired,goToLastViewedChannel:y().func.isRequired,openModal:y().func.isRequired,closeModal:y().func.isRequired}).isRequired,teammateNameDisplaySetting:y().string.isRequired,currentRelativeTeamUrl:y().string.isRequired,isLegacySidebar:y().bool,announcementBarCount:y().number,customStatus:y().object,contactName:y().string,isCustomStatusEnabled:y().bool.isRequired});const pm=(0,K.ZP)(hm),um=(0,i.EN)((0,n.connect)((function(){const e=(0,p.T5)(),t=(0,gd.yC)();return function(s){const n=(0,h.iE)(s),a=(0,m.TB)(s)||{},i=(0,p.ts)(s),r=(0,u.Dc)(s).length>1;let o,l,c,g;if(a&&a.type===D.LQ.DM_CHANNEL){const e=(0,$i.aU)(i.id,a.name);o=(0,p.PR)(s,e),g=(0,Po.No)(s,e),c=o&&t(s,o.id)}else a&&a.type===D.LQ.GM_CHANNEL&&(l=e(s,a.id,!1));const f=(0,m.Bw)(s)||{member_count:0,guest_count:0,pinnedpost_count:0};return{teamId:(0,u.ev)(s),channel:a,channelMember:(0,m.HU)(s),currentUser:i,dmUser:o,gmMembers:l,rhsState:(0,Ke.kV)(s),rhsOpen:(0,Ke.aC)(s),isFavorite:(0,m.CA)(s),isReadOnly:(0,m.ui)(s),isMuted:(0,m.D7)(s),isQuickSwitcherOpen:(0,Ms.g)(s,N.r8.QUICK_SWITCH),hasGuests:f.guest_count>0,pinnedPostsCount:f.pinnedpost_count,hasMoreThanOneTeam:r,teammateNameDisplaySetting:(0,d.kl)(s),currentRelativeTeamUrl:(0,u.gm)(s),isLegacySidebar:"true"===n.EnableLegacySidebar,announcementBarCount:(0,Ou.b)(s),customStatus:c,contactName:g,isCustomStatusEnabled:(0,gd.uD)(s)}}}),(e=>({actions:(0,a.bindActionCreators)({favoriteChannel:o.ZE,unfavoriteChannel:o.Dn,showFlaggedPosts:Ve.Yv,showPinnedPosts:Ve.B7,showChannelFiles:Ve.Cj,showMentions:Ve.rb,closeRightHandSide:Ve.Lg,getCustomEmojisInText:Iu.i,updateChannelNotifyProps:o.n$,goToLastViewedChannel:b.NL,openModal:H.h,closeModal:H.M},e)})))(pm));var mm=s(27640),gm=s(77905),fm=s(73787),Em=s(21226),Cm=s(99206),bm=(s(48702),s(76279)),_m=s(13685),vm=s(62788);function ym(e){const t=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{width:"14px",height:"10px",viewBox:"0 0 16 12",role:"img","aria-label":t.formatMessage({id:"generic_icons.camera",defaultMessage:"Camera Icon"})},M.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},M.createElement("g",{transform:"translate(-696.000000, -34.000000)",fillRule:"nonzero",fill:"inherit"},M.createElement("g",{transform:"translate(-1.000000, 0.000000)"},M.createElement("g",{transform:"translate(687.000000, 22.000000)"},M.createElement("g",{transform:"translate(10.000000, 12.000000)"},M.createElement("path",{d:"M15.105,1.447 L12,3 L12,1 C12,0.447 11.553,0 11,0 L1,0 C0.447,0 0,0.447 0,1 L0,11 C0,11.553 0.447,12 1,12 L11,12 C11.553,12 12,11.553 12,11 L12,9 L15.105,10.553 C15.6,10.8 16,10.553 16,10 L16,2 C16,1.447 15.6,1.2 15.105,1.447 Z M12.895,7.211 C12.612,7.07 12.306,7 12,7 L10.5,7 C10.224,7 10,7.224 10,7.5 L10,10 L2,10 L2,2 L10,2 L10,4.5 C10,4.776 10.224,5 10.5,5 L12,5 C12.306,5 12.612,4.93 12.895,4.789 L14,4.236 L14,7.763 L12.895,7.211 Z"}))))))))}const Mm={left:"inherit",right:0,bottom:"100%",top:"auto"};function Pm(e){const{formatMessage:t}=e.intl;let s;if(0===e.pluginCallMethods.length)s=null;else if(1===e.pluginCallMethods.length){const t=e.pluginCallMethods[0];s=M.createElement("button",{type:"button",className:"style--none post-action icon icon--attachment",onClick:()=>{t.action&&t.action(e.currentChannel,e.channelMember)},onTouchEnd:()=>{t.action&&t.action(e.currentChannel,e.channelMember)}},t.icon)}else{const n=e.pluginCallMethods.map((t=>M.createElement("li",{key:t.id,onClick:s=>{s.preventDefault(),t.action&&t.action(e.currentChannel,e.channelMember)}},M.createElement("a",{href:"#"},M.createElement("span",{className:"call-plugin-icon"},t.icon),t.dropdownText))));s=M.createElement(Os.Z,null,M.createElement("button",{type:"button",className:"style--none post-action"},M.createElement("div",{className:"icon icon--attachment"},M.createElement(ym,{className:"d-flex"}))),M.createElement(Is.Z,{id:"callOptions",openLeft:!0,openUp:!0,ariaLabel:t({id:"call_button.menuAriaLabel",defaultMessage:"Call type selector"}),customStyles:Mm},n))}return s}Pm.propTypes={currentChannel:y().object.isRequired,channelMember:y().object,intl:J.gm.isRequired,locale:y().string.isRequired,pluginCallMethods:y().arrayOf(y().object)},Pm.defaultProps={pluginCallMethods:[]};const wm=(0,K.ZP)(Pm);wm.displayName="injectIntl(CallButton)";const Sm=wm,Tm=(0,n.connect)((function(e){return{currentChannel:(0,m.TB)(e),locale:(0,di.B)(e),pluginCallMethods:e.plugins.components.CallButton,channelMember:(0,m.HU)(e)}}))(Sm);var Nm=s(68492),Rm=s(83440),Im=s(79541),Om=s(52881);function Lm(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Am(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Lm(Object(s),!0).forEach((function(t){km(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Lm(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function km(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const xm=N.ZP.KeyCodes;function Dm(e){return String.prototype.trimRight?e.trimRight():e.replace(/\s*$/,"")}class Zm extends M.PureComponent{static getDerivedStateFromProps(e,t){let s={currentChannel:e.currentChannel};return e.currentChannel.id!==t.currentChannel.id&&(s=Am(Am({},s),{},{message:e.draft.message,submitting:!1,serverError:null})),s}constructor(e){super(e),km(this,"setShowPreview",(e=>{this.props.actions.setShowPreview(e)})),km(this,"setOrientationListeners",(()=>{window.screen.orientation&&"onchange"in window.screen.orientation?window.screen.orientation.addEventListener("change",this.onOrientationChange):"onorientationchange"in window&&window.addEventListener("orientationchange",this.onOrientationChange)})),km(this,"removeOrientationListeners",(()=>{window.screen.orientation&&"onchange"in window.screen.orientation?window.screen.orientation.removeEventListener("change",this.onOrientationChange):"onorientationchange"in window&&window.removeEventListener("orientationchange",this.onOrientationChange)})),km(this,"onOrientationChange",(()=>{if(!R.Vg())return;let e="portrait";window.orientation&&(e=90===Math.abs(window.orientation)?"landscape":"portrait"),window.screen.orientation&&(e=window.screen.orientation.type.split("-")[0]),this.lastOrientation&&e!==this.lastOrientation&&"post_textbox"===(document.activeElement||{}).id&&this.textboxRef.current.blur(),this.lastOrientation=e})),km(this,"handlePostError",(e=>{this.setState({postError:e})})),km(this,"toggleEmojiPicker",(e=>{e.preventDefault(),this.setState({showEmojiPicker:!this.state.showEmojiPicker})})),km(this,"hideEmojiPicker",(()=>{this.handleEmojiClose()})),km(this,"doSubmit",(async e=>{const t=this.props.currentChannel.id;if(e&&e.preventDefault(),this.props.draft.uploadsInProgress.length>0||this.state.submitting)return;let s=this.state.message,n=!1;const a=this.state.serverError;a&&(0,z.cW)(a)&&a.submittedMessage===s&&(s=a.submittedMessage,n=!0);const i={file_ids:[]};if(i.message=s,0===i.message.trim().length&&0===this.props.draft.fileInfos.length)return;if(this.state.postError)return this.setState({errorClass:"animation--highlight"}),void setTimeout((()=>{this.setState({errorClass:null})}),N.ZP.ANIMATION_TIMEOUT);this.props.actions.addMessageIntoHistory(this.state.message),this.setState({submitting:!0,serverError:null});const r=I.oL.exec(i.message);if(0!==i.message.indexOf("/")||n)if(r&&this.props.emojiMap.has(r[2]))this.sendReaction(r),this.setState({message:""});else{const{error:e}=await this.sendMessage(i);e||this.setState({message:""})}else{this.setState({message:"",postError:null});let e={};e.channel_id=t,e.team_id=this.props.currentTeamId;const s=await this.props.actions.runSlashCommandWillBePostedHooks(i.message,e);if(s.error)this.setState({serverError:Am(Am({},s.error),{},{submittedMessage:i.message}),message:i.message});else if(s.data.message||s.data.args){i.message=s.data.message,e=s.data.args;const{error:t}=await this.props.actions.executeCommand(i.message,e);t&&(t.sendMessage?await this.sendMessage(i):this.setState({serverError:Am(Am({},t),{},{submittedMessage:i.message}),message:i.message}))}}this.setState({submitting:!1,postError:null}),cancelAnimationFrame(this.saveDraftFrame),this.props.actions.setDraft(N.hC.DRAFT+t,null),this.draftsForChannel[t]=null;const o=Date.now()-this.lastBlurAt<150;this.focusTextbox(o)})),km(this,"handleNotifyAllConfirmation",(e=>{this.hideNotifyAllModal(),this.doSubmit(e)})),km(this,"hideNotifyAllModal",(()=>{this.setState({showConfirmModal:!1})})),km(this,"showNotifyAllModal",(()=>{this.setState({showConfirmModal:!0})})),km(this,"getStatusFromSlashCommand",(()=>{const{message:e}=this.state,t=e.split(" ");return t.length>0?t[0].substring(1):""})),km(this,"isStatusSlashCommand",(e=>"online"===e||"away"===e||"dnd"===e||"offline"===e)),km(this,"handleSubmit",(async e=>{e&&e.preventDefault(),I.tq()&&this.focusTextbox(!0);const{currentChannel:t,userIsOutOfOffice:s,groupsWithAllowReference:n,channelMemberCountsByGroup:a,currentChannelMembersCount:i,useGroupMentions:r}=this.props,o=this.props.enableConfirmNotificationsToChannel&&this.props.useChannelMentions;let l=0,c=0,d=[];const h=!(0,z.t7)(this.state.message);if(this.props.enableConfirmNotificationsToChannel&&h&&r&&(d=(0,z.TA)(this.state.message,n),d.length>0&&(d=d.map((e=>{const t=a[e.id];return t&&t.channel_member_count>N.ZP.NOTIFY_ALL_MEMBERS&&t.channel_member_count>l&&(l=t.channel_member_count,c=t.channel_member_timezones_count),"@".concat(e.name)})),d=[...new Set(d)])),o&&i>N.ZP.NOTIFY_ALL_MEMBERS&&!h&&(l=i-1,d=["@all","@group"],this.props.isTimezoneEnabled)){const{data:e}=await this.props.actions.getChannelTimezones(this.props.currentChannel.id);c=e?e.length:0}if(l>0)return this.setState({channelTimezoneCount:c,memberNotifyCount:l,mentions:d}),void this.showNotifyAllModal();const p=this.getStatusFromSlashCommand();if(s&&this.isStatusSlashCommand(p)){const e={ModalId:N.r8.RESET_STATUS,dialogType:He,dialogProps:{newStatus:p}};return this.props.actions.openModal(e),void this.setState({message:""})}if("/header"===Dm(this.state.message)){const e={modalId:N.r8.EDIT_CHANNEL_HEADER,dialogType:Lh,dialogProps:{channel:t}};return this.props.actions.openModal(e),void this.setState({message:""})}const u=t.type===N.ZP.DM_CHANNEL||t.type===N.ZP.GM_CHANNEL;if(!u&&"/purpose"===Dm(this.state.message)){const e={modalId:N.r8.EDIT_CHANNEL_PURPOSE,dialogType:Dh,dialogProps:{channel:t}};return this.props.actions.openModal(e),void this.setState({message:""})}if(!u&&"/rename"===Dm(this.state.message))return T.VB(t),void this.setState({message:""});await this.doSubmit(e)})),km(this,"sendMessage",(async e=>{const{actions:t,currentChannel:s,currentUserId:n,draft:a,useGroupMentions:i,useChannelMentions:r,groupsWithAllowReference:o}=this.props;let l=e;l.channel_id=s.id;const c=I.u3(),d=n;l.pending_post_id="".concat(d,":").concat(c),l.user_id=d,l.create_at=c,l.parent_id=this.state.parentId,l.metadata={},l.props={},!r&&(0,z.t7)(l.message,{checkAllMentions:!0})&&(l.props.mentionHighlightDisabled=!0),!i&&(0,z.TA)(l.message,o)&&(l.props.disable_group_highlight=!0);const h=await t.runMessageWillBePostedHooks(l);return h.error?(this.setState({serverError:h.error,submitting:!1}),h):(l=h.data,t.onSubmitPost(l,a.fileInfos),t.scrollPostListToBottom(),this.setState({submitting:!1}),{data:!0})})),km(this,"focusTextbox",((e=!1)=>{const t=this.props.readOnlyChannel||!this.props.canPost;this.textboxRef.current&&t?this.textboxRef.current.blur():!this.textboxRef.current||!e&&R.tq()||this.textboxRef.current.focus()})),km(this,"postMsgKeyPress",(e=>{const{ctrlSend:t,codeBlockOnCtrlEnter:s}=this.props,{allowSending:n,withClosedCodeBlock:a,ignoreKeyPress:i,message:r}=(0,z.bp)(e,this.state.message,t,s,Date.now(),this.lastChannelSwitchAt,this.state.caretPosition);if(i)return e.preventDefault(),void e.stopPropagation();n&&(e.persist&&e.persist(),this.textboxRef.current&&this.textboxRef.current.blur(),a&&r?this.setState({message:r},(()=>this.handleSubmit(e))):this.handleSubmit(e),this.setShowPreview(!1)),this.emitTypingEvent()})),km(this,"emitTypingEvent",(()=>{const e=this.props.currentChannel.id;T.bH(e,"")})),km(this,"handleChange",(e=>{const t=e.target.value,s=this.props.currentChannel.id;let n=this.state.serverError;(0,z.cW)(n)&&(n=null),this.setState({message:t,serverError:n});const a=Am(Am({},this.props.draft),{},{message:t});cancelAnimationFrame(this.saveDraftFrame),this.saveDraftFrame=requestAnimationFrame((()=>{this.props.actions.setDraft(N.hC.DRAFT+s,a)})),this.draftsForChannel[s]=a})),km(this,"pasteHandler",(e=>{if(!e.clipboardData||!e.clipboardData.items||"post_textbox"!==e.target.id)return;const{clipboardData:t}=e,s=(0,X.hC)(t);if(!s)return;e.preventDefault();let n=this.state.message;if((0,X.lw)(s.className)){const{formattedMessage:e,formattedCodeBlock:s}=(0,X.fB)(this.state.caretPosition,n,t),a=this.state.caretPosition+s.length;return void this.setMessageAndCaretPostion(e,a)}const a=n.length;n=(0,X.Kt)(s,n.trim(),this.state.caretPosition);const i=n.length-(a-this.state.caretPosition);this.setMessageAndCaretPostion(n,i)})),km(this,"handleFileUploadChange",(()=>{this.focusTextbox()})),km(this,"handleUploadStart",((e,t)=>{const s=[...this.props.draft.uploadsInProgress,...e],n=Am(Am({},this.props.draft),{},{uploadsInProgress:s});this.props.actions.setDraft(N.hC.DRAFT+t,n),this.draftsForChannel[t]=n,this.focusTextbox()})),km(this,"handleUploadProgress",(({clientId:e,name:t,percent:s,type:n})=>{const a=Am(Am({},this.state.uploadsProgressPercent),{},{[e]:{percent:s,name:t,type:n}});this.setState({uploadsProgressPercent:a})})),km(this,"handleFileUploadComplete",((e,t,s)=>{const n=Am({},this.draftsForChannel[s]);for(let e=0;e<t.length;e++)if(n.uploadsInProgress){const s=n.uploadsInProgress.indexOf(t[e]);-1!==s&&(n.uploadsInProgress=n.uploadsInProgress.filter(((e,t)=>s!==t)))}n.fileInfos&&(n.fileInfos=(0,bm.Vi)(n.fileInfos.concat(e),this.props.locale)),this.draftsForChannel[s]=n,this.props.actions.setDraft(N.hC.DRAFT+s,n)})),km(this,"handleUploadError",((e,t,s)=>{const n=Am({},this.draftsForChannel[s]);let a=e;if("string"==typeof e&&(a=new Error(e)),-1!==t&&n.uploadsInProgress){const e=n.uploadsInProgress.indexOf(t);if(-1!==e){const t=n.uploadsInProgress.filter(((t,s)=>e!==s)),a=Am(Am({},n),{},{uploadsInProgress:t});this.props.actions.setDraft(N.hC.DRAFT+s,a),this.draftsForChannel[s]=a}}this.setState({serverError:a})})),km(this,"removePreview",(e=>{let t={};const s=Am({},this.props.draft),n=this.props.currentChannel.id;this.setState({serverError:null});let a=s.fileInfos.findIndex((t=>t.id===e));if(-1===a){if(a=s.uploadsInProgress.indexOf(e),-1!==a){const n=s.uploadsInProgress.filter(((e,t)=>a!==t));t=Am(Am({},s),{},{uploadsInProgress:n}),this.fileUploadRef.current&&this.fileUploadRef.current&&this.fileUploadRef.current.cancelUpload(e)}}else{const e=s.fileInfos.filter(((e,t)=>a!==t));t=Am(Am({},s),{},{fileInfos:e})}this.props.actions.setDraft(N.hC.DRAFT+n,t),this.draftsForChannel[n]=t,this.handleFileUploadChange()})),km(this,"focusTextboxIfNecessary",(e=>{this.props.rhsExpanded||document.getElementsByClassName("channel-switch-modal").length||(0,z.a0)(e,document.activeElement)&&this.focusTextbox()})),km(this,"documentKeyHandler",(e=>{const t=e.ctrlKey||e.metaKey,s=t&&I.pD(e,xm.FORWARD_SLASH),n=t&&e.shiftKey&&I.pD(e,xm.BACK_SLASH);if(s)return e.preventDefault(),void T.kk();n?this.reactToLastMessage(e):this.focusTextboxIfNecessary(e)})),km(this,"getFileCount",(()=>{const e=this.props.draft;return e.fileInfos.length+e.uploadsInProgress.length})),km(this,"getFileUploadTarget",(()=>this.textboxRef.current?this.textboxRef.current:null)),km(this,"getCreatePostControls",(()=>this.createPostControlsRef.current)),km(this,"handleMouseUpKeyUp",(e=>{const t=I.qK(e.target);this.setState({caretPosition:t})})),km(this,"handleSelect",(e=>{I.cf(this.textboxRef.current.getInputBox(),e)})),km(this,"handleKeyDown",(e=>{const t=e.ctrlKey||e.metaKey,s=0===this.state.message.length,n=0===this.props.draft.message.length,a=(this.props.ctrlSend||this.props.codeBlockOnCtrlEnter)&&I.pD(e,xm.ENTER)&&t,i=!t&&!e.altKey&&!e.shiftKey&&I.pD(e,xm.UP),r=!t&&!e.altKey&&e.shiftKey&&I.pD(e,xm.UP),o=I._E(e)&&!e.altKey&&!e.shiftKey,l=I.pD(e,xm.B)||I.pD(e,xm.I),c=I._E(e,!0)&&e.altKey,d=I.pD(e,xm.K);I.m(e)?this.setState({message:I.V4(e)}):a?this.postMsgKeyPress(e):i&&s?this.editLastPost(e):r&&s?this.replyToLastPost(e):o&&n&&I.pD(e,xm.UP)?this.loadPrevMessage(e):o&&n&&I.pD(e,xm.DOWN)?this.loadNextMessage(e):(o&&l||c&&d)&&this.applyHotkeyMarkdown(e)})),km(this,"editLastPost",(e=>{e.preventDefault();const t=this.props.currentUsersLatestPost;if(!t)return;let s;s=t.root_id&&t.root_id.length>0?I._u("create_post.comment",D.V8.MESSAGE_TYPES.COMMENT):I._u("create_post.post",D.V8.MESSAGE_TYPES.POST),this.textboxRef.current&&this.textboxRef.current.blur(),this.props.actions.setEditingPost(t.id,this.props.commentCountForPost,"post_textbox",s)})),km(this,"replyToLastPost",(e=>{e.preventDefault();const t=this.props.latestReplyablePostId,s=document.getElementById("reply_textbox");s&&s.focus(),t&&this.props.actions.selectPostFromRightHandSideSearchByPostId(t)})),km(this,"loadPrevMessage",(e=>{e.preventDefault(),this.props.actions.moveHistoryIndexBack(D.V8.MESSAGE_TYPES.POST).then((()=>this.fillMessageFromHistory()))})),km(this,"loadNextMessage",(e=>{e.preventDefault(),this.props.actions.moveHistoryIndexForward(D.V8.MESSAGE_TYPES.POST).then((()=>this.fillMessageFromHistory()))})),km(this,"applyHotkeyMarkdown",(e=>{const t=I.IG(e);this.setState({message:t.message},(()=>{const e=this.textboxRef.current.getInputBox();I.AU(e,t.selectionStart,t.selectionEnd)}))})),km(this,"reactToLastMessage",(e=>{e.preventDefault();const{rhsExpanded:t,actions:{emitShortcutReactToLastPostFrom:s}}=this.props,n=0===document.getElementsByClassName(N.Sz.MODAL).length,a=0===document.getElementsByClassName(N.Sz.POPUP).length;!t&&n&&a&&s(N.tY.CENTER)})),km(this,"handleBlur",(()=>{this.lastBlurAt=Date.now(),this.setState({textboxActive:!1})})),km(this,"handleFocus",(()=>{this.setState({textboxActive:!0})})),km(this,"showPostDeletedModal",(()=>{this.setState({showPostDeletedModal:!0})})),km(this,"hidePostDeletedModal",(()=>{this.setState({showPostDeletedModal:!1})})),km(this,"handleEmojiClose",(()=>{this.setState({showEmojiPicker:!1})})),km(this,"setMessageAndCaretPostion",((e,t)=>{const s=this.textboxRef.current.getInputBox();this.setState({message:e,caretPosition:t},(()=>{I.Mq(s,t)}))})),km(this,"handleEmojiClick",(e=>{const t=e.name||e.aliases[0];if(t){if(""===this.state.message)this.setState({message:":"+t+": "});else{const{message:e}=this.state,{firstPiece:s,lastPiece:n}=(0,z.Nn)(this.state.caretPosition,e),a=""===s?":".concat(t,": ").concat(n):"".concat(s," :").concat(t,": ").concat(n),i=""===s?":".concat(t,": ").length:"".concat(s," :").concat(t,": ").length;this.setMessageAndCaretPostion(a,i)}this.handleEmojiClose()}})),km(this,"handleGifClick",(e=>{if(""===this.state.message)this.setState({message:e});else{const t=/\s+$/.test(this.state.message)?this.state.message+e:this.state.message+" "+e;this.setState({message:t})}this.handleEmojiClose()})),km(this,"handleHeightChange",((e,t)=>{this.setState({renderScrollbar:e>t}),window.requestAnimationFrame((()=>{this.textboxRef.current&&this.setState({scrollbarWidth:I.LF(this.textboxRef.current.getInputBox())})}))})),this.state={message:this.props.draft.message,caretPosition:this.props.draft.message.length,submitting:!1,showPostDeletedModal:!1,showEmojiPicker:!1,showConfirmModal:!1,channelTimezoneCount:0,uploadsProgressPercent:{},renderScrollbar:!1,scrollbarWidth:0,currentChannel:e.currentChannel,mentions:[],memberNotifyCount:0,textboxActive:!1},this.lastBlurAt=0,this.lastChannelSwitchAt=0,this.draftsForChannel={},this.lastOrientation=null,this.topDiv=M.createRef(),this.textboxRef=M.createRef(),this.fileUploadRef=M.createRef(),this.createPostControlsRef=M.createRef()}componentDidMount(){const{useGroupMentions:e,currentChannel:t,isTimezoneEnabled:s,actions:n}=this.props;this.onOrientationChange(),n.setShowPreview(!1),n.clearDraftUploads(N.hC.DRAFT,((e,t)=>t?Am(Am({},t),{},{uploadsInProgress:[]}):t)),this.focusTextbox(),document.addEventListener("paste",this.pasteHandler),document.addEventListener("keydown",this.documentKeyHandler),this.setOrientationListeners(),e&&n.getChannelMemberCountsByGroup(t.id,s)}componentDidUpdate(e,t){const{useGroupMentions:s,currentChannel:n,isTimezoneEnabled:a,actions:i}=this.props;e.currentChannel.id!==n.id&&(this.lastChannelSwitchAt=Date.now(),this.focusTextbox(),s&&i.getChannelMemberCountsByGroup(n.id,a)),n.id!==e.currentChannel.id&&i.setShowPreview(!1),t.showEmojiPicker&&!this.state.showEmojiPicker&&this.focusTextbox()}componentWillUnmount(){if(document.removeEventListener("paste",this.pasteHandler),document.removeEventListener("keydown",this.documentKeyHandler),this.removeOrientationListeners(),this.saveDraftFrame){const e=this.props.currentChannel.id;this.props.actions.setDraft(N.hC.DRAFT+e,this.draftsForChannel[e]),cancelAnimationFrame(this.saveDraftFrame)}}sendReaction(e){const t=this.props.currentChannel.id,s=e[1],n=e[2],a=this.props.latestReplyablePostId;a&&"+"===s?this.props.actions.addReaction(a,n):a&&"-"===s&&this.props.actions.removeReaction(a,n),this.props.actions.setDraft(N.hC.DRAFT+t,null),this.draftsForChannel[t]=null}fillMessageFromHistory(){const e=this.props.messageInHistoryItem;e&&this.setState({message:e})}createTutorialTip(){const e=[];return e.push(M.createElement("div",null,M.createElement("h4",null,M.createElement(V.Z,{id:"create_post.tutorialTip.title",defaultMessage:"Sending Messages"})),M.createElement("p",null,M.createElement(Dt.Z,{id:"create_post.tutorialTip1",defaultMessage:"Type here to write a message and press **Enter** to post it."})),M.createElement("p",null,M.createElement(Dt.Z,{id:"create_post.tutorialTip2",defaultMessage:"Click the **Attachment** button to upload an image or a file."})))),M.createElement(Gt,{id:"postTextboxTipMessage",placement:"top",screens:e,overlayClass:"tip-overlay--chat",telemetryTag:"tutorial_tip_1_sending_messages"})}shouldEnableSendButton(){return 0!==this.state.message.trim().length||0!==this.props.draft.fileInfos.length}render(){const{currentChannel:e,draft:t,fullWidthTextBox:s,showTutorialTip:n,canPost:a}=this.props,i=this.props.readOnlyChannel||!a,{formatMessage:r}=this.props.intl,{renderScrollbar:o,channelTimezoneCount:l,mentions:c,memberNotifyCount:d}=this.state,h=I._u("accessibility.sections.centerFooter","message input complimentary region");let p="",u="";c.includes("@all")||c.includes("@group")?(u=M.createElement(V.Z,{id:"notify_all.title.confirm",defaultMessage:"Confirm sending notifications to entire channel"}),p=l>0?M.createElement(Dt.Z,{id:"notify_all.question_timezone",defaultMessage:"By using **@all** or **@group** you are about to send notifications to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{totalMembers:d,timezones:l}}):M.createElement(Dt.Z,{id:"notify_all.question",defaultMessage:"By using **@all** or **@group** you are about to send notifications to **{totalMembers} people**. Are you sure you want to do this?",values:{totalMembers:d}})):c.length>0&&(u=M.createElement(V.Z,{id:"notify_all.title.confirm_groups",defaultMessage:"Confirm sending notifications to groups"}),p=1===c.length?l>0?M.createElement(Dt.Z,{id:"notify_all.question_timezone_one_group",defaultMessage:"By using **{mention}** you are about to send notifications to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{mention:c[0],totalMembers:d,timezones:l}}):M.createElement(Dt.Z,{id:"notify_all.question_one_group",defaultMessage:"By using **{mention}** you are about to send notifications to **{totalMembers} people**. Are you sure you want to do this?",values:{mention:c[0],totalMembers:d}}):l>0?M.createElement(Dt.Z,{id:"notify_all.question_timezone_groups",defaultMessage:"By using **{mentions}** and **{finalMention}** you are about to send notifications to at least **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{mentions:c.slice(0,-1).join(", "),finalMention:c[c.length-1],totalMembers:d,timezones:l}}):M.createElement(Dt.Z,{id:"notify_all.question_groups",defaultMessage:"By using **{mentions}** and **{finalMention}** you are about to send notifications to at least **{totalMembers} people**. Are you sure you want to do this?",values:{mentions:c.slice(0,-1).join(", "),finalMention:c[c.length-1],totalMembers:d}}));const m=M.createElement(V.Z,{id:"notify_all.confirm",defaultMessage:"Confirm"});let g=null;this.state.serverError&&(g=M.createElement(Om.Z,{id:"postServerError",error:this.state.serverError,submittedMessage:this.state.serverError.submittedMessage,handleSubmit:this.handleSubmit}));let f=null;if(this.state.postError){const e="post-error"+(this.state.errorClass?" "+this.state.errorClass:"");f=M.createElement("label",{className:e},this.state.postError)}let E=null;!i&&(t.fileInfos.length>0||t.uploadsInProgress.length>0)&&(E=M.createElement(_m.Z,{fileInfos:t.fileInfos,onRemove:this.removePreview,uploadsInProgress:t.uploadsInProgress,uploadsProgressPercent:this.state.uploadsProgressPercent}));let C="post-create-footer";f&&(C+=" has-error");let b=null;n&&(b=this.createTutorialTip());let _="";s||(_="center");let v="send-button theme";this.shouldEnableSendButton()||(v+=" disabled");let y,P,w="";this.props.canUploadFiles||(w=" post-create--attachment-disabled"),i||this.props.shouldShowPreview||(y=M.createElement(Tm,null)),i||this.props.shouldShowPreview||(P=M.createElement(vm.Z,{ref:this.fileUploadRef,fileCount:this.getFileCount(),getTarget:this.getFileUploadTarget,onFileUploadChange:this.handleFileUploadChange,onUploadStart:this.handleUploadStart,onFileUpload:this.handleFileUploadComplete,onUploadError:this.handleUploadError,onUploadProgress:this.handleUploadProgress,postType:"post",channelId:e.id}));let S=null;const T=r({id:"emoji_picker.emojiPicker",defaultMessage:"Emoji Picker"}).toLowerCase();let N;!this.props.enableEmojiPicker||i||this.props.shouldShowPreview||(S=M.createElement("div",null,M.createElement($.Z,{show:this.state.showEmojiPicker,target:this.getCreatePostControls,onHide:this.hideEmojiPicker,onEmojiClose:this.handleEmojiClose,onEmojiClick:this.handleEmojiClick,onGifClick:this.handleGifClick,enableGifPicker:this.props.enableGifPicker,topOffset:-7}),M.createElement("button",{type:"button","aria-label":T,onClick:this.toggleEmojiPicker,className:W()("emoji-picker__container","post-action",{"post-action--active":this.state.showEmojiPicker})},M.createElement(ee.Z,{id:"emojiPickerButton",className:"icon icon--emoji "})))),N=i?I._u("create_post.read_only","This channel is read-only. Only members with permission can post here."):r({id:"create_post.write",defaultMessage:"Write to {channelDisplayName}"},{channelDisplayName:e.display_name});let R="";return o&&(R=" scroll"),M.createElement("form",{id:"create_post",ref:this.topDiv,className:_,onSubmit:this.handleSubmit},M.createElement("div",{className:W()("post-create"+w+R,{"textbox-active":this.state.textboxActive}),style:this.state.renderScrollbar&&this.state.scrollbarWidth?{"--detected-scrollbar-width":"".concat(this.state.scrollbarWidth,"px")}:void 0},M.createElement("div",{className:"post-create-body"},M.createElement("div",{role:"application",id:"centerChannelFooter","aria-label":h,tabIndex:"-1",className:"post-body__cell a11y__region","data-a11y-sort-order":"2"},M.createElement(te.Z,{onChange:this.handleChange,onKeyPress:this.postMsgKeyPress,onKeyDown:this.handleKeyDown,onSelect:this.handleSelect,onMouseUp:this.handleMouseUpKeyUp,onKeyUp:this.handleMouseUpKeyUp,onComposition:this.emitTypingEvent,onHeightChange:this.handleHeightChange,handlePostError:this.handlePostError,value:i?"":this.state.message,onBlur:this.handleBlur,onFocus:this.handleFocus,emojiEnabled:this.props.enableEmojiPicker,createMessage:N,channelId:e.id,id:"post_textbox",ref:this.textboxRef,disabled:i,characterLimit:this.props.maxPostSize,preview:this.props.shouldShowPreview,badConnection:this.props.badConnection,listenForMentionKeyClick:!0,useChannelMentions:this.props.useChannelMentions}),M.createElement("span",{ref:this.createPostControlsRef,className:"post-body__actions"},y,P,S,M.createElement("a",{role:"button",tabIndex:"0","aria-label":r({id:"create_post.send_message",defaultMessage:"Send a message"}),className:v,onClick:this.handleSubmit},M.createElement(Nm.Z,{className:"fa fa-paper-plane",title:{id:(0,Ae.t)("create_post.icon"),defaultMessage:"Create a post"}})))),b),M.createElement("div",{id:"postCreateFooter",role:"form",className:C},M.createElement("div",{className:"d-flex justify-content-between"},M.createElement(Rm.Z,{channelId:e.id,postId:""}),M.createElement(se.Z,{characterLimit:this.props.maxPostSize,showPreview:this.props.shouldShowPreview,updatePreview:this.setShowPreview,message:i?"":this.state.message})),M.createElement("div",null,f,E,g))),M.createElement(Im.Z,{show:this.state.showPostDeletedModal,onHide:this.hidePostDeletedModal}),M.createElement(Te.Z,{title:u,message:p,confirmButtonText:m,show:this.state.showConfirmModal,onConfirm:this.handleNotifyAllConfirmation,onCancel:this.hideNotifyAllModal}))}}km(Zm,"propTypes",{currentChannelMembersCount:y().number,currentChannel:y().object,currentTeamId:y().string,currentUserId:y().string,codeBlockOnCtrlEnter:y().bool,ctrlSend:y().bool,fullWidthTextBox:y().bool,showTutorialTip:y().bool.isRequired,messageInHistoryItem:y().string,draft:y().shape({message:y().string.isRequired,uploadsInProgress:y().array.isRequired,fileInfos:y().array.isRequired}).isRequired,commentCountForPost:y().number,latestReplyablePostId:y().string,locale:y().string.isRequired,currentUsersLatestPost:y().object,readOnlyChannel:y().bool,canUploadFiles:y().bool.isRequired,enableEmojiPicker:y().bool.isRequired,enableGifPicker:y().bool.isRequired,enableConfirmNotificationsToChannel:y().bool.isRequired,maxPostSize:y().number.isRequired,emojiMap:y().object.isRequired,badConnection:y().bool.isRequired,userIsOutOfOffice:y().bool.isRequired,rhsExpanded:y().bool.isRequired,isTimezoneEnabled:y().bool.isRequired,canPost:y().bool.isRequired,useChannelMentions:y().bool.isRequired,intl:J.gm.isRequired,shouldShowPreview:y().bool.isRequired,actions:y().shape({setShowPreview:y().func.isRequired,addMessageIntoHistory:y().func.isRequired,moveHistoryIndexBack:y().func.isRequired,moveHistoryIndexForward:y().func.isRequired,addReaction:y().func.isRequired,onSubmitPost:y().func.isRequired,removeReaction:y().func.isRequired,clearDraftUploads:y().func.isRequired,runMessageWillBePostedHooks:y().func.isRequired,runSlashCommandWillBePostedHooks:y().func.isRequired,setDraft:y().func.isRequired,setEditingPost:y().func.isRequired,selectPostFromRightHandSideSearchByPostId:y().func.isRequired,openModal:y().func.isRequired,executeCommand:y().func.isRequired,getChannelTimezones:y().func.isRequired,scrollPostListToBottom:y().func.isRequired,emitShortcutReactToLastPostFrom:y().func,getChannelMemberCountsByGroup:y().func}).isRequired,groupsWithAllowReference:y().object,channelMemberCountsByGroup:y().object,useGroupMentions:y().bool.isRequired}),km(Zm,"defaultProps",{latestReplyablePostId:""});const Hm=(0,K.ZP)(Zm);function qm(e,t){return s=>{s((0,U.qb)(e,t))}}const jm=(0,n.connect)((function(){const e=(0,Qe.U6)(),t=(0,Qe.Jf)(D.V8.MESSAGE_TYPES.POST);return(s,n)=>{const a=(0,h.iE)(s),i=(0,h.lJ)(s),r=(0,m.TB)(s)||{},o=(0,Ke.HG)(s,N.hC.DRAFT,r.id),l=(0,Qe.bt)(s,r.id),c=(0,Qe.xl)(s,l),g=(0,Qe.kO)(s),f=(0,m.Bw)(s)?(0,m.Bw)(s).member_count:1,E="true"===a.EnableTutorial,C=(0,d.wS)(s,N.uP.TUTORIAL_STEP,(0,p.rc)(s),N.PN.FINISHED),b="true"===a.EnableEmojiPicker,_="true"===a.EnableGifPicker,v="true"===a.EnableConfirmNotificationsToChannel,y=(0,p.rc)(s),M=(0,p.ZO)(s,y)===N.gg.OUT_OF_OFFICE,P=(0,mm.S)(s)>1,w="true"===a.ExperimentalTimezone,S=(0,Em.dj)(s),T=(0,Z.Ai)(s,{channel:r.id,team:r.team_id,permission:D.Pl.CREATE_POST}),R=(0,Z.Ai)(s,{channel:r.id,team:r.team_id,permission:D.Pl.USE_CHANNEL_MENTIONS}),I="true"===(null==i?void 0:i.IsLicensed)&&"true"===(null==i?void 0:i.LDAPGroups),O=I&&(0,Z.Ai)(s,{channel:r.id,team:r.team_id,permission:D.Pl.USE_GROUP_MENTIONS}),L=(0,m.am)(s,r.id),A=(0,u.ev)(s),k=O?(0,ka.mK)(s,A,r.id):null;return{currentTeamId:A,currentChannel:r,currentChannelMembersCount:f,currentUserId:y,codeBlockOnCtrlEnter:(0,d.o4)(s,D.uP.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter",!0),ctrlSend:(0,d.o4)(s,N.uP.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),fullWidthTextBox:(0,d.U2)(s,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.CHANNEL_DISPLAY_MODE,N.uP.CHANNEL_DISPLAY_MODE_DEFAULT)===N.uP.CHANNEL_DISPLAY_MODE_FULL_SCREEN,showTutorialTip:E&&C===N.PN.POST_POPOVER,messageInHistoryItem:t(s),draft:o,commentCountForPost:e(s,{post:c}),latestReplyablePostId:g,locale:(0,di.B)(s),currentUsersLatestPost:(0,Qe.l0)(s),readOnlyChannel:n.readOnlyChannel||!(0,p.BW)(s)&&"true"===a.ExperimentalTownSquareIsReadOnly&&r.name===N.gT.DEFAULT_CHANNEL,canUploadFiles:(0,es.SI)(a),enableEmojiPicker:b,enableGifPicker:_,enableConfirmNotificationsToChannel:v,maxPostSize:parseInt(a.MaxPostSize,10)||N.gT.DEFAULT_CHARACTER_LIMIT,userIsOutOfOffice:M,rhsExpanded:(0,Ke.OZ)(s),emojiMap:(0,Em.kM)(s),badConnection:P,isTimezoneEnabled:w,shortcutReactToLastPostEmittedFrom:S,canPost:T,useChannelMentions:R,shouldShowPreview:(0,j.QH)(s),groupsWithAllowReference:k,useGroupMentions:O,channelMemberCountsByGroup:L,isLDAPEnabled:I}}}),(function(e){return{actions:(0,a.bindActionCreators)({addMessageIntoHistory:x.$s,onSubmitPost:qm,moveHistoryIndexBack:x.Pc,moveHistoryIndexForward:x.Rc,addReaction:U.rU,removeReaction:x.WO,setDraft:Cm.Bc,clearDraftUploads:Cm.Qg,selectPostFromRightHandSideSearchByPostId:Ve.kZ,setEditingPost:U.Jp,emitShortcutReactToLastPostFrom:U.id,openModal:H.h,executeCommand:gm.P,getChannelTimezones:o.ng,runMessageWillBePostedHooks:fm.H,runSlashCommandWillBePostedHooks:fm.J,scrollPostListToBottom:b.WW,setShowPreview:q.v9,getChannelMemberCountsByGroup:o.am},e)}}))(Hm);function Um(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Fm extends M.PureComponent{constructor(e){super(e),Um(this,"setExpanded",(e=>{this.setState({expandedKey:e})})),this.state={expandedKey:e.defaultExpandedKey}}render(){return M.createElement("div",{className:"Accordion"},this.props.children(this.setExpanded,this.state.expandedKey))}}Um(Fm,"propTypes",{defaultExpandedKey:y().string.isRequired,children:y().func.isRequired});var Bm=s(25896);const Gm=s.p+"files/bc39a70bb1048e5a929335dd8e40d958.apng",Vm=()=>M.createElement("svg",{viewBox:"0 0 1366 767",fill:"none",xmlns:"http://www.w3.org/2000/svg"},M.createElement("rect",{width:"1366",height:"767",fill:"var(--center-channel-bg)"}),M.createElement("mask",{id:"mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"1366",height:"767"},M.createElement("rect",{width:"1366",height:"767",fill:"var(--center-channel-bg)"})),M.createElement("g",{mask:"url(#mask0)"},M.createElement("g",{opacity:"0.5"},M.createElement("path",{opacity:"0.08",fillRule:"evenodd",clipRule:"evenodd",d:"M-676.894 2032L1652 1293.08L1424.96 647.622C1424.96 647.622 1380.64 695.825 1254.89 695.825C1151.41 695.825 992.815 663.207 758.34 544.248C680.414 504.713 608.621 487.89 542.133 487.89C165.438 487.89 -41.0984 1027.86 -229.486 1036.79C-451.126 1047.29 -746.809 1803.59 -746.809 1803.59L-676.894 2032Z",fill:"url(#paint0_linear)"}),M.createElement("path",{opacity:"0.08",fillRule:"evenodd",clipRule:"evenodd",d:"M-693.799 1938.98L1635.1 1202.49L1408.06 559.152C1408.06 559.152 1363.73 607.196 1237.98 607.196C1134.51 607.196 975.911 574.685 741.435 456.118C663.509 416.713 591.716 399.945 525.229 399.945C148.533 399.945 -58.0032 938.146 -246.391 947.039C-468.031 957.503 -763.714 1711.32 -763.714 1711.32L-693.799 1938.98Z",fill:"url(#paint1_linear)"}),M.createElement("path",{opacity:"0.08",fillRule:"evenodd",clipRule:"evenodd",d:"M-714.084 1856.11L1614.81 1117.19L1387.77 471.732C1387.77 471.732 1343.44 519.935 1217.7 519.935C1114.22 519.935 955.625 487.317 721.149 368.358C643.223 328.823 571.43 312 504.943 312C128.247 312 -78.2891 851.975 -266.677 860.898C-488.316 871.397 -784 1627.7 -784 1627.7L-714.084 1856.11Z",fill:"url(#paint2_linear)"})),M.createElement("g",{opacity:"0.16"},M.createElement("rect",{x:"1360.4",y:"313",width:"3.52187",height:"3.52709",transform:"rotate(45 1360.4 313)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1225.73",y:"447.677",width:"3.52187",height:"3.5271",transform:"rotate(45 1225.73 447.677)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.2",y:"582.156",width:"3.52187",height:"3.5271",transform:"rotate(45 1360.2 582.156)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.96",y:"335.446",width:"3.52187",height:"3.52709",transform:"rotate(45 1337.96 335.446)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1203.28",y:"470.124",width:"3.52187",height:"3.52708",transform:"rotate(45 1203.28 470.124)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.76",y:"604.602",width:"3.52187",height:"3.52708",transform:"rotate(45 1337.76 604.602)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.51",y:"357.892",width:"3.52187",height:"3.52708",transform:"rotate(45 1315.51 357.892)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1180.83",y:"492.57",width:"3.52187",height:"3.52708",transform:"rotate(45 1180.83 492.57)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.31",y:"627.048",width:"3.52187",height:"3.52708",transform:"rotate(45 1315.31 627.048)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1293.06",y:"380.339",width:"3.52187",height:"3.52709",transform:"rotate(45 1293.06 380.339)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1158.39",y:"515.016",width:"3.52187",height:"3.5271",transform:"rotate(45 1158.39 515.016)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1292.86",y:"649.494",width:"3.52187",height:"3.5271",transform:"rotate(45 1292.86 649.494)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.62",y:"402.785",width:"3.52187",height:"3.52709",transform:"rotate(45 1270.62 402.785)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1135.94",y:"537.462",width:"3.52187",height:"3.5271",transform:"rotate(45 1135.94 537.462)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.42",y:"671.941",width:"3.52187",height:"3.5271",transform:"rotate(45 1270.42 671.941)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1248.17",y:"425.231",width:"3.52187",height:"3.5271",transform:"rotate(45 1248.17 425.231)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1113.49",y:"559.909",width:"3.52187",height:"3.52707",transform:"rotate(45 1113.49 559.909)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1247.97",y:"694.387",width:"3.52187",height:"3.52707",transform:"rotate(45 1247.97 694.387)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1248.14",y:"470.09",width:"3.52187",height:"3.5271",transform:"rotate(45 1248.14 470.09)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.37",y:"357.859",width:"3.52187",height:"3.52709",transform:"rotate(45 1360.37 357.859)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1225.69",y:"492.537",width:"3.52187",height:"3.52708",transform:"rotate(45 1225.69 492.537)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.17",y:"627.015",width:"3.52187",height:"3.52708",transform:"rotate(45 1360.17 627.015)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.92",y:"380.306",width:"3.52187",height:"3.52708",transform:"rotate(45 1337.92 380.306)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1203.25",y:"514.983",width:"3.52187",height:"3.52708",transform:"rotate(45 1203.25 514.983)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.72",y:"649.461",width:"3.52187",height:"3.52708",transform:"rotate(45 1337.72 649.461)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.48",y:"402.752",width:"3.52187",height:"3.52709",transform:"rotate(45 1315.48 402.752)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1180.8",y:"537.429",width:"3.52187",height:"3.5271",transform:"rotate(45 1180.8 537.429)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.28",y:"671.907",width:"3.52187",height:"3.5271",transform:"rotate(45 1315.28 671.907)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1293.03",y:"425.198",width:"3.52187",height:"3.52709",transform:"rotate(45 1293.03 425.198)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1158.35",y:"559.875",width:"3.52187",height:"3.5271",transform:"rotate(45 1158.35 559.875)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1292.83",y:"694.354",width:"3.52187",height:"3.5271",transform:"rotate(45 1292.83 694.354)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.58",y:"447.644",width:"3.52187",height:"3.5271",transform:"rotate(45 1270.58 447.644)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1135.91",y:"582.322",width:"3.52187",height:"3.52707",transform:"rotate(45 1135.91 582.322)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.39",y:"716.8",width:"3.52187",height:"3.52707",transform:"rotate(45 1270.39 716.8)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.55",y:"492.503",width:"3.52187",height:"3.5271",transform:"rotate(45 1270.55 492.503)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1248.11",y:"514.95",width:"3.52187",height:"3.52708",transform:"rotate(45 1248.11 514.95)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.34",y:"402.719",width:"3.52187",height:"3.52708",transform:"rotate(45 1360.34 402.719)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1225.66",y:"537.396",width:"3.52187",height:"3.52708",transform:"rotate(45 1225.66 537.396)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.14",y:"671.874",width:"3.52185",height:"3.52708",transform:"rotate(45 1360.14 671.874)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.89",y:"425.165",width:"3.52187",height:"3.52709",transform:"rotate(45 1337.89 425.165)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1203.21",y:"559.842",width:"3.52187",height:"3.5271",transform:"rotate(45 1203.21 559.842)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.69",y:"694.32",width:"3.52185",height:"3.5271",transform:"rotate(45 1337.69 694.32)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.44",y:"447.611",width:"3.52187",height:"3.52709",transform:"rotate(45 1315.44 447.611)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1180.77",y:"582.288",width:"3.52187",height:"3.5271",transform:"rotate(45 1180.77 582.288)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.24",y:"716.767",width:"3.52185",height:"3.5271",transform:"rotate(45 1315.24 716.767)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1293",y:"470.057",width:"3.52187",height:"3.5271",transform:"rotate(45 1293 470.057)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1158.32",y:"604.735",width:"3.52187",height:"3.52707",transform:"rotate(45 1158.32 604.735)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1292.8",y:"739.213",width:"3.52185",height:"3.52707",transform:"rotate(45 1292.8 739.213)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1292.96",y:"514.917",width:"3.52187",height:"3.5271",transform:"rotate(45 1292.96 514.917)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.52",y:"537.363",width:"3.52187",height:"3.52708",transform:"rotate(45 1270.52 537.363)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1248.07",y:"559.809",width:"3.52187",height:"3.52708",transform:"rotate(45 1248.07 559.809)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.3",y:"447.578",width:"3.52187",height:"3.52709",transform:"rotate(45 1360.3 447.578)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1225.63",y:"582.255",width:"3.52187",height:"3.5271",transform:"rotate(45 1225.63 582.255)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.1",y:"716.733",width:"3.52185",height:"3.5271",transform:"rotate(45 1360.1 716.733)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.86",y:"470.024",width:"3.52187",height:"3.52709",transform:"rotate(45 1337.86 470.024)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1203.18",y:"604.701",width:"3.52187",height:"3.5271",transform:"rotate(45 1203.18 604.701)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.66",y:"739.18",width:"3.52185",height:"3.5271",transform:"rotate(45 1337.66 739.18)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.41",y:"492.47",width:"3.52187",height:"3.5271",transform:"rotate(45 1315.41 492.47)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1180.73",y:"627.148",width:"3.52187",height:"3.52707",transform:"rotate(45 1180.73 627.148)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.21",y:"761.626",width:"3.52185",height:"3.52707",transform:"rotate(45 1315.21 761.626)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.38",y:"537.33",width:"3.52187",height:"3.5271",transform:"rotate(45 1315.38 537.33)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1292.93",y:"559.776",width:"3.52187",height:"3.52708",transform:"rotate(45 1292.93 559.776)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.49",y:"582.222",width:"3.52187",height:"3.52708",transform:"rotate(45 1270.49 582.222)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1248.04",y:"604.668",width:"3.52187",height:"3.5271",transform:"rotate(45 1248.04 604.668)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.27",y:"492.437",width:"3.52187",height:"3.52709",transform:"rotate(45 1360.27 492.437)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1225.59",y:"627.115",width:"3.52187",height:"3.5271",transform:"rotate(45 1225.59 627.115)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.07",y:"761.593",width:"3.52188",height:"3.5271",transform:"rotate(45 1360.07 761.593)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.82",y:"514.883",width:"3.52187",height:"3.5271",transform:"rotate(45 1337.82 514.883)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1203.15",y:"649.561",width:"3.52187",height:"3.52707",transform:"rotate(45 1203.15 649.561)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1337.79",y:"559.743",width:"3.52187",height:"3.5271",transform:"rotate(45 1337.79 559.743)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1315.34",y:"582.189",width:"3.52187",height:"3.52708",transform:"rotate(45 1315.34 582.189)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1292.9",y:"604.635",width:"3.52187",height:"3.52708",transform:"rotate(45 1292.9 604.635)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1270.45",y:"627.081",width:"3.52187",height:"3.5271",transform:"rotate(45 1270.45 627.081)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1248.01",y:"649.528",width:"3.52187",height:"3.5271",transform:"rotate(45 1248.01 649.528)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1360.24",y:"537.296",width:"3.52187",height:"3.5271",transform:"rotate(45 1360.24 537.296)",fill:"var(--button-bg)"}),M.createElement("rect",{x:"1225.56",y:"671.974",width:"3.52187",height:"3.52707",transform:"rotate(45 1225.56 671.974)",fill:"var(--button-bg)"})),M.createElement("g",{opacity:"0.08"},M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 15.0962 314.034)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10335",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 37.024 335.994)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 15.0962 270.113)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 37.024 292.074)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10335",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 58.9517 314.034)",fill:"var(--button-bg)"}),M.createElement("circle",{r:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 15.0962 226.193)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 37.024 248.153)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 58.9517 270.113)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10335",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 80.8794 292.074)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 15.0962 182.273)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 37.024 204.233)",fill:"var(--button-bg)"}),M.createElement("circle",{r:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 58.9517 226.193)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 80.8794 248.153)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10335",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 102.807 270.113)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 15.0962 138.352)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 37.024 160.312)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 58.9517 182.273)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 80.8794 204.233)",fill:"var(--button-bg)"}),M.createElement("circle",{r:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 102.807 226.193)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10334",ry:"3.10335",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 124.735 248.153)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10335",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 37.024 116.392)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10335",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 58.9517 138.352)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10335",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 80.8794 160.312)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10335",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 102.807 182.273)",fill:"var(--button-bg)"}),M.createElement("ellipse",{rx:"3.10335",ry:"3.10334",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 124.735 204.233)",fill:"var(--button-bg)"}),M.createElement("circle",{r:"3.10335",transform:"matrix(0.706583 -0.70763 0.706583 0.70763 146.662 226.193)",fill:"var(--button-bg)"})),M.createElement("rect",{width:"167",height:"1024",fill:"url(#paint3_linear)"}),M.createElement("rect",{x:"1366",y:"1024",width:"188",height:"1024",transform:"rotate(180 1366 1024)",fill:"url(#paint4_linear)"})),M.createElement("defs",null,M.createElement("linearGradient",{id:"paint0_linear",x1:"452.595",y1:"1171.11",x2:"452.595",y2:"487.89",gradientUnits:"userSpaceOnUse"},M.createElement("stop",{stopColor:"#0058CC",stopOpacity:"0"}),M.createElement("stop",{offset:"1",stopColor:"#0058CC"})),M.createElement("linearGradient",{id:"paint1_linear",x1:"435.691",y1:"1080.92",x2:"435.691",y2:"399.944",gradientUnits:"userSpaceOnUse"},M.createElement("stop",{stopColor:"#0058CC",stopOpacity:"0"}),M.createElement("stop",{offset:"1",stopColor:"#0058CC"})),M.createElement("linearGradient",{id:"paint2_linear",x1:"415.405",y1:"995.22",x2:"415.405",y2:"312",gradientUnits:"userSpaceOnUse"},M.createElement("stop",{stopColor:"#0058CC",stopOpacity:"0"}),M.createElement("stop",{offset:"1",stopColor:"#0058CC"})),M.createElement("linearGradient",{id:"paint3_linear",x1:"-8.48718e-07",y1:"439",x2:"158.46",y2:"439",gradientUnits:"userSpaceOnUse"},M.createElement("stop",{stopColor:"var(--center-channel-bg)"}),M.createElement("stop",{offset:"1",stopColor:"var(--center-channel-bg)",stopOpacity:"0"})),M.createElement("linearGradient",{id:"paint4_linear",x1:"1366",y1:"1463",x2:"1544.39",y2:"1463",gradientUnits:"userSpaceOnUse"},M.createElement("stop",{stopColor:"var(--center-channel-bg)"}),M.createElement("stop",{offset:"1",stopColor:"var(--center-channel-bg)",stopOpacity:"0"})))),Km=()=>M.createElement("svg",{viewBox:"0 0 329 273",fill:"none",xmlns:"http://www.w3.org/2000/svg"},M.createElement("g",{filter:"url(#filter0_f)"},M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M324.682 11.9045C324.687 11.0023 324.514 10.1079 324.173 9.27253C323.832 8.43715 323.329 7.67714 322.695 7.03593C322.06 6.39473 321.305 5.88489 320.473 5.53555C319.641 5.18622 318.748 5.00423 317.846 5H12.8364C11.0143 5.00977 9.27061 5.74255 7.98869 7.03727C6.70676 8.33199 5.99148 10.0827 6.00008 11.9045V195H6V216.651C6 218.464 6.72025 220.203 8.0023 221.484C9.28436 222.766 11.0232 223.486 12.8363 223.486H126.93L123.5 253H206L201.492 223.486H315C321.432 223.491 324.686 220.871 324.682 214C324.681 213.275 324.682 201.333 324.682 196.761C324.682 195.671 324.682 195 324.682 195L324.682 11.9045Z",fill:"var(--center-channel-color)",fillOpacity:"0.08"})),M.createElement("path",{d:"M160.507 260.921C242.251 260.921 308.518 258.651 308.518 255.849C308.518 253.048 242.251 250.777 160.507 250.777C78.7621 250.777 12.4951 253.048 12.4951 255.849C12.4951 258.651 78.7621 260.921 160.507 260.921Z",fill:"var(--center-channel-color)",fillOpacity:"0.08"}),M.createElement("path",{opacity:"0.1",d:"M202.208 253.482H161.135L119.979 252.955L120.224 250.845H201.802L202.208 253.482Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M202.287 254.008L119.979 252.955L120.224 250.844L124.201 216.026H196.485L201.802 250.844L202.208 253.482L202.287 254.008Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M319.682 6.90452C319.687 6.00227 319.514 5.1079 319.173 4.27253C318.832 3.43715 318.329 2.67714 317.695 2.03593C317.06 1.39473 316.305 0.88489 315.473 0.535554C314.641 0.186219 313.748 0.00423428 312.846 0H7.83636C6.01426 0.00977462 4.27061 0.74255 2.98869 2.03727C1.70676 3.33199 0.991479 5.08269 1.00008 6.90452V191.761H319.682V6.90452Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M202.287 254.008L119.979 252.955L120.224 250.844L124.201 216.026H196.485L201.802 250.844L202.208 253.482L202.287 254.008Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{d:"M215.479 251.371H106.26V254.008H215.479V251.371Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M215.479 251.371H106.26V254.008H215.479V251.371Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{opacity:"0.1",d:"M169.048 218.4L201.885 251.371L196.846 218.4H169.048Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M319.682 6.90452C319.687 6.00227 319.514 5.1079 319.173 4.27253C318.832 3.43715 318.329 2.67714 317.695 2.03593C317.06 1.39473 316.305 0.88489 315.473 0.535554C314.641 0.186219 313.748 0.00423428 312.846 0H7.83636C6.01426 0.00977462 4.27061 0.74255 2.98869 2.03727C1.70676 3.33199 0.991479 5.08269 1.00008 6.90452V191.761H319.682V6.90452Z",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),M.createElement("path",{d:"M1 189.914V211.565C1 213.378 1.72025 215.116 3.0023 216.398C4.28436 217.68 6.02319 218.4 7.83629 218.4H312.846C313.743 218.401 314.633 218.224 315.462 217.881C316.292 217.538 317.046 217.034 317.681 216.399C318.316 215.765 318.819 215.011 319.163 214.181C319.506 213.352 319.682 212.463 319.682 211.565V189.914H1Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M1 190V211.651C1 213.464 1.72025 215.202 3.0023 216.484C4.28436 217.766 6.02319 218.486 7.83629 218.486H312.846C313.743 218.487 314.633 218.311 315.462 217.967C316.292 217.624 317.046 217.121 317.681 216.486C318.316 215.851 318.819 215.097 319.163 214.268C319.506 213.438 319.682 212.549 319.682 211.651V190H1Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{d:"M308.074 11.6061H14.1924V177.781H308.074V11.6061Z",fill:"var(--center-channel-bg)"}),M.createElement("circle",{cx:"160.5",cy:"204.5",r:"7.5",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M91 257.109C99.2843 257.109 106 256.438 106 255.609C106 254.781 99.2843 254.109 91 254.109C82.7157 254.109 76 254.781 76 255.609C76 256.438 82.7157 257.109 91 257.109Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{d:"M90.6655 256.388C91.6247 256.388 92.4023 255.371 92.4023 254.116C92.4023 252.861 91.6247 251.843 90.6655 251.843C89.7063 251.843 88.9287 252.861 88.9287 254.116C88.9287 255.371 89.7063 256.388 90.6655 256.388Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 253.612C91.6247 253.612 92.4023 252.595 92.4023 251.34C92.4023 250.085 91.6247 249.068 90.6655 249.068C89.7063 249.068 88.9287 250.085 88.9287 251.34C88.9287 252.595 89.7063 253.612 90.6655 253.612Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 250.832C91.6247 250.832 92.4023 249.815 92.4023 248.56C92.4023 247.305 91.6247 246.288 90.6655 246.288C89.7063 246.288 88.9287 247.305 88.9287 248.56C88.9287 249.815 89.7063 250.832 90.6655 250.832Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 248.056C91.6247 248.056 92.4023 247.039 92.4023 245.784C92.4023 244.529 91.6247 243.512 90.6655 243.512C89.7063 243.512 88.9287 244.529 88.9287 245.784C88.9287 247.039 89.7063 248.056 90.6655 248.056Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 245.276C91.6247 245.276 92.4023 244.259 92.4023 243.004C92.4023 241.749 91.6247 240.732 90.6655 240.732C89.7063 240.732 88.9287 241.749 88.9287 243.004C88.9287 244.259 89.7063 245.276 90.6655 245.276Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 242.5C91.6247 242.5 92.4023 241.483 92.4023 240.228C92.4023 238.973 91.6247 237.956 90.6655 237.956C89.7063 237.956 88.9287 238.973 88.9287 240.228C88.9287 241.483 89.7063 242.5 90.6655 242.5Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 239.72C91.6247 239.72 92.4023 238.703 92.4023 237.448C92.4023 236.193 91.6247 235.176 90.6655 235.176C89.7063 235.176 88.9287 236.193 88.9287 237.448C88.9287 238.703 89.7063 239.72 90.6655 239.72Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M97.1646 218.438C97.4016 218.137 97.6177 217.819 97.8113 217.487L93.2476 216.739L98.1808 216.776C98.6542 215.746 98.9127 214.63 98.9405 213.497C98.9683 212.364 98.7648 211.237 98.3425 210.185L91.7187 213.621L97.8251 209.132C97.2518 208.147 96.4821 207.29 95.5636 206.615C94.6452 205.94 93.5977 205.461 92.4863 205.208C91.3749 204.955 90.2233 204.933 89.1029 205.143C87.9826 205.354 86.9176 205.792 85.9739 206.432C85.0303 207.071 84.2283 207.898 83.6177 208.86C83.0071 209.823 82.6009 210.9 82.4245 212.026C82.2481 213.152 82.3051 214.303 82.592 215.406C82.879 216.509 83.3897 217.541 84.0925 218.438C83.7225 218.91 83.4036 219.419 83.141 219.958L89.0673 223.034L82.7484 220.914C82.4585 221.774 82.3103 222.676 82.3096 223.583C82.3061 225.449 82.9345 227.261 84.0925 228.724C83.129 229.95 82.5299 231.423 82.3638 232.974C82.1977 234.524 82.4712 236.091 83.1532 237.493C83.8351 238.896 84.898 240.079 86.2203 240.906C87.5426 241.733 89.071 242.172 90.6309 242.172C92.1907 242.172 93.7192 241.733 95.0415 240.906C96.3638 240.079 97.4266 238.896 98.1086 237.493C98.7905 236.091 99.0641 234.524 98.898 232.974C98.7319 231.423 98.1328 229.95 97.1692 228.724C98.3228 227.257 98.9495 225.446 98.9487 223.58C98.9478 221.715 98.3195 219.904 97.1646 218.438Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M82.3096 223.579C82.3061 225.444 82.9345 227.256 84.0926 228.719C83.129 229.946 82.5299 231.418 82.3638 232.969C82.1977 234.52 82.4712 236.086 83.1532 237.489C83.8351 238.892 84.898 240.074 86.2203 240.901C87.5426 241.729 89.071 242.168 90.6309 242.168C92.1907 242.168 93.7192 241.729 95.0415 240.901C96.3638 240.074 97.4266 238.892 98.1086 237.489C98.7905 236.086 99.0641 234.52 98.898 232.969C98.7319 231.418 98.1328 229.946 97.1692 228.719C98.2824 227.306 82.3096 222.646 82.3096 223.579Z",fill:"var(--center-channel-color)"}),M.createElement("rect",{x:"83",y:"49",width:"154",height:"8",rx:"4",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M83 53C83 50.7909 84.7909 49 87 49H95C97.2091 49 99 50.7909 99 53C99 55.2091 97.2091 57 95 57H87C84.7909 57 83 55.2091 83 53Z",fill:"var(--online-indicator)"}),M.createElement("rect",{x:"83",y:"70",width:"154",height:"8",rx:"4",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M83 74C83 71.7909 84.7909 70 87 70H151C153.209 70 155 71.7909 155 74C155 76.2091 153.209 78 151 78H87C84.7909 78 83 76.2091 83 74Z",fill:"var(--online-indicator)"}),M.createElement("rect",{x:"83",y:"97",width:"154",height:"8",rx:"4",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M83 101C83 98.7909 84.7909 97 87 97H119C121.209 97 123 98.7909 123 101C123 103.209 121.209 105 119 105H87C84.7909 105 83 103.209 83 101Z",fill:"var(--online-indicator)"}),M.createElement("path",{d:"M141 124C141 121.791 142.791 120 145 120H179C181.209 120 183 121.791 183 124V129C183 131.209 181.209 133 179 133H145C142.791 133 141 131.209 141 129V124Z",fill:"var(--button-bg)"}),M.createElement("path",{opacity:"0.1",d:"M168.541 218.459L201.378 251.43L196.339 218.459H168.541Z",fill:"var(--center-channel-color)"}),M.createElement("path",{opacity:"0.1",d:"M307.655 11.683H13.4543V21.3909H307.655V11.683Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M23.2238 13.3734H15.5007C15.3017 13.3734 15.1404 13.5347 15.1404 13.7337V18.9202C15.1404 19.1191 15.3017 19.2804 15.5007 19.2804H23.2238C23.4228 19.2804 23.5841 19.1191 23.5841 18.9202V13.7337C23.5841 13.5347 23.4228 13.3734 23.2238 13.3734Z",fill:"var(--sidebar-bg)"}),M.createElement("path",{opacity:"0.3",d:"M203.974 13.3734H115.869C115.721 13.3734 115.601 13.4934 115.601 13.6413V19.0125C115.601 19.1605 115.721 19.2804 115.869 19.2804H203.974C204.122 19.2804 204.242 19.1605 204.242 19.0125V13.6413C204.242 13.4934 204.122 13.3734 203.974 13.3734Z",fill:"var(--sidebar-bg)"}),M.createElement("path",{d:"M201.609 16.9342H201.392L201.314 16.8696C201.582 16.5463 201.731 16.1399 201.734 15.7196C201.732 15.3734 201.628 15.0355 201.434 14.7487C201.24 14.4619 200.965 14.239 200.645 14.1082C200.324 13.9774 199.972 13.9446 199.633 14.0139C199.294 14.0832 198.982 14.2516 198.739 14.4977C198.495 14.7438 198.33 15.0565 198.265 15.3964C198.199 15.7363 198.235 16.088 198.369 16.4072C198.504 16.7263 198.73 16.9985 199.018 17.1893C199.307 17.3801 199.646 17.481 199.993 17.4792C200.411 17.4728 200.815 17.3247 201.138 17.0589L201.217 17.1236V17.3406L202.57 18.6938L202.972 18.2874L201.609 16.9342ZM199.993 16.9342C199.751 16.9351 199.515 16.8643 199.313 16.7307C199.112 16.597 198.955 16.4066 198.862 16.1837C198.769 15.9607 198.745 15.7152 198.792 15.4782C198.839 15.2413 198.955 15.0236 199.126 14.8528C199.296 14.682 199.514 14.5658 199.751 14.5189C199.988 14.472 200.234 14.4965 200.457 14.5894C200.68 14.6823 200.87 14.8392 201.004 15.0404C201.137 15.2417 201.208 15.478 201.207 15.7196C201.209 15.8794 201.178 16.0379 201.117 16.1858C201.057 16.3338 200.967 16.4681 200.854 16.5812C200.741 16.6942 200.607 16.7836 200.459 16.8443C200.311 16.9049 200.152 16.9354 199.993 16.9342Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M303.433 19.2803C305.065 19.2803 306.389 17.9569 306.389 16.3245C306.389 14.6921 305.065 13.3687 303.433 13.3687C301.8 13.3687 300.477 14.6921 300.477 16.3245C300.477 17.9569 301.8 19.2803 303.433 19.2803Z",fill:"var(--sidebar-bg)"}),M.createElement("g",{opacity:"0.1"},M.createElement("path",{opacity:"0.1",d:"M212.363 196.392C212.483 196.192 212.677 196.047 212.903 195.99C213.134 195.958 213.203 196.253 213.116 196.452C213.938 198.761 214.778 201.14 216.178 203.176C216.645 203.776 217.061 204.414 217.421 205.084C217.684 205.718 217.894 206.373 218.049 207.042C218.788 209.439 219.787 211.748 221.028 213.928C221.184 214.209 221.272 214.521 221.288 214.841C221.303 215.162 221.244 215.481 221.116 215.775C220.525 217.069 221.005 218.343 221.264 219.609C221.619 221.378 221.55 223.211 221.633 224.998C221.633 225.557 221.633 226.116 221.665 226.675C221.726 227.878 221.712 229.085 221.624 230.286C221.527 231.122 221.324 231.944 221.162 232.767C219.555 240.484 221.301 248.617 221.887 256.482C221.928 256.964 221.821 257.447 221.582 257.868C220.88 259.064 221.222 260.408 221.582 261.659C221.794 262.712 222.224 263.71 222.843 264.587C223.023 264.788 223.178 265.01 223.305 265.248C223.532 265.747 223.305 266.338 223.13 266.86C224.381 267.061 225.642 267.195 226.908 267.262C225.266 267.275 223.626 267.141 222.007 266.86C222.164 266.338 222.405 265.747 222.178 265.248C222.047 265.007 221.884 264.785 221.693 264.587C221.077 263.708 220.648 262.711 220.432 261.659C220.09 260.408 219.749 259.064 220.432 257.868C220.673 257.448 220.78 256.965 220.742 256.482C220.155 248.631 218.404 240.484 220.016 232.767C220.187 231.944 220.391 231.122 220.478 230.286C220.565 229.085 220.581 227.879 220.525 226.675C220.525 226.116 220.501 225.557 220.488 224.998C220.404 223.211 220.488 221.378 220.118 219.609C219.864 218.343 219.384 217.069 219.975 215.775C220.102 215.481 220.16 215.162 220.145 214.842C220.13 214.521 220.042 214.209 219.887 213.928C218.643 211.749 217.642 209.44 216.903 207.042C216.748 206.373 216.538 205.718 216.275 205.084C215.915 204.415 215.501 203.777 215.037 203.176C213.697 201.232 212.871 198.997 212.085 196.771C212.187 196.655 212.27 196.521 212.363 196.392Z",fill:"var(--center-channel-color)"})),M.createElement("g",{opacity:"0.1"},M.createElement("path",{opacity:"0.1",d:"M192.57 176.611C192.568 176.625 192.568 176.639 192.57 176.653C192.768 176.962 193.249 176.782 193.554 176.57L195.087 175.512C197.134 175.793 199.203 175.892 201.267 175.808C207.138 175.725 213.014 175.956 218.871 176.367C220.829 176.505 222.848 176.653 224.696 176.002C225.619 175.669 226.497 175.143 227.467 174.875C227.802 174.813 228.125 174.697 228.423 174.533C228.534 174.838 228.64 175.143 228.737 175.457C228.954 176.154 229.098 177.022 228.562 177.517C228.239 177.755 227.863 177.914 227.467 177.978C226.506 178.242 225.619 178.773 224.696 179.105C222.848 179.757 220.829 179.609 218.871 179.47C213.014 179.059 207.138 178.828 201.267 178.911C199.206 178.994 197.14 178.893 195.096 178.611L193.563 179.673C193.258 179.886 192.778 180.066 192.579 179.757C192.516 179.634 192.492 179.496 192.51 179.359C192.531 178.445 192.551 177.529 192.57 176.611Z",fill:"var(--center-channel-color)"}),M.createElement("path",{opacity:"0.1",d:"M226.095 148.411C225.83 146.904 225.328 145.448 224.608 144.098L224.03 148.661C223.993 148.947 223.956 149.233 223.924 149.52C223.85 148.864 223.823 148.203 223.841 147.543C223.841 146.883 223.947 146.222 224.03 145.566L224.608 141.003C225.328 142.354 225.83 143.81 226.095 145.317C226.62 147.569 227.267 149.791 228.035 151.972C228.469 153.288 228.904 154.605 229.375 155.907C229.675 156.654 229.906 157.427 230.063 158.216C230.165 158.849 230.169 159.495 230.243 160.128C230.395 161.493 230.87 162.802 231.629 163.948C231.767 164.215 231.999 164.422 232.28 164.529C232.469 164.563 232.663 164.555 232.848 164.506C234.891 164.103 236.868 163.419 238.724 162.474C238.969 162.354 239.2 162.207 239.412 162.036C239.657 162.959 240.216 163.971 239.717 164.783C239.461 165.126 239.118 165.394 238.724 165.559C236.868 166.504 234.891 167.188 232.848 167.592C232.661 167.633 232.467 167.633 232.28 167.592C231.999 167.484 231.767 167.277 231.629 167.01C230.871 165.864 230.396 164.555 230.243 163.19C230.169 162.557 230.165 161.911 230.063 161.278C229.907 160.488 229.676 159.715 229.375 158.969C228.913 157.662 228.451 156.35 228.035 155.034C227.269 152.863 226.621 150.652 226.095 148.411Z",fill:"var(--center-channel-color)"}),M.createElement("path",{opacity:"0.1",d:"M225.62 160.987C225.62 161.19 225.62 161.398 225.62 161.606C225.629 161.398 225.624 161.195 225.62 160.987Z",fill:"var(--center-channel-color)"}),M.createElement("path",{opacity:"0.1",d:"M192.117 168.755C192.625 170.09 192.607 171.559 192.579 172.986C192.579 173.36 192.579 173.729 192.579 174.103C192.54 173.333 192.384 172.573 192.117 171.85C191.904 171.295 191.604 170.778 191.415 170.219C191.091 169.241 191.104 168.183 191.452 167.213C191.641 167.739 191.914 168.233 192.117 168.755Z",fill:"var(--center-channel-color)"}),M.createElement("path",{opacity:"0.1",d:"M167.871 137.346L168.135 137.004L169.52 139.313C170.079 140.345 170.763 141.303 171.557 142.167C172.366 143.033 173.467 143.568 174.647 143.668C175.392 143.661 176.129 143.52 176.823 143.252C180.056 142.167 182.99 140.444 186.061 138.976C186.606 138.66 187.216 138.473 187.844 138.431C188.163 138.425 188.475 138.522 188.733 138.709C188.991 138.895 189.182 139.161 189.276 139.465C189.627 141.234 189.974 142.998 190.454 144.735C190.913 146.379 191.336 148.028 191.724 149.681C191.985 150.696 192.17 151.729 192.279 152.771C192.329 153.362 192.334 153.958 192.339 154.549L192.408 161.722C192.408 161.827 192.399 161.932 192.38 162.036L192.339 157.643C192.339 157.048 192.339 156.457 192.279 155.865C192.17 154.823 191.985 153.791 191.724 152.776C191.33 151.122 190.907 149.473 190.454 147.829C189.992 146.093 189.627 144.329 189.276 142.555C189.182 142.251 188.991 141.986 188.733 141.8C188.474 141.615 188.162 141.518 187.844 141.525C187.208 141.559 186.588 141.741 186.034 142.056C182.976 143.525 180.029 145.248 176.795 146.328C176.102 146.599 175.364 146.742 174.62 146.749C173.439 146.648 172.338 146.114 171.53 145.248C170.737 144.383 170.053 143.424 169.493 142.393C168.934 141.447 168.37 140.505 167.807 139.558C167.492 139.031 167.072 138.422 167.248 137.83C167.506 137.746 167.726 137.575 167.871 137.346Z",fill:"var(--center-channel-color)"})),M.createElement("path",{d:"M91 257C99.2843 257 106 256.328 106 255.5C106 254.672 99.2843 254 91 254C82.7157 254 76 254.672 76 255.5C76 256.328 82.7157 257 91 257Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{d:"M90.6655 256.279C91.6247 256.279 92.4023 255.261 92.4023 254.007C92.4023 252.752 91.6247 251.734 90.6655 251.734C89.7063 251.734 88.9287 252.752 88.9287 254.007C88.9287 255.261 89.7063 256.279 90.6655 256.279Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 253.503C91.6247 253.503 92.4023 252.486 92.4023 251.231C92.4023 249.976 91.6247 248.959 90.6655 248.959C89.7063 248.959 88.9287 249.976 88.9287 251.231C88.9287 252.486 89.7063 253.503 90.6655 253.503Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 250.723C91.6247 250.723 92.4023 249.706 92.4023 248.451C92.4023 247.196 91.6247 246.178 90.6655 246.178C89.7063 246.178 88.9287 247.196 88.9287 248.451C88.9287 249.706 89.7063 250.723 90.6655 250.723Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 247.947C91.6247 247.947 92.4023 246.93 92.4023 245.675C92.4023 244.42 91.6247 243.403 90.6655 243.403C89.7063 243.403 88.9287 244.42 88.9287 245.675C88.9287 246.93 89.7063 247.947 90.6655 247.947Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 245.167C91.6247 245.167 92.4023 244.15 92.4023 242.895C92.4023 241.64 91.6247 240.622 90.6655 240.622C89.7063 240.622 88.9287 241.64 88.9287 242.895C88.9287 244.15 89.7063 245.167 90.6655 245.167Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 242.391C91.6247 242.391 92.4023 241.374 92.4023 240.119C92.4023 238.864 91.6247 237.847 90.6655 237.847C89.7063 237.847 88.9287 238.864 88.9287 240.119C88.9287 241.374 89.7063 242.391 90.6655 242.391Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M90.6655 239.611C91.6247 239.611 92.4023 238.594 92.4023 237.339C92.4023 236.084 91.6247 235.067 90.6655 235.067C89.7063 235.067 88.9287 236.084 88.9287 237.339C88.9287 238.594 89.7063 239.611 90.6655 239.611Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M97.1646 218.329C97.4016 218.027 97.6177 217.71 97.8113 217.378L93.2476 216.63L98.1808 216.667C98.6542 215.637 98.9127 214.521 98.9405 213.388C98.9683 212.255 98.7648 211.128 98.3425 210.076L91.7187 213.512L97.8251 209.023C97.2518 208.038 96.4821 207.181 95.5636 206.506C94.6452 205.831 93.5977 205.352 92.4863 205.099C91.3749 204.845 90.2233 204.823 89.1029 205.034C87.9826 205.244 86.9176 205.683 85.9739 206.323C85.0303 206.962 84.2283 207.789 83.6177 208.751C83.0071 209.714 82.6009 210.791 82.4245 211.917C82.2481 213.043 82.3051 214.194 82.592 215.297C82.879 216.4 83.3897 217.432 84.0925 218.329C83.7225 218.801 83.4036 219.31 83.141 219.849L89.0673 222.925L82.7484 220.805C82.4585 221.665 82.3103 222.567 82.3096 223.474C82.3061 225.34 82.9345 227.152 84.0925 228.615C83.129 229.841 82.5299 231.314 82.3638 232.865C82.1977 234.415 82.4712 235.982 83.1532 237.384C83.8351 238.787 84.898 239.97 86.2203 240.797C87.5426 241.624 89.071 242.063 90.6309 242.063C92.1907 242.063 93.7192 241.624 95.0415 240.797C96.3638 239.97 97.4266 238.787 98.1086 237.384C98.7905 235.982 99.0641 234.415 98.898 232.865C98.7319 231.314 98.1328 229.841 97.1692 228.615C98.3228 227.148 98.9495 225.337 98.9487 223.471C98.9478 221.606 98.3195 219.795 97.1646 218.329Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M82.3096 223.47C82.3061 225.335 82.9345 227.147 84.0926 228.61C83.129 229.836 82.5299 231.309 82.3638 232.86C82.1977 234.411 82.4712 235.977 83.1532 237.38C83.8351 238.782 84.898 239.965 86.2203 240.792C87.5426 241.62 89.071 242.058 90.6309 242.058C92.1907 242.058 93.7192 241.62 95.0415 240.792C96.3638 239.965 97.4266 238.782 98.1086 237.38C98.7905 235.977 99.0641 234.411 98.898 232.86C98.7319 231.309 98.1328 229.836 97.1692 228.61C98.2824 227.197 82.3096 222.537 82.3096 223.47Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M217.88 272.454C241.49 272.454 260.63 269.584 260.63 266.044C260.63 262.503 241.49 259.633 217.88 259.633C194.27 259.633 175.13 262.503 175.13 266.044C175.13 269.584 194.27 272.454 217.88 272.454Z",fill:"var(--center-channel-color)",fillOpacity:"0.08"}),M.createElement("path",{d:"M238.648 180.266C238.62 179.472 238.523 178.677 238.426 177.888C238.07 174.923 237.705 171.958 237.128 169.034C237.026 168.464 236.871 167.904 236.666 167.362C236.458 166.85 236.172 166.379 235.955 165.871C235.957 165.852 235.957 165.834 235.955 165.815C236.223 165.686 236.486 165.556 236.745 165.418C236.932 165.323 237.111 165.213 237.281 165.09C237.451 164.967 237.594 164.81 237.701 164.628C238.163 163.815 237.645 162.781 237.41 161.857C237.16 160.864 237.216 159.673 236.486 159.008C233.881 156.698 235.174 151.988 233.872 148.681C233.641 148.104 233.377 147.535 233.179 146.944C233.026 146.482 232.92 146.021 232.809 145.559C231.885 141.71 230.912 137.878 229.89 134.064C228.814 130.11 228.929 125.991 227.58 122.13C227.326 121.329 226.993 120.556 226.587 119.82C226.136 119.054 225.524 118.394 224.795 117.885C222.827 116.527 220.846 115.368 218.536 114.874C216.227 114.38 213.732 114.458 211.377 114.468C210.533 113.297 209.373 112.392 208.032 111.858L207.991 111.738C207.802 111.27 207.657 110.787 207.557 110.293C207.481 109.804 207.442 109.309 207.441 108.815C207.441 108.284 207.418 107.748 207.404 107.217L207.533 107.092C207.843 106.766 208.127 106.417 208.383 106.048C208.631 105.7 208.847 105.331 209.03 104.944C209.237 104.506 209.413 104.054 209.557 103.591C209.837 102.656 210.028 101.695 210.125 100.723C210.249 99.5824 210.286 98.414 210.319 97.2732C210.319 97.0423 210.319 96.8114 210.319 96.5759V96.405C210.319 96.2202 210.319 96.0401 210.319 95.86V95.8C210.357 94.6204 210.059 93.4543 209.46 92.4378C208.624 91.1908 207.192 90.5904 205.81 90.0916C203.039 89.131 199.995 88.4983 197.256 89.5282C195.08 90.3502 193.344 92.1422 191.196 93.052C191.245 93.1342 191.29 93.219 191.33 93.306C191.33 93.3183 191.33 93.3307 191.33 93.343C191.367 93.4261 191.399 93.5046 191.427 93.5878C191.496 93.7747 191.547 93.9681 191.579 94.1651C191.641 94.5381 191.641 94.9189 191.579 95.2919C190.931 95.5824 190.214 95.6879 189.51 95.5968C189.776 96.4665 190.219 97.2717 190.812 97.9614C191.002 98.2015 191.2 98.4232 191.39 98.6772L191.681 99.0375C192.176 99.6179 192.579 100.27 192.877 100.973C192.986 101.25 193.062 101.54 193.103 101.836C193.191 102.423 193.168 103.097 193.247 103.684C193.276 103.936 193.34 104.183 193.436 104.418C193.613 105.635 194.077 106.792 194.79 107.793C195.504 108.795 196.445 109.612 197.538 110.177C197.838 112.003 197.838 113.866 197.538 115.691C197.538 115.793 197.501 115.895 197.478 115.996C196.221 117.58 195.016 119.252 193.468 120.49C192.764 121.041 192.011 121.527 191.219 121.94C190.753 122.209 190.255 122.415 189.736 122.554C189.154 122.688 188.544 122.67 187.967 122.813C186.851 123.167 185.912 123.931 185.339 124.951C185.047 125.491 184.723 126.012 184.369 126.512C184.045 126.914 183.639 127.242 183.297 127.625C182.059 129.011 181.722 131.015 181.449 132.89C180.487 133.954 179.431 134.929 178.294 135.805C177.939 136.087 177.544 136.316 177.121 136.484C176.031 136.848 174.835 136.382 173.888 135.68C172.941 134.978 172.202 134.054 171.287 133.334L171.047 133.689C170.979 133.622 170.915 133.549 170.858 133.472C170.483 132.944 170.223 132.343 170.096 131.708C169.763 130.004 170.391 128.18 169.902 126.522C169.721 125.921 169.287 125.302 168.687 125.316C168.086 125.33 167.712 125.931 167.195 126.212C166.363 126.674 165.347 126.254 164.525 125.797C163.703 125.339 162.765 124.827 161.864 125.099C161.847 125.397 161.9 125.694 162.02 125.967C162.14 126.24 162.322 126.481 162.553 126.669C163.017 127.037 163.397 127.498 163.67 128.023C163.805 128.596 163.857 129.185 163.823 129.773C163.915 131.122 164.747 132.281 165.55 133.334C166.548 134.612 167.592 135.852 168.682 137.056C168.551 137.286 168.346 137.463 168.1 137.56C168.038 137.779 168.038 138.01 168.1 138.229C168.146 138.38 168.204 138.527 168.276 138.668C168.382 138.885 168.511 139.098 168.622 139.296L170.243 142.146L170.507 142.608C170.617 142.802 170.728 142.986 170.844 143.176C171.226 143.839 171.68 144.459 172.197 145.023C172.455 145.294 172.74 145.539 173.047 145.753C173.247 145.896 173.459 146.023 173.68 146.131C173.989 146.289 174.319 146.403 174.659 146.469C174.826 146.504 174.996 146.526 175.167 146.533C175.344 146.547 175.522 146.547 175.699 146.533C176.231 146.459 176.753 146.324 177.255 146.131C180.345 145.046 183.181 143.314 186.119 141.841C186.523 141.615 186.957 141.447 187.408 141.342C187.56 141.313 187.715 141.301 187.87 141.305C188.027 141.31 188.182 141.336 188.332 141.384C188.479 141.433 188.619 141.503 188.747 141.592C189.007 141.766 189.187 142.034 189.251 142.34C189.339 142.802 189.422 143.231 189.505 143.674C189.588 144.118 189.681 144.561 189.773 145.005C189.958 145.887 190.156 146.769 190.387 147.642C190.512 148.104 190.632 148.593 190.752 149.073C191.048 150.246 191.339 151.429 191.607 152.611C191.69 152.981 191.768 153.355 191.842 153.724C191.98 154.381 192.079 155.046 192.138 155.715C192.14 155.73 192.14 155.746 192.138 155.761C192.184 156.343 192.189 156.92 192.193 157.502V159.326L192.24 164.711C192.24 165.487 191.824 165.972 191.496 166.67C191.431 166.813 191.371 166.96 191.32 167.108C191.258 167.296 191.207 167.487 191.168 167.681C191.168 167.741 191.14 167.806 191.131 167.866C191.122 167.926 191.131 168.009 191.103 168.078C191.076 168.147 191.103 168.217 191.08 168.281C191.057 168.346 191.08 168.42 191.08 168.485C191.08 168.549 191.08 168.632 191.08 168.706C191.08 168.78 191.08 168.836 191.08 168.896C191.08 168.956 191.08 169.057 191.08 169.136C191.08 169.214 191.08 169.251 191.08 169.307C191.08 169.362 191.112 169.487 191.126 169.579L191.154 169.718C191.186 169.852 191.219 169.986 191.265 170.119C191.357 170.397 191.473 170.669 191.593 170.937C191.713 171.205 191.833 171.477 191.935 171.754C191.999 171.93 192.055 172.109 192.101 172.29C192.112 172.331 192.122 172.373 192.129 172.415C192.166 172.558 192.198 172.701 192.226 172.849V172.951C192.253 173.108 192.276 173.269 192.295 173.412C192.297 173.431 192.297 173.449 192.295 173.468C192.295 173.648 192.332 173.828 192.341 174.008C192.383 174.664 192.373 175.334 192.341 175.994L192.286 179.282V179.384C192.281 179.487 192.303 179.589 192.35 179.68C192.384 179.731 192.429 179.774 192.483 179.803C192.538 179.832 192.598 179.847 192.66 179.846C192.894 179.829 193.118 179.742 193.302 179.596L194.771 178.53H194.863C193.704 180.428 192.775 182.52 192.595 184.751C192.525 186.224 192.62 187.7 192.877 189.152C194.23 198.851 197.418 208.637 196.748 218.428C196.485 222.284 198.083 226.044 198.073 229.905C198.073 231.406 197.819 232.893 197.755 234.389C197.473 240.818 200.753 247.321 199.418 253.602C199.88 255.163 201.63 255.994 202.124 257.546C202.54 258.862 201.94 260.262 201.455 261.55C201.28 261.999 201.146 262.463 201.053 262.936C199.709 262.936 198.217 262.963 197.321 263.338C197.072 263.419 196.83 263.518 196.595 263.633C195.769 264.127 195.713 265.48 196.235 266.298C196.757 267.115 199.69 269.725 200.549 270.154L202.429 271.078C203.438 271.648 204.529 272.059 205.663 272.297C206.617 272.403 207.581 272.385 208.531 272.242C209.266 272.163 210.079 272.043 210.554 271.443C211.224 270.593 210.882 269.212 210.425 267.984C210.594 267.849 210.725 267.672 210.804 267.471C210.885 267.149 210.927 266.819 210.928 266.487C211.064 265.845 211.285 265.224 211.584 264.64C212.356 262.76 212.323 260.645 212.277 258.599C212.286 255.273 212.057 251.95 211.594 248.656C211.363 247.27 211.049 245.885 210.781 244.499C209.795 239.481 209.372 234.37 209.52 229.258C209.536 228.017 209.363 226.78 209.007 225.591C208.855 224.905 208.815 224.198 208.887 223.499L209.441 215.043C209.599 213.323 209.625 211.594 209.52 209.87C209.441 208.946 209.289 208.023 209.196 207.099C209.056 205.338 209.027 203.571 209.109 201.806C209.159 199.908 209.247 197.872 210.333 196.347C210.388 196.25 210.462 196.164 210.551 196.095C210.64 196.026 210.741 195.975 210.85 195.946C211.072 195.913 211.136 196.214 211.053 196.408C211.169 196.759 211.289 197.105 211.409 197.456C211.446 197.557 211.478 197.654 211.515 197.751C211.575 197.932 211.64 198.112 211.704 198.292C211.769 198.472 211.797 198.541 211.838 198.666L212.019 199.128C212.069 199.266 212.125 199.4 212.176 199.534C212.226 199.668 212.291 199.825 212.351 199.968C212.411 200.111 212.471 200.255 212.536 200.398C212.601 200.541 212.647 200.661 212.707 200.795L212.929 201.257C212.984 201.372 213.039 201.492 213.099 201.608C213.159 201.723 213.28 201.945 213.372 202.111C213.423 202.208 213.474 202.305 213.529 202.398C213.677 202.656 213.829 202.906 213.991 203.155C214.305 203.617 214.642 204.079 214.915 204.573C215.011 204.735 215.097 204.903 215.173 205.076C215.429 205.714 215.632 206.372 215.779 207.044C215.94 207.653 216.13 208.249 216.337 208.836C216.545 209.422 216.799 210.009 217.026 210.581C217.15 210.868 217.28 211.154 217.409 211.436C217.797 212.29 218.217 213.131 218.642 213.962C218.717 214.109 218.776 214.264 218.818 214.424C218.839 214.501 218.856 214.58 218.869 214.659C218.886 214.813 218.886 214.968 218.869 215.121C218.864 215.218 218.851 215.313 218.832 215.408C218.804 215.55 218.762 215.689 218.707 215.823C218.139 217.121 218.596 218.4 218.846 219.675C219.064 221.019 219.169 222.378 219.16 223.739C219.16 224.201 219.16 224.663 219.201 225.092C219.201 225.656 219.201 226.215 219.234 226.778C219.266 227.342 219.234 227.988 219.266 228.593C219.276 229.199 219.251 229.805 219.192 230.408C219.192 230.621 219.137 230.829 219.104 231.036C219.003 231.66 218.859 232.279 218.735 232.884C218.274 235.319 218.06 237.795 218.097 240.273C218.097 241.268 218.13 242.264 218.194 243.261C218.25 244.264 218.328 245.261 218.416 246.263C218.462 246.813 218.518 247.362 218.573 247.912C218.665 248.863 218.767 249.815 218.869 250.766C218.97 251.718 219.081 252.766 219.178 253.759C219.275 254.752 219.363 255.745 219.432 256.733C219.476 257.223 219.373 257.715 219.137 258.146C219.043 258.318 218.966 258.497 218.906 258.682C218.863 258.811 218.829 258.942 218.804 259.075C218.777 259.228 218.758 259.382 218.749 259.537C218.737 259.861 218.756 260.186 218.804 260.506C218.829 260.667 218.856 260.821 218.887 260.968C218.956 261.287 219.04 261.606 219.123 261.92C219.313 262.79 219.624 263.629 220.047 264.414C220.137 264.575 220.238 264.729 220.351 264.876C220.384 264.922 220.421 264.963 220.458 265.009C220.553 265.12 220.641 265.238 220.721 265.36C220.759 265.417 220.791 265.478 220.818 265.541C220.913 265.796 220.932 266.073 220.873 266.34C220.823 266.617 220.726 266.894 220.652 267.157L220.892 267.189C220.555 268.256 220.398 269.351 220.966 270.067C221.428 270.667 222.255 270.787 222.989 270.866C223.938 271.012 224.903 271.033 225.857 270.926C226.991 270.688 228.082 270.276 229.091 269.706L230.971 268.783C231.83 268.353 234.758 265.762 235.28 264.922C235.802 264.081 235.742 262.756 234.925 262.261C234.691 262.143 234.448 262.043 234.2 261.961C233.368 261.615 232.024 261.583 230.768 261.564C230.703 261.102 230.666 260.599 230.647 260.123C230.563 258.356 230.597 256.584 230.749 254.821C230.855 253.57 231.017 252.323 231.003 251.071C231.003 249.399 230.657 247.746 230.477 246.083C230.296 244.421 230.278 242.795 230.25 241.151C230.209 238.731 230.92 236.426 231.229 234.034L231.77 229.826C231.861 229.315 231.873 228.794 231.807 228.279C231.724 227.817 231.511 227.356 231.423 226.894C231.234 225.845 231.71 224.806 231.858 223.749C232.029 222.534 231.765 221.301 231.594 220.082C231.37 218.156 231.264 216.219 231.276 214.281C231.109 202.365 230.772 190.182 226.744 179.033C226.583 178.571 226.407 178.109 226.227 177.68C226.308 177.658 226.388 177.632 226.467 177.601C226.593 177.555 226.712 177.493 226.823 177.417C226.872 177.387 226.918 177.353 226.961 177.315C227.09 177.187 227.184 177.028 227.234 176.853C227.288 176.684 227.316 176.508 227.317 176.331C227.311 176.019 227.266 175.709 227.183 175.408L227.128 175.218C227.035 174.904 226.934 174.595 226.827 174.295C226.726 173.994 226.615 173.703 226.499 173.408C226.259 172.86 226.064 172.293 225.917 171.713C225.636 170.401 225.917 168.886 225.128 167.82C223.382 165.427 224.615 161.751 223.885 158.837C223.645 157.913 223.294 156.989 223.072 156.066C222.934 155.474 222.846 154.869 222.758 154.264C222.527 152.956 222.413 151.63 222.416 150.302C222.416 149.637 222.518 148.972 222.596 148.311L223.151 143.73C223.77 144.915 224.212 146.185 224.462 147.498C224.504 147.688 224.541 147.873 224.583 148.062C225.082 150.322 225.699 152.554 226.43 154.749C226.851 156.075 227.266 157.396 227.719 158.707C227.853 159.081 227.982 159.46 228.102 159.843C228.22 160.226 228.313 160.617 228.379 161.012C228.43 161.326 228.453 161.649 228.476 161.968C228.5 162.287 228.518 162.615 228.55 162.933C228.701 164.297 229.159 165.609 229.89 166.771C229.913 166.801 229.935 166.832 229.955 166.863C230.079 167.088 230.278 167.261 230.518 167.353C230.684 167.388 230.856 167.388 231.022 167.353H231.049C231.294 167.302 231.539 167.247 231.779 167.187C231.815 167.18 231.851 167.17 231.885 167.159C231.996 168.591 232.421 170.018 232.458 171.463C232.504 173.565 231.733 175.578 231.243 177.615C230.831 179.474 230.555 181.36 230.416 183.259C230.353 183.635 230.377 184.02 230.486 184.386C230.538 184.563 230.651 184.717 230.804 184.82C230.958 184.924 231.142 184.971 231.326 184.954C231.456 184.91 231.576 184.841 231.679 184.749C231.781 184.658 231.864 184.547 231.922 184.423C232.472 183.509 232.655 182.422 232.435 181.379C232.874 181.472 233.1 181.975 233.206 182.432C233.487 183.618 233.42 184.859 233.012 186.007C232.74 186.773 232.32 187.48 232.089 188.27C232.006 188.516 232.006 188.782 232.089 189.027C232.32 189.558 233.049 189.521 233.576 189.327C235.297 188.626 236.695 187.309 237.498 185.633C238.315 183.965 238.71 182.122 238.648 180.266Z",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M211.7 271.484C211.206 272.08 210.36 272.2 209.593 272.279C208.603 272.422 207.6 272.44 206.605 272.334C205.432 272.098 204.301 271.69 203.247 271.124L201.288 270.2C200.397 269.771 197.348 267.194 196.803 266.358C196.258 265.522 196.314 264.206 197.173 263.712C197.418 263.596 197.671 263.497 197.93 263.416C199.371 262.843 202.291 263.134 203.824 262.913C204.585 262.877 205.34 263.054 206.004 263.425C207.519 264.095 210.189 264.626 210.85 266.33C211.363 267.642 212.767 270.187 211.7 271.484Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M222.578 270.219C223.072 270.815 223.918 270.935 224.684 271.013C226.869 271.422 229.128 271.009 231.026 269.854L232.985 268.93C233.881 268.501 236.93 265.924 237.475 265.088C238.02 264.252 237.964 262.931 237.101 262.442C236.858 262.323 236.606 262.224 236.348 262.146C234.906 261.573 231.987 261.864 230.454 261.643C229.692 261.605 228.935 261.783 228.269 262.155C226.758 262.825 224.112 263.356 223.428 265.06C222.901 266.376 221.493 268.921 222.578 270.219Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M227.34 176.835C227.812 177.742 228.224 178.681 228.573 179.643C232.768 190.727 233.119 202.855 233.294 214.71C233.279 216.638 233.388 218.565 233.622 220.479C233.798 221.693 234.084 222.917 233.895 224.132C233.742 225.18 233.248 226.215 233.433 227.254C233.521 227.716 233.742 228.177 233.83 228.639C233.899 229.151 233.885 229.67 233.788 230.177L233.23 234.361C232.906 236.745 232.167 239.035 232.209 241.442C232.236 243.081 232.264 244.721 232.444 246.351C232.712 247.994 232.896 249.649 232.994 251.311C232.994 252.558 232.837 253.8 232.726 255.043C232.57 256.796 232.535 258.559 232.62 260.317C232.684 261.67 232.841 263.088 233.544 264.229C232.735 265.383 231.941 266.418 230.652 267C228.033 268.145 225.026 267.757 222.194 267.346C222.351 266.824 222.592 266.233 222.365 265.734C222.234 265.493 222.071 265.271 221.88 265.074C221.264 264.194 220.835 263.198 220.619 262.146C220.278 260.894 219.936 259.55 220.619 258.354C220.86 257.934 220.968 257.451 220.929 256.969C220.342 249.117 218.592 240.97 220.204 233.253C220.375 232.431 220.578 231.609 220.666 230.773C220.753 229.571 220.768 228.365 220.712 227.161L220.73 225.439C220.647 223.651 220.73 221.818 220.361 220.049C220.107 218.784 219.626 217.509 220.217 216.216C220.345 215.922 220.403 215.602 220.388 215.282C220.373 214.962 220.284 214.649 220.13 214.368C218.885 212.19 217.885 209.88 217.146 207.482C216.993 206.813 216.783 206.158 216.518 205.524C216.158 204.856 215.744 204.218 215.28 203.617C213.894 201.58 213.035 199.22 212.213 196.892C212.3 196.675 212.213 196.38 212.005 196.43C211.892 196.458 211.787 196.508 211.694 196.577C211.601 196.646 211.523 196.733 211.464 196.832C210.337 198.347 210.24 200.37 210.189 202.264C210.105 204.019 210.135 205.777 210.282 207.529C210.374 208.452 210.536 209.376 210.619 210.3C210.727 212.014 210.7 213.734 210.536 215.444L209.968 223.822C209.887 224.518 209.927 225.223 210.088 225.905C210.458 227.084 210.639 228.314 210.624 229.549C210.478 234.63 210.925 239.711 211.954 244.688C212.231 246.074 212.559 247.432 212.799 248.812C213.279 252.088 213.516 255.395 213.51 258.705C213.561 260.742 213.594 262.862 212.79 264.709C212.475 265.289 212.244 265.911 212.106 266.556C212.106 266.887 212.062 267.216 211.977 267.536C211.741 268.141 211.053 268.399 210.402 268.538C209.209 268.797 207.984 268.884 206.767 268.796C206.481 268.793 206.199 268.73 205.94 268.612C205.478 268.376 205.247 267.877 204.9 267.503C204.157 266.69 202.919 266.441 202.24 265.573C201.39 264.483 201.746 262.908 202.24 261.624C202.734 260.34 203.367 258.95 202.933 257.638C202.42 256.1 200.623 255.269 200.115 253.717C201.501 247.464 198.092 240.998 198.383 234.602C198.452 233.11 198.711 231.632 198.715 230.14C198.715 226.298 197.066 222.557 197.33 218.724C198.027 208.983 194.706 199.257 193.302 189.591C193.033 188.149 192.934 186.681 193.006 185.217C193.214 182.797 194.337 180.548 195.685 178.53C196.655 177.084 197.819 175.666 199.422 174.992C200.743 174.433 202.221 174.438 203.653 174.447C207.229 174.475 210.804 174.502 214.379 174.567C216.812 174.532 219.242 174.748 221.631 175.214C223.566 175.652 225.377 176.553 227.34 176.835Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M169.578 132.429C169.232 130.734 169.888 128.919 169.375 127.27C169.19 126.674 168.737 126.055 168.114 126.069C167.49 126.083 167.098 126.679 166.562 126.96C165.698 127.422 164.645 127.002 163.79 126.549C162.936 126.097 161.943 125.58 161.019 125.852C160.908 126.443 161.305 127.002 161.739 127.413C162.216 127.777 162.611 128.236 162.899 128.762C163.116 129.307 163.014 129.916 163.06 130.503C163.157 131.842 163.984 133.001 164.857 134.045C166.226 135.727 167.68 137.338 169.213 138.871C169.213 138.871 171.523 135.989 171.49 135.486C171.458 134.983 170.668 134.562 170.382 134.184C169.988 133.665 169.713 133.066 169.578 132.429Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{opacity:"0.72",d:"M169.578 132.429C169.232 130.734 169.888 128.919 169.375 127.27C169.19 126.674 168.737 126.055 168.114 126.069C167.49 126.083 167.098 126.679 166.562 126.96C165.698 127.422 164.645 127.002 163.79 126.549C162.936 126.097 161.943 125.579 161.019 125.852C160.908 126.443 161.305 127.002 161.739 127.413C162.216 127.777 162.611 128.236 162.899 128.762C163.116 129.307 163.014 129.916 163.06 130.503C163.157 131.842 163.984 133.001 164.857 134.045C166.226 135.727 167.68 137.338 169.213 138.871C169.213 138.871 171.523 135.989 171.49 135.486C171.458 134.983 170.668 134.562 170.382 134.184C169.988 133.665 169.713 133.066 169.578 132.429Z",fill:"var(--center-channel-color)",fillOpacity:"0.72"}),M.createElement("path",{d:"M238.892 167.898C239.1 168.436 239.254 168.993 239.354 169.561C239.955 172.47 240.334 175.421 240.708 178.368C240.805 179.153 240.906 179.943 240.934 180.732C241.042 182.614 240.655 184.492 239.812 186.178C238.96 187.874 237.506 189.192 235.733 189.872C235.188 190.066 234.426 190.103 234.186 189.577C234.1 189.333 234.1 189.068 234.186 188.824C234.403 188.039 234.842 187.332 235.109 186.57C235.531 185.432 235.602 184.193 235.313 183.014C235.202 182.552 234.966 182.058 234.509 181.966C234.737 183.007 234.544 184.096 233.973 184.995C233.91 185.12 233.823 185.23 233.717 185.321C233.61 185.411 233.487 185.48 233.354 185.522C233.166 185.541 232.976 185.496 232.817 185.394C232.657 185.291 232.537 185.138 232.477 184.958C232.365 184.595 232.342 184.21 232.407 183.836C232.552 181.945 232.839 180.068 233.266 178.22C233.775 176.193 234.583 174.193 234.527 172.101C234.481 170.207 233.728 168.346 233.941 166.466C233.937 166.362 233.969 166.26 234.031 166.176C234.093 166.092 234.182 166.031 234.283 166.004C234.813 165.787 235.358 165.606 235.913 165.464C236.241 165.381 237.359 165.002 237.673 165.168C237.987 165.335 238.006 166.152 238.135 166.438C238.38 166.914 238.68 167.385 238.892 167.898Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{opacity:"0.72",d:"M238.892 167.898C239.1 168.436 239.254 168.993 239.354 169.561C239.955 172.47 240.334 175.421 240.708 178.368C240.805 179.153 240.906 179.943 240.934 180.732C241.042 182.614 240.655 184.492 239.812 186.178C238.96 187.874 237.506 189.192 235.733 189.872C235.188 190.066 234.426 190.103 234.186 189.577C234.1 189.333 234.1 189.068 234.186 188.824C234.403 188.039 234.842 187.332 235.109 186.57C235.531 185.432 235.602 184.193 235.313 183.014C235.202 182.552 234.966 182.058 234.509 181.966C234.737 183.007 234.544 184.096 233.973 184.995C233.91 185.12 233.823 185.23 233.717 185.321C233.61 185.411 233.487 185.48 233.354 185.522C233.166 185.541 232.976 185.496 232.817 185.394C232.657 185.291 232.537 185.138 232.477 184.958C232.365 184.595 232.342 184.21 232.407 183.836C232.552 181.945 232.839 180.068 233.266 178.22C233.775 176.193 234.583 174.193 234.527 172.101C234.481 170.207 233.728 168.346 233.941 166.466C233.937 166.362 233.969 166.26 234.031 166.176C234.093 166.092 234.182 166.031 234.283 166.004C234.813 165.787 235.358 165.606 235.913 165.464C236.241 165.381 237.359 165.002 237.673 165.168C237.987 165.335 238.006 166.152 238.135 166.438C238.38 166.914 238.68 167.385 238.892 167.898Z",fill:"var(--center-channel-color)",fillOpacity:"0.72"}),M.createElement("path",{d:"M201.51 111.784C205.783 111.784 209.247 108.321 209.247 104.048C209.247 99.776 205.783 96.3125 201.51 96.3125C197.237 96.3125 193.773 99.776 193.773 104.048C193.773 108.321 197.237 111.784 201.51 111.784Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{opacity:"0.72",d:"M201.51 111.784C205.783 111.784 209.247 108.321 209.247 104.048C209.247 99.7759 205.783 96.3125 201.51 96.3125C197.237 96.3125 193.773 99.7759 193.773 104.048C193.773 108.321 197.237 111.784 201.51 111.784Z",fill:"var(--center-channel-color)",fillOpacity:"0.72"}),M.createElement("path",{d:"M208.443 109.646C208.44 110.139 208.479 110.632 208.559 111.119C208.666 111.612 208.821 112.093 209.021 112.556C209.278 113.312 209.642 114.027 210.102 114.68C210.568 115.339 211.269 115.795 212.06 115.955C206.77 118.435 201.123 120.067 195.325 120.79C196.238 120.183 196.997 119.372 197.542 118.421C197.834 117.812 198.032 117.163 198.129 116.495C198.625 113.698 198.375 110.819 197.404 108.15C197.307 107.891 197.214 107.568 197.404 107.351C197.483 107.273 197.577 107.214 197.681 107.175C199.977 106.2 202.458 105.737 204.951 105.817C205.589 105.817 206.226 105.85 206.864 105.896C207.206 105.923 207.958 105.85 208.249 106.099C208.54 106.348 208.411 107.327 208.42 107.729L208.443 109.646Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{opacity:"0.72",d:"M208.443 109.646C208.44 110.139 208.479 110.632 208.559 111.119C208.666 111.612 208.821 112.093 209.021 112.555C209.278 113.312 209.642 114.027 210.101 114.68C210.568 115.339 211.268 115.795 212.06 115.955C206.77 118.435 201.123 120.067 195.325 120.79C196.238 120.183 196.997 119.372 197.542 118.421C197.834 117.812 198.031 117.163 198.129 116.495C198.625 113.698 198.375 110.819 197.404 108.149C197.307 107.891 197.214 107.568 197.404 107.351C197.483 107.273 197.577 107.213 197.681 107.175C199.977 106.2 202.458 105.737 204.951 105.817C205.589 105.817 206.226 105.85 206.863 105.896C207.205 105.923 207.958 105.85 208.249 106.099C208.54 106.348 208.411 107.327 208.42 107.729L208.443 109.646Z",fill:"var(--center-channel-color)",fillOpacity:"0.72"}),M.createElement("path",{d:"M212.536 115.29C211.397 113.832 209.804 112.798 208.009 112.351C206.214 111.904 204.322 112.07 202.633 112.823C198.937 114.583 197.136 118.827 193.898 121.284C193.161 121.836 192.376 122.32 191.551 122.73C191.065 122.998 190.547 123.202 190.008 123.339C189.403 123.473 188.775 123.455 188.161 123.598C187.012 123.935 186.034 124.694 185.422 125.723C185.12 126.261 184.783 126.779 184.415 127.274C184.078 127.676 183.657 128.004 183.302 128.387C182.013 129.773 181.662 131.759 181.371 133.625C180.362 134.685 179.261 135.654 178.082 136.52C177.712 136.806 177.301 137.033 176.863 137.195C175.731 137.564 174.479 137.098 173.514 136.4C172.548 135.703 171.763 134.784 170.811 134.091C169.938 135.338 169.024 136.594 168.091 137.786C167.951 138.018 167.736 138.194 167.481 138.285C167.306 138.876 167.726 139.485 168.04 140.012L169.726 142.848C170.286 143.879 170.97 144.837 171.763 145.702C172.581 146.553 173.685 147.071 174.862 147.157C175.607 147.15 176.344 147.007 177.038 146.736C180.271 145.656 183.205 143.933 186.276 142.464C186.83 142.149 187.45 141.967 188.087 141.933C188.405 141.926 188.717 142.023 188.975 142.208C189.234 142.394 189.425 142.659 189.519 142.963C189.87 144.737 190.216 146.501 190.697 148.237C191.156 149.881 191.579 151.53 191.967 153.184C192.227 154.199 192.413 155.231 192.521 156.273C192.572 156.864 192.577 157.456 192.586 158.051L192.651 165.219C192.651 165.995 192.216 166.475 191.875 167.168C191.36 168.245 191.282 169.48 191.658 170.613C191.847 171.172 192.147 171.69 192.36 172.244C192.868 173.579 192.849 175.047 192.822 176.474L192.761 179.744C192.744 179.88 192.768 180.019 192.831 180.141C193.029 180.451 193.51 180.271 193.815 180.058L195.325 179.024C197.372 179.306 199.441 179.407 201.505 179.324C207.376 179.241 213.252 179.472 219.109 179.883C221.067 180.021 223.086 180.169 224.934 179.518C225.857 179.185 226.735 178.654 227.705 178.391C228.101 178.326 228.477 178.168 228.8 177.929C229.336 177.435 229.192 176.544 228.975 175.869C228.781 175.26 228.564 174.655 228.319 174.063C228.07 173.519 227.867 172.955 227.71 172.378C227.419 171.075 227.71 169.565 226.892 168.503C225.072 166.124 226.361 162.462 225.594 159.566C225.349 158.643 224.984 157.719 224.753 156.795C224.606 156.204 224.513 155.604 224.425 155.003C224.183 153.703 224.064 152.382 224.07 151.059C224.07 150.399 224.176 149.738 224.259 149.082L224.837 144.519C225.557 145.87 226.059 147.326 226.324 148.833C226.849 151.085 227.496 153.307 228.264 155.488C228.698 156.804 229.132 158.116 229.604 159.423C229.905 160.17 230.135 160.943 230.292 161.732C230.393 162.365 230.398 163.012 230.472 163.644C230.627 165.009 231.102 166.317 231.858 167.464C231.999 167.73 232.232 167.937 232.514 168.046C232.701 168.087 232.895 168.087 233.082 168.046C235.124 167.642 237.102 166.958 238.957 166.014C239.352 165.848 239.694 165.58 239.95 165.238C240.449 164.425 239.89 163.413 239.645 162.49C239.401 161.566 239.447 160.314 238.671 159.654C235.959 157.345 237.285 152.666 235.95 149.378C235.71 148.801 235.433 148.242 235.23 147.651C235.073 147.189 234.957 146.727 234.842 146.265C233.896 142.438 232.883 138.625 231.802 134.825C230.684 130.891 230.804 126.794 229.396 122.952C229.131 122.149 228.786 121.375 228.366 120.642C227.894 119.876 227.264 119.219 226.518 118.716C224.472 117.363 222.412 116.213 220.005 115.724C217.598 115.234 214.984 115.262 212.536 115.29Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M212.536 115.29C211.397 113.832 209.804 112.798 208.009 112.351C206.214 111.904 204.322 112.07 202.633 112.823C198.937 114.583 197.136 118.827 193.898 121.284C193.161 121.836 192.376 122.32 191.551 122.73C191.065 122.998 190.547 123.202 190.008 123.339C189.403 123.473 188.775 123.455 188.161 123.598C187.012 123.935 186.034 124.694 185.422 125.723C185.12 126.261 184.783 126.779 184.415 127.274C184.078 127.676 183.657 128.004 183.302 128.387C182.013 129.773 181.662 131.759 181.371 133.625C180.362 134.685 179.261 135.654 178.082 136.52C177.712 136.806 177.301 137.033 176.863 137.195C175.731 137.564 174.479 137.098 173.514 136.4C172.548 135.703 171.763 134.784 170.811 134.091C169.938 135.338 169.024 136.594 168.091 137.786C167.951 138.018 167.736 138.194 167.481 138.285C167.306 138.876 167.726 139.485 168.04 140.012L169.726 142.848C170.286 143.879 170.97 144.837 171.763 145.702C172.581 146.553 173.685 147.071 174.862 147.157C175.607 147.15 176.344 147.007 177.038 146.736C180.271 145.656 183.205 143.933 186.276 142.464C186.83 142.149 187.45 141.967 188.087 141.933C188.405 141.926 188.717 142.023 188.975 142.208C189.234 142.394 189.425 142.659 189.519 142.963C189.87 144.737 190.216 146.501 190.697 148.237C191.156 149.881 191.579 151.53 191.967 153.184C192.227 154.199 192.413 155.231 192.521 156.273C192.572 156.864 192.577 157.456 192.586 158.051L192.651 165.219C192.651 165.995 192.216 166.475 191.875 167.168C191.36 168.245 191.282 169.48 191.658 170.613C191.847 171.172 192.147 171.69 192.36 172.244C192.868 173.579 192.849 175.047 192.822 176.474L192.761 179.744C192.744 179.88 192.768 180.019 192.831 180.141C193.029 180.451 193.51 180.271 193.815 180.058L195.325 179.024C197.372 179.306 199.441 179.407 201.505 179.324C207.376 179.241 213.252 179.472 219.109 179.883C221.067 180.021 223.086 180.169 224.934 179.518C225.857 179.185 226.735 178.654 227.705 178.391C228.101 178.326 228.477 178.168 228.8 177.929C229.336 177.435 229.192 176.544 228.975 175.869C228.781 175.26 228.564 174.655 228.319 174.063C228.07 173.519 227.867 172.955 227.71 172.378C227.419 171.075 227.71 169.565 226.892 168.503C225.072 166.124 226.361 162.462 225.594 159.566C225.349 158.643 224.984 157.719 224.753 156.795C224.606 156.204 224.513 155.604 224.425 155.003C224.183 153.703 224.064 152.382 224.07 151.059C224.07 150.399 224.176 149.738 224.259 149.082L224.837 144.519C225.557 145.87 226.059 147.326 226.324 148.833C226.849 151.085 227.496 153.307 228.264 155.488C228.698 156.804 229.132 158.116 229.604 159.423C229.905 160.17 230.135 160.943 230.292 161.732C230.393 162.365 230.398 163.012 230.472 163.644C230.627 165.009 231.102 166.317 231.858 167.464C231.999 167.73 232.232 167.937 232.514 168.046C232.701 168.087 232.895 168.087 233.082 168.046C235.124 167.642 237.102 166.958 238.957 166.014C239.352 165.848 239.694 165.58 239.95 165.238C240.449 164.425 239.89 163.413 239.645 162.49C239.401 161.566 239.447 160.314 238.671 159.654C235.959 157.345 237.285 152.666 235.95 149.378C235.71 148.801 235.433 148.242 235.23 147.651C235.073 147.189 234.957 146.727 234.842 146.265C233.896 142.438 232.883 138.625 231.802 134.825C230.684 130.891 230.804 126.794 229.396 122.952C229.131 122.149 228.786 121.375 228.366 120.642C227.894 119.876 227.264 119.219 226.518 118.716C224.472 117.363 222.412 116.213 220.005 115.724C217.598 115.234 214.984 115.262 212.536 115.29Z",fill:"var(--center-channel-color)",fillOpacity:"0.64"}),M.createElement("path",{d:"M194.48 105.942C193.44 105.383 193.713 103.859 193.556 102.709C193.191 100.303 190.48 98.8804 189.861 96.5342C190.592 96.6253 191.335 96.5201 192.013 96.2294C192.143 95.4504 191.989 94.6506 191.579 93.9756C193.81 93.0519 195.621 91.2923 197.884 90.4748C200.739 89.4449 203.889 90.0776 206.79 91.0337C208.226 91.4955 209.718 92.1282 210.587 93.366C211.538 94.7284 211.51 96.5157 211.473 98.1784C211.395 100.783 211.289 103.48 210.129 105.813C208.656 108.782 204.475 111.53 201.02 110.727C199.588 110.394 199.173 109.489 198.558 108.242C198.18 107.466 198.041 106.565 197.173 106.159C196.304 105.753 195.325 106.395 194.48 105.942Z",fill:"var(--center-channel-color)"}),M.createElement("g",{opacity:"0.1"},M.createElement("path",{opacity:"0.1",d:"M191.976 95.0933C191.907 94.6927 191.763 94.3089 191.551 93.9617C191.68 93.9094 191.81 93.854 191.939 93.7955C192.039 94.2211 192.052 94.6626 191.976 95.0933Z",fill:"var(--center-channel-color)"}),M.createElement("path",{opacity:"0.1",d:"M193.537 101.568C193.713 102.737 193.44 104.256 194.461 104.801C195.302 105.263 196.309 104.612 197.136 105.009C197.962 105.406 198.124 106.316 198.521 107.092C199.126 108.339 199.551 109.24 200.983 109.577C204.438 110.38 208.619 107.628 210.092 104.658C211.252 102.326 211.358 99.6286 211.436 97.0238C211.436 96.8945 211.436 96.7698 211.436 96.6405C211.436 97.1439 211.436 97.6519 211.436 98.1507C211.358 100.755 211.252 103.453 210.092 105.785C208.619 108.755 204.438 111.503 200.983 110.699C199.551 110.366 199.136 109.461 198.521 108.214C198.143 107.438 198.004 106.538 197.136 106.131C196.267 105.725 195.288 106.381 194.461 105.928C193.422 105.369 193.694 103.845 193.537 102.695C193.172 100.289 190.461 98.8665 189.842 96.5204C190.009 96.5428 190.177 96.5536 190.346 96.5527C191.339 98.2661 193.237 99.587 193.537 101.568Z",fill:"var(--center-channel-color)"})),M.createElement("defs",null,M.createElement("filter",{id:"filter0_f",x:"2",y:"1",width:"326.682",height:"256",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},M.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),M.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),M.createElement("feGaussianBlur",{stdDeviation:"2",result:"effect1_foregroundBlur"})))),Ym=()=>M.createElement("svg",{width:"444",height:"313",viewBox:"0 0 444 313",fill:"none",xmlns:"http://www.w3.org/2000/svg"},M.createElement("g",{filter:"url(#filter0_f)"},M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M375.682 51.9045C375.687 51.0023 375.514 50.1079 375.173 49.2725C374.832 48.4372 374.329 47.6771 373.695 47.0359C373.06 46.3947 372.305 45.8849 371.473 45.5356C370.641 45.1862 369.748 45.0042 368.846 45H63.8364C62.0143 45.0098 60.2706 45.7425 58.9887 47.0373C57.7068 48.332 56.9915 50.0827 57.0001 51.9045V235H57V256.651C57 258.464 57.7203 260.203 59.0023 261.484C60.2844 262.766 62.0232 263.486 63.8363 263.486H177.93L174.5 293H257L252.492 263.486H366C372.432 263.491 375.686 260.871 375.682 254C375.681 253.275 375.682 241.333 375.682 236.761C375.682 235.671 375.682 235 375.682 235L375.682 51.9045Z",fill:"var(--center-channel-color)",fillOpacity:"0.08"})),M.createElement("path",{d:"M211.507 300.921C293.251 300.921 359.518 298.651 359.518 295.849C359.518 293.048 293.251 290.777 211.507 290.777C129.762 290.777 63.4951 293.048 63.4951 295.849C63.4951 298.651 129.762 300.921 211.507 300.921Z",fill:"var(--center-channel-color)",fillOpacity:"0.08"}),M.createElement("path",{opacity:"0.1",d:"M253.208 293.482H212.135L170.979 292.955L171.224 290.845H252.802L253.208 293.482Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M253.287 294.008L170.979 292.955L171.224 290.844L175.201 256.026H247.485L252.802 290.844L253.208 293.482L253.287 294.008Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M370.682 46.9045C370.687 46.0023 370.514 45.1079 370.173 44.2725C369.832 43.4372 369.329 42.6771 368.695 42.0359C368.06 41.3947 367.305 40.8849 366.473 40.5356C365.641 40.1862 364.748 40.0042 363.846 40H58.8364C57.0143 40.0098 55.2706 40.7425 53.9887 42.0373C52.7068 43.332 51.9915 45.0827 52.0001 46.9045V231.761H370.682V46.9045Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M253.287 294.008L170.979 292.955L171.224 290.844L175.201 256.026H247.485L252.802 290.844L253.208 293.482L253.287 294.008Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{d:"M266.479 291.371H157.26V294.008H266.479V291.371Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M266.479 291.371H157.26V294.008H266.479V291.371Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{opacity:"0.1",d:"M220.048 258.4L252.885 291.371L247.846 258.4H220.048Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M370.682 46.9045C370.687 46.0023 370.514 45.1079 370.173 44.2725C369.832 43.4372 369.329 42.6771 368.695 42.0359C368.06 41.3947 367.305 40.8849 366.473 40.5356C365.641 40.1862 364.748 40.0042 363.846 40H58.8364C57.0143 40.0098 55.2706 40.7425 53.9887 42.0373C52.7068 43.332 51.9915 45.0827 52.0001 46.9045V231.761H370.682V46.9045Z",fill:"var(--center-channel-color)",fillOpacity:"0.72"}),M.createElement("path",{d:"M52 229.914V251.565C52 253.378 52.7203 255.116 54.0023 256.398C55.2844 257.68 57.0232 258.4 58.8363 258.4H363.846C364.743 258.401 365.633 258.224 366.462 257.881C367.292 257.538 368.046 257.034 368.681 256.399C369.316 255.765 369.819 255.011 370.163 254.181C370.506 253.352 370.682 252.463 370.682 251.565V229.914H52Z",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M52 230V251.651C52 253.464 52.7203 255.202 54.0023 256.484C55.2844 257.766 57.0232 258.486 58.8363 258.486H363.846C364.743 258.487 365.633 258.311 366.462 257.967C367.292 257.624 368.046 257.121 368.681 256.486C369.316 255.851 369.819 255.097 370.163 254.268C370.506 253.438 370.682 252.549 370.682 251.651V230H52Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{d:"M359.074 51.6061H65.1924V217.781H359.074V51.6061Z",fill:"var(--center-channel-bg)"}),M.createElement("circle",{cx:"211.5",cy:"244.5",r:"7.5",fill:"var(--center-channel-color)",fillOpacity:"0.16"}),M.createElement("path",{d:"M142 297.109C150.284 297.109 157 296.438 157 295.609C157 294.781 150.284 294.109 142 294.109C133.716 294.109 127 294.781 127 295.609C127 296.438 133.716 297.109 142 297.109Z",fill:"var(--center-channel-color)",fillOpacity:"0.24"}),M.createElement("path",{d:"M141.665 296.388C142.625 296.388 143.402 295.371 143.402 294.116C143.402 292.861 142.625 291.843 141.665 291.843C140.706 291.843 139.929 292.861 139.929 294.116C139.929 295.371 140.706 296.388 141.665 296.388Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M141.665 293.612C142.625 293.612 143.402 292.595 143.402 291.34C143.402 290.085 142.625 289.068 141.665 289.068C140.706 289.068 139.929 290.085 139.929 291.34C139.929 292.595 140.706 293.612 141.665 293.612Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M141.665 290.832C142.625 290.832 143.402 289.815 143.402 288.56C143.402 287.305 142.625 286.288 141.665 286.288C140.706 286.288 139.929 287.305 139.929 288.56C139.929 289.815 140.706 290.832 141.665 290.832Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M141.665 288.056C142.625 288.056 143.402 287.039 143.402 285.784C143.402 284.529 142.625 283.512 141.665 283.512C140.706 283.512 139.929 284.529 139.929 285.784C139.929 287.039 140.706 288.056 141.665 288.056Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M141.665 285.276C142.625 285.276 143.402 284.259 143.402 283.004C143.402 281.749 142.625 280.732 141.665 280.732C140.706 280.732 139.929 281.749 139.929 283.004C139.929 284.259 140.706 285.276 141.665 285.276Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M141.665 282.5C142.625 282.5 143.402 281.483 143.402 280.228C143.402 278.973 142.625 277.956 141.665 277.956C140.706 277.956 139.929 278.973 139.929 280.228C139.929 281.483 140.706 282.5 141.665 282.5Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M141.665 279.72C142.625 279.72 143.402 278.703 143.402 277.448C143.402 276.193 142.625 275.176 141.665 275.176C140.706 275.176 139.929 276.193 139.929 277.448C139.929 278.703 140.706 279.72 141.665 279.72Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M148.165 258.438C148.402 258.137 148.618 257.819 148.811 257.487L144.248 256.739L149.181 256.776C149.654 255.746 149.913 254.63 149.94 253.497C149.968 252.364 149.765 251.237 149.342 250.185L142.719 253.621L148.825 249.132C148.252 248.147 147.482 247.29 146.564 246.615C145.645 245.94 144.598 245.461 143.486 245.208C142.375 244.955 141.223 244.933 140.103 245.143C138.983 245.354 137.918 245.792 136.974 246.432C136.03 247.071 135.228 247.898 134.618 248.86C134.007 249.823 133.601 250.9 133.424 252.026C133.248 253.152 133.305 254.303 133.592 255.406C133.879 256.509 134.39 257.541 135.093 258.438C134.723 258.91 134.404 259.419 134.141 259.958L140.067 263.034L133.748 260.914C133.459 261.774 133.31 262.676 133.31 263.583C133.306 265.449 133.935 267.261 135.093 268.724C134.129 269.95 133.53 271.423 133.364 272.974C133.198 274.524 133.471 276.091 134.153 277.493C134.835 278.896 135.898 280.079 137.22 280.906C138.543 281.733 140.071 282.172 141.631 282.172C143.191 282.172 144.719 281.733 146.041 280.906C147.364 280.079 148.427 278.896 149.109 277.493C149.791 276.091 150.064 274.524 149.898 272.974C149.732 271.423 149.133 269.95 148.169 268.724C149.323 267.257 149.95 265.446 149.949 263.58C149.948 261.715 149.319 259.904 148.165 258.438Z",fill:"var(--online-indicator)"}),M.createElement("path",{opacity:"0.1",d:"M133.31 263.579C133.306 265.444 133.935 267.256 135.093 268.719C134.129 269.946 133.53 271.418 133.364 272.969C133.198 274.52 133.471 276.086 134.153 277.489C134.835 278.892 135.898 280.074 137.22 280.901C138.543 281.729 140.071 282.168 141.631 282.168C143.191 282.168 144.719 281.729 146.041 280.901C147.364 280.074 148.427 278.892 149.109 277.489C149.791 276.086 150.064 274.52 149.898 272.969C149.732 271.418 149.133 269.946 148.169 268.719C149.282 267.306 133.31 262.646 133.31 263.579Z",fill:"var(--center-channel-color)"}),M.createElement("path",{d:"M443.193 16.0555C443.193 16.0555 400.368 13.4855 405.413 43.3313C405.413 43.3313 404.396 48.6073 409.218 51C409.218 51 409.294 48.7894 413.612 49.543C415.149 49.7964 416.711 49.8711 418.266 49.7654C420.363 49.6282 422.358 48.8169 423.952 47.4536C423.952 47.4536 435.991 42.5063 440.67 22.9399C440.67 22.9399 444.133 18.6706 443.996 17.5726L436.769 20.643C436.769 20.643 439.241 25.8281 437.278 30.1362C437.278 30.1362 437.044 20.8283 435.655 21.0308C435.376 21.0715 431.902 22.8264 431.902 22.8264C431.902 22.8264 436.149 31.8558 432.944 38.4224C432.944 38.4224 434.16 27.2936 430.574 23.4792L425.488 26.4334C425.488 26.4334 430.452 35.7616 427.085 43.3747C427.085 43.3747 427.949 31.6994 424.415 27.1517L419.807 30.7279C419.807 30.7279 424.471 39.9192 421.628 46.2335C421.628 46.2335 421.256 32.646 418.81 31.6194C418.81 31.6194 414.776 35.1603 414.161 36.6069C414.161 36.6069 417.355 43.2843 415.371 46.8049C415.371 46.8049 414.156 37.7502 413.159 37.6996C413.159 37.6996 409.141 43.6988 408.724 47.8166C408.724 47.8166 408.897 41.7007 412.187 37.1331C412.187 37.1331 408.301 37.7958 406.033 40.2975C406.033 40.2975 406.658 36.0586 413.179 35.6843C413.179 35.6843 416.5 31.1316 417.385 30.8586C417.385 30.8586 410.905 30.3161 406.974 32.0524C406.974 32.0524 410.432 28.0513 418.575 29.8722L423.127 26.1743C423.127 26.1743 414.593 25.0157 410.972 26.2959C410.972 26.2959 415.137 22.755 424.353 25.3349L429.307 22.3906C429.307 22.3906 422.029 20.8324 417.696 21.3789C417.696 21.3789 422.273 18.9256 430.762 21.5864L434.322 20.0042C434.322 20.0042 428.992 18.9622 427.43 18.7954C425.868 18.6286 425.788 18.2037 425.788 18.2037C429.164 17.6437 432.631 18.0272 435.802 19.3116C435.802 19.3116 443.32 16.5261 443.193 16.0555Z",fill:"var(--online-indicator)"}),M.createElement("path",{d:"M384.646 0.0251977C384.646 0.0251977 365.998 -1.14679 368.177 12.495C368.177 12.495 367.739 14.9053 369.836 16C369.836 16 369.87 14.9766 371.754 15.3296C372.424 15.4471 373.104 15.4815 373.781 15.4321C374.696 15.3689 375.567 14.995 376.259 14.3675C376.259 14.3675 381.51 12.1059 383.551 3.16163C383.551 3.16163 385.058 1.21228 384.998 0.710652L381.848 2.11265C381.848 2.11265 382.923 4.48177 382.078 6.4517C382.078 6.4517 381.975 2.19907 381.372 2.29693C381.249 2.29693 379.733 3.12002 379.733 3.12002C379.733 3.12002 381.588 7.24919 380.189 10.248C380.189 10.248 380.719 5.16174 379.154 3.41679L376.936 4.78861C376.936 4.78861 379.1 9.05084 377.632 12.5307C377.632 12.5307 378.011 7.19386 376.469 5.11647L374.462 6.75396C374.462 6.75396 376.494 10.9549 375.257 13.8417C375.257 13.8417 375.091 7.62963 374.025 7.1591C374.025 7.1591 372.269 8.77602 371.999 9.44135C371.999 9.44135 373.392 12.5115 372.529 14.1028C372.529 14.1028 371.999 9.9631 371.547 9.94161C371.547 9.94161 369.795 12.6852 369.614 14.5468C369.701 12.8102 370.223 11.1276 371.125 9.66541C370.114 9.8651 369.181 10.3685 368.441 11.1136C368.441 11.1136 368.716 9.1743 371.557 9.00557C371.557 9.00557 373.03 6.92315 373.393 6.79512C373.393 6.79512 370.566 6.54956 368.853 7.34384C368.853 7.34384 370.36 5.51704 373.908 6.34607L375.871 4.65737C375.871 4.65737 372.148 4.14065 370.569 4.71041C370.569 4.71041 372.384 3.09349 376.404 4.27051L378.563 2.92476C378.563 2.92476 375.388 2.2137 373.499 2.46749C373.499 2.46749 375.496 1.34671 379.196 2.55894L380.742 1.83737C380.742 1.83737 378.418 1.36135 377.734 1.28452C377.05 1.2077 377.017 1.01336 377.017 1.01336C378.49 0.757829 380.003 0.935008 381.385 1.52505C381.385 1.52505 384.704 0.238287 384.646 0.0251977Z",fill:"var(--online-indicator)"}),M.createElement("path",{d:"M0.35387 32.0252C0.35387 32.0252 19.0016 30.8532 16.8229 44.495C16.8229 44.495 17.2615 46.9053 15.1644 48C15.1644 48 15.1302 46.9766 13.2457 47.3296C12.5765 47.4471 11.8963 47.4815 11.2192 47.4321C10.3039 47.3689 9.43347 46.995 8.74103 46.3675C8.74103 46.3675 3.49032 44.1059 1.44889 35.1616C1.44889 35.1616 -0.0575027 33.2123 0.00170135 32.7107L3.15221 34.1126C3.15221 34.1126 2.07734 36.4818 2.92154 38.4517C2.92154 38.4517 3.02461 34.1991 3.62804 34.2969C3.75084 34.2969 5.26731 35.12 5.26731 35.12C5.26731 35.12 3.41226 39.2492 4.81078 42.248C4.81078 42.248 4.28103 37.1617 5.84619 35.4168L8.06434 36.7886C8.06434 36.7886 5.90013 41.0508 7.3675 44.5307C7.3675 44.5307 6.98947 39.1939 8.53051 37.1165L10.5377 38.754C10.5377 38.754 8.50597 42.9549 9.74267 45.8417C9.74267 45.8417 9.90929 39.6296 10.9745 39.1591C10.9745 39.1591 12.7313 40.776 13.0015 41.4414C13.0015 41.4414 11.6078 44.5115 12.4713 46.1028C12.4713 46.1028 13.0015 41.9631 13.4527 41.9416C13.4527 41.9416 15.2047 44.6852 15.3863 46.5468C15.2985 44.8102 14.7775 43.1276 13.8746 41.6654C14.8856 41.8651 15.8186 42.3685 16.5589 43.1136C16.5589 43.1136 16.284 41.1743 13.4426 41.0056C13.4426 41.0056 11.9705 38.9232 11.6073 38.7951C11.6073 38.7951 14.4338 38.5496 16.1467 39.3438C16.1467 39.3438 14.6403 37.517 11.0921 38.3461L9.12912 36.6574C9.12912 36.6574 12.8524 36.1406 14.4311 36.7104C14.4311 36.7104 12.6156 35.0935 8.5963 36.2705L6.43691 34.9248C6.43691 34.9248 9.61196 34.2137 11.5012 34.4675C11.5012 34.4675 9.5041 33.3467 5.80366 34.5589L4.25778 33.8374C4.25778 33.8374 6.58206 33.3613 7.26619 33.2845C7.95032 33.2077 7.98279 33.0134 7.98279 33.0134C6.50964 32.7578 4.99733 32.935 3.6153 33.525C3.6153 33.525 0.296421 32.2383 0.35387 32.0252Z",fill:"var(--online-indicator)"}),M.createElement("ellipse",{cx:"212",cy:"135.5",rx:"44",ry:"43.5",fill:"var(--center-channel-bg)"}),M.createElement("path",{d:"M258 136.001C258 145.099 255.302 153.993 250.247 161.557C245.192 169.122 238.008 175.018 229.602 178.499C221.197 181.98 211.947 182.891 203.024 181.116C194.101 179.341 185.905 174.959 179.472 168.526C173.039 162.092 168.658 153.896 166.884 144.973C165.109 136.05 166.02 126.8 169.502 118.395C172.984 109.99 178.88 102.806 186.445 97.7516C194.01 92.6973 202.904 89.9997 212.001 90C218.042 90.0002 224.024 91.1902 229.605 93.5021C235.186 95.814 240.257 99.2025 244.528 103.474C248.799 107.746 252.187 112.817 254.499 118.398C256.811 123.979 258 129.961 258 136.001ZM206.684 160.35L240.806 126.228C241.083 125.952 241.302 125.625 241.451 125.265C241.601 124.905 241.678 124.519 241.678 124.129C241.678 123.739 241.601 123.352 241.451 122.992C241.302 122.632 241.083 122.305 240.806 122.029L236.608 117.862C236.333 117.586 236.006 117.367 235.647 117.217C235.287 117.068 234.901 116.991 234.512 116.991C234.122 116.991 233.737 117.068 233.377 117.217C233.017 117.367 232.69 117.586 232.415 117.862L204.585 145.693L191.59 132.667C191.033 132.113 190.278 131.801 189.491 131.801C188.705 131.801 187.95 132.113 187.392 132.667L183.194 136.89C182.639 137.448 182.327 138.203 182.327 138.99C182.327 139.776 182.639 140.531 183.194 141.089L202.487 160.375C202.762 160.651 203.089 160.87 203.449 161.02C203.81 161.169 204.196 161.246 204.586 161.246C204.976 161.246 205.362 161.169 205.722 161.02C206.082 160.87 206.41 160.651 206.685 160.375L206.684 160.35Z",fill:"var(--online-indicator)"}),M.createElement("defs",null,M.createElement("filter",{id:"filter0_f",x:"53",y:"41",width:"326.682",height:"256",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},M.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),M.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),M.createElement("feGaussianBlur",{stdDeviation:"2",result:"effect1_foregroundBlur"}))));function Wm(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class zm extends M.PureComponent{constructor(e){super(e),Wm(this,"checkStepsSkipped",(()=>this.props.preferences.some((e=>e.name===N.jm.SKIP&&"true"===e.value)))),Wm(this,"getStartingStep",(()=>{for(let e=0;e<this.props.steps.length;e++)if(!this.isStepComplete(this.props.steps[e].id))return this.props.steps[e].id;return this.props.steps[0].id})),Wm(this,"getIncompleteStep",(()=>{for(let e=0;e<this.props.steps.length;e++)if(!this.isStepComplete(this.props.steps[e].id))return this.props.steps[e].id;return null})),Wm(this,"onClickHeader",((e,t)=>{const s=this.getStepNumberFromId(t);(0,Ye.L9)(Xt(this.props.isFirstAdmin),"click_onboarding_step".concat(s)),e(t)})),Wm(this,"getStepNumberFromId",(e=>this.props.steps.findIndex((t=>t.id===e))+1)),Wm(this,"onSkip",(e=>t=>{this.nextStep(e,t)})),Wm(this,"onSkipAll",(async()=>{this.showFinalScreen(),this.props.actions.savePreferences(this.props.currentUser.id,[{user_id:this.props.currentUser.id,category:N.uP.RECOMMENDED_NEXT_STEPS,name:N.jm.SKIP,value:"true"}])})),Wm(this,"onFinish",(e=>async t=>{const s=this.getStepNumberFromId(t);(0,Ye.L9)(Xt(this.props.isFirstAdmin),"complete_onboarding_step".concat(s)),await this.props.actions.savePreferences(this.props.currentUser.id,[{category:N.uP.RECOMMENDED_NEXT_STEPS,user_id:this.props.currentUser.id,name:t,value:"true"}]),this.nextStep(e,t)})),Wm(this,"showFinalScreenNoAnimation",(()=>{(0,Ye.tF)(Xt(this.props.isFirstAdmin),"pageview_tips_next_steps"),this.setState({showFinalScreen:!1,animating:!1})})),Wm(this,"showFinalScreen",(()=>{(0,Ye.L9)(Xt(this.props.isFirstAdmin),"click_skip_getting_started",{channel_sidebar:!1}),(0,Ye.tF)(Xt(this.props.isFirstAdmin),"pageview_tips_next_steps"),this.setState({showFinalScreen:!1,animating:!0})})),Wm(this,"transitionToFinalScreen",(()=>{this.setState({showTransitionScreen:!0,animating:!0})})),Wm(this,"setTimerToFinalScreen",(()=>{this.state.showTransitionScreen&&setTimeout((()=>{this.props.actions.setShowNextStepsView(!1),this.props.actions.savePreferences(this.props.currentUser.id,[{category:N.uP.RECOMMENDED_NEXT_STEPS,user_id:this.props.currentUser.id,name:N.jm.HIDE,value:"true"}])}),1500)})),Wm(this,"stopAnimating",(()=>{this.setState({animating:!1})})),Wm(this,"nextStep",((e,t)=>{const s=this.props.steps.findIndex((e=>e.id===t));if(s+1>this.props.steps.length-1){const t=this.getIncompleteStep();null===t?(e(""),setTimeout((()=>{this.transitionToFinalScreen()}),300)):e(t)}else this.isStepComplete(this.props.steps[s+1].id)?this.nextStep(e,this.props.steps[s+1].id):e(this.props.steps[s+1].id)})),Wm(this,"isStepComplete",(e=>this.props.preferences.some((t=>t.name===e&&"true"===t.value)))),Wm(this,"renderStep",((e,t)=>{const{id:s,title:n}=e;let a=M.createElement("div",{className:"NextStepsView__cardHeaderBadge"},M.createElement("span",null,t+1));return this.isStepComplete(s)&&(a=M.createElement("i",{className:"icon icon-check-circle"})),(i,r)=>M.createElement(Bm.Z,{key:"index"+r+"-"+t,className:W()({complete:this.isStepComplete(s)}),expanded:r===s},M.createElement(Bm.Z.Header,null,M.createElement("button",{onClick:()=>this.onClickHeader(i,s),disabled:this.isStepComplete(s),className:"NextStepsView__cardHeader"},a,M.createElement("span",null,n))),M.createElement(Bm.Z.Body,null,M.createElement(e.component,{id:s,expanded:r===s,isAdmin:this.props.isFirstAdmin,currentUser:this.props.currentUser,onFinish:this.onFinish(i),onSkip:this.onSkip(i)})))})),Wm(this,"renderTransitionScreen",(()=>M.createElement("div",{className:W()("NextStepsView__viewWrapper NextStepsView__transitionView",{transitioning:this.state.showTransitionScreen,completed:this.state.showTransitionScreen&&this.state.showFinalScreen,animating:this.state.animating}),onTransitionEnd:this.setTimerToFinalScreen},M.createElement("div",{className:"NextStepsView__transitionBody"},M.createElement(Ym,null),M.createElement("h1",{className:"NextStepsView__transitionTopText"},M.createElement(V.Z,{id:"next_steps_view.nicelyDone",defaultMessage:"Nicely done! You’re all set."})),M.createElement("h2",{className:"NextStepsView__transitionBottomText"},M.createElement("img",{loading:"lazy",src:Gm}),M.createElement(V.Z,{id:"next_steps_view.oneMoment",defaultMessage:"One moment"})))))),Wm(this,"renderMainBody",(()=>{const e=this.props.steps.map(this.renderStep);return M.createElement("div",{className:W()("NextStepsView__viewWrapper NextStepsView__mainView",{completed:this.state.showFinalScreen||this.state.showTransitionScreen,animating:this.state.animating})},M.createElement("header",{className:"NextStepsView__header"},M.createElement("div",{className:"NextStepsView__header-headerText"},M.createElement("h1",{className:"NextStepsView__header-headerTopText"},M.createElement(V.Z,{id:"next_steps_view.welcomeToGomlo",defaultMessage:"Welcome to Gomlo"})),M.createElement("h2",{className:"NextStepsView__header-headerBottomText"},M.createElement(V.Z,{id:"next_steps_view.hereAreSomeNextSteps",defaultMessage:"Here are some recommended next steps to help you get started"})))),M.createElement("div",{className:"NextStepsView__body"},M.createElement("div",{className:"NextStepsView__body-main"},M.createElement(Fm,{defaultExpandedKey:null===this.getIncompleteStep()?"":this.getStartingStep()},((t,s)=>M.createElement(M.Fragment,null,e.map((e=>e(t,s)))))),M.createElement("div",{className:"NextStepsView__skipGettingStarted"},M.createElement("div",{style:{height:64}}))),!(0,I.tq)()&&M.createElement("div",{className:"NextStepsView__body-graphic"},M.createElement(Km,null))))})),this.state={showFinalScreen:!1,showTransitionScreen:!1,animating:!1,show:!1}}async componentDidMount(){await this.props.actions.getProfiles(),(null===this.getIncompleteStep()||this.checkStepsSkipped())&&this.showFinalScreenNoAnimation(),this.setState({show:!0}),(0,Ye.tF)(Xt(this.props.isFirstAdmin),"pageview_welcome"),this.props.actions.closeRightHandSide()}render(){return M.createElement("section",{id:"app-content",className:"app__content NextStepsView"},this.state.show&&M.createElement(M.Fragment,null,M.createElement(Vm,null),this.renderMainBody(),this.renderTransitionScreen()))}}Wm(zm,"propTypes",{preferences:y().array.isRequired,isFirstAdmin:y().bool.isRequired,steps:y().array.isRequired,actions:y().shape({savePreferences:y().func.isRequired,setShowNextStepsView:y().func.isRequired,closeRightHandSide:y().func.isRequired,getProfiles:y().func.isRequired}).isRequired});const Jm=(0,n.connect)((function(){const e=(0,d.YX)();return t=>{const s=(0,u.ev)(t),n=(0,u.VP)(t,s||"");return{currentUser:(0,p.ts)(t),isAdmin:(0,p.BW)(t),preferences:e(t,N.uP.RECOMMENDED_NEXT_STEPS),steps:ms(t),isFirstAdmin:us(t),team:n}}}),(function(e){return{actions:(0,a.bindActionCreators)({savePreferences:Oe.$A,setShowNextStepsView:Wt,getProfiles:r.cp,closeRightHandSide:Ve.Lg},e)}}))(zm);var Xm=s(6171),Qm=s(11728),$m=s(37611),eg=s(16165),tg=s(76908);const sg=[lr.ap.aS,lr.ap.o$];class ng extends M.PureComponent{render(){const{isMobile:e,createAt:t,isScrolling:s,isRhsPost:n,toastPresent:a}=this.props;if(!e||0===t)return null;const i=W()("post-list__timestamp",{scrolling:s,rhs:n,toastAdjustment:a});return M.createElement("div",{className:i,"data-testid":"floatingTimestamp"},M.createElement("div",null,M.createElement("span",null,M.createElement(lr.ZP,{value:t,useTime:!1,ranges:sg}))))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(ng,"propTypes",{isScrolling:y().bool.isRequired,isMobile:y().bool.isRequired,createAt:y().oneOfType([y().instanceOf(Date),y().number]).isRequired,toastPresent:y().bool.isRequired,isRhsPost:y().bool});const ag=(0,n.connect)((function(e,t){let s=t.postId;if(Xm.mM(s)){const e=Xm.v0(s);s=e[e.length-1]}const n=(0,Qe.xl)(e,s),a=(0,tg.E)(e);return{createAt:n?n.create_at:0,toastPresent:a}}))(ng);var ig=s(59929),rg=s(51102);class og extends M.PureComponent{render(){if(!this.props.fileInfos||0===this.props.fileInfos.length)return null;let e=null;return this.props.fileInfos.length>1&&(e=M.createElement(V.Z,{id:"post_body.plusMore",defaultMessage:" plus {count, number} other {count, plural, one {file} other {files}}",values:{count:this.props.fileInfos.length-1}})),M.createElement("span",null,this.props.fileInfos[0].name,e)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(og,"propTypes",{parentPostId:y().string.isRequired,fileInfos:y().arrayOf(y().object)});const lg=(0,n.connect)((function(){const e=(0,ue.Tw)();return function(t,s){let n;return s.parentPostId&&(n=e(t,s.parentPostId)),{fileInfos:n}}}))(og);var cg=s(35845);function dg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class hg extends M.PureComponent{constructor(...e){super(...e),dg(this,"makeUsername",(()=>{const e=this.props.post.props;let t=this.props.displayName;return this.props.enablePostUsernameOverride&&e&&"true"===e.from_webhook&&e.override_username&&(t=e.override_username),t})),dg(this,"makeCommentedOnMessage",(()=>{const{post:e}=this.props;let t="";if(e.message)t=I.DB(e.message);else if(e.file_ids&&e.file_ids.length>0)t=M.createElement(lg,{parentPostId:e.id});else if(e.props&&e.props.attachments&&e.props.attachments.length>0){const s=e.props.attachments[0],n=s.pretext||s.title||s.text||s.fallback||"";t=I.DB(n)}return t}))}render(){const e=this.makeUsername(),t=this.makeCommentedOnMessage(),s=this.props.parentPostUser,n=s&&s.id||"",a=M.createElement(cg.Z,{user:s,userId:n,displayName:e,hasMention:!0,disablePopover:!1});return M.createElement("div",{"data-testid":"post-link",className:"post__link"},M.createElement("span",null,M.createElement(V.Z,{id:"post_body.commentedOn",defaultMessage:"Commented on {name}'s message: ",values:{name:M.createElement("a",{className:"theme user_name"},a)}}),M.createElement("a",{className:"theme",onClick:this.props.onCommentClick},"string"==typeof t?(0,rg.LV)(t):t)))}}dg(hg,"propTypes",{displayName:y().string,enablePostUsernameOverride:y().bool,onCommentClick:y().func});const pg=(0,n.connect)((function(e,t){let s="";if(t.post){const n=(0,p.PR)(e,t.post.user_id);s=(0,I.hI)(e,n)}return{displayName:s,enablePostUsernameOverride:"true"===(0,h.iE)(e).EnablePostUsernameOverride}}))(hg);var ug=s(75515);function mg(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function gg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class fg extends M.PureComponent{constructor(...e){super(...e),gg(this,"retryPost",(e=>{e.preventDefault();const t=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?mg(Object(s),!0).forEach((function(t){gg(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):mg(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},this.props.post);Reflect.deleteProperty(t,"id"),this.props.actions.createPost(t)})),gg(this,"cancelPost",(e=>{e.preventDefault(),this.props.actions.removePost(this.props.post)}))}render(){return M.createElement("span",{className:"pending-post-actions"},M.createElement("a",{className:"post-retry",href:"#",onClick:this.retryPost},M.createElement(V.Z,{id:"pending_post_actions.retry",defaultMessage:"Retry"}))," - ",M.createElement("a",{className:"post-cancel",href:"#",onClick:this.cancelPost},M.createElement(V.Z,{id:"pending_post_actions.cancel",defaultMessage:"Cancel"})))}}gg(fg,"propTypes",{actions:y().shape({createPost:y().func.isRequired,removePost:y().func.isRequired}).isRequired});const Eg=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({createPost:U.qb,removePost:x.M8},e)}}))(fg);var Cg=s(59474),bg=s(73862),_g=s(98368),vg=s(10005),yg=s(67705);function Mg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Pg extends M.PureComponent{constructor(e){super(e),Mg(this,"maxHeight",void 0),Mg(this,"textContainer",void 0),Mg(this,"overflowRef",void 0),Mg(this,"toggleCollapse",(e=>{e.preventDefault(),this.setState((e=>({isCollapsed:!e.isCollapsed})))})),Mg(this,"checkTextOverflow",(()=>{this.overflowRef&&window.cancelAnimationFrame(this.overflowRef),this.overflowRef=window.requestAnimationFrame((()=>{let e=!1;this.textContainer.current&&this.textContainer.current.scrollHeight>this.maxHeight&&(e=!0),e!==this.state.isOverflow&&this.setState({isOverflow:e})}))})),Mg(this,"handleResize",(()=>{this.checkTextOverflow()})),this.maxHeight=this.props.isAttachmentText?200:600,this.textContainer=M.createRef(),this.state={isCollapsed:!0,isOverflow:!1}}componentDidMount(){this.checkTextOverflow(),window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){this.props.text===e.text&&this.props.isRHSExpanded===e.isRHSExpanded&&this.props.isRHSOpen===e.isRHSOpen&&this.props.checkOverflow===e.checkOverflow||this.checkTextOverflow()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize),this.overflowRef&&window.cancelAnimationFrame(this.overflowRef)}render(){const{isCollapsed:e,isOverflow:t}=this.state,{text:s,children:n,isAttachmentText:a,compactDisplay:i}=this.props;let r,o="post-message";e?(r=this.maxHeight,o+=" post-message--collapsed"):o+=" post-message--expanded",""===s&&(o+=" hidden");const l=a?"post-attachment-collapse__gradient":"post-collapse__gradient",c=a?"post-attachment-collapse__show-more":"post-collapse__show-more";let d=null;if(t){!a&&e&&i&&r&&(r-=22);let t="fa fa-angle-up",s=(0,I._u)("post_info.message.show_less","Show less");e&&(t="fa fa-angle-down",s=(0,I._u)("post_info.message.show_more","Show more")),d=M.createElement("div",{className:"post-collapse"},M.createElement("div",{id:"collapseGradient",className:l}),M.createElement("div",{className:c},M.createElement("div",{className:"post-collapse__show-more-line"}),M.createElement("button",{id:"showMoreButton",className:"post-collapse__show-more-button",onClick:this.toggleCollapse},M.createElement("span",{className:t}),s),M.createElement("div",{className:"post-collapse__show-more-line"}))),o+=" post-message--overflow"}return M.createElement("div",{className:o},M.createElement("div",{style:{maxHeight:r},className:"post-message__text-container",ref:this.textContainer},n),d)}}Mg(Pg,"propTypes",{children:y().node,checkOverflow:y().number,isAttachmentText:y().bool,isRHSExpanded:y().bool.isRequired,isRHSOpen:y().bool.isRequired,text:y().string,compactDisplay:y().bool.isRequired});const wg=(0,n.connect)((function(e){return{isRHSExpanded:(0,Ke.OZ)(e),isRHSOpen:(0,Ke.aC)(e),compactDisplay:(0,d.U2)(e,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.MESSAGE_DISPLAY,N.uP.MESSAGE_DISPLAY_DEFAULT)===N.uP.MESSAGE_DISPLAY_COMPACT}}))(Pg);function Sg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Tg extends M.PureComponent{constructor(e){super(e),Sg(this,"handleClick",(async()=>{const{binding:e,post:t,intl:s}=this.props;if(!e.call)return;let n="";const{data:a}=await this.props.actions.getChannel(t.channel_id);a&&(n=a.team_id);const i=(0,Yd.qM)(e.app_id,Vd.NR.IN_POST+"/"+e.location,t.channel_id,n,t.id,t.root_id),r=(0,Yd.Zw)(e.call,i,{post:Vd.JI.EXPAND_ALL});this.setState({executing:!0});const o=await this.props.actions.doAppCall(r,Vd._L.SUBMIT,s);if(this.setState({executing:!1}),o.error){const e=o.error,n=e.error||s.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForPost(e,n,t)}const l=o.data;switch(l.type){case Vd.Bp.OK:l.markdown&&this.props.actions.postEphemeralCallResponseForPost(l,l.markdown,t);break;case Vd.Bp.NAVIGATE:case Vd.Bp.FORM:break;default:{const e=s.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:l.type});this.props.actions.postEphemeralCallResponseForPost(l,e,t)}}})),this.state={executing:!1}}render(){const{binding:e}=this.props;return e.call?M.createElement("button",{onClick:this.handleClick,style:void 0},M.createElement(Gr.Z,{loading:this.state.executing},M.createElement(ft.Z,{message:e.label,options:{mentionHighlight:!1,markdown:!1,autolinkedUrlSchemes:[]}}))):null}}Sg(Tg,"propTypes",{actions:y().shape({getChannel:y().func.isRequired}).isRequired});const Ng=(0,K.ZP)(Tg),Rg=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({doAppCall:Kd.cW,getChannel:o.mr,postEphemeralCallResponseForPost:Kd.Rv},e)}}))(Ng);var Ig=s(70668),Og=s(52166),Lg=s(51695);function Ag(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class kg extends M.PureComponent{constructor(e){super(e),Ag(this,"providers",void 0),Ag(this,"handleSelected",(async e=>{var t;if(!e)return;this.setState({selected:e});const s=null===(t=this.props.binding.bindings)||void 0===t?void 0:t.find((t=>t.location===e.value));if(!s)return void console.debug("Trying to select element not present in binding.");if(!s.call)return;const{post:n,intl:a}=this.props;let i="";const{data:r}=await this.props.actions.getChannel(n.channel_id);r&&(i=r.team_id);const o=(0,Yd.qM)(s.app_id,Vd.NR.IN_POST+"/"+s.location,n.channel_id,i,n.id,n.root_id),l=(0,Yd.Zw)(s.call,o,{post:Vd.JI.EXPAND_ALL}),c=await this.props.actions.doAppCall(l,Vd._L.SUBMIT,a);if(c.error){const e=c.error,t=e.error||a.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForPost(e,t,n)}const d=c.data;switch(d.type){case Vd.Bp.OK:d.markdown&&this.props.actions.postEphemeralCallResponseForPost(d,d.markdown,n);break;case Vd.Bp.NAVIGATE:case Vd.Bp.FORM:break;default:{const e=this.props.intl.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:d.type});this.props.actions.postEphemeralCallResponseForPost(d,e,n)}}}));const t=e.binding;if(this.providers=[],t.bindings){const e=t.bindings.map((e=>({text:e.label,value:e.location})));this.providers=[new Ig.Z(e)]}this.state={}}render(){const{binding:e}=this.props;return M.createElement(Lg.Z.Consumer,null,(({handlePopupOpened:t})=>{var s;return M.createElement(Og.Z,{providers:this.providers,onSelected:this.handleSelected,placeholder:e.label,inputClassName:"post-attachment-dropdown",value:null===(s=this.state.selected)||void 0===s?void 0:s.text,toggleFocus:t})}))}}Ag(kg,"propTypes",{actions:y().shape({getChannel:y().func.isRequired}).isRequired});const xg=(0,K.ZP)(kg),Dg=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({doAppCall:Kd.cW,getChannel:o.mr,postEphemeralCallResponseForPost:Kd.Rv},e)}}))(xg);function Zg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Hg extends M.PureComponent{constructor(...e){super(...e),Zg(this,"fillBindings",(e=>{const t=JSON.parse(JSON.stringify(e));return(0,Yd.r)(t),t.bindings})),Zg(this,"renderBindings",(()=>{if(!this.props.embed.app_id)return null;if(!this.props.embed.bindings)return null;const e=this.fillBindings(this.props.embed);if(!e||!e.length)return null;const t=[];return e.forEach((e=>{e.call&&e.location&&(e.bindings&&e.bindings.length>0?t.push(M.createElement(Dg,{key:e.location,post:this.props.post,binding:e})):t.push(M.createElement(Rg,{key:e.location,post:this.props.post,binding:e})))})),M.createElement("div",{className:"attachment-actions"},t)})),Zg(this,"handleFormattedTextClick",(e=>I.QJ(e,this.props.currentRelativeTeamUrl)))}render(){const{embed:e,options:t}=this.props;let s,n;e.label&&(s=M.createElement("h1",{className:"attachment__title"},M.createElement(ft.Z,{message:e.label,options:{mentionHighlight:!1,renderer:new yg.Z,autolinkedUrlSchemes:[]}}))),e.description&&(n=M.createElement(wg,{isAttachmentText:!0,text:e.description||""},M.createElement(ft.Z,{message:e.description,options:t})));const a=this.renderBindings();return M.createElement("div",{className:"attachment",ref:"attachment",onClick:this.handleFormattedTextClick},M.createElement("div",{className:"attachment__content"},M.createElement("div",{className:"clearfix attachment__container attachment__container--"},s,M.createElement("div",null,M.createElement("div",{className:"attachment__body attachment__body--no_thumb"},n,a),M.createElement("div",{style:qg.footer})))))}}Zg(Hg,"propTypes",{currentRelativeTeamUrl:y().string.isRequired});const qg={footer:{clear:"both"}},jg=(0,n.connect)((function(e){return{currentRelativeTeamUrl:(0,u.gm)(e)}}))(Hg);function Ug(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Fg extends M.PureComponent{render(){const e=[];return this.props.embeds.forEach(((t,s)=>{e.push(M.createElement(jg,{embed:t,post:this.props.post,key:"att_"+s,options:this.props.options}))})),M.createElement("div",{id:"messageAttachmentList_".concat(this.props.post.id),className:"attachment__list"},e)}}function Bg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Ug(Fg,"propTypes",{embeds:y().array.isRequired}),Ug(Fg,"defaultProps",{imagesMetadata:{}});class Gg extends M.PureComponent{constructor(...e){super(...e),Bg(this,"toggleEmbedVisibility",(()=>{this.props.actions.toggleEmbedVisibility(this.props.post.id)})),Bg(this,"getEmbed",(()=>{const{metadata:e}=this.props.post;return(0,ig.VV)(e)})),Bg(this,"isEmbedToggleable",(e=>{const t=this.props.pluginPostWillRenderEmbedComponents||[];for(const s of t)if(s.match(e))return Boolean(s.toggleable);return"image"===e.type||"opengraph"===e.type&&vg.Z.isYoutubeLink(e.url)})),Bg(this,"renderEmbed",(e=>{const t=this.props.pluginPostWillRenderEmbedComponents||[];for(const s of t)if(s.match(e)){const t=s.component;return this.props.isEmbedVisible&&M.createElement(t,{embed:e})}switch(e.type){case"image":return this.props.isEmbedVisible?M.createElement(_g.Z,{imageMetadata:this.props.post.metadata.images[e.url],link:e.url,post:this.props.post}):null;case"message_attachment":{let e=[];return this.props.post.props&&this.props.post.props.attachments&&(e=this.props.post.props.attachments),M.createElement(Cg.Z,{attachments:e,postId:this.props.post.id,options:this.props.options,imagesMetadata:this.props.post.metadata.images})}case"opengraph":return vg.Z.isYoutubeLink(e.url)?this.props.isEmbedVisible?M.createElement(vg.Z,{postId:this.props.post.id,link:e.url,show:this.props.isEmbedVisible}):null:M.createElement(bg.Z,{postId:this.props.post.id,link:e.url,isEmbedVisible:this.props.isEmbedVisible,post:this.props.post,toggleEmbedVisibility:this.toggleEmbedVisibility});default:return null}})),Bg(this,"renderToggle",(e=>M.createElement("button",{key:"toggle",className:"style--none post__embed-visibility color--link ".concat(e?"pull-left":""),"data-expanded":this.props.isEmbedVisible,"aria-label":"Toggle Embed Visibility",onClick:this.toggleEmbedVisibility})))}render(){const e=this.getEmbed();if(this.props.appsEnabled&&((t=this.props.post.props)&&t.app_bindings&&t.app_bindings.length))return M.createElement(M.Fragment,null,this.props.children,M.createElement(Fg,{embeds:this.props.post.props.app_bindings,post:this.props.post}));var t;if(e){const t=this.isEmbedToggleable(e),s=/^\s*https?:\/\/.*$/.test(this.props.post.message);return M.createElement("div",null,t&&s&&this.renderToggle(!0),this.props.children,t&&!s&&this.renderToggle(!1),this.renderEmbed(e))}return this.props.children}}Bg(Gg,"propTypes",{pluginPostWillRenderEmbedComponents:y().array,children:y().element,isEmbedVisible:y().bool,appsEnabled:y().bool.isRequired,actions:y().shape({toggleEmbedVisibility:y().func.isRequired}).isRequired});const Vg=(0,n.connect)((function(e,t){return{isEmbedVisible:(0,B.Y_)(e,t.post.id),pluginPostWillRenderEmbedComponents:e.plugins.components.PostWillRenderEmbedComponent,appsEnabled:(0,Gd.D)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({toggleEmbedVisibility:U.bV},e)}}))(Gg);var Kg=s(2803);function Yg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Wg extends M.PureComponent{constructor(e){super(e),Yg(this,"imageProps",void 0),Yg(this,"checkPostOverflow",(()=>{this.setState((e=>({checkOverflow:e.checkOverflow+1})))})),Yg(this,"handleHeightReceived",(e=>{e>0&&this.checkPostOverflow()})),Yg(this,"handleFormattedTextClick",(e=>I.QJ(e,this.props.currentRelativeTeamUrl))),this.state={collapse:!0,hasOverflow:!1,checkOverflow:0},this.imageProps={onImageLoaded:this.handleHeightReceived,onImageHeightChanged:this.checkPostOverflow}}renderDeletedPost(){return M.createElement("p",null,M.createElement(V.Z,{id:"post_body.deleted",defaultMessage:"(message deleted)"}))}renderEditedIndicator(){return z.cq(this.props.post)?M.createElement("span",{id:"postEdited_".concat(this.props.post.id),className:"post-edited__indicator"},M.createElement(V.Z,{id:"post_message_view.edited",defaultMessage:"(edited)"})):null}render(){const{post:e,enableFormatting:t,options:s,pluginPostTypes:n,compactDisplay:a,isRHS:i,theme:r,wordBlocked:o}=this.props;if(e.state===D.V8.POST_DELETED)return this.renderDeletedPost();let l=o.reduce(((e,t)=>{const s=new RegExp(t,"ig");return t.length<3?e.replace(s,"✴✴"):e.replace(s,"✴✴✴")}),e.message);if(!t)return M.createElement("span",null,l);const c=e.props&&e.props.type?e.props.type:e.type;if(n&&n.hasOwnProperty(c)){const t=n[c].component;return M.createElement(t,{post:e,compactDisplay:a,isRHS:i,theme:r})}const d=I.Kx(e);if(a&&d){const e=I._u("post_info.message.visible.compact"," (Only visible to you)");l=l.concat(e)}const h=i?"rhsPostMessageText_".concat(e.id):"postMessageText_".concat(e.id);return M.createElement(wg,{checkOverflow:this.state.checkOverflow,text:l||""},M.createElement("div",{"aria-readonly":"true",tabIndex:0,id:h,className:"post-message__text",dir:"auto",onClick:this.handleFormattedTextClick},M.createElement(Kg.Z,{message:l,imageProps:this.imageProps,isRHS:i,options:s,post:e,channelId:e.channel_id,mentionKeys:[]})),this.renderEditedIndicator(),M.createElement(A.Z,{pluggableName:"PostMessageAttachment",postId:e.id,onHeightChange:this.handleHeightReceived}))}}Yg(Wg,"propTypes",{enableFormatting:y().bool,compactDisplay:y().bool,isRHS:y().bool,isRHSOpen:y().bool,isRHSExpanded:y().bool,pluginPostTypes:y().any,currentRelativeTeamUrl:y().string.isRequired,wordBlocked:y().arrayOf(y().string).isRequired}),Yg(Wg,"defaultProps",{options:{},isRHS:!1,pluginPostTypes:{}});const zg=(0,n.connect)((function(e){return{enableFormatting:(0,d.o4)(e,D.uP.CATEGORY_ADVANCED_SETTINGS,"formatting",!0),isRHSExpanded:(0,Ke.OZ)(e),isRHSOpen:(0,Ke.aC)(e),pluginPostTypes:e.plugins.postTypes,theme:(0,d.gh)(e),currentRelativeTeamUrl:(0,u.gm)(e),wordBlocked:(0,h.Cu)(e)}}))(Wg);function Jg(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Xg extends M.PureComponent{constructor(e){super(e),this.sendingAction=new pt.Z((()=>{const e=this.props.post;e&&e.id===e.pending_post_id&&this.setState({sending:!0})})),this.state={sending:!1}}static getDerivedStateFromProps(e,t){return t.sending&&e.post&&e.post.id!==e.post.pending_post_id?{sending:!1}:null}componentDidUpdate(){!1===this.state.sending&&this.sendingAction.cancel()}componentDidMount(){const e=this.props.post;e&&e.id===e.pending_post_id&&this.sendingAction.fireAfter(3e3)}componentWillUnmount(){this.sendingAction.cancel()}render(){const e=this.props.post,t=this.props.user,s=this.props.parentPost,n=this.props.parentPostUser;let a,i="";const r=I.Kx(e);if(I.A0(t))return M.createElement("div",{className:"post__link banned"},"Nội dung bị ẩn do tài khoản bị BAN");let o;this.props.isFirstReply&&s&&e.type!==N.ZP.PostTypes.EPHEMERAL&&(a=M.createElement(pg,{post:s,parentPostUser:n,onCommentClick:this.props.handleCommentClick})),this.props.post.failed&&(i+=" post--fail",o=M.createElement(Eg,{post:this.props.post})),z.cq(this.props.post)&&(i+=" post--edited");let l=null;(e.file_ids&&e.file_ids.length>0||e.filenames&&e.filenames.length>0)&&this.props.post.state!==D.V8.POST_DELETED&&(l=M.createElement(ug.Z,{post:e,compactDisplay:this.props.compactDisplay})),this.state.sending&&(i+=" post-waiting");const c=M.createElement(M.Fragment,null,o,this.state.sending&&M.createElement(bn.Z,null),M.createElement(zg,{post:this.props.post,compactDisplay:this.props.compactDisplay,hasMention:!0})),d=e.type&&this.props.pluginPostTypes.hasOwnProperty(e.type)||e.props&&e.props.type&&this.props.pluginPostTypes.hasOwnProperty(e.props.type);let h;h=this.props.post.state===D.V8.POST_DELETED||d?c:M.createElement(Vg,{post:this.props.post,isEmbedVisible:this.props.isEmbedVisible},c);let p="";this.props.isCommentMention&&(p="mention-comment");let u="";return r&&(u="post--ephemeral"),M.createElement(M.Fragment,null,a,M.createElement("div",{id:"".concat(e.id,"_message"),className:"post__body post__body_x ".concat(p," ").concat(u," ").concat(i)},h,l))}}Jg(Xg,"propTypes",{post:y().object.isRequired,parentPost:y().object,parentPostUser:y().object,handleCommentClick:y().func.isRequired,compactDisplay:y().bool,isCommentMention:y().bool,isFirstReply:y().bool,pluginPostTypes:y().object,isEmbedVisible:y().bool,enablePostUsernameOverride:y().bool.isRequired,isReadOnly:y().bool,user:y().object}),Jg(Xg,"defaultProps",{isReadOnly:!1});const Qg=(0,n.connect)((function(e,t){let s,n;t.post.root_id&&(s=(0,Qe.xl)(e,t.post.root_id),n=s?(0,p.PR)(e,s.user_id):null);const a="true"===(0,h.iE)(e).EnablePostUsernameOverride,i=0!==((0,m.TB)(e)||{}).delete_at;return{parentPost:s,parentPostUser:n,pluginPostTypes:e.plugins.postTypes,enablePostUsernameOverride:a,isReadOnly:(0,m.ui)(e)||i,user:(0,p.PR)(e,t.post.user_id)}}))(Xg);var $g=s(17189);const ef=e=>{const{userId:t,isSystemMessage:s,isBot:a}=e,i=(0,gd.yC)(),r=(0,n.useDispatch)(),o=(0,n.useSelector)((e=>i(e,t))),l=(0,n.useSelector)(gd.bo),c=(0,n.useSelector)(gd.uD),d=o&&o.emoji;return!c||s||a?null:d?M.createElement(cr.Z,{userID:t,showTooltip:!0,emojiStyle:{marginLeft:4,marginTop:2}}):l?M.createElement("div",{onClick:()=>r(Jc(!0)),className:"post__header-set-custom-status cursor--pointer"},M.createElement(ee.Z,{className:"post__header-set-custom-status-icon"}),M.createElement("span",{className:"post__header-set-custom-status-text"},M.createElement(V.Z,{id:"post_header.update_status",defaultMessage:"Update your status"}))):null};ef.propTypes={userId:y().string.isRequired,isSystemMessage:y().bool.isRequired,isBot:y().bool.isRequired};const tf=ef;class sf extends M.PureComponent{render(){var e;const{post:t}=this.props,s=z.Ew(t),n=z.zj(t),a="true"===(null==t||null===(e=t.props)||void 0===e?void 0:e.from_webhook);let i,r,o=M.createElement(Et.Z,{userId:t.user_id,hasMention:!0});a?(o=t.props.override_username&&this.props.enablePostUsernameOverride?M.createElement(Et.Z,{userId:t.user_id,hideStatus:!0,overwriteName:t.props.override_username,overwriteIcon:this.props.overwriteIcon}):M.createElement(Et.Z,{userId:t.user_id,hideStatus:!0}),this.props.isBot||(i=M.createElement(Cn.Z,null))):n?(o=M.createElement(Et.Z,{userId:t.user_id,hideStatus:!0,hasMention:!0}),i=M.createElement($g.Z,null,M.createElement(V.Z,{id:"post_info.auto_responder",defaultMessage:"AUTOMATIC REPLY"}))):s&&this.props.isBot?o=M.createElement(Et.Z,{userId:t.user_id,hideStatus:!0}):s&&(o=M.createElement(Et.Z,{userId:"",overwriteName:M.createElement(V.Z,{id:"post_info.system",defaultMessage:"System"}),overwriteImage:N.ZP.SYSTEM_MESSAGE_PROFILE_IMAGE,disablePopover:!0})),this.props.compactDisplay&&(r=M.createElement("strong",{className:"colon"},":"));const l=M.createElement(tf,{userId:this.props.post.user_id,isBot:this.props.isBot||a,isSystemMessage:s});return M.createElement("div",{className:"post__header post__header_x"},o,r,i,l)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(sf,"propTypes",{handleCommentClick:y().func.isRequired,handleCardClick:y().func.isRequired,handleDropdownOpened:y().func.isRequired,compactDisplay:y().bool,replyCount:y().number,isFirstReply:y().bool,hover:y().bool.isRequired,showTimeWithoutHover:y().bool.isRequired,enablePostUsernameOverride:y().bool.isRequired,isBot:y().bool.isRequired,isGuest:y().bool.isRequired,isLastPost:y().bool,overwriteIcon:y().string});const nf=(0,n.connect)((function(e,t){var s,n;const a=(0,h.iE)(e),i="true"===a.EnablePostUsernameOverride,r="true"===a.EnablePostIconOverride&&(null===(s=t.post)||void 0===s||null===(n=s.props)||void 0===n?void 0:n.override_icon_url);let o;r&&(o=Ws.je.getAbsoluteUrl(r));const l=(0,p.PR)(e,t.post.user_id);return{enablePostUsernameOverride:i,isBot:Boolean(l&&l.is_bot),overwriteIcon:o,isGuest:Boolean(l&&(0,I.a_)(l))}}))(sf),af=M.createContext({handlePopupOpened:null});var rf=s(30685);function of(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let lf;var cf;!function(e){e[e.Flagged=0]="Flagged",e[e.Pinned=1]="Pinned",e[e.PinnedAndFlagged=2]="PinnedAndFlagged",e[e.Neither=3]="Neither"}(lf||(lf={})),function(e){e.Flagged="flagged",e.Pinned="pinned",e.PinnedAndFlagged="pinnedAndFlagged"}(cf||(cf={}));class df extends M.PureComponent{constructor(...e){super(...e),of(this,"messageInfos",{flagged:{id:(0,Ae.t)("post_pre_header.flagged"),defaultMessage:"Saved"},pinned:{id:(0,Ae.t)("post_pre_header.pinned"),defaultMessage:"Pinned"}}),of(this,"handleLinkClick",((e,t)=>{e===cf.Pinned&&t?this.props.actions.showPinnedPosts(t):this.props.actions.showFlaggedPosts()}))}getPostStatus(e,t){return e?t?lf.PinnedAndFlagged:lf.Flagged:t?lf.Pinned:lf.Neither}getMessageInfo(e,t,s){if(t&&s)return!1;if(e===lf.PinnedAndFlagged){if(!s&&!t)return cf.PinnedAndFlagged;if(s)return cf.Flagged;if(t)return cf.Pinned}return e!==lf.Flagged||t?e===lf.Pinned&&!s&&cf.Pinned:cf.Flagged}render(){const{isFlagged:e,isPinned:t,skipPinned:s,skipFlagged:n,channelId:a}=this.props,i=this.getMessageInfo(this.getPostStatus(e,t),n,s);return(e||t)&&i?M.createElement("div",{className:"post-pre-header"},M.createElement("div",{className:"post-pre-header__icons-container"},t&&!s&&M.createElement("span",{className:"icon-pin icon icon--post-pre-header"}),e&&!n&&M.createElement(rf.Z,{className:"icon icon--post-pre-header"})),M.createElement("div",{className:"post-pre-header__text-container"},i&&i!==cf.PinnedAndFlagged&&M.createElement("span",null,M.createElement("a",{onClick:()=>this.handleLinkClick(i,a)},M.createElement(V.Z,{id:this.messageInfos[i].id,defaultMessage:this.messageInfos[i].defaultMessage}))),i&&i===cf.PinnedAndFlagged&&M.createElement("span",null,M.createElement("a",{onClick:()=>this.handleLinkClick(cf.Pinned,a)},M.createElement(V.Z,{id:this.messageInfos[cf.Pinned].id,defaultMessage:this.messageInfos[cf.Pinned].defaultMessage})),M.createElement("span",{className:"post-pre-header__link-separator"},"⬤"),M.createElement("a",{onClick:()=>this.handleLinkClick(cf.Flagged)},M.createElement(V.Z,{id:this.messageInfos[cf.Flagged].id,defaultMessage:this.messageInfos[cf.Flagged].defaultMessage}))))):null}}of(df,"propTypes",{isFlagged:y().bool.isRequired,isPinned:y().bool,skipPinned:y().bool,skipFlagged:y().bool,channelId:y().string.isRequired,actions:y().shape({showFlaggedPosts:y().func.isRequired,showPinnedPosts:y().func.isRequired}).isRequired});const hf=(0,K.ZP)(df),pf=(0,n.connect)(null,(e=>({actions:(0,a.bindActionCreators)({showFlaggedPosts:Ve.Yv,showPinnedPosts:Ve.B7},e)})))(hf);var uf=s(25350),mf=s(38373);function gf(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ff extends M.PureComponent{constructor(){super(),gf(this,"handlePress",(e=>{e.preventDefault();const{actions:t,isFlagged:s,postId:n}=this.props;s?t.unflagPost(n):t.flagPost(n)})),gf(this,"handleA11yActivateEvent",(()=>{this.setState({a11yActive:!0})})),gf(this,"handleA11yDeactivateEvent",(()=>{this.setState({a11yActive:!1})})),this.buttonRef=M.createRef(),this.state={a11yActive:!1}}componentDidMount(){this.buttonRef.current&&(this.buttonRef.current.addEventListener(N.sp.ACTIVATE,this.handleA11yActivateEvent),this.buttonRef.current.addEventListener(N.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}componentWillUnmount(){this.buttonRef.current&&(this.buttonRef.current.removeEventListener(N.sp.ACTIVATE,this.handleA11yActivateEvent),this.buttonRef.current.removeEventListener(N.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}componentDidUpdate(){this.state.a11yActive&&this.buttonRef.current&&this.buttonRef.current.dispatchEvent(new Event(N.sp.UPDATE))}render(){const e=this.props.isFlagged;let t;return t=e?M.createElement(rf.Z,{className:W()("icon","icon--small","icon--small-filled",{"post-menu__item--selected":e})}):M.createElement(ao.Z,{className:W()("icon","icon--small")}),M.createElement(tt.Z,{className:"hidden-xs",key:"flagtooltipkey".concat(e?"flagged":""),delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:M.createElement(et.Z,{id:"flagTooltip",className:"hidden-xs"},M.createElement(V.Z,{id:e?(0,Ae.t)("flag_post.unflag"):(0,Ae.t)("flag_post.flag"),defaultMessage:e?"Remove from Saved":"Save"}))},M.createElement("button",{ref:this.buttonRef,id:"".concat(this.props.location,"_flagIcon_").concat(this.props.postId),"aria-label":e?(0,I._u)("flag_post.unflag","Remove from Saved").toLowerCase():(0,I._u)("flag_post.flag","Save").toLowerCase(),className:"post-menu__item",onClick:this.handlePress},t))}}gf(ff,"propTypes",{location:y().oneOf([N.tY.CENTER,N.tY.RHS_ROOT,N.tY.RHS_COMMENT,N.tY.SEARCH]).isRequired,postId:y().string.isRequired,isFlagged:y().bool.isRequired,actions:y().shape({flagPost:y().func.isRequired,unflagPost:y().func.isRequired}).isRequired}),gf(ff,"defaultProps",{location:N.tY.CENTER});const Ef=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({flagPost:U.co,unflagPost:U.xk},e)}}))(ff);var Cf=s(30845),bf=s(56546),_f=s(29278),vf=s(63483),yf=s(43529),Mf=s(79401);class Pf extends M.PureComponent{render(){return M.createElement("div",{className:"emoji-picker__header modal-header"},M.createElement("button",{type:"button",className:"close emoji-picker__header-close-button",onClick:this.props.handleEmojiPickerClose},M.createElement("span",{"aria-hidden":"true"},"×"),M.createElement("span",{className:"sr-only"},M.createElement(V.Z,{id:"emoji_picker.close",defaultMessage:"Close"}))),M.createElement("h4",{className:"modal-title emoji-picker__header-title"},M.createElement(V.Z,{id:"emoji_picker.header",defaultMessage:"Emoji Picker"})))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(Pf,"propTypes",{handleEmojiPickerClose:y().func.isRequired});var wf=s(93814),Sf=s(23493),Tf=s.n(Sf),Nf=s(52332),Rf=s(58122);function If(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Of extends M.Component{constructor(...e){super(...e),If(this,"handleClick",(e=>{e.preventDefault(),this.props.onCategoryClick(this.props.category)}))}shouldComponentUpdate(e){return e.selected!==this.props.selected||e.enable!==this.props.enable}render(){let e="emoji-picker__category";return this.props.selected&&(e+=" emoji-picker__category--selected"),this.props.enable||(e+=" disable"),M.createElement("a",{className:e,href:"#",onClick:this.handleClick,"aria-label":this.props.category},this.props.icon)}}If(Of,"propTypes",{category:y().string.isRequired,icon:y().node.isRequired,onCategoryClick:y().func.isRequired,selected:y().bool.isRequired,enable:y().bool.isRequired});var Lf=s(3601);function Af(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class kf extends M.Component{constructor(...e){super(...e),Af(this,"emojiItemRef",(e=>{this.emojiItem=e})),Af(this,"emojiName",(()=>{const{formatMessage:e}=this.props.intl;return e({id:"emoji_picker_item.emoji_aria_label",defaultMessage:"{emojiName} emoji"},{emojiName:this.props.emoji.aliases[0].replace(/_/g," ")})})),Af(this,"handleMouseOver",(()=>{this.props.isSelected||this.props.onItemOver(this.props.categoryIndex,this.props.emojiIndex)})),Af(this,"handleMouseOverThrottle",rr()(this.handleMouseOver,150,{leading:!0,trailing:!0})),Af(this,"handleClick",(()=>{this.props.onItemClick(this.props.emoji)}))}shouldComponentUpdate(e){return e.isSelected!==this.props.isSelected}componentDidUpdate(e){if(!e.isSelected&&this.props.isSelected){const e=this.emojiItem.offsetTop,t=e+this.emojiItem.offsetHeight,{containerRef:s,containerTop:n,containerBottom:a}=this.props;e<n?s.scrollTop=e-10:t>a&&(s.scrollTop=t-s.offsetHeight+10)}}render(){const{emoji:e}=this.props;let t="emoji-picker__item";this.props.isSelected&&(t+=" selected");let s,n="emojisprite";return n+=" emoji-category-"+e.category+"-"+e.batch,n+=" emoji-"+e.filename,s=e.category&&e.batch?M.createElement("img",{alt:"emoji image","data-testid":e.aliases,onMouseOver:this.handleMouseOverThrottle,src:Rf.Z,className:n,onClick:this.handleClick,id:"emoji-"+e.filename,"aria-label":this.emojiName(),role:"button",loading:"lazy"}):M.createElement("img",{alt:"custom emoji image",onMouseOver:this.handleMouseOver,src:(0,Lf.UK)(e),className:"emoji-category--custom",onClick:this.handleClick,loading:"lazy"}),M.createElement("div",{className:t,ref:this.emojiItemRef},M.createElement("div",{"data-testid":"emojiItem"},s))}}Af(kf,"propTypes",{emoji:y().object.isRequired,onItemOver:y().func.isRequired,onItemClick:y().func.isRequired,category:y().string.isRequired,isSelected:y().bool,categoryIndex:y().number.isRequired,emojiIndex:y().number.isRequired,containerRef:y().any,containerTop:y().number.isRequired,containerBottom:y().number.isRequired,intl:J.gm.isRequired});const xf=(0,K.ZP)(kf);function Df(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Zf(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Df(Object(s),!0).forEach((function(t){Hf(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Df(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Hf(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const qf="searchResults";(0,Ae.t)("emoji_picker.searchResults");const jf={recent:{name:"recent",className:"fa fa-clock-o",id:(0,Ae.t)("emoji_picker.recent"),message:"Recently Used",offset:0}},Uf={people:{name:"people",className:"fa fa-smile-o",id:(0,Ae.t)("emoji_picker.people"),message:"People",offset:0}},Ff=Zf(Zf({},Uf),{},{nature:{name:"nature",className:"fa fa-leaf",id:(0,Ae.t)("emoji_picker.nature"),message:"Nature",offset:0},foods:{name:"foods",className:"fa fa-cutlery",id:(0,Ae.t)("emoji_picker.foods"),message:"Foods",offset:0},activity:{name:"activity",className:"fa fa-futbol-o",id:(0,Ae.t)("emoji_picker.activity"),message:"Activity",offset:0},places:{name:"places",className:"fa fa-plane",id:(0,Ae.t)("emoji_picker.places"),message:"Places",offset:0},objects:{name:"objects",className:"fa fa-lightbulb-o",id:(0,Ae.t)("emoji_picker.objects"),message:"Objects",offset:0},symbols:{name:"symbols",className:"fa fa-heart-o",id:(0,Ae.t)("emoji_picker.symbols"),message:"Symbols",offset:0},flags:{name:"flags",className:"fa fa-flag-o",id:(0,Ae.t)("emoji_picker.flags"),message:"Flags",offset:0},custom:{name:"custom",className:"fa fa-at",id:(0,Ae.t)("emoji_picker.custom"),message:"Custom",offset:0}});function Bf(e){return e.filename||e.id}class Gf extends M.PureComponent{static getEmojis(e,t){const{categories:s,allEmojis:n}=t,a=e.emojiMap,i=a.customEmojis;for(const t of Object.keys(s)){let r=[];"recent"===t&&e.recentEmojis.length?r=[...e.recentEmojis].reverse().filter((e=>a.has(e))).map((e=>a.get(e))):(r=(Nf.Ur.get(t)||[]).map((e=>Nf.Ax[e])),"custom"===t&&(r=r.concat([...i.values()]))),s[t].emojiIds=r.map((e=>Bf(e)));for(let e=0;e<r.length;e++){const t=r[e],s=Bf(t);n[s]=Zf(Zf({},t),{},{visible:!1,offset:null}),t.filename||(n[s]=Zf(Zf({},n[s]),{},{aliases:[t.name],category:"custom",filename:s}))}}return{categories:s,allEmojis:n}}static getDerivedStateFromProps(e,t){let s={emojiMap:e.emojiMap};if(JSON.stringify(Object.keys(t.categories))!==t.categoryKeys||e.emojiMap!==t.emojiMap){const{categories:n,allEmojis:a}=Gf.getEmojis(e,t);s=Zf(Zf({},s),{},{categories:n,allEmojis:a,categoryKeys:JSON.stringify(Object.keys(n))})}return s}constructor(e){super(e),Hf(this,"renderAllCategories",(()=>{const e=this.props.recentEmojis.length?Zf(Zf({},jf),Ff):Ff;this.setState((t=>({categories:Zf(Zf({},e),t.categories),renderAllCategories:!0})))})),Hf(this,"loadMoreCustomEmojis",(async()=>{if(!this.props.customEmojisEnabled||this.loadingMoreEmojis)return;this.loadingMoreEmojis=!0;const{data:e}=await this.props.actions.getCustomEmojis(this.props.customEmojiPage,200);if(e){if(e.length<200)return this.missingPages=!1,void(this.loadingMoreEmojis=!1);await this.props.actions.incrementEmojiPickerPage(),this.loadingMoreEmojis=!1}else this.loadingMoreEmojis=!1})),Hf(this,"lastVisibleEmojiRef",(e=>{this.lastVisibleEmoji=e})),Hf(this,"emojiPickerContainerRef",(e=>{this.emojiPickerContainer=e})),Hf(this,"emojiSearchInput",(e=>{this.searchInput=e})),Hf(this,"handleCategoryClick",(e=>{this.setState({cursor:[Object.keys(this.state.categories).indexOf(e),0]}),this.updateEmojisToShow(this.state.categories[e].offset),this.emojiPickerContainer.scrollTop=this.state.categories[e].offset,this.searchInput.focus()})),Hf(this,"handleFilterChange",(e=>{e.preventDefault();const t=function(e){return e.toLowerCase().replace(/^:|:$/g,"")}(e.target.value);this.props.customEmojisEnabled&&t&&""!==t.trim()&&this.props.actions.searchCustomEmojis(t),this.props.handleFilterChange(t),this.setState((()=>({cursor:[-1,-1]})))})),Hf(this,"handleItemOver",((e,t)=>{this.setState({cursor:[e,t]})})),Hf(this,"handleItemClick",(e=>{this.props.onEmojiClick(e)})),Hf(this,"handleCategoryKeyDown",(e=>{switch(e.key){case"ArrowRight":e.preventDefault(),this.selectNextEmoji(),this.searchInput.focus();break;case"ArrowLeft":e.preventDefault(),this.selectPrevEmoji(),this.searchInput.focus();break;case"ArrowUp":e.preventDefault(),this.selectPrevEmoji(9),this.searchInput.focus();break;case"ArrowDown":e.preventDefault(),this.selectNextEmoji(9),this.searchInput.focus()}})),Hf(this,"handleKeyDown",(e=>{switch(e.key){case"ArrowRight":(-1!==this.state.cursor[0]||-1!==this.state.cursor[1]||e.target.selectionStart+1>this.props.filter.length)&&(e.preventDefault(),this.selectNextEmoji());break;case"ArrowLeft":this.state.cursor[0]>0||this.state.cursor[1]>0?(e.preventDefault(),this.selectPrevEmoji()):0===this.state.cursor[0]&&0===this.state.cursor[1]&&(this.setState({cursor:[-1,-1]}),e.target.selectionStart=this.props.filter.length,e.target.selectionEnd=this.props.filter.length,e.preventDefault(),this.searchInput.focus());break;case"ArrowUp":e.preventDefault(),e.shiftKey?e.target.selectionStart=0:-1===this.state.cursor[0]?(e.target.selectionStart=0,e.target.selectionEnd=0):0===this.state.cursor[0]&&this.state.cursor[1]<9?(this.setState({cursor:[-1,-1]}),e.target.selectionStart=this.props.filter.length,e.target.selectionEnd=this.props.filter.length,this.searchInput.focus()):this.selectPrevEmoji(9);break;case"ArrowDown":e.preventDefault(),e.shiftKey?e.target.selectionEnd=this.props.filter.length:this.props.filter&&0===e.target.selectionStart?(e.target.selectionStart=this.props.filter.length,e.target.selectionEnd=this.props.filter.length):this.selectNextEmoji(9);break;case"Enter":e.preventDefault(),this.getCurrentEmojiByCursor(this.state.cursor)&&this.props.onEmojiClick(this.getCurrentEmojiByCursor(this.state.cursor))}})),Hf(this,"handleScroll",(()=>{this.emojiPickerContainer&&this.updateEmojisToShow(this.emojiPickerContainer.scrollTop)})),Hf(this,"emojiCurrentResultsItems",((e,t,s)=>{const{cursor:n,emojisToShow:a}=this.state;let i=s;return t.map(((t,s)=>{let r;return i++,i===a&&(r=this.lastVisibleEmojiRef),i>=a?M.createElement("div",{key:i,className:"emoji-picker__item",ref:r},M.createElement("img",{alt:"emoji image",src:Rf.Z,className:"emojisprite",loading:"lazy"})):M.createElement(xf,{key:t.filename+":"+s,emoji:t,onItemOver:this.handleItemOver,onItemClick:this.handleItemClick,onItemUnmount:t,category:t.category,isSelected:n[0]===e&&n[1]===s,categoryIndex:e,emojiIndex:s,containerRef:this.emojiPickerContainer,containerTop:this.state.divTopOffset,containerBottom:this.state.divTopOffset+this.divHeight})}))})),Hf(this,"updateCategoryOffset",((e,t)=>{e!==qf&&this.setState((s=>({categories:Zf(Zf({},s.categories),{},{[e]:Zf(Zf({},s.categories[e]),{},{offset:t})})})))})),this.handleScrollThrottle=Tf()(this.handleScroll,100,{leading:!1,trailing:!0}),this.divHeight=0,this.missingPages=!0,this.loadingMoreEmojis=!1;const t=e.recentEmojis.length?Zf(Zf({},jf),Uf):Uf;this.state={allEmojis:{},categories:t,cursor:[-1,-1],divTopOffset:0,emojisToShow:1476,renderAllCategories:!1}}componentDidMount(){0===this.props.customEmojiPage&&this.loadMoreCustomEmojis(),window.requestAnimationFrame((()=>{this.searchInput&&this.searchInput.focus(),this.renderAllCategoriesFrame=window.requestAnimationFrame((()=>{this.renderAllCategories()}))})),this.emojiPickerContainer&&(this.divHeight=this.emojiPickerContainer.offsetHeight);const e=document.getElementById("root");e&&e.classList.add("emoji-picker--active")}updateEmojisToShow(e){if(e!==this.state.divTopOffset&&(this.setState({divTopOffset:e}),this.lastVisibleEmoji)){const t=this.lastVisibleEmoji.offsetTop-(e+290+75);if(t<=0){const e=135+Math.ceil(t/27*9*-1);this.setState((t=>({emojisToShow:t.emojisToShow+e})))}}}componentWillUnmount(){this.renderAllCategoriesFrame&&window.cancelAnimationFrame(this.renderAllCategoriesFrame);const e=document.getElementById("root");e&&e.classList.remove("emoji-picker--active")}componentDidUpdate(e){this.props.visible&&!e.visible&&this.searchInput.focus(),this.missingPages&&this.emojiPickerContainer&&this.emojiPickerContainer.scrollHeight-this.state.divTopOffset-this.emojiPickerContainer.clientHeight<=500&&this.loadMoreCustomEmojis()}selectNextEmoji(e=1){const{cursor:t}=this.state;let s=[t[0],t[1]+e];this.getCurrentEmojiByCursor(s)?this.setState({cursor:s}):(s=[t[0]+1,0],this.getCurrentEmojiByCursor(s)&&this.setState({cursor:s}))}selectPrevEmoji(e=1){const{cursor:t}=this.state;let s=[t[0],t[1]-e];if(this.getCurrentEmojiByCursor(s))this.setState({cursor:s});else if(0!==t[0]){const e=this.getCategoryByIndex(t[0]-1),n=this.state.categories[e.name].emojiIds.length-1;s=[t[0]-1,n],this.getCurrentEmojiByCursor(s)&&this.setState({cursor:s})}}getCategoryByIndex(e){return this.props.filter&&0!==e?null:this.getCategoriesByKey(Object.keys(this.state.categories)[e])}getCurrentEmojiByCursor(e){const t=this.getCategoryByIndex(e[0]);return t?this.getEmojisByCategory(t)[e[1]]:null}getCategoriesByKey(e){return this.props.filter?{id:qf,name:qf}:this.state.categories[e]}sortEmojis(e){const{recentEmojis:t}=this.props,s=[],n=[];Object.values(e).forEach((e=>{let a=n;for(let n=0;n<e.aliases.length;n++)t.includes(e.aliases[n].toLowerCase())&&(a=s);a.push(e)}));const a=(e,t)=>(0,qo.v)(e,t,this.props.filter);return s.sort(a),n.sort(a),[...s,...n]}getEmojisByCategory(e){if(this.props.filter){const e=Object.values(this.state.allEmojis).filter((e=>{for(let t=0;t<e.aliases.length;t++)if(e.aliases[t].toLowerCase().includes(this.props.filter))return!0;return!1}));return this.sortEmojis(e)}return this.state.categories[e.name].emojiIds.map((e=>this.state.allEmojis[e]))}getEmojisByName(e){return Object.values(this.state.allEmojis).filter((t=>{for(let s=0;s<t.aliases.length;s++)if(t.aliases[s].toLowerCase()===e)return!0;return!1}))}getCurrentEmojiName(){const e=this.getCurrentEmojiByCursor(this.state.cursor);return e?e.aliases[0].replace(/_/g," "):""}getCurrentEmojiCategoryName(){const e=Object.keys(this.state.categories);let t=e[0];for(let s=e.length-1;s>=0;s--){const n=this.state.categories[e[s]];if(n.offset&&this.state.divTopOffset>n.offset-20){t=e[s];break}}return t}emojiCategories(){const e=this.props.recentEmojis.length?Zf(Zf({},jf),Ff):Ff,t=Object.keys(e),s=this.props.filter?t[0]:this.getCurrentEmojiCategoryName(),n=t.map((t=>{const n=e[t];return M.createElement(Of,{key:"header-"+n.name,category:n.name,icon:M.createElement(V.Z,{id:n.id,defaultMessage:n.message},(e=>M.createElement("i",{className:n.className,title:e}))),onCategoryClick:this.handleCategoryClick,selected:s===n.name,enable:!this.props.filter})}));return M.createElement("div",{id:"emojiPickerCategories",className:"emoji-picker__categories",onKeyDown:this.handleCategoryKeyDown},n)}emojiSearch(){return M.createElement("div",{className:"emoji-picker__search-container"},M.createElement("span",{className:"fa fa-search emoji-picker__search-icon"}),M.createElement(V.Z,{id:"emoji_picker.search_emoji",defaultMessage:"Search for an emoji"},(e=>M.createElement(pa.Z,{id:"emojiPickerSearch","aria-label":e,ref:this.emojiSearchInput,className:"emoji-picker__search","data-testid":"emojiInputSearch",type:"text",onChange:this.handleFilterChange,onKeyDown:this.handleKeyDown,autoComplete:"off",placeholder:{id:(0,Ae.t)("emoji_picker.search"),defaultMessage:"Search Emoji"},value:this.props.filter}))))}emojiCurrentResults(){const e=["thumbsup","heart","laughing","astonished","cry","rage"].reduce(((e,t)=>[...e,...this.getEmojisByName(t)]),[]),t=this.emojiCurrentResultsItems(0,e,0);return M.createElement("div",{ref:this.emojiPickerContainerRef,onScroll:this.handleScrollThrottle,className:"emoji-picker__items",style:{overflowY:this.state.renderAllCategories?"auto":"hidden"}},M.createElement("div",{className:"emoji-picker__container"},t))}render(){return M.createElement("div",{className:"emoji-picker__inner",role:"application"},M.createElement("div",{"aria-live":"assertive",className:"sr-only"},M.createElement(V.Z,{id:"emoji_picker_item.emoji_aria_label",defaultMessage:"{emojiName} emoji",values:{emojiName:this.getCurrentEmojiName()}})),this.emojiCurrentResults())}}Hf(Gf,"propTypes",{listHeight:y().number,onEmojiClose:y().func.isRequired,onEmojiClick:y().func.isRequired,customEmojisEnabled:y().bool,emojiMap:y().object.isRequired,recentEmojis:y().array.isRequired,customEmojiPage:y().number.isRequired,visible:y().bool,actions:y().shape({getCustomEmojis:y().func.isRequired,searchCustomEmojis:y().func.isRequired,incrementEmojiPickerPage:y().func.isRequired}).isRequired,filter:y().string.isRequired,handleFilterChange:y().func.isRequired}),Hf(Gf,"defaultProps",{listHeight:245,customEmojiPage:0,customEmojisEnabled:!1});const Vf=(0,n.connect)((function(e){return{customEmojisEnabled:"true"===e.entities.general.config.EnableCustomEmoji,customEmojiPage:e.views.emoji.emojiPickerCustomPage,emojiMap:(0,Em.kM)(e),recentEmojis:(0,Em.Gd)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getCustomEmojis:Iu.cc,searchCustomEmojis:Iu.pL,incrementEmojiPickerPage:wf.pN},e)}}))(Gf);function Kf(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Yf(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Wf extends M.PureComponent{constructor(e){super(e),Yf(this,"handleEnterEmojiTab",(()=>{this.setState({emojiTabVisible:!0})})),Yf(this,"handleExitEmojiTab",(()=>{this.setState({emojiTabVisible:!1})})),Yf(this,"handleEmojiPickerClose",(()=>{this.props.onEmojiClose()})),Yf(this,"handleFilterChange",(e=>{this.setState({filter:e})})),this.state={emojiTabVisible:!0,filter:""}}render(){let e;!this.props.style||0===this.props.style.left&&0===this.props.style.top||(e="top"===this.props.placement||"bottom"===this.props.placement?{top:this.props.style.top,bottom:this.props.style.bottom,right:this.props.rightOffset}:function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Kf(Object(s),!0).forEach((function(t){Yf(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Kf(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},this.props.style),e.top=e.top?e.top+this.props.topOffset:this.props.topOffset,e.left&&(e.left+=this.props.leftOffset));let t="emoji-picker";return"bottom"===this.props.placement&&(t+=" bottom"),this.props.enableGifPicker&&void 0!==this.props.onGifClick?M.createElement(_f.Z,{defaultActiveKey:1,id:"emoji-picker-tabs",style:e,className:t,justified:!0},M.createElement(Pf,{handleEmojiPickerClose:this.handleEmojiPickerClose}),M.createElement(vf.Z,{eventKey:1,onEnter:this.handleEnterEmojiTab,onExit:this.handleExitEmojiTab,title:M.createElement(ee.Z,null)},M.createElement(Vf,{style:this.props.style,onEmojiClose:this.props.onEmojiClose,onEmojiClick:this.props.onEmojiClick,customEmojis:this.props.customEmojis,visible:this.state.emojiTabVisible,filter:this.state.filter,handleFilterChange:this.handleFilterChange})),M.createElement(vf.Z,{eventKey:2,title:M.createElement(Mf.Z,null),mountOnEnter:!0,unmountOnExit:!0},M.createElement(yf.Z,{onGifClick:this.props.onGifClick,defaultSearchText:this.state.filter,handleSearchTextChange:this.handleFilterChange}))):M.createElement("div",{id:"emojiPicker-2",style:e,className:"a11y__popup ".concat(t," emoji-picker--single")},M.createElement(Pf,{handleEmojiPickerClose:this.handleEmojiPickerClose}),M.createElement(Vf,{style:this.props.style,onEmojiClose:this.props.onEmojiClose,onEmojiClick:this.props.onEmojiClick,customEmojis:this.props.customEmojis,filter:this.state.filter,handleFilterChange:this.handleFilterChange}))}}function zf(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Yf(Wf,"propTypes",{style:y().object,rightOffset:y().number,topOffset:y().number,leftOffset:y().number,placement:y().oneOf(["top","bottom","left","right"]),customEmojis:y().object,onEmojiClose:y().func.isRequired,onEmojiClick:y().func.isRequired,onGifClick:y().func,enableGifPicker:y().bool}),Yf(Wf,"defaultProps",{rightOffset:0,topOffset:0,leftOffset:0});class Jf extends M.PureComponent{constructor(...e){super(...e),zf(this,"emojiPickerPosition",(0,Cf.default)((e=>{let t=N.gT.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET;return e&&(t=window.innerWidth-e.getBoundingClientRect().left-N.gT.DEFAULT_EMOJI_PICKER_LEFT_OFFSET,t<N.gT.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET&&(t=N.gT.DEFAULT_EMOJI_PICKER_RIGHT_OFFSET)),t}))),zf(this,"getPlacement",(0,Cf.default)(((e,t,s,n)=>{if(e){const a=e.getBoundingClientRect();return(0,bf.b)(a,window.innerHeight,t,s,n)}return"top"})))}render(){const{target:e,rightOffset:t,spaceRequiredAbove:s,spaceRequiredBelow:n,defaultHorizontalPosition:a}=this.props,i=void 0===t?this.emojiPickerPosition(e()):t,r=this.getPlacement(e(),s,n,a);return M.createElement(Zt.Z,{show:this.props.show,placement:r,rootClose:!0,container:this.props.container,onHide:this.props.onHide,target:e,animation:!1},M.createElement(Wf,{enableGifPicker:this.props.enableGifPicker,onEmojiClose:this.props.onHide,onEmojiClick:this.props.onEmojiClick,onGifClick:this.props.onGifClick,rightOffset:i,topOffset:this.props.topOffset,leftOffset:this.props.leftOffset}))}}function Xf(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}zf(Jf,"CENTER_SPACE_REQUIRED_ABOVE",476),zf(Jf,"CENTER_SPACE_REQUIRED_BELOW",497),zf(Jf,"RHS_SPACE_REQUIRED_ABOVE",420),zf(Jf,"RHS_SPACE_REQUIRED_BELOW",420),zf(Jf,"propTypes",{show:y().bool.isRequired,container:y().func,target:y().func.isRequired,onEmojiClick:y().func.isRequired,onGifClick:y().func,onHide:y().func.isRequired,topOffset:y().number,rightOffset:y().number,leftOffset:y().number,spaceRequiredAbove:y().number,spaceRequiredBelow:y().number,enableGifPicker:y().bool,defaultHorizontalPosition:y().oneOf(["left","right"])}),zf(Jf,"defaultProps",{spaceRequiredAbove:Jf.CENTER_SPACE_REQUIRED_ABOVE,spaceRequiredBelow:Jf.CENTER_SPACE_REQUIRED_BELOW,enableGifPicker:!1});class Qf extends M.PureComponent{constructor(...e){super(...e),Xf(this,"handleAddEmoji",(e=>{this.setState({showEmojiPicker:!1});const t=e.name||e.aliases[0];this.props.actions.addReaction(this.props.postId,t),this.props.toggleEmojiPicker()}))}render(){const{channelId:e,location:t,postId:s,showEmojiPicker:n,teamId:a}=this.props;let i,r;return t!==N.tY.RHS_ROOT&&t!==N.tY.RHS_COMMENT||(i=Jf.RHS_SPACE_REQUIRED_ABOVE,r=Jf.RHS_SPACE_REQUIRED_BELOW),M.createElement(bp.Z,{channelId:e,teamId:a,permissions:[Ps.Z.ADD_REACTION]},M.createElement(M.Fragment,null,M.createElement(Jf,{show:n,target:this.props.getDotMenuRef,onHide:this.props.toggleEmojiPicker,onEmojiClose:this.props.toggleEmojiPicker,onEmojiClick:this.handleAddEmoji,topOffset:-7,spaceRequiredAbove:i,n:!0,spaceRequiredBelow:r}),M.createElement(tt.Z,{className:"hidden-xs",delayShow:500,placement:"top",overlay:M.createElement(et.Z,{id:"reaction-icon-tooltip",className:"hidden-xs"},M.createElement(V.Z,{id:"post_info.tooltip.add_reactions",defaultMessage:"Add Reaction"}))},M.createElement("button",{"data-testid":"post-reaction-emoji-icon",id:"".concat(t,"_reaction_").concat(s),"aria-label":(0,I._u)("post_info.tooltip.add_reactions","Add Reaction").toLowerCase(),className:W()("post-menu__item","post-menu__item--reactions",{"post-menu__item--active":n}),onClick:this.props.toggleEmojiPicker},M.createElement(ee.Z,{className:"icon icon--small"})))))}}Xf(Qf,"propTypes",{channelId:y().string,postId:y().string.isRequired,teamId:y().string.isRequired,getDotMenuRef:y().func.isRequired,location:y().oneOf(["CENTER","RHS_ROOT","RHS_COMMENT"]),showEmojiPicker:y().bool,toggleEmojiPicker:y().func.isRequired,actions:y().shape({addReaction:y().func.isRequired}).isRequired}),Xf(Qf,"defaultProps",{location:N.tY.CENTER,showEmojiPicker:!1});const $f=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({addReaction:U.rU},e)}}))(Qf);var eE=s(971);function tE(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class sE extends M.PureComponent{constructor(e){super(e),tE(this,"postHeaderRef",void 0),tE(this,"toggleEmojiPicker",(()=>{const e=!this.state.showEmojiPicker;this.setState({showEmojiPicker:e,showOptionsMenuWithoutHover:!1}),this.props.handleDropdownOpened(e||this.state.showDotMenu)})),tE(this,"removePost",(()=>{this.props.actions.removePost(this.props.post)})),tE(this,"createRemovePostButton",(()=>M.createElement("button",{className:"post__remove theme color--link style--none",type:"button",onClick:this.removePost},"×"))),tE(this,"handleDotMenuOpened",(e=>{this.setState({showDotMenu:e}),this.props.handleDropdownOpened(e||this.state.showEmojiPicker)})),tE(this,"getDotMenu",(()=>this.refs.dotMenu)),tE(this,"buildOptions",((e,t,s)=>{if(!this.props.shouldShowDotMenu)return null;const{isMobile:n,isReadOnly:a}=this.props,i=this.props.hover||this.state.showEmojiPicker||this.state.showDotMenu||this.state.showOptionsMenuWithoutHover,r=n?"hide":"pull-right";let o,l,c,d;return i&&(o=M.createElement(uf.Z,{handleCommentClick:this.props.handleCommentClick,commentCount:this.props.replyCount,postId:e.id,extraClass:r})),!t&&i&&!a&&this.props.enableEmojiPicker&&(l=M.createElement($f,{channelId:e.channel_id,postId:e.id,teamId:this.props.teamId,getDotMenuRef:this.getDotMenu,showEmojiPicker:this.state.showEmojiPicker,toggleEmojiPicker:this.toggleEmojiPicker})),(n||i)&&(c=M.createElement(mf.Z,{post:e,commentCount:this.props.replyCount,isFlagged:this.props.isFlagged,handleCommentClick:this.props.handleCommentClick,handleDropdownOpened:this.handleDotMenuOpened,handleAddReactionClick:this.toggleEmojiPicker,isMenuOpen:this.state.showDotMenu,isReadOnly:a,enableEmojiPicker:this.props.enableEmojiPicker}),l=M.createElement($f,{channelId:e.channel_id,postId:e.id,teamId:this.props.teamId,getDotMenuRef:this.getDotMenu,showEmojiPicker:this.state.showEmojiPicker,toggleEmojiPicker:this.toggleEmojiPicker})),!t&&!n&&(i||this.props.isFlagged)&&(d=M.createElement(Ef,{postId:e.id,isFlagged:this.props.isFlagged})),M.createElement("div",{ref:"dotMenu","data-testid":"post-menu-".concat(e.id),className:"col post-menu post-x"},c,l,d,o)})),tE(this,"handleShortcutReactToLastPost",(e=>{if(e){var t,s,n;const{post:e,isReadOnly:a,enableEmojiPicker:i,isMobile:r,actions:o}=this.props;null===(t=o.emitShortcutReactToLastPostFrom)||void 0===t||t.call(o,N.tY.NO_WHERE);const l=e&&e.state===D.V8.POST_DELETED,c=e&&I.Kx(e),d=e&&z.Ew(e),h=e&&z.zj(e),p=e&&e.failed,u=null===(s=this.postHeaderRef)||void 0===s||null===(n=s.current)||void 0===n?void 0:n.getBoundingClientRect();u&&(!(u.top-65>0&&u.bottom<window.innerHeight-85)||c||d||h||p||l||a||r||!i||this.setState({showOptionsMenuWithoutHover:!0},(()=>{this.toggleEmojiPicker()})))}})),this.state={showEmojiPicker:!1,showOptionsMenuWithoutHover:!1,showDotMenu:!1},this.postHeaderRef=M.createRef()}componentDidUpdate(e){const{shortcutReactToLastPostEmittedFrom:t,isLastPost:s}=this.props;e.shortcutReactToLastPostEmittedFrom!==t&&t===N.tY.CENTER&&void 0!==s&&this.handleShortcutReactToLastPost(s)}render(){const e=this.props.post,t=I.Kx(e),s=z.Ew(e),n=z.zj(e);let a,i,r;return e.props&&e.props.card&&(a=M.createElement(tt.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:M.createElement(et.Z,{id:"viewAdditionalInfo-".concat(e.id)},M.createElement(V.Z,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},M.createElement("button",{className:"card-icon__container icon--show style--none "+(this.props.isCardOpen?"active":""),onClick:e=>{e.preventDefault(),this.props.handleCardClick(this.props.post)}},M.createElement(eE.Z,{className:"icon icon__info","aria-hidden":"true"})))),t?i=M.createElement("div",{className:"col col__remove"},this.createRemovePostButton()):e.failed||(i=this.buildOptions(e,s,n)),t&&!this.props.compactDisplay&&e.state!==D.V8.POST_DELETED&&(r=M.createElement("span",{className:"post__visibility"},M.createElement(V.Z,{id:"post_info.message.visible",defaultMessage:"(Only visible to you)"}))),M.createElement("div",{className:"post__header--info",ref:this.postHeaderRef},M.createElement("div",{className:"col"},a,r),i)}}tE(sE,"propTypes",{teamId:y().string,handleCommentClick:y().func.isRequired,handleCardClick:y().func.isRequired,handleDropdownOpened:y().func.isRequired,isFlagged:y().bool,isCardOpen:y().bool,replyCount:y().number,isFirstReply:y().bool,isMobile:y().bool,compactDisplay:y().bool,hover:y().bool.isRequired,showTimeWithoutHover:y().bool.isRequired,enableEmojiPicker:y().bool,isReadOnly:y().oneOfType([y().bool,y().oneOf([null])]),shortcutReactToLastPostEmittedFrom:y().string,isLastPost:y().bool,actions:y().shape({removePost:y().func.isRequired,emitShortcutReactToLastPostFrom:y().func}).isRequired,shouldShowDotMenu:y().bool.isRequired});const nE=(0,n.connect)((function(e,t){const s=(0,Ke.Kj)(e),n=(0,h.iE)(e),a=e.entities.channels.channels[t.post.channel_id],i=a?0!==a.delete_at:null,r="true"===n.EnableEmojiPicker&&!i,o=(0,u.ev)(e),l=(0,Em.dj)(e);return{teamId:o,isFlagged:null!=(0,d.U2)(e,N.uP.CATEGORY_FLAGGED_POST,t.post.id,null),isMobile:e.views.channel.mobileView,isCardOpen:s&&s.id===t.post.id,enableEmojiPicker:r,isReadOnly:(0,m.ui)(e)||i,shouldShowDotMenu:z.Rj(e,t.post,a),shortcutReactToLastPostEmittedFrom:l}}),(function(e){return{actions:(0,a.bindActionCreators)({removePost:x.M8,emitShortcutReactToLastPostFrom:U.id},e)}}))(sE);function aE(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const iE=[lr.ap.aS,lr.ap.o$];class rE extends M.PureComponent{constructor(...e){super(...e),aE(this,"handleClick",(()=>{(0,I.tq)()&&T.Fy()}))}render(){const{eventTime:e,isPermalink:t,location:s,postId:n,teamUrl:a,timestampProps:i={}}=this.props,r=M.createElement(lr.ZP,Object.assign({value:e,className:"post__time",useDate:!1},i)),o=(0,R.tq)()||!t?M.createElement("div",{role:"presentation",className:"post_permalink_mobile_view"},r):M.createElement(ht.Link,{id:"".concat(s,"_time_").concat(n),to:"".concat(a,"/pl/").concat(n),className:"post__permalink",onClick:this.handleClick},r);return M.createElement(tt.Z,{delayShow:500,placement:"top",overlay:M.createElement(et.Z,{id:e.toString(),className:"hidden-xs"},M.createElement(lr.ZP,{value:e,ranges:iE}))},o)}}aE(rE,"propTypes",{isPermalink:y().bool.isRequired,eventTime:y().number,location:y().string,postId:y().string.isRequired,teamUrl:y().string.isRequired}),aE(rE,"defaultProps",{eventTime:0,location:N.tY.CENTER});const oE=(0,n.connect)((function(e){return{teamUrl:(0,u.gm)(e)}}))(rE);var lE=s(78910),cE=s(36141);function dE(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class hE extends M.PureComponent{constructor(e){super(e),dE(this,"addReactionButtonRef",M.createRef()),dE(this,"getTarget",(()=>this.addReactionButtonRef.current)),dE(this,"handleEmojiClick",(e=>{this.setState({showEmojiPicker:!1});const t=(0,Lf.Vi)(e)?e.name:e.aliases[0];this.props.actions.addReaction(this.props.post.id,t)})),dE(this,"hideEmojiPicker",(()=>{this.setState({showEmojiPicker:!1})})),dE(this,"toggleEmojiPicker",(()=>{this.setState({showEmojiPicker:!this.state.showEmojiPicker})})),this.state={showEmojiPicker:!1}}render(){const e=new Map,t=[];if(this.props.reactions)for(const s of Object.values(this.props.reactions)){const n=s.emoji_name;e.has(n)?e.get(n).push(s):(t.push(n),e.set(n,[s]))}if(0===e.size)return null;const s=t.map((t=>M.createElement(lE.Z,{key:t,post:this.props.post,emojiName:t,reactions:e.get(t)||[]}))),n=this.getTarget();let a=15;n&&(a=window.innerWidth-n.getBoundingClientRect().right-222,a<0&&(a=15));let i=null;if(this.props.enableEmojiPicker){const e=M.createElement(et.Z,{id:"addReactionTooltip"},M.createElement(V.Z,{id:"reaction_list.addReactionTooltip",defaultMessage:"Add a reaction"}));i=M.createElement("span",{className:"emoji-picker__container"},M.createElement(Jf,{show:this.state.showEmojiPicker,target:this.getTarget,onHide:this.hideEmojiPicker,onEmojiClose:this.hideEmojiPicker,onEmojiClick:this.handleEmojiClick,rightOffset:a,topOffset:-5}),M.createElement(bp.Z,{channelId:this.props.post.channel_id,teamId:this.props.teamId,permissions:[Ps.Z.ADD_REACTION]},M.createElement(tt.Z,{placement:"top",delayShow:N.ZP.OVERLAY_TIME_DELAY,overlay:e},M.createElement("button",{"aria-label":(0,I._u)("reaction.add.ariaLabel","Add a reaction"),className:"Reaction",onClick:this.toggleEmojiPicker},M.createElement("span",{id:"addReaction-".concat(this.props.post.id),className:"Reaction__add",ref:this.addReactionButtonRef},M.createElement(cE.Z,null))))))}let r="post-add-reaction";return this.state.showEmojiPicker&&(r+=" post-add-reaction-emoji-picker-open"),M.createElement("div",{"aria-label":(0,I._u)("reaction.container.ariaLabel","reactions"),className:"post-reaction-list"},s,M.createElement("div",{className:r},i))}}dE(hE,"propTypes",{teamId:y().string.isRequired,enableEmojiPicker:y().bool.isRequired,actions:y().shape({addReaction:y().func.isRequired}).isRequired});const pE=(0,n.connect)((function(){const e=(0,Qe.r)();return function(t,s){const n="true"===(0,h.iE)(t).EnableEmojiPicker&&!s.isReadOnly;return{teamId:((0,m.mr)(t,s.post.channel_id)||{}).team_id,reactions:e(t,s.post.id),enableEmojiPicker:n}}}),(function(e){return{actions:(0,a.bindActionCreators)({addReaction:U.rU},e)}}))(hE);var uE=s(59281),mE=s(12770),gE=s(88771),fE=s(12874),EE=s(61577),CE=s(96329);function bE({threadId:e}){const t=(0,n.useDispatch)(),s=(0,n.useSelector)(u.ev),a=(0,n.useSelector)(p.rc),i=(0,n.useSelector)((t=>(0,pi.HA)(t,e)));(0,M.useEffect)((()=>{(0,uE.Y)(i)&&i.is_following&&t((0,fc.bJ)(a,s,e))}),[]);const{participants:r,reply_count:o=0,last_reply_at:l,is_following:c=!1,post:{channel_id:d}}=i,h=(0,M.useMemo)((()=>null==r?void 0:r.map((({id:e})=>e))),[r]),m=(0,M.useCallback)((()=>{t((0,Ve.F8)({id:e,channel_id:d}))}),[e,d]),g=(0,M.useCallback)((()=>{t((0,fc.NC)(a,s,e,!c))}),[c]);return M.createElement("div",{className:"ThreadFooter"},(0,uE.Y)(i)||!i.unread_replies?M.createElement("div",{className:"indicator"}):M.createElement(gE.Z,{id:"threadFooterIndicator",content:M.createElement(V.Z,{id:"threading.numNewMessages",defaultMessage:"{newReplies, plural, =0 {no unread messages} =1 {one unread message} other {# unread messages}}",values:{newReplies:i.unread_replies}})},M.createElement("div",{className:"indicator",tabIndex:0},M.createElement("div",{className:"dot-unreads"}))),h?M.createElement(mE.Z,{userIds:h,size:"sm"}):null,M.createElement(fE.Z,{onClick:m,className:"ReplyButton separated",prepend:M.createElement("span",{className:"icon"},M.createElement("i",{className:"icon-reply-outline"}))},M.createElement(V.Z,{id:"threading.numReplies",defaultMessage:"{totalReplies, plural, =0 {Reply} =1 {# reply} other {# replies}}",values:{totalReplies:o}})),M.createElement(EE.Z,{isFollowing:c,className:"separated",onClick:g}),Boolean(l)&&M.createElement(lr.ZP,Object.assign({value:l},CE._),(({formatted:e})=>M.createElement("span",{className:"Timestamp separated alt-visible"},M.createElement(V.Z,{id:"threading.footer.lastReplyAt",defaultMessage:"Last reply {formatted}",values:{formatted:e}})))))}const _E=(0,M.memo)(bE);function vE(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class yE extends M.PureComponent{constructor(e){super(e),vE(this,"handleCommentClick",(e=>{e.preventDefault();const t=this.props.post;t&&this.props.actions.selectPost(t)})),vE(this,"handleCardClick",(e=>{e&&this.props.actions.selectPostCard(e)})),vE(this,"handlePostClick",(e=>{const t=this.props.post;t&&(this.props.channelIsArchived||t.system_post_ids||e.altKey&&this.props.actions.markPostAsUnread(t,"CENTER"))})),vE(this,"handleDropdownOpened",(e=>{this.props.togglePostMenu&&this.props.togglePostMenu(e),this.setState({dropdownOpened:e})})),vE(this,"hasSameRoot",(e=>{const t=e.post;return!(e.isFirstReply||(t.root_id||e.previousPostIsComment||!e.consecutivePostByUser)&&!t.root_id)})),vE(this,"getClassName",((e,t,s,n,a,i)=>{let r="post";(e.failed||e.state===D.V8.POST_DELETED)&&(r+=" post--hide-controls"),!this.state.fadeOutHighlight&&this.props.shouldHighlight&&(r+=" post--highlight",(e.is_pinned||this.props.isFlagged)&&(r+=" post--pinned-or-flagged-highlight"));let o="";o=this.hasSameRoot(this.props)?"same--root":"other--root",i&&(r+=" post--bot");let l="";n||t||(l="current--user");let c="";this.props.consecutivePostByUser&&(c="same--user");let d="";return e.root_id&&e.root_id.length>0?d="post--comment":this.props.replyCount>0&&(d="post--root",c="",o=""),(t||s)&&(r+=" post--system",t&&(l="",d="",o="")),a&&(d="post--comment same--root"),this.props.compactDisplay&&(r+=" post--compact"),(this.state.dropdownOpened||this.state.a11yActive)&&(r+=" post--hovered"),(e.is_pinned||this.props.isFlagged)&&(r+=" post--pinned-or-flagged"),!this.state.alt||this.props.channelIsArchived||e.system_post_ids||(r+=" cursor--pointer"),this.props.currentUserId===e.user_id&&(r+=" its-me"),r+" "+c+" "+o+" "+d+" "+l})),vE(this,"setHover",(()=>{this.setState({hover:!0})})),vE(this,"unsetHover",(()=>{this.setState({hover:!1})})),vE(this,"handleAlt",(e=>{this.state.alt!==e.altKey&&this.setState({alt:e.altKey})})),vE(this,"handleA11yActivateEvent",(()=>{this.setState({a11yActive:!0,ariaHidden:!1})})),vE(this,"handleA11yDeactivateEvent",(()=>{this.setState({a11yActive:!1,ariaHidden:!0})})),vE(this,"handlePostFocus",(()=>{this.updateAriaLabel()})),vE(this,"updateAriaLabel",(()=>{this.setState({currentAriaLabel:this.props.createAriaLabel(this.props.intl)})})),this.postRef=M.createRef(),this.state={dropdownOpened:!1,hover:!1,alt:!1,a11yActive:!1,currentAriaLabel:"",ariaHidden:!0,fadeOutHighlight:!1}}componentDidMount(){document.addEventListener("keydown",this.handleAlt),document.addEventListener("keyup",this.handleAlt),this.postRef.current&&(this.postRef.current.addEventListener(N.sp.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.addEventListener(N.sp.DEACTIVATE,this.handleA11yDeactivateEvent)),this.props.shouldHighlight&&(this.highlightTimeout=setTimeout((()=>{this.setState({fadeOutHighlight:!0})}),N.ZP.PERMALINK_FADEOUT))}componentWillUnmount(){document.removeEventListener("keydown",this.handleAlt),document.removeEventListener("keyup",this.handleAlt),this.postRef.current&&(this.postRef.current.removeEventListener(N.sp.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.removeEventListener(N.sp.DEACTIVATE,this.handleA11yDeactivateEvent)),clearTimeout(this.highlightTimeout)}componentDidUpdate(e){this.state.a11yActive&&this.postRef.current.dispatchEvent(new Event(N.sp.UPDATE)),this.props.post.state===D.V8.POST_DELETED&&e.post.state!==D.V8.POST_DELETED&&this.updateAriaLabel()}render(){const{post:e,replyCount:t,isCollapsedThreadsEnabled:s}=this.props;if(!e.id)return null;const n=z.Ew(e),a=(0,ig.L9)(e),i=z.zj(e),r=e&&e.props&&"true"===e.props.from_webhook,o=e&&e.props&&"true"===e.props.from_bot;let l=M.createElement("span",{className:"profile-picture-invisible"});const c=this.hasSameRoot(this.props)&&this.props.consecutivePostByUser&&!e.root_id&&0===this.props.replyCount&&!o;c||(l=M.createElement(Ct.Z,{compactDisplay:this.props.compactDisplay,post:e,userId:e.user_id}),i&&(l=M.createElement("span",{className:"auto-responder"},l)));const d=!(I.Kx(e)||D.V8.POST_DELETED===e.state||(0,ig.ZK)(e)||e.type===D.V8.POST_TYPES.COMBINED_USER_ACTIVITY),h=M.createElement(oE,{isPermalink:d,eventTime:e.create_at,postId:e.id});let p;return(i||!n&&(Boolean(this.props.replyCount)||this.props.isFirstReply))&&(p=M.createElement(uf.Z,{handleCommentClick:this.handleCommentClick,commentCount:this.props.replyCount,postId:e.id,extraClass:"post__x-comment-count"})),M.createElement(af.Provider,{value:{handlePopupOpened:this.handleDropdownOpened}},M.createElement("div",{ref:this.postRef,id:"post_"+e.id,"data-testid":"postView",role:"listitem",className:"a11y__section ".concat(this.getClassName(e,n,a,r,i,o)),tabIndex:"0",onFocus:this.handlePostFocus,onBlur:this.removeFocus,onMouseOver:this.setHover,onMouseLeave:this.unsetHover,onTouchStart:this.setHover,onClick:this.handlePostClick,"aria-label":this.state.currentAriaLabel,"aria-atomic":!0},M.createElement("div",{role:"application","data-testid":"postContent",className:W()("post__content post__container_x",{center:this.props.center}),"aria-hidden":this.state.ariaHidden},M.createElement("div",{className:"post__img"},l),M.createElement("div",{className:"post__content_x"},M.createElement("div",{className:"post__content_x_wrap"},M.createElement("div",{className:"post__content_x_message"},M.createElement(nf,{post:e,handleCommentClick:this.handleCommentClick,handleCardClick:this.handleCardClick,handleDropdownOpened:this.handleDropdownOpened,compactDisplay:this.props.compactDisplay,isFirstReply:this.props.isFirstReply,replyCount:this.props.replyCount,showTimeWithoutHover:!c,hover:this.state.hover||this.state.a11yActive,isLastPost:this.props.isLastPost}),M.createElement(Qg,{post:e,handleCommentClick:this.handleCommentClick,compactDisplay:this.props.compactDisplay,isCommentMention:this.props.isCommentMention,isFirstReply:this.props.isFirstReply}),s&&!e.root_id&&t?M.createElement(_E,{threadId:e.id}):null,M.createElement("div",{className:"post-more-info"},M.createElement("div",{className:"post-x-more"},p,M.createElement(pf,{isFlagged:this.props.isFlagged,isPinned:e.is_pinned,channelId:e.channel_id,postTime:e.crea})),M.createElement("div",{className:"post-time"},h)),M.createElement(pE,{post:e,isReadOnly:this.props.isReadOnly})),M.createElement("div",{className:"post__content_x_actionholder"},M.createElement(nE,{post:e,handleCommentClick:this.handleCommentClick,handleCardClick:this.handleCardClick,handleDropdownOpened:this.handleDropdownOpened,compactDisplay:this.props.compactDisplay,replyCount:this.props.replyCount,isFirstReply:this.props.isFirstReply,showTimeWithoutHover:!1,hover:this.state.hover||this.state.a11yActive,isLastPost:this.props.isLastPost})))))))}}vE(yE,"propTypes",{post:y().object.isRequired,thread:y().object,createAriaLabel:y().func.isRequired,currentUserId:y().string.isRequired,center:y().bool,compactDisplay:y().bool,isFirstReply:y().bool,shouldHighlight:y().bool,consecutivePostByUser:y().bool,previousPostIsComment:y().bool,togglePostMenu:y().func,isCommentMention:y().bool,replyCount:y().number,isLastPost:y().bool,channelIsArchived:y().bool.isRequired,intl:J.gm.isRequired,actions:y().shape({selectPost:y().func.isRequired,selectPostCard:y().func.isRequired,markPostAsUnread:y().func.isRequired}).isRequired,isFlagged:y().bool.isRequired,isCollapsedThreadsEnabled:y().bool,isReadOnly:y().bool}),vE(yE,"defaultProps",{post:{},isReadOnly:!1});const ME=(0,K.ZP)(yE);function PE(e,t){return!(!e||!e.root_id||t&&(e.root_id===t.id||e.root_id===t.root_id))}const wE=(0,n.connect)((function(){const e=(0,z.yk)(),t=(0,Qe.VC)(),s=(0,z.Tx)();return(n,a)=>{const i=a.post||(0,Qe.xl)(n,a.postId),r=(0,m.mr)(n,i.channel_id);let o=null;a.previousPostId&&(o=(0,Qe.xl)(n,a.previousPostId));let l=!1,c=!1;o&&(l=(0,z.f_)(i,o),c=Boolean(o.root_id));const h=0!==((0,m.TB)(n)||{}).delete_at;return{post:i,createAriaLabel:s(n,i),currentUserId:(0,p.rc)(n),isFirstReply:PE(i,o),consecutivePostByUser:l,previousPostIsComment:c,replyCount:e(n,i),isCommentMention:t(n,i.id),center:(0,d.U2)(n,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.CHANNEL_DISPLAY_MODE,N.uP.CHANNEL_DISPLAY_MODE_DEFAULT)===N.uP.CHANNEL_DISPLAY_MODE_CENTERED,compactDisplay:(0,d.U2)(n,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.MESSAGE_DISPLAY,N.uP.MESSAGE_DISPLAY_DEFAULT)===N.uP.MESSAGE_DISPLAY_COMPACT,channelIsArchived:(0,hl.t2)(r),isFlagged:null!=(0,d.U2)(n,N.uP.CATEGORY_FLAGGED_POST,i.id,null),isCollapsedThreadsEnabled:(0,d.ym)(n),isReadOnly:(0,m.ui)(n)||h}}}),(function(e){return{actions:(0,a.bindActionCreators)({selectPost:Ve.F8,selectPostCard:Ve.Jm,markPostAsUnread:U.VW},e)}}))(ME),SE=(0,n.connect)((function(){const e=(0,Xm.H)();return(t,s)=>({post:e(t,s.combinedId),postId:s.combinedId})}))(wE);var TE=s(12898);const NE=[lr.ap.aS,lr.ap.o$],RE=({date:e})=>M.createElement(TE.Z,null,M.createElement(lr.ZP,{value:e,useTime:!1,useSemanticOutput:!1,ranges:NE}));RE.propTypes={date:y().oneOfType([y().number,y().instanceOf(Date)]).isRequired};const IE=(0,M.memo)(RE);class OE extends M.PureComponent{render(){const{children:e}=this.props;return M.createElement("div",{className:"Separator NotificationSeparator","data-testid":"NotificationSeparator"},M.createElement("hr",{className:"separator__hr"}),e&&M.createElement("div",{className:"separator__text"},e))}}class LE extends M.PureComponent{render(){return M.createElement("div",{className:"new-separator"},M.createElement(OE,{id:this.props.separatorId},M.createElement(V.Z,{id:"posts_view.newMsg",defaultMessage:"New Messages"})))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(LE,"propTypes",{separatorId:y().string.isRequired});var AE=s(61032),kE=s(42306);const xE=e=>M.createElement("svg",{width:"128",height:"113",viewBox:"0 0 128 113",fill:"none",xmlns:"http://www.w3.org/2000/svg"},M.createElement("path",{d:"M1.80233 55.6593C2.37238 26.1034 26.5458 29.6575 63.6379 13.7906C100.73 -2.07616 121.565 28.4022 120.995 57.9581C120.425 87.5141 90.6936 115.71 61.7755 110.352C32.8574 104.993 1.23229 85.2152 1.80233 55.6593Z",fill:e.theme.buttonBg,fillOpacity:"0.08"}),M.createElement("mask",{id:"mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"0",y:"7",width:"122",height:"106"},M.createElement("path",{d:"M1.80233 55.6593C2.37238 26.1034 26.5458 29.6575 63.6379 13.7907C100.73 -2.07613 121.565 28.4023 120.995 57.9582C120.425 87.5141 90.6936 115.71 61.7755 110.352C32.8574 104.993 1.23229 85.2152 1.80233 55.6593Z",fill:e.theme.centerChannelBg})),M.createElement("g",{mask:"url(#mask0)"},M.createElement("path",{d:"M104.069 99.1028C117.129 99.1028 127.717 98.3007 127.717 97.3113C127.717 96.3219 117.129 95.5199 104.069 95.5199C91.0094 95.5199 80.4222 96.3219 80.4222 97.3113C80.4222 98.3007 91.0094 99.1028 104.069 99.1028Z",fill:"black",fillOpacity:"0.16"}),M.createElement("ellipse",{cx:"56.5959",cy:"88.8915",rx:"36.0082",ry:"1.9706",fill:"black",fillOpacity:"0.08"}),M.createElement("path",{d:"M60.8954 89.4289C64.754 89.4289 67.8821 89.0279 67.8821 88.5332C67.8821 88.0385 64.754 87.6375 60.8954 87.6375C57.0368 87.6375 53.9088 88.0385 53.9088 88.5332C53.9088 89.0279 57.0368 89.4289 60.8954 89.4289Z",fill:"black",fillOpacity:"0.08"}),M.createElement("path",{d:"M38.8605 89.4289C46.3799 89.4289 52.4756 89.0279 52.4756 88.5332C52.4756 88.0385 46.3799 87.6375 38.8605 87.6375C31.3411 87.6375 25.2455 88.0385 25.2455 88.5332C25.2455 89.0279 31.3411 89.4289 38.8605 89.4289Z",fill:"black",fillOpacity:"0.08"})),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M60.6626 80.4766L59.8322 81.5339L60.7427 80.9318C60.7813 81.1497 60.8128 81.3687 60.8372 81.5886C62.5681 80.2116 64.5919 79.4635 64.5919 79.4635C64.5919 79.4635 64.5349 80.0035 64.3794 80.8026L63.7606 81.0247L64.3347 81.0255C64.2031 81.6703 64.0384 82.3065 63.8415 82.9309L62.633 83.3646L63.6958 83.3661C63.3963 84.2644 62.9733 85.107 62.4413 85.8645C60.7187 88.2006 58.6275 89.4766 57.7705 88.7145C57.7036 88.6549 57.6461 88.5847 57.5979 88.5047C56.9013 87.6727 56.5888 85.5648 56.8889 83.1819C56.927 82.8867 56.982 82.5945 57.0535 82.3068L57.9169 83.3166L57.2266 81.6931C58.0016 79.2486 59.6729 77.0824 59.6729 77.0824C59.6729 77.0824 59.8783 77.577 60.1213 78.3494L59.6961 78.8907L60.1879 78.5655C60.3787 79.1922 60.5372 79.8303 60.6626 80.4766Z",fill:e.theme.centerChannelBg}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M60.6626 80.4766L59.8322 81.5339L60.7427 80.9318C60.7813 81.1497 60.8128 81.3687 60.8372 81.5886C62.5681 80.2116 64.5919 79.4635 64.5919 79.4635C64.5919 79.4635 64.5349 80.0035 64.3794 80.8026L63.7606 81.0247L64.3347 81.0255C64.2031 81.6703 64.0384 82.3065 63.8415 82.9309L62.633 83.3646L63.6958 83.3661C63.3963 84.2644 62.9733 85.107 62.4413 85.8645C60.7187 88.2006 58.6275 89.4766 57.7705 88.7145C57.7036 88.6549 57.6461 88.5847 57.5979 88.5047C56.9013 87.6727 56.5888 85.5648 56.8889 83.1819C56.927 82.8867 56.982 82.5945 57.0535 82.3068L57.9169 83.3166L57.2266 81.6931C58.0016 79.2486 59.6729 77.0824 59.6729 77.0824C59.6729 77.0824 59.8783 77.577 60.1213 78.3494L59.6961 78.8907L60.1879 78.5655C60.3787 79.1922 60.5372 79.8303 60.6626 80.4766Z",fill:e.theme.onlineIndicator}),M.createElement("path",{d:"M65.374 18.9794C65.374 17.3225 64.0309 15.9794 62.374 15.9794H18.5716C16.9148 15.9794 15.5716 17.3225 15.5716 18.9794V43.3287C15.5716 44.9856 16.9148 46.3287 18.5716 46.3287H21.8975V54.6747L28.7123 46.3287H62.374C64.0309 46.3287 65.374 44.9856 65.374 43.3287V18.9794Z",fill:e.theme.onlineIndicator}),M.createElement("path",{d:"M56.3859 24.8945H24.5599C24.1059 24.8945 23.7379 25.2625 23.7379 25.7165C23.7379 26.1705 24.1059 26.5385 24.5599 26.5385H56.3859C56.8399 26.5385 57.2079 26.1705 57.2079 25.7165C57.2079 25.2625 56.8399 24.8945 56.3859 24.8945Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M56.3859 30.3321H24.5599C24.1059 30.3321 23.7379 30.7001 23.7379 31.1541C23.7379 31.6081 24.1059 31.9761 24.5599 31.9761H56.3859C56.8399 31.9761 57.2079 31.6081 57.2079 31.1541C57.2079 30.7001 56.8399 30.3321 56.3859 30.3321Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M56.3859 35.7697H24.5599C24.1059 35.7697 23.7379 36.1377 23.7379 36.5917C23.7379 37.0456 24.1059 37.4136 24.5599 37.4136H56.3859C56.8399 37.4136 57.2079 37.0456 57.2079 36.5917C57.2079 36.1377 56.8399 35.7697 56.3859 35.7697Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M44.5932 46.4341C44.5932 44.851 45.8765 43.5677 47.4595 43.5677H65.374V46.4341H44.5932Z",fill:"black",fillOpacity:"0.24"}),M.createElement("path",{d:"M46.0263 45.0502C46.0263 43.3934 47.3695 42.0502 49.0263 42.0502H83.1549C84.8117 42.0502 86.1549 43.3934 86.1549 45.0502V63.4983C86.1549 65.1552 84.8117 66.4983 83.1549 66.4983H81.0577V73.2215L75.5667 66.4983H49.0263C47.3695 66.4983 46.0263 65.1552 46.0263 63.4983V45.0502Z",fill:e.theme.buttonBg}),M.createElement("path",{d:"M53.2683 48.958H78.9127C79.2784 48.958 79.5748 49.2544 79.5748 49.6201C79.5748 49.9858 79.2784 50.2822 78.9127 50.2822H53.2684C52.9027 50.2822 52.6062 49.9858 52.6062 49.6201C52.6062 49.2544 52.9027 48.958 53.2683 48.958Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M53.2684 53.3382H78.9127C79.2784 53.3382 79.5748 53.6347 79.5748 54.0004C79.5748 54.3661 79.2784 54.6625 78.9127 54.6625H53.2684C52.9027 54.6625 52.6062 54.3661 52.6062 54.0004C52.6062 53.6347 52.9027 53.3382 53.2684 53.3382Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M53.2684 57.7185H78.9127C79.2784 57.7185 79.5748 58.0149 79.5748 58.3806C79.5748 58.7463 79.2784 59.0428 78.9127 59.0428H53.2684C52.9027 59.0428 52.6062 58.7463 52.6062 58.3806C52.6062 58.0149 52.9027 57.7185 53.2684 57.7185Z",fill:e.theme.centerChannelBg}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M52.0864 66.4983C52.1153 66.3055 52.1322 66.1106 52.137 65.9148C52.1526 65.276 52.0384 64.6406 51.8013 64.0476L48.0833 65.9849L51.5109 63.4539C51.1891 62.8984 50.7571 62.4154 50.2415 62.0347C49.726 61.6541 49.138 61.384 48.5142 61.2412C47.8903 61.0984 47.2438 61.0859 46.615 61.2046C45.9861 61.3233 45.3883 61.5706 44.8586 61.9312C44.3289 62.2917 43.8788 62.7578 43.536 63.3004C43.1933 63.8431 42.9653 64.4507 42.8662 65.0856C42.7931 65.5544 42.7914 66.0308 42.8605 66.4983H52.0864Z",fill:"black",fillOpacity:"0.24"}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M46.0723 78.7692C46.2 78.5525 46.276 78.2806 46.276 77.9854C46.276 77.2778 45.8395 76.7043 45.3011 76.7043C44.7627 76.7043 44.3262 77.2778 44.3262 77.9854C44.3262 78.2806 44.4022 78.5525 44.5299 78.7692C44.4022 78.9858 44.3262 79.2577 44.3262 79.5529C44.3262 79.8476 44.4019 80.119 44.5291 80.3354C44.4019 80.5518 44.3262 80.8232 44.3262 81.1179C44.3262 81.4131 44.4022 81.685 44.5299 81.9016C44.4022 82.1183 44.3262 82.3902 44.3262 82.6854C44.3262 82.9801 44.4019 83.2515 44.5292 83.4679C44.4019 83.6844 44.3262 83.9558 44.3262 84.2504C44.3262 84.5457 44.4022 84.8176 44.5299 85.0342C44.4022 85.2509 44.3262 85.5228 44.3262 85.818C44.3262 86.1126 44.4019 86.384 44.5291 86.6004C44.4019 86.8169 44.3262 87.0883 44.3262 87.3829C44.3262 88.0904 44.7627 88.664 45.3011 88.664C45.8395 88.664 46.276 88.0904 46.276 87.3829C46.276 87.0883 46.2003 86.8169 46.0731 86.6004C46.2003 86.384 46.276 86.1126 46.276 85.818C46.276 85.5228 46.2 85.2509 46.0723 85.0342C46.2 84.8176 46.276 84.5457 46.276 84.2504C46.276 83.9558 46.2003 83.6844 46.0731 83.4679C46.2003 83.2515 46.276 82.9801 46.276 82.6854C46.276 82.3902 46.2 82.1183 46.0723 81.9016C46.2 81.685 46.276 81.4131 46.276 81.1179C46.276 80.8232 46.2003 80.5518 46.0731 80.3354C46.2003 80.119 46.276 79.8476 46.276 79.5529C46.276 79.2577 46.2 78.9858 46.0723 78.7692Z",fill:e.theme.centerChannelColor}),M.createElement("path",{opacity:"0.32",fillRule:"evenodd",clipRule:"evenodd",d:"M46.0723 78.7692C46.2 78.5525 46.276 78.2806 46.276 77.9854C46.276 77.2778 45.8395 76.7043 45.3011 76.7043C44.7627 76.7043 44.3262 77.2778 44.3262 77.9854C44.3262 78.2806 44.4022 78.5525 44.5299 78.7692C44.4022 78.9858 44.3262 79.2577 44.3262 79.5529C44.3262 79.8476 44.4019 80.119 44.5291 80.3354C44.4019 80.5518 44.3262 80.8232 44.3262 81.1179C44.3262 81.4131 44.4022 81.685 44.5299 81.9016C44.4022 82.1183 44.3262 82.3902 44.3262 82.6854C44.3262 82.9801 44.4019 83.2515 44.5292 83.4679C44.4019 83.6844 44.3262 83.9558 44.3262 84.2504C44.3262 84.5457 44.4022 84.8176 44.5299 85.0342C44.4022 85.2509 44.3262 85.5228 44.3262 85.818C44.3262 86.1126 44.4019 86.384 44.5291 86.6004C44.4019 86.8169 44.3262 87.0883 44.3262 87.3829C44.3262 88.0904 44.7627 88.664 45.3011 88.664C45.8395 88.664 46.276 88.0904 46.276 87.3829C46.276 87.0883 46.2003 86.8169 46.0731 86.6004C46.2003 86.384 46.276 86.1126 46.276 85.818C46.276 85.5228 46.2 85.2509 46.0723 85.0342C46.2 84.8176 46.276 84.5457 46.276 84.2504C46.276 83.9558 46.2003 83.6844 46.0731 83.4679C46.2003 83.2515 46.276 82.9801 46.276 82.6854C46.276 82.3902 46.2 82.1183 46.0723 81.9016C46.2 81.685 46.276 81.4131 46.276 81.1179C46.276 80.8232 46.2003 80.5518 46.0731 80.3354C46.2003 80.119 46.276 79.8476 46.276 79.5529C46.276 79.2577 46.2 78.9858 46.0723 78.7692Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M48.9492 67.2676C49.0823 67.0973 49.2036 66.9181 49.3122 66.7312L46.7505 66.3094L49.5196 66.3302C49.7854 65.7495 49.9305 65.1205 49.9461 64.4817C49.9617 63.8428 49.8475 63.2075 49.6104 62.6144L45.8923 64.5517L49.32 62.0207C48.9982 61.4653 48.5661 60.9822 48.0506 60.6016C47.535 60.2209 46.9471 59.9508 46.3232 59.808C45.6993 59.6652 45.0529 59.6528 44.424 59.7715C43.7952 59.8902 43.1973 60.1375 42.6677 60.498C42.138 60.8585 41.6878 61.3246 41.3451 61.8673C41.0023 62.4099 40.7743 63.0175 40.6753 63.6524C40.5762 64.2873 40.6083 64.9358 40.7693 65.5577C40.9304 66.1797 41.2171 66.7617 41.6116 67.2676C41.4039 67.5334 41.2249 67.8206 41.0775 68.1243L44.404 69.8585L40.8571 68.6633C40.6944 69.1483 40.6112 69.6566 40.6108 70.1684C40.6088 71.2202 40.9616 72.2418 41.6116 73.0666C41.0707 73.7581 40.7344 74.5884 40.6412 75.4628C40.548 76.3371 40.7015 77.2202 41.0843 78.011C41.4671 78.8019 42.0637 79.4686 42.8059 79.9351C43.5482 80.4016 44.4061 80.6489 45.2817 80.6489C46.1573 80.6489 47.0152 80.4016 47.7575 79.9351C48.4997 79.4686 49.0963 78.8019 49.4791 78.011C49.8619 77.2202 50.0155 76.3371 49.9222 75.4628C49.829 74.5884 49.4927 73.7581 48.9518 73.0666C49.5993 72.2399 49.9511 71.2184 49.9507 70.1666C49.9502 69.1148 49.5975 68.0937 48.9492 67.2676Z",fill:e.theme.onlineIndicator}),M.createElement("path",{opacity:"0.1",d:"M40.6108 70.1658C40.6088 71.2177 40.9616 72.2392 41.6116 73.064C41.0707 73.7555 40.7344 74.5858 40.6412 75.4602C40.548 76.3345 40.7015 77.2176 41.0843 78.0084C41.4671 78.7993 42.0637 79.4661 42.8059 79.9325C43.5482 80.399 44.4061 80.6464 45.2817 80.6464C46.1573 80.6464 47.0152 80.399 47.7575 79.9325C48.4997 79.4661 49.0963 78.7993 49.4791 78.0084C49.8619 77.2176 50.0155 76.3345 49.9222 75.4602C49.829 74.5858 49.4927 73.7555 48.9518 73.064C49.5767 72.2672 40.6108 69.6398 40.6108 70.1658Z",fill:e.theme.centerChannelColor}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M37.2968 80.8175L36.9707 81.9966L37.5096 81.1534C37.9495 81.8459 38.2901 82.6083 38.5196 83.4141C39.1858 85.9642 38.9674 88.2705 38.0319 88.5652C37.9587 88.5883 37.8833 88.5983 37.8062 88.5961C36.9057 88.7278 35.36 87.909 33.9432 86.4649C33.7681 86.2852 33.6035 86.0936 33.4504 85.8913L34.5522 85.7168L33.1339 85.4432C31.9167 83.5905 31.3364 81.1672 31.3364 81.1672C31.3364 81.1672 31.766 81.2544 32.3976 81.4524L32.5388 82.064L32.5736 81.5089C33.0828 81.6746 33.5831 81.8717 34.0721 82.0993L34.3479 83.2938L34.4123 82.2661C34.5753 82.3457 34.7354 82.4315 34.8924 82.5233C34.8619 80.4521 35.3937 78.4667 35.3937 78.4667C35.3937 78.4667 35.7204 78.7852 36.1678 79.3132L36.0008 79.9169L36.2919 79.4615C36.6498 79.8924 36.9854 80.3451 37.2968 80.8175Z",fill:e.theme.centerChannelBg}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M37.2968 80.8175L36.9707 81.9966L37.5096 81.1534C37.9495 81.8459 38.2901 82.6083 38.5196 83.4141C39.1858 85.9642 38.9674 88.2705 38.0319 88.5652C37.9587 88.5883 37.8833 88.5983 37.8062 88.5961C36.9057 88.7278 35.36 87.909 33.9432 86.4649C33.7681 86.2852 33.6035 86.0936 33.4504 85.8913L34.5522 85.7168L33.1339 85.4432C31.9167 83.5905 31.3364 81.1672 31.3364 81.1672C31.3364 81.1672 31.766 81.2544 32.3976 81.4524L32.5388 82.064L32.5736 81.5089C33.0828 81.6746 33.5831 81.8717 34.0721 82.0993L34.3479 83.2938L34.4123 82.2661C34.5753 82.3457 34.7354 82.4315 34.8924 82.5233C34.8619 80.4521 35.3937 78.4667 35.3937 78.4667C35.3937 78.4667 35.7204 78.7852 36.1678 79.3132L36.0008 79.9169L36.2919 79.4615C36.6498 79.8924 36.9854 80.3451 37.2968 80.8175Z",fill:e.theme.onlineIndicator}),M.createElement("path",{d:"M90.4075 33.0776C90.4075 33.0776 82.0605 34.3956 83.0864 32.7323C84.1122 31.069 89.5744 29.4072 90.5762 29.7542C91.578 30.1013 90.4075 33.0776 90.4075 33.0776Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M90.4074 33.0776C90.4074 33.0776 82.0605 34.3956 83.0863 32.7323C84.1121 31.069 89.5744 29.4072 90.5761 29.7542C91.5779 30.1013 90.4074 33.0776 90.4074 33.0776Z",fill:e.theme.centerChannelColor,fillOpacity:"0.32"}),M.createElement("path",{d:"M90.4074 33.0776C90.4074 33.0776 82.0605 34.3956 83.0863 32.7323C84.1121 31.069 89.5744 29.4072 90.5761 29.7542C91.5779 30.1013 90.4074 33.0776 90.4074 33.0776Z",fill:e.theme.centerChannelColor,fillOpacity:"0.48"}),M.createElement("path",{d:"M99.9799 14.4778C99.9799 14.4778 94.588 15.9236 97.0867 20.5237C97.0867 20.5237 101.164 28.541 99.4539 29.0668C97.7443 29.5925 89.8536 29.3296 89.8536 29.3296C89.8536 29.3296 88.0125 33.7983 88.9331 33.9297C89.8536 34.0612 104.583 37.0841 106.161 34.1926C107.739 31.3011 106.161 18.8151 106.161 18.8151C106.161 18.8151 103.925 12.6378 99.9799 14.4778Z",fill:e.theme.buttonBg}),M.createElement("path",{opacity:"0.24",d:"M99.9799 14.4778C99.9799 14.4778 94.588 15.9236 97.0867 20.5237C97.0867 20.5237 101.164 28.541 99.4539 29.0668C97.7443 29.5925 89.8536 29.3296 89.8536 29.3296C89.8536 29.3296 88.0125 33.7983 88.9331 33.9297C89.8536 34.0612 104.583 37.0841 106.161 34.1926C107.739 31.3011 106.161 18.8151 106.161 18.8151C106.161 18.8151 103.925 12.6378 99.9799 14.4778Z",fill:e.theme.centerChannelColor}),M.createElement("path",{d:"M115.235 82.8224C115.235 82.8224 117.602 88.474 116.287 89.5255C114.972 90.5769 115.235 92.5484 116.156 92.5484C117.076 92.5484 119.181 90.7083 120.364 88.474C121.246 86.8096 122.711 83.4676 123.402 81.871C123.45 81.7592 123.474 81.6385 123.473 81.5167C123.471 81.3949 123.444 81.2748 123.392 81.1643C123.341 81.0538 123.267 80.9553 123.175 80.8753C123.084 80.7953 122.976 80.7356 122.859 80.7001L119.049 79.5366L115.235 82.8224Z",fill:e.theme.buttonBg}),M.createElement("path",{d:"M90.2482 89.6568C90.2482 89.6568 85.2508 93.7312 82.6206 93.5998C79.9904 93.4683 79.5958 96.2284 82.6206 96.6227C85.6453 97.017 94.7196 97.1484 95.5086 96.6227C96.2977 96.097 96.0347 90.5769 95.5086 90.4454C94.9826 90.314 90.2482 89.6568 90.2482 89.6568Z",fill:e.theme.buttonBg}),M.createElement("path",{d:"M107.213 47.7301C107.213 47.7301 107.213 51.8045 105.109 53.5131C105.109 53.5131 102.61 66.262 104.846 67.0506C107.082 67.8392 117.208 74.6736 118.128 78.0908L120.364 79.7995C120.364 79.7995 116.287 83.8739 115.498 83.8739C114.709 83.8739 106.95 73.2279 99.98 71.2564C99.98 71.2564 95.6402 70.2049 95.7717 64.5534C95.9032 58.9018 101.032 43.9186 101.032 43.9186H106.95L107.213 47.7301Z",fill:e.theme.sidebarBg}),M.createElement("path",{opacity:"0.9",d:"M107.213 47.7301C107.213 47.7301 107.213 51.8045 105.109 53.5131C105.109 53.5131 102.61 66.262 104.846 67.0506C107.082 67.8392 117.208 74.6736 118.128 78.0908L120.364 79.7995C120.364 79.7995 116.287 83.8739 115.498 83.8739C114.709 83.8739 106.95 73.2279 99.98 71.2564C99.98 71.2564 95.6402 70.2049 95.7717 64.5534C95.9032 58.9018 101.032 43.9186 101.032 43.9186H106.95L107.213 47.7301Z",fill:e.theme.centerChannelColor}),M.createElement("path",{d:"M93.5359 44.97C93.5359 44.97 89.5906 57.3246 90.2481 62.1876C90.2481 62.1876 88.67 66.7877 89.8536 71.7821C91.0372 76.7765 89.7221 89.6568 89.4591 89.9197C89.1961 90.1826 92.3523 92.9426 95.7716 90.7083C95.7716 90.7083 95.9031 87.5539 96.5607 86.8968C97.2182 86.2396 97.2182 72.4393 96.5607 70.4678C95.9031 68.4963 103.662 54.1702 103.662 54.1702C103.662 54.1702 107.871 50.3587 106.292 48.3872C104.714 46.4158 106.424 42.4728 106.424 42.4728L94.4565 43.2614L93.5359 44.97Z",fill:e.theme.sidebarBg}),M.createElement("path",{opacity:"0.8",d:"M93.5359 44.97C93.5359 44.97 89.5906 57.3246 90.2481 62.1876C90.2481 62.1876 88.67 66.7877 89.8536 71.7821C91.0372 76.7765 89.7221 89.6568 89.4591 89.9197C89.1961 90.1826 92.3523 92.9426 95.7716 90.7083C95.7716 90.7083 95.9031 87.5539 96.5607 86.8968C97.2182 86.2396 97.2182 72.4393 96.5607 70.4678C95.9031 68.4963 103.662 54.1702 103.662 54.1702C103.662 54.1702 107.871 50.3587 106.292 48.3872C104.714 46.4158 106.424 42.4728 106.424 42.4728L94.4565 43.2614L93.5359 44.97Z",fill:e.theme.centerChannelColor}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M94.1031 14.2901C93.3815 14.6621 92.5627 14.8721 91.6948 14.8721C88.7896 14.8721 86.4344 12.5184 86.4344 9.61487C86.4344 6.71135 88.7896 4.35759 91.6948 4.35759C94.4842 4.35759 96.7665 6.52736 96.9441 9.27023C98.2172 10.6232 99.7874 12.1701 100.374 12.2435C101.427 12.3749 96.9552 18.0265 96.9552 18.0265C96.9552 18.0265 95.5348 15.6356 94.1031 14.2901Z",fill:e.theme.centerChannelBg}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M94.1031 14.2901C93.3815 14.6621 92.5627 14.8721 91.6948 14.8721C88.7896 14.8721 86.4344 12.5184 86.4344 9.61487C86.4344 6.71135 88.7896 4.35759 91.6948 4.35759C94.4842 4.35759 96.7665 6.52736 96.9441 9.27023C98.2172 10.6232 99.7874 12.1701 100.374 12.2435C101.427 12.3749 96.9552 18.0265 96.9552 18.0265C96.9552 18.0265 95.5348 15.6356 94.1031 14.2901Z",fill:e.theme.centerChannelColor,fillOpacity:"0.48"}),M.createElement("path",{d:"M101.164 12.1121L100.506 11.192C100.506 11.192 95.9749 15.229 95.8075 16.2992C95.6946 16.8997 95.8235 17.5205 96.1662 18.0265L98.7964 16.8436L100.111 14.215L101.164 12.1121Z",fill:e.theme.buttonBg}),M.createElement("path",{d:"M93.273 44.7072C93.273 44.7072 92.2209 47.8616 93.0099 47.7301C93.799 47.5987 93.799 45.8901 94.7196 45.8901C95.6402 45.8901 96.1662 44.4443 96.1662 44.4443L93.273 44.7072Z",fill:e.theme.buttonBg}),M.createElement("path",{d:"M99.9799 44.97C99.9799 44.97 103.005 51.5416 106.818 50.8844L107.563 50.5654C107.874 50.4324 108.128 50.1936 108.28 49.8913C108.432 49.5891 108.472 49.2429 108.393 48.914C108.03 47.4003 107.362 44.97 106.818 44.97H99.9799Z",fill:e.theme.buttonBg}),M.createElement("path",{d:"M86.4457 9.94482C86.4457 9.94482 86.9604 8.30053 88.6701 8.95769C90.3797 9.61485 91.8263 11.0606 92.2208 10.0092C92.6154 8.9577 93.625 7.99042 94.3038 8.80264C94.9826 9.61486 98.0731 11.1263 97.9416 10.3377C97.81 9.54914 99.5854 4.88331 96.1662 3.1747C92.7469 1.46609 90.9057 0.151768 89.1961 1.46609C87.4865 2.78041 83.2781 5.27761 83.9357 6.85479C84.5932 8.43197 84.3302 9.22056 85.3823 9.61486C86.4344 10.0092 86.4457 9.94482 86.4457 9.94482Z",fill:e.theme.sidebarBg}),M.createElement("path",{opacity:"0.8",d:"M86.4457 9.94482C86.4457 9.94482 86.9604 8.30053 88.6701 8.95769C90.3797 9.61485 91.8263 11.0606 92.2208 10.0092C92.6154 8.9577 93.625 7.99042 94.3038 8.80264C94.9826 9.61486 98.0731 11.1263 97.9416 10.3377C97.81 9.54914 99.5854 4.88331 96.1662 3.1747C92.7469 1.46609 90.9057 0.151768 89.1961 1.46609C87.4865 2.78041 83.2781 5.27761 83.9357 6.85479C84.5932 8.43197 84.3302 9.22056 85.3823 9.61486C86.4344 10.0092 86.4457 9.94482 86.4457 9.94482Z",fill:e.theme.centerChannelColor}),M.createElement("path",{d:"M101.821 12.9007C101.821 12.9007 101.69 11.7178 100.506 11.9806C99.3224 12.2435 96.1662 17.5008 96.1662 17.5008C95.651 19.1793 95.2555 20.8922 94.9825 22.6266C94.4565 25.781 93.4044 37.347 92.3523 39.3185C91.3003 41.2899 93.2729 45.89 93.2729 45.89C93.2729 45.89 94.4565 44.5757 98.2703 45.3643C102.084 46.1529 107.082 46.9415 107.476 46.5472C107.871 46.1529 107.082 45.1015 108.134 43.7871C109.186 42.4728 110.632 17.6322 105.372 14.8722C105.372 14.8721 102.873 12.9007 101.821 12.9007Z",fill:e.theme.buttonBg}),M.createElement("path",{d:"M101.821 12.9007C101.821 12.9007 101.69 11.7178 100.506 11.9806C99.3224 12.2435 96.1662 17.5008 96.1662 17.5008C95.651 19.1793 95.2555 20.8922 94.9825 22.6266C94.4565 25.781 93.4044 37.347 92.3523 39.3185C91.3003 41.2899 93.2729 45.89 93.2729 45.89C93.2729 45.89 94.4565 44.5757 98.2703 45.3643C102.084 46.1529 107.082 46.9415 107.476 46.5472C107.871 46.1529 107.082 45.1015 108.134 43.7871C109.186 42.4728 110.632 17.6322 105.372 14.8722C105.372 14.8721 102.873 12.9007 101.821 12.9007Z",fill:"black",fillOpacity:"0.08"}),M.createElement("path",{opacity:"0.2",d:"M100.506 16.8436C100.506 16.8436 95.114 18.2894 97.6127 22.8895C97.6127 22.8895 101.69 30.9068 99.9799 31.4325C98.2703 31.9583 90.3797 31.6954 90.3797 31.6954C90.3797 31.6954 89.5248 34.5212 90.4454 34.6526C91.366 34.784 105.109 39.4499 106.687 36.5584C108.265 33.6669 106.687 21.1809 106.687 21.1809C106.687 21.1809 104.451 15.0036 100.506 16.8436Z",fill:"black"}),M.createElement("path",{d:"M77.496 31.0798L86.2368 35.8781C86.2875 35.9117 86.3449 35.9339 86.405 35.9429C86.4652 35.952 86.5266 35.9478 86.585 35.9306C86.6433 35.9134 86.6972 35.8836 86.7428 35.8434C86.7884 35.8031 86.8246 35.7534 86.8488 35.6976L88.9901 31.2246C89.0307 31.0971 89.0241 30.9593 88.9715 30.8362C88.9189 30.7132 88.8239 30.613 88.7037 30.5541L81.4467 26.8158C81.3573 26.762 81.2512 26.7431 81.1487 26.7627C81.0463 26.7823 80.9547 26.8389 80.8914 26.9218L77.2664 30.3349C77.2308 30.3985 77.2084 30.4686 77.2006 30.5411C77.1929 30.6136 77.2 30.6869 77.2215 30.7565C77.2429 30.8262 77.2784 30.8908 77.3256 30.9463C77.3728 31.0019 77.4308 31.0473 77.496 31.0798Z",fill:e.theme.sidebarBg}),M.createElement("path",{opacity:"0.8",d:"M77.496 31.0798L86.2368 35.8781C86.2875 35.9117 86.3449 35.9339 86.405 35.9429C86.4652 35.952 86.5266 35.9478 86.585 35.9306C86.6433 35.9134 86.6972 35.8836 86.7428 35.8434C86.7884 35.8031 86.8246 35.7534 86.8488 35.6976L88.9901 31.2246C89.0307 31.0971 89.0241 30.9593 88.9715 30.8362C88.9189 30.7132 88.8239 30.613 88.7037 30.5541L81.4467 26.8158C81.3573 26.762 81.2512 26.7431 81.1487 26.7627C81.0463 26.7823 80.9547 26.8389 80.8914 26.9218L77.2664 30.3349C77.2308 30.3985 77.2084 30.4686 77.2006 30.5411C77.1929 30.6136 77.2 30.6869 77.2215 30.7565C77.2429 30.8262 77.2784 30.8908 77.3256 30.9463C77.3728 31.0019 77.4308 31.0473 77.496 31.0798Z",fill:e.theme.centerChannelColor}),M.createElement("path",{d:"M90.5294 35.0693C90.5294 35.0693 82.0996 35.6599 83.2657 34.0916C84.4318 32.5234 90.0176 31.3406 90.9855 31.7731C91.9535 32.2056 90.5294 35.0693 90.5294 35.0693Z",fill:e.theme.centerChannelBg}),M.createElement("path",{d:"M90.5295 35.0693C90.5295 35.0693 82.0997 35.6599 83.2658 34.0916C84.4319 32.5234 90.0177 31.3406 90.9856 31.7731C91.9535 32.2056 90.5295 35.0693 90.5295 35.0693Z",fill:e.theme.centerChannelColor,fillOpacity:"0.48"}),M.createElement("path",{d:"M100.506 16.0551C100.506 16.0551 95.1141 17.5008 97.6128 22.1009C97.6128 22.1009 101.69 30.1183 99.98 30.644C98.2703 31.1697 90.3797 30.9069 90.3797 30.9069C90.3797 30.9069 88.5386 35.3755 89.4591 35.507C90.3797 35.6384 105.109 38.6613 106.687 35.7698C108.265 32.8783 106.687 20.3923 106.687 20.3923C106.687 20.3923 104.451 14.215 100.506 16.0551Z",fill:e.theme.buttonBg}),M.createElement("path",{opacity:"0.4",fillRule:"evenodd",clipRule:"evenodd",d:"M7.58358 23.5035H6.23999V25.5979H4.22461V26.8624H6.23999V28.8778H7.58358V26.8624H9.59897V25.5979H7.58358V23.5035Z",fill:e.theme.onlineIndicator}),M.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M72.6581 4.51406H70.5084V7.86513H67.2838V9.88842H70.5084V13.113H72.6581V9.88842H75.8827V7.86513H72.6581V4.51406Z",fill:e.theme.onlineIndicator}),M.createElement("path",{opacity:"0.5",fillRule:"evenodd",clipRule:"evenodd",d:"M122.908 33.5356H119.863V38.2829H115.295V41.1493H119.863V45.7175H122.908V41.1493H127.477V38.2829H122.908V33.5356Z",fill:e.theme.onlineIndicator}));xE.propTypes={theme:y().any.isRequired};const DE=xE,ZE=({totalUsers:e,usersLimit:t,channel:s,setHeader:n,theme:a})=>{if(!e)return M.createElement(bn.Z,null);const i=s.type===N.gT.PRIVATE_CHANNEL;return e<t&&!i?HE(n,a):qE(s,n)};ZE.propTypes={totalUsers:y().number,usersLimit:y().number.isRequired,setHeader:y().node.isRequired,theme:y().any.isRequired};const HE=(e,t)=>M.createElement(M.Fragment,null,e,M.createElement("div",{className:"LessThanMaxFreeUsers"},M.createElement(DE,{theme:t}),M.createElement("div",{className:"titleAndButton"},M.createElement(V.Z,{id:"intro_messages.inviteOthersToWorkspace.title",defaultMessage:"Let’s add some people to the workspace!"}),M.createElement(kE.Z,{accessibilityLabel:I._u("intro_messages.inviteOthers","Invite others to the workspace"),id:"introTextInvite",className:"intro-links color--link cursor--pointer",modalId:N.r8.INVITATION,dialogType:ta},M.createElement(V.Z,{id:"generic_icons.add",defaultMessage:"Add Icon"},(e=>M.createElement("i",{className:"icon-email-plus-outline",title:e}))),M.createElement(V.Z,{id:"intro_messages.inviteOthersToWorkspace.button",defaultMessage:"Invite others to the workspace"}))))),qE=(e,t)=>{const s=e.group_constrained?ip:Cl.Z;if(0!==e.delete_at)return null;const n=e.type===N.gT.PRIVATE_CHANNEL;return M.createElement("div",{className:"MoreThanMaxFreeUsersWrapper"},M.createElement("div",{className:"MoreThanMaxFreeUsers"},M.createElement(bp.Z,{channelId:e.id,teamId:e.team_id,permissions:[n?D.Pl.MANAGE_PRIVATE_CHANNEL_MEMBERS:D.Pl.MANAGE_PUBLIC_CHANNEL_MEMBERS]},M.createElement(AE.Z,{className:"intro-links color--link",dialogType:s,dialogProps:{channel:e}},M.createElement(V.Z,{id:"generic_icons.add",defaultMessage:"Add Icon"},(e=>M.createElement("i",{className:"icon-account-plus-outline",title:e}))),n&&e.group_constrained&&M.createElement(V.Z,{id:"intro_messages.inviteGropusToChannel.button",defaultMessage:"Add groups to this private channel"}),n&&!e.group_constrained&&M.createElement(V.Z,{id:"intro_messages.inviteMembersToPrivateChannel.button",defaultMessage:"Add members to this private channel"}),!n&&M.createElement(V.Z,{id:"intro_messages.inviteMembersToChannel.button",defaultMessage:"Add members to this channel"})))),t)},jE=M.memo(ZE);class UE extends M.PureComponent{componentDidMount(){var e;null!==(e=this.props.stats)&&void 0!==e&&e.total_users_count||this.props.actions.getTotalUsersStats()}render(){const{currentUserId:e,channel:t,fullWidth:s,enableUserCreation:n,isReadOnly:a,channelProfiles:i,teamIsGroupConstrained:r,teammate:o,stats:l,usersLimit:c,theme:d}=this.props;let h="";return s||(h="channel-intro--centered"),t.type===N.gT.DM_CHANNEL?function(e,t,s){const n="channelIntro";return s?M.createElement("div",{id:n,className:"channel-intro "+t},M.createElement("div",{className:"post-profile-img__container channel-intro-img"},M.createElement(or.Z,{src:I.bb(s.id,s.last_picture_update),size:"xl",userId:s.id,username:s.username,hasMention:!0})),M.createElement("div",{className:"channel-intro-profile d-flex"},M.createElement(Et.Z,{userId:s.id,disablePopover:!1,hasMention:!0})),s.is_bot?null:FE(e)):M.createElement("div",{id:n,className:"channel-intro "+t},M.createElement("p",{className:"channel-intro-text"},M.createElement(V.Z,{id:"intro_messages.teammate",defaultMessage:"This is the start of your direct message history with this teammate. Direct messages and files shared here are not shown to people outside this area."})))}(t,h,o):t.type===N.gT.GM_CHANNEL?function(e,t,s,n){const a="channelIntro";if(s.length>0){const i=s.filter((e=>e.id!==n)).map((e=>M.createElement(or.Z,{key:"introprofilepicture"+e.id,src:I.bb(e.id,e.last_picture_update),size:"xl",userId:e.id,username:e.username})));return M.createElement("div",{id:a,className:"channel-intro "+t},M.createElement("div",{className:"post-profile-img__container channel-intro-img"},i),FE(e))}return M.createElement("div",{id:a,className:"channel-intro "+t},M.createElement("p",{className:"channel-intro-text"},M.createElement(V.Z,{id:"intro_messages.group_message",defaultMessage:"This is the start of your group message history with these teammates. Messages and files shared here are not shown to people outside this area."})))}(t,h,i,e):t.name===N.gT.DEFAULT_CHANNEL?function(e,t,s,n,a,i,r,o){let l=null;const c=s.total_users_count,d=e.type===N.gT.PRIVATE_CHANNEL;let h=null;if(!r){const t=FE(e);t&&(h=M.createElement(bp.Z,{teamId:e.team_id,channelId:e.id,permissions:[d?D.Pl.MANAGE_PRIVATE_CHANNEL_PROPERTIES:D.Pl.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},t))}return!r&&i&&(l=M.createElement(vs.Z,{teamId:e.team_id,permissions:[D.Pl.INVITE_USER]},M.createElement(vs.Z,{teamId:e.team_id,permissions:[D.Pl.ADD_USER_TO_TEAM]},!o&&h&&M.createElement(jE,{setHeader:h,totalUsers:c,usersLimit:n,channel:e,theme:a}),o&&M.createElement(AE.Z,{className:"intro-links color--link",dialogType:Ba,dialogProps:{channel:e}},M.createElement(V.Z,{id:"generic_icons.add",defaultMessage:"Add Icon"},(e=>M.createElement("i",{className:"fa fa-user-plus",title:e}))),M.createElement(V.Z,{id:"intro_messages.addGroupsToTeam",defaultMessage:"Add other groups to this team"}))))),M.createElement("div",{id:"channelIntro",className:"channel-intro "+t},M.createElement("h2",{className:"channel-intro__title"},M.createElement(V.Z,{id:"intro_messages.beginning",defaultMessage:"Beginning of {name}",values:{name:e.display_name}})),M.createElement("p",{className:"channel-intro__content"},!r&&M.createElement(Dt.Z,{id:"intro_messages.default",defaultMessage:"**Welcome to {display_name}!**\\n \\nPost messages here that you want everyone to see. Everyone automatically becomes a permanent member of this channel when they join the team.",values:{display_name:e.display_name}}),r&&M.createElement(Dt.Z,{id:"intro_messages.readonly.default",defaultMessage:"**Welcome to {display_name}!**\\n \\nMessages can only be posted by system admins. Everyone automatically becomes a permanent member of this channel when they join the team.",values:{display_name:e.display_name}})),l,o&&h,M.createElement("br",null))}(t,h,l,c,d,n,a,r):t.name===N.gT.OFFTOPIC_CHANNEL?function(e,t,s,n,a){const i=e.type===N.gT.PRIVATE_CHANNEL,r=FE(e),o=s.total_users_count;let l=null;r&&(l=M.createElement(bp.Z,{teamId:e.team_id,channelId:e.id,permissions:[i?D.Pl.MANAGE_PRIVATE_CHANNEL_PROPERTIES:D.Pl.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},r));const c=l?M.createElement(jE,{setHeader:l,totalUsers:o,usersLimit:n,channel:e,theme:a}):null;return M.createElement("div",{id:"channelIntro",className:"channel-intro "+t},M.createElement("h2",{className:"channel-intro__title"},M.createElement(V.Z,{id:"intro_messages.beginning",defaultMessage:"Beginning of {name}",values:{name:e.display_name}})),c)}(t,h,l,c,d):t.type===N.gT.OPEN_CHANNEL||t.type===N.gT.PRIVATE_CHANNEL?function(e,t,s,n,a){const i=e.display_name;let r;const o=0!==e.delete_at,l=n.total_users_count;let c;r=o?"":e.type===N.gT.PRIVATE_CHANNEL?M.createElement(V.Z,{id:"intro_messages.onlyInvited",defaultMessage:" Only invited members can see this private channel."}):M.createElement(V.Z,{id:"intro_messages.anyMember",defaultMessage:" Any member can join and read this channel."}),e.purpose&&""!==e.purpose&&(e.type===N.gT.PRIVATE_CHANNEL?c=M.createElement("span",null,M.createElement(V.Z,{id:"intro_messages.purposePrivate",defaultMessage:" This private channel's purpose is: {purpose}",values:{purpose:e.purpose}})):e.type===N.gT.OPEN_CHANNEL&&(c=M.createElement("span",null,M.createElement(V.Z,{id:"intro_messages.purpose",defaultMessage:" This channel's purpose is: {purpose}",values:{purpose:e.purpose}}))));const d=e.type===N.gT.PRIVATE_CHANNEL;let h=null;const p=FE(e);p&&(h=M.createElement(bp.Z,{teamId:e.team_id,channelId:e.id,permissions:[d?D.Pl.MANAGE_PRIVATE_CHANNEL_PROPERTIES:D.Pl.MANAGE_PUBLIC_CHANNEL_PROPERTIES]},p));const u=h?M.createElement(jE,{totalUsers:l,usersLimit:a,channel:e,setHeader:h,theme:s}):null;return M.createElement("div",{id:"channelIntro",className:"channel-intro "+t},M.createElement("h2",{className:"channel-intro__title"},M.createElement(V.Z,{id:"intro_messages.beginning",defaultMessage:"Beginning of {name}",values:{name:i}})),M.createElement("p",{className:"channel-intro__content"},r,c,M.createElement("br",null)),u)}(t,h,d,l,c):null}}function FE(e){return e.delete_at,null}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(UE,"propTypes",{currentUserId:y().string.isRequired,fullWidth:y().bool.isRequired,locale:y().string.isRequired,channelProfiles:y().array.isRequired,enableUserCreation:y().bool,isReadOnly:y().bool,teamIsGroupConstrained:y().bool,creatorName:y().string.isRequired,teammateName:y().string,stats:y().any.isRequired,theme:y().any.isRequired,usersLimit:y().number.isRequired,actions:y().shape({getTotalUsersStats:y().func.isRequired}).isRequired});const BE=(0,n.connect)((function(e){const t="true"===(0,h.iE)(e).EnableUserCreation,s=(0,m.ui)(e),n=(0,u.kA)(e),a=(0,m.TB)(e)||{},i=(0,I.PR)(e,a.id),r=(0,p.PR)(e,a.creator_id);let o=parseInt((0,h.iE)(e).ExperimentalCloudUserLimit||"10",10);0===o&&(o=10);const l=(0,p.S1)(e)||{total_users_count:0};return{currentUserId:(0,p.rc)(e),channel:a,fullWidth:(0,d.U2)(e,N.uP.CATEGORY_DISPLAY_SETTINGS,N.uP.CHANNEL_DISPLAY_MODE,N.uP.CHANNEL_DISPLAY_MODE_DEFAULT)===N.uP.CHANNEL_DISPLAY_MODE_FULL_SCREEN,locale:(0,di.B)(e),channelProfiles:(0,p.OX)(e),enableUserCreation:t,isReadOnly:s,teamIsGroupConstrained:Boolean(n.group_constrained),creatorName:(0,I.hI)(e,r),teammate:i,teammateName:(0,I.hI)(e,i),stats:l,usersLimit:o,theme:(0,d.gh)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({getTotalUsersStats:r.S1},e)}}))(UE);class GE extends M.PureComponent{blockShortcutReactToLastPostForNonMessages(e){const{actions:{emitShortcutReactToLastPostFrom:t}}=this.props;(0,z.Xq)(e)&&t(N.tY.NO_WHERE)}componentDidUpdate(e){const{listId:t,isLastPost:s,shortcutReactToLastPostEmittedFrom:n}=this.props,a=e.shortcutReactToLastPostEmittedFrom!==n&&n===N.tY.CENTER;s&&a&&this.blockShortcutReactToLastPostForNonMessages(t)}render(){const{listId:e,previousListId:t,loadingOlderPosts:s,loadingNewerPosts:n,post:a}=this.props,{OLDER_MESSAGES_LOADER:i,NEWER_MESSAGES_LOADER:r,CHANNEL_INTRO_MESSAGE:o,LOAD_OLDER_MESSAGES_TRIGGER:l,LOAD_NEWER_MESSAGES_TRIGGER:c}=N.iH;if(Xm.Ji(e)){const t=Xm.xF(e);return M.createElement(IE,{key:t,date:t})}if(Xm.p4(e))return M.createElement(LE,{separatorId:e});if(e===o)return M.createElement(BE,null);if(e===l||e===c)return M.createElement("button",{className:"more-messages-text theme style--none color--link",onClick:e===l?this.props.loadOlderPosts:this.props.loadNewerPosts},M.createElement(V.Z,{id:"posts_view.loadMore",defaultMessage:"Load More Messages"}));if(e===i||e===r){const e=!s&&!n;return M.createElement("div",{className:"loading-screen"},M.createElement("div",{className:W()("loading__content",{hideAnimation:e})},M.createElement("div",{className:"round round-1"}),M.createElement("div",{className:"round round-2"}),M.createElement("div",{className:"round round-3"})))}const d={previousPostId:t,shouldHighlight:this.props.shouldHighlight,togglePostMenu:this.props.togglePostMenu,isLastPost:this.props.isLastPost};return Xm.mM(e)?M.createElement(SE,Object.assign({combinedId:e},d)):M.createElement(wE,Object.assign({postId:e,post:a},d))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(GE,"propTypes",{listId:y().string.isRequired,previousListId:y().string,fullWidth:y().bool,shouldHighlight:y().bool,loadOlderPosts:y().func.isRequired,loadNewerPosts:y().func.isRequired,togglePostMenu:y().func.isRequired,isLastPost:y().bool.isRequired,shortcutReactToLastPostEmittedFrom:y().string.isRequired,loadingNewerPosts:y().bool.isRequired,loadingOlderPosts:y().bool.isRequired,actions:y().shape({emitShortcutReactToLastPostFrom:y().func.isRequired}).isRequired});const VE=(0,n.connect)((function(e,t){let s;(0,z.Xq)(t.listId)||(s=t.listId);const n=(0,Em.dj)(e);return{post:t.post||(s?(0,Qe.xl)(e,s):null),channel:t.channel,shortcutReactToLastPostEmittedFrom:n}}),(function(e){return{actions:(0,a.bindActionCreators)({emitShortcutReactToLastPostFrom:U.id},e)}}))(GE);function KE(e){const{formatMessage:t}=(0,Ys.Z)();return M.createElement("span",e,M.createElement("svg",{x:"0px",y:"0px",viewBox:"-239 239 21 23",enableBackground:"new -239 239 21 23",role:"img","aria-label":t({id:"generic_icons.arrow.down",defaultMessage:"Down Arrow Icon"})},M.createElement("path",{d:"M-239,241.4l2.4-2.4l8.1,8.2l8.1-8.2l2.4,2.4l-10.5,10.6L-239,241.4z M-228.5,257.2l8.1-8.2l2.4,2.4l-10.5,10.6l-10.5-10.6 l2.4-2.4L-228.5,257.2z"})))}class YE extends M.PureComponent{render(){if(ra()(window).width()>768)return null;let e="post-list__arrows";return this.props.isScrolling&&!1===this.props.atBottom&&(e+=" scrolling"),M.createElement("div",{className:e,onClick:this.props.onClick},M.createElement(KE,null))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(YE,"propTypes",{isScrolling:y().bool.isRequired,atBottom:y().bool,onClick:y().func.isRequired});var WE=s(54228),zE=s(95939);function JE(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class XE extends M.PureComponent{constructor(...e){super(...e),JE(this,"mounted",void 0),JE(this,"handleDismiss",(()=>{"function"==typeof this.props.onDismiss&&this.props.onDismiss()}))}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){let e="toast";const{show:t,extraClasses:s,showActions:n,width:a}=this.props;s&&(e+=" ".concat(s)),t&&(e+=" toast__visible");let i="toast__message";n&&(i+=" toast__pointer");let r=M.createElement("div",null);return n&&t&&(r=M.createElement(et.Z,{id:"toast-close__tooltip"},M.createElement(V.Z,{id:"general_button.close",defaultMessage:"Close"}),M.createElement("div",{className:"tooltip__shortcut--txt"},M.createElement(V.Z,{id:"general_button.esc",defaultMessage:"esc"})))),M.createElement("div",{className:e},M.createElement("div",{className:i,onClick:n?this.props.onClick:void 0},n&&(()=>M.createElement("div",{className:"toast__jump"},M.createElement(nc,null),a>N.ZP.MOBILE_SCREEN_WIDTH&&this.props.onClickMessage))(),this.props.children),M.createElement("div",{className:"toast__dismiss",onClick:this.handleDismiss,"data-testid":s?"dismissToast-".concat(s):"dismissToast"},M.createElement(WE.Z,{delayShow:N.ZP.OVERLAY_TIME_DELAY,placement:"bottom",overlay:r},M.createElement(zE.Z,{className:"close-btn",id:"dismissToast"}))))}}let QE;JE(XE,"propTypes",{onClick:y().func,onClickMessage:y().string,onDismiss:y().func,children:y().node,show:y().bool.isRequired,showActions:y().bool,width:y().number.isRequired,extraClasses:y().string}),function(e){e.Contrast="contrast"}(QE||(QE={}));const $E=({children:e,variant:t})=>{let s="shortcut-key";return t===QE.Contrast&&(s+=" shortcut-key--contrast"),M.createElement("mark",{className:s},e)};$E.propTypes={variant:y().oneOf(["contrast"]),children:y().node.isRequired};const eC=()=>{const e=(0,I.V5)()?"⌘":"Ctrl";return M.createElement("span",{className:"search-shortcut"},M.createElement($E,{variant:QE.Contrast},e),!(0,R.P)()&&M.createElement($E,{variant:QE.Contrast},"Shift"),M.createElement($E,{variant:QE.Contrast},"F"))},tC=({children:e,onDismiss:t})=>M.createElement("div",{className:"hint-toast__wrapper"},M.createElement("div",{className:"hint-toast"},M.createElement("div",{className:"hint-toast__message"},e),M.createElement("div",{className:"hint-toast__dismiss",onClick:()=>{"function"==typeof t&&t()},"data-testid":"dismissHintToast"},M.createElement(zE.Z,{className:"close-btn",id:"dismissHintToast"}))));function sC(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}tC.propTypes={children:y().node.isRequired,onDismiss:y().func.isRequired};const nC=[lr.ap.NL];class aC extends M.PureComponent{constructor(e){super(e),sC(this,"handleShortcut",(e=>{I.pD(e,N.ZP.KeyCodes.ESCAPE)&&(this.state.showUnreadToast?this.hideUnreadToast():this.state.showNewMessagesToast?this.hideNewMessagesToast():this.hideArchiveToast())})),sC(this,"hideUnreadToast",(()=>{this.state.showUnreadToast&&this.setState({showUnreadToast:!1})})),sC(this,"hideArchiveToast",(()=>{this.state.showMessageHistoryToast&&this.setState({showMessageHistoryToast:!1})})),sC(this,"hideNewMessagesToast",((e=!0)=>{this.state.showNewMessagesToast&&(this.setState({showNewMessagesToast:!1}),e&&this.props.updateLastViewedBottomAt())})),sC(this,"hideSearchHintToast",(()=>{this.props.onSearchHintDismiss&&this.props.onSearchHintDismiss()})),sC(this,"newMessagesToastText",((e,t)=>this.props.width>500&&void 0!==t?M.createElement(V.Z,{id:"postlist.toast.newMessagesSince",defaultMessage:"{count, number} new {count, plural, one {message} other {messages}} {isToday, select, true {} other {since}} {date}",values:{count:e,isToday:(0,id.zk)(new Date(t)).toString(),date:M.createElement(lr.ZP,{value:t,useTime:!1,ranges:nC})}}):M.createElement(V.Z,{id:"postlist.toast.newMessages",defaultMessage:"{count, number} new {count, plural, one {message} other {messages}}",values:{count:e}}))),sC(this,"archiveToastText",(()=>M.createElement(V.Z,{id:"postlist.toast.history",defaultMessage:"Viewing message history"}))),sC(this,"getSearchHintToastText",(()=>M.createElement(V.Z,{id:"postlist.toast.searchHint",defaultMessage:"Tip: Try {searchShortcut} to search this channel",values:{searchShortcut:M.createElement(eC,null)}}))),sC(this,"changeUrlToRemountChannelView",(()=>{const{match:e}=this.props;st.m.replace("/".concat(e.params.team))})),sC(this,"scrollToNewMessage",(()=>{const{focusedPostId:e,atLatestPost:t,scrollToNewMessage:s,updateLastViewedBottomAt:n}=this.props;!e||t?(s(),n(),this.hideNewMessagesToast()):this.changeUrlToRemountChannelView()})),sC(this,"scrollToLatestMessages",(()=>{const{focusedPostId:e,atLatestPost:t,scrollToLatestMessages:s}=this.props;if(e){if(!t)return void this.changeUrlToRemountChannelView();this.hideArchiveToast()}s(),this.hideUnreadToast()})),this.state={unreadCountInChannel:e.unreadCountInChannel}}static getDerivedStateFromProps(e,t){let s,{showUnreadToast:n,showNewMessagesToast:a,showMessageHistoryToast:i}=t;return s=e.atLatestPost?aC.countNewMessages(e.postListIds,e.rootPosts,e.isCollapsedThreadsEnabled):e.channelMarkedAsUnread?t.unreadCountInChannel:t.unreadCountInChannel+e.newRecentMessagesCount,void 0===n&&null!==e.atBottom&&(n=s>0&&!e.atBottom),void 0===i&&""!==e.focusedPostId&&null!==e.atBottom&&(i=e.initScrollOffsetFromBottom>1e3||!e.atLatestPost),!e.channelMarkedAsUnread||e.atBottom||t.channelMarkedAsUnread||t.showUnreadToast||(n=!0),e.channelMarkedAsUnread&&e.lastViewedAt!==t.lastViewedAt&&!e.atBottom&&(n=!0),!n&&s>0&&!e.atBottom&&e.lastViewedBottom<e.latestPostTimeStamp&&(a=!0),s||(a=!1,n=!1),{unreadCount:s,showUnreadToast:n,showNewMessagesToast:a,lastViewedAt:e.lastViewedAt,channelMarkedAsUnread:e.channelMarkedAsUnread,showMessageHistoryToast:i}}componentDidMount(){this.mounted=!0;const{showUnreadToast:e,showNewMessagesToast:t,showMessageHistoryToast:s}=this.state,n=Boolean(e||t||s);document.addEventListener("keydown",this.handleShortcut),this.props.actions.updateToastStatus(n)}componentDidUpdate(e,t){const{showUnreadToast:s,showNewMessagesToast:n,showMessageHistoryToast:a}=this.state,{atBottom:i,atLatestPost:r,postListIds:o,lastViewedBottom:l,updateNewMessagesAtInChannel:c,actions:d}=this.props;!e.atBottom&&i&&r&&(this.hideNewMessagesToast(!1),this.hideUnreadToast(),this.hideArchiveToast());const h=e.postListIds.length,p=o.length;if(p!==h&&o[0]!==e.postListIds[0]&&!1===i&&r&&p>0&&!s&&c(l),t.showUnreadToast!==s||t.showNewMessagesToast!==n||t.showMessageHistoryToast!==a){const e=Boolean(s||n||a);d.updateToastStatus(e)}}componentWillUnmount(){document.removeEventListener("keydown",this.handleShortcut)}getToastToRender(){const{atLatestPost:e,atBottom:t,width:s,lastViewedAt:n,showSearchHintToast:a}=this.props,{showUnreadToast:i,showNewMessagesToast:r,showMessageHistoryToast:o,unreadCount:l}=this.state,c={show:!0,width:s,onDismiss:this.hideUnreadToast,onClick:this.scrollToLatestMessages,onClickMessage:I._u("postlist.toast.scrollToBottom","Jump to recents"),showActions:!e||e&&!t};if(i&&l>0)return M.createElement(XE,c,this.newMessagesToastText(l,n));if(r){const e={onDismiss:this.hideNewMessagesToast,onClick:this.scrollToNewMessage,onClickMessage:I._u("postlist.toast.scrollToLatest","Jump to new messages")};return M.createElement(XE,Object.assign({},c,e),this.newMessagesToastText(l,n))}if(o){const e={show:!0,width:s,onDismiss:this.hideArchiveToast,onClick:this.scrollToLatestMessages,onClickMessage:I._u("postlist.toast.scrollToBottom","Jump to recents"),showActions:!0,extraClasses:"toast__history"};return M.createElement(XE,e,this.archiveToastText())}return a?M.createElement(tC,{onDismiss:this.hideSearchHintToast},this.getSearchHintToastText()):null}render(){const e=this.getToastToRender();return M.createElement(M.Fragment,null,e)}}sC(aC,"propTypes",{unreadCountInChannel:y().number,newRecentMessagesCount:y().number,channelMarkedAsUnread:y().bool,isCollapsedThreadsEnabled:y().bool,rootPosts:y().object,atLatestPost:y().bool,postListIds:y().array,latestPostTimeStamp:y().number,atBottom:y().bool,lastViewedBottom:y().number,width:y().number,lastViewedAt:y().number,focusedPostId:y().string,initScrollOffsetFromBottom:y().number,updateNewMessagesAtInChannel:y().func,scrollToNewMessage:y().func,scrollToLatestMessages:y().func,updateLastViewedBottomAt:y().func,showSearchHintToast:y().bool,onSearchHintDismiss:y().func,match:y().shape({params:y().shape({team:y().string}).isRequired}).isRequired,actions:y().shape({updateToastStatus:y().func.isRequired}).isRequired}),sC(aC,"defaultProps",{focusedPostId:""}),sC(aC,"countNewMessages",((e,t,s)=>{const n=(0,z.lH)(e);if(n<=0)return 0;let a=e.slice(0,n).filter((e=>!(0,z.Xq)(e)));return s&&(a=a.filter((e=>t[e]))),a.length}));const iC=(0,K.ZP)(aC),rC=(0,i.EN)((0,n.connect)((function(){const e=(0,Jt.P1)(Qe.Bd,p.rc,((e,t)=>t),((e,t,s)=>s),d.ym,((e,t,s,n,a)=>s?s.map((t=>e[t])).filter((e=>e&&e.user_id!==t&&e.state!==D.V8.POST_DELETED&&e.create_at>n&&(!a||""===e.root_id))).length:0)),t=(0,Jt.P1)(Qe.Bd,p.rc,m.TB,((e,t,s)=>Object.values(e).filter((e=>""===e.root_id&&e.channel_id===s.id&&e.state!==D.V8.POST_DELETED)).reduce(((e,t)=>(e[t.id]=!0,e)),{}))),s=(0,Xm.Zl)();return function(n,a){let i=0;const r=(0,m.Zm)(n,a.channelId),o=n.views.channel.lastChannelViewTime[a.channelId];if(!a.atLatestPost){let t=(0,Qe.T$)(n,a.channelId);t&&(t=s(n,{postIds:t,lastViewedAt:o,channelId:a.channelId})),i=e(n,t,o)}return{rootPosts:t(n),lastViewedAt:o,newRecentMessagesCount:i,isCollapsedThreadsEnabled:(0,d.ym)(n),unreadCountInChannel:(0,m.JC)(n),channelMarkedAsUnread:r}}}),(function(e){return{actions:(0,a.bindActionCreators)({updateToastStatus:b.fB},e)}}))(iC));function oC(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function lC(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?oC(Object(s),!0).forEach((function(t){cC(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):oC(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function cC(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const dC={padding:"14px 0px 7px"},hC={position:"absolute",bottom:"0",maxHeight:"100%"},pC=-50;class uC extends M.PureComponent{constructor(e){super(e),cC(this,"getNewMessagesSeparatorIndex",(e=>e.findIndex((e=>0===e.indexOf(N.iH.START_OF_NEW_MESSAGES))))),cC(this,"handleWindowResize",(()=>{this.props.actions.checkAndSetMobileView();const e=I.tq();if(e!==this.state.isMobile){const t=this.state.dynamicListStyle;this.state.postMenuOpened&&(e||"unset"!==t.willChange?e&&"transform"===t.willChange&&(t.willChange="unset"):t.willChange="transform"),this.setState({isMobile:e,dynamicListStyle:t}),this.scrollStopAction=new pt.Z(this.handleScrollStop)}this.showSearchHintThreshold=this.getShowSearchHintThreshold()})),cC(this,"togglePostMenu",(e=>{const t=this.state.dynamicListStyle;this.state.isMobile&&(t.willChange=e?"unset":"transform"),this.setState({postMenuOpened:e,dynamicListStyle:t})})),cC(this,"renderRow",(({data:e,itemId:t,style:s})=>{const n=e.indexOf(t);let a="";const i=-1!==n&&n<e.length-1?e[n+1]:"",r=n>0&&n<e.length?e[n-1]:"";((0,Xm.Ji)(r)||(0,Xm.p4)(r))&&(a+="post-row__padding bottom"),((0,Xm.Ji)(i)||(0,Xm.p4)(i))&&(a.includes("post-row__padding")?a+=" top":a+="post-row__padding top");const o=t===this.state.postListIds[0];return M.createElement("div",{style:s,className:W()("post-item__v2",a)},M.createElement(VE,{listId:t,previousListId:(0,z.in)(e,n),shouldHighlight:t===this.props.focusedPostId,loadOlderPosts:this.props.actions.loadOlderPosts,loadNewerPosts:this.props.actions.loadNewerPosts,togglePostMenu:this.togglePostMenu,isLastPost:o,loadingNewerPosts:this.props.loadingNewerPosts,loadingOlderPosts:this.props.loadingOlderPosts}))})),cC(this,"scrollToFailed",(e=>{0===e?this.props.actions.changeUnreadChunkTimeStamp(""):this.props.actions.changeUnreadChunkTimeStamp(this.props.lastViewedAt)})),cC(this,"onScroll",(({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:s,clientHeight:n,scrollHeight:a})=>{if(a<=0)return;const i="forward"===e&&!s,r=a-n-t,o=r<1e3;"backward"===e&&!s&&t<1e3&&!this.props.atOldestPost?this.props.actions.loadOlderPosts():i&&o&&!this.props.atLatestPost&&this.props.actions.loadNewerPosts(),this.state.isMobile&&(this.state.isScrolling||this.setState({isScrolling:!0}),this.scrollStopAction&&this.scrollStopAction.fireAfter(N.ZP.SCROLL_DELAY)),this.checkBottom(t,a,n),s&&(this.listRef.current._getRangeToRender()[3]<=1&&!this.props.atLatestPost&&this.props.actions.canLoadMorePosts(N.kL.AFTER_ID),!this.state.atBottom&&a&&this.setState({initScrollOffsetFromBottom:r})),this.state.isMobile&&this.state.showSearchHint&&this.setState({showSearchHint:!1}),this.state.isMobile||this.state.isSearchHintDismissed||this.setState({showSearchHint:r>this.showSearchHintThreshold})})),cC(this,"getShowSearchHintThreshold",(()=>3*window.screen.height)),cC(this,"checkBottom",((e,t,s)=>{this.updateAtBottom(this.isAtBottom(e,t,s))})),cC(this,"isAtBottom",((e,t,s)=>t-s-e<=10&&t>0)),cC(this,"updateAtBottom",(e=>{if(e!==this.state.atBottom){let t=Date.now();this.props.latestPostTimeStamp>t&&(t=this.props.latestPostTimeStamp),this.setState({atBottom:e,lastViewedBottom:t})}})),cC(this,"updateLastViewedBottomAt",((e=Date.now())=>{this.setState({lastViewedBottom:e})})),cC(this,"handleScrollStop",(()=>{this.mounted&&this.setState({isScrolling:!1})})),cC(this,"handleSearchHintDismiss",(()=>{this.setState({showSearchHint:!1,isSearchHintDismissed:!0})})),cC(this,"updateFloatingTimestamp",(e=>{this.state.isMobile&&this.props.postListIds&&this.setState({topPostId:(0,z.nc)(this.props.postListIds.slice(e))})})),cC(this,"onItemsRendered",(({visibleStartIndex:e})=>{this.updateFloatingTimestamp(e)})),cC(this,"initScrollToIndex",(()=>{if(this.props.focusedPostId)return{index:this.state.postListIds.findIndex((e=>e===this.props.focusedPostId)),position:"center"};const e=(0,z.lH)(this.state.postListIds);return e>0?(0,Xm.Ji)(this.state.postListIds[e+1])?{index:e+1,position:"start",offset:pC}:{index:e,position:"start",offset:pC}:{index:0,position:"end"}})),cC(this,"scrollToLatestMessages",(()=>{this.props.atLatestPost?this.scrollToBottom():(this.updateNewMessagesAtInChannel(),this.props.actions.changeUnreadChunkTimeStamp(""))})),cC(this,"scrollToBottom",(()=>{this.listRef.current?this.listRef.current.scrollToItem(0,"end"):setTimeout((()=>{this.listRef.current&&this.listRef.current.scrollToItem(0,"end")}),500)})),cC(this,"scrollToNewMessage",(()=>{this.listRef.current?this.listRef.current.scrollToItem((0,z.lH)(this.state.postListIds),"start",pC):setTimeout((()=>{this.listRef.current&&this.listRef.current.scrollToItem((0,z.lH)(this.state.postListIds),"start",pC)}),500)})),cC(this,"updateNewMessagesAtInChannel",((e=Date.now())=>{this.props.actions.updateNewMessagesAtInChannel(this.props.channelId,e)})),cC(this,"renderToasts",(e=>M.createElement(rC,{atLatestPost:this.props.atLatestPost,postListIds:this.state.postListIds,atBottom:this.state.atBottom,width:e,lastViewedBottom:this.state.lastViewedBottom,latestPostTimeStamp:this.props.latestPostTimeStamp,scrollToNewMessage:this.scrollToNewMessage,scrollToLatestMessages:this.scrollToLatestMessages,updateNewMessagesAtInChannel:this.updateNewMessagesAtInChannel,updateLastViewedBottomAt:this.updateLastViewedBottomAt,channelId:this.props.channelId,focusedPostId:this.props.focusedPostId,initScrollOffsetFromBottom:this.state.initScrollOffsetFromBottom,onSearchHintDismiss:this.handleSearchHintDismiss,showSearchHintToast:this.state.showSearchHint})));const t=N.iH.CHANNEL_INTRO_MESSAGE,s=I.tq();this.state={isScrolling:!1,isMobile:s,atBottom:null,lastViewedBottom:Date.now(),postListIds:[t],topPostId:"",postMenuOpened:!1,dynamicListStyle:{willChange:"transform"},initScrollCompleted:!1,initScrollOffsetFromBottom:0,showSearchHint:!1,isSearchHintDismissed:!1},this.listRef=M.createRef(),this.postListRef=M.createRef(),s&&(this.scrollStopAction=new pt.Z(this.handleScrollStop)),this.initRangeToRender=this.props.focusedPostId?[0,100]:[0,50];let n=0;n=e.focusedPostId?this.props.postListIds.findIndex((e=>e===this.props.focusedPostId)):this.getNewMessagesSeparatorIndex(e.postListIds);const a=e.focusedPostId?100:50;this.initRangeToRender=[Math.max(n-30,0),Math.max(n+30,Math.min(e.postListIds.length-1,a))],this.showSearchHintThreshold=this.getShowSearchHintThreshold()}componentDidMount(){this.mounted=!0,this.props.actions.checkAndSetMobileView(),window.addEventListener("resize",this.handleWindowResize),eg.Z.addListener(N.GM.POST_LIST_SCROLL_TO_BOTTOM,this.scrollToLatestMessages)}getSnapshotBeforeUpdate(e){if(this.postListRef&&this.postListRef.current){const t=this.props.postListIds&&this.props.postListIds.length!==e.postListIds.length&&this.props.postListIds[0]===e.postListIds[0],s=this.props.atOldestPost!==e.atOldestPost;if((t||s)&&!1===this.state.atBottom){const e=this.postListRef.current;return{previousScrollTop:e.parentElement.scrollTop,previousScrollHeight:e.scrollHeight}}}return null}componentDidUpdate(e,t,s){if(!this.postListRef.current)return;const n=e.postListIds.length,a=this.props.postListIds.length;if(s){const t=this.postListRef.current.scrollHeight,i=a!==n&&this.props.postListIds[0]===e.postListIds[0],r=this.props.atOldestPost!==e.atOldestPost;if((i||r)&&!this.state.atBottom&&s){const e=s.previousScrollTop+(t-s.previousScrollHeight);0!==e&&e-s.previousScrollTop!=0&&this.listRef.current.scrollTo(e,e-s.previousScrollTop,!0)}}}componentWillUnmount(){this.mounted=!1,window.removeEventListener("resize",this.handleWindowResize),eg.Z.removeListener(N.GM.POST_LIST_SCROLL_TO_BOTTOM,this.scrollToLatestMessages)}static getDerivedStateFromProps(e){const t=e.postListIds;let s;return s=e.atOldestPost?[...t,N.iH.CHANNEL_INTRO_MESSAGE]:e.autoRetryEnable?[...t,N.iH.OLDER_MESSAGES_LOADER]:[...t,N.iH.LOAD_OLDER_MESSAGES_TRIGGER],e.atLatestPost||(s=e.autoRetryEnable?[N.iH.NEWER_MESSAGES_LOADER,...s]:[N.iH.LOAD_NEWER_MESSAGES_TRIGGER,...s]),{postListIds:s}}render(){const e=this.props.channelId;let t;this.props.latestAriaLabelFunc&&this.props.postListIds.indexOf(N.iH.START_OF_NEW_MESSAGES)>=0&&(t=this.props.latestAriaLabelFunc(this.props.intl));const{dynamicListStyle:s}=this.state;return M.createElement("div",{role:"list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0,"data-a11y-loop-navigation":!1,"aria-label":I._u("accessibility.sections.centerContent","message list main region")},this.state.isMobile&&M.createElement(M.Fragment,null,M.createElement(ag,{isScrolling:this.state.isScrolling,isMobile:!0,postId:this.state.topPostId}),M.createElement(YE,{isScrolling:this.state.isScrolling,atBottom:this.state.atBottom,onClick:this.scrollToBottom})),M.createElement("div",{role:"presentation",className:"post-list-holder-by-time",key:"postlist-"+e},M.createElement("div",{role:"presentation",className:"post-list__table"},M.createElement("div",{id:"postListContent",className:"post-list__content"},M.createElement("span",{className:"sr-only","aria-live":"polite"},t),M.createElement(Qm.Z,null,(({height:e,width:t})=>M.createElement(M.Fragment,null,M.createElement("div",null,this.renderToasts(t)),M.createElement($m.z,{ref:this.listRef,height:e,width:t,className:"post-list__dynamic",itemData:this.state.postListIds,overscanCountForward:80,overscanCountBackward:80,onScroll:this.onScroll,initScrollToIndex:this.initScrollToIndex,canLoadMorePosts:this.props.actions.canLoadMorePosts,innerRef:this.postListRef,style:lC(lC({},hC),s),innerListStyle:dC,initRangeToRender:this.initRangeToRender,loaderId:N.iH.OLDER_MESSAGES_LOADER,correctScrollToBottom:this.props.atLatestPost,onItemsRendered:this.onItemsRendered,scrollToFailed:this.scrollToFailed},this.renderRow))))))))}}cC(uC,"propTypes",{postListIds:y().array.isRequired,focusedPostId:y().string,channelId:y().string.isRequired,autoRetryEnable:y().bool,atOldestPost:y().bool,atLatestPost:y().bool,loadingNewerPosts:y().bool,loadingOlderPosts:y().bool,intl:J.gm.isRequired,latestPostTimeStamp:y().number,latestAriaLabelFunc:y().func,lastViewedAt:y().string,actions:y().shape({loadOlderPosts:y().func.isRequired,loadNewerPosts:y().func.isRequired,canLoadMorePosts:y().func.isRequired,checkAndSetMobileView:y().func.isRequired,changeUnreadChunkTimeStamp:y().func.isRequired,updateNewMessagesAtInChannel:y().func.isRequired}).isRequired});const mC=(0,K.ZP)(uC);function gC(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class fC extends M.PureComponent{constructor(e){super(e),gC(this,"postsOnLoad",(async e=>{const{focusedPostId:t,isFirstLoad:s,latestPostTimeStamp:n,isPrefetchingInProcess:a,actions:i}=this.props;t?await i.loadPostsAround(e,this.props.focusedPostId):s?a||await i.loadUnreads(e):n?await i.syncPostsInChannel(e,this.props.latestPostTimeStamp,!1):await i.loadLatestPosts(e),t||this.markChannelAsReadAndViewed(e),this.mounted&&this.setState({loadingOlderPosts:!1,loadingNewerPosts:!1})})),gC(this,"callLoadPosts",(async(e,t,s)=>{const{error:n}=await this.props.actions.loadPosts({channelId:e,postId:t,type:s});return s===N.kL.BEFORE_ID?this.setState({loadingOlderPosts:!1}):this.setState({loadingNewerPosts:!1}),n?this.autoRetriesCount<3?(this.autoRetriesCount++,await this.callLoadPosts(e,t,s)):this.mounted&&this.setState({autoRetryEnable:!1}):(this.mounted&&this.setState({autoRetryEnable:!0}),this.state.autoRetryEnable||(this.autoRetriesCount=0)),{error:n}})),gC(this,"markChannelAsReadAndViewed",(e=>{this.props.actions.markChannelAsViewed(e),this.props.actions.markChannelAsRead(e)})),gC(this,"getOldestVisiblePostId",(()=>(0,z.ju)(this.props.postListIds))),gC(this,"getLatestVisiblePostId",(()=>(0,z.nc)(this.props.postListIds))),gC(this,"canLoadMorePosts",(async(e=N.kL.BEFORE_ID)=>{if(this.props.postListIds&&!this.state.loadingOlderPosts&&!this.state.loadingNewerPosts)if(this.extraPagesLoaded>10)this.state.autoRetryEnable&&this.setState({autoRetryEnable:!1});else{if(this.props.atOldestPost||e!==N.kL.BEFORE_ID){if(!this.props.atLatestPost){const e=this.getLatestVisiblePostId();await this.getPostsAfter(e)}}else{const e=this.getOldestVisiblePostId();await this.getPostsBefore(e)}this.extraPagesLoaded+=1}})),gC(this,"getPostsBefore",(async()=>{if(this.state.loadingOlderPosts)return;const e=this.getOldestVisiblePostId();this.setState({loadingOlderPosts:!0}),await this.callLoadPosts(this.props.channelId,e,N.kL.BEFORE_ID)})),gC(this,"getPostsAfter",(async()=>{if(this.state.loadingNewerPosts)return;const e=this.getLatestVisiblePostId();this.setState({loadingNewerPosts:!0}),await this.callLoadPosts(this.props.channelId,e,N.kL.AFTER_ID)})),this.state={loadingNewerPosts:!1,loadingOlderPosts:!1,autoRetryEnable:!0},this.autoRetriesCount=0,this.loadingMorePosts=null,this.actionsForPostList={loadOlderPosts:this.getPostsBefore,loadNewerPosts:this.getPostsAfter,checkAndSetMobileView:e.actions.checkAndSetMobileView,canLoadMorePosts:this.canLoadMorePosts,changeUnreadChunkTimeStamp:e.changeUnreadChunkTimeStamp,updateNewMessagesAtInChannel:this.props.actions.updateNewMessagesAtInChannel}}componentDidMount(){this.mounted=!0,this.props.channelId&&this.postsOnLoad(this.props.channelId)}componentDidUpdate(e){this.props.channelId!==e.channelId&&this.postsOnLoad(this.props.channelId)}componentWillUnmount(){this.props.channelManuallyUnread||this.markChannelAsReadAndViewed(this.props.channelId),this.mounted=!1}render(){return this.props.postListIds?M.createElement(mC,{key:"postlist-"+this.props.channelId,loadingNewerPosts:this.state.loadingNewerPosts,loadingOlderPosts:this.state.loadingOlderPosts,atOldestPost:this.props.atOldestPost,atLatestPost:this.props.atLatestPost,focusedPostId:this.props.focusedPostId,channelId:this.props.channelId,autoRetryEnable:this.state.autoRetryEnable,actions:this.actionsForPostList,postListIds:this.props.formattedPostIds,latestPostTimeStamp:this.props.latestPostTimeStamp,latestAriaLabelFunc:this.props.latestAriaLabelFunc,latestPostId:this.props.latestPostId}):M.createElement(Ga.Z,{position:"absolute",key:"loading"})}}gC(fC,"propTypes",{formattedPostIds:y().array,postListIds:y().array,channelId:y().string,focusedPostId:y().string,atLatestPost:y().bool,atOldestPost:y().bool,isFirstLoad:y().bool,latestPostTimeStamp:y().number,latestAriaLabelFunc:y().func,channelManuallyUnread:y().bool.isRequired,latestPostId:y().string,changeUnreadChunkTimeStamp:y().func.isRequired,isPrefetchingInProcess:y().bool.isRequired,actions:y().shape({loadPostsAround:y().func.isRequired,loadUnreads:y().func.isRequired,loadPosts:y().func.isRequired,checkAndSetMobileView:y().func.isRequired,syncPostsInChannel:y().func.isRequired,loadLatestPosts:y().func.isRequired,markChannelAsViewed:y().func.isRequired,markChannelAsRead:y().func.isRequired,updateNewMessagesAtInChannel:y().func.isRequired}).isRequired});const EC=(e,t)=>!e.entities.posts.postsInChannel[t],CC=(0,dn.GA)((e=>(0,z.nc)(e))),bC=(0,i.EN)((0,n.connect)((function(){const e=(0,Qe.Rx)(),t=(0,Xm.Zl)(),s=(0,z.Tx)();return function(n,a){let i,r,o,l,c=0,d=!1,h=!1;const{focusedPostId:p,unreadChunkTimeStamp:u,channelId:g}=a,f=n.views.channel,E=f.lastChannelViewTime[g],C=f.channelPrefetchStatus[g]===D.eE.STARTED,b=(0,m.Zm)(n,g);if(r=p&&""!==u?e(n,p,g):u?(0,Qe.Wj)(n,g,u):(0,Qe.G4)(n,g),r&&(i=r.order,d=r.recent,h=r.oldest),i&&(o=t(n,{postIds:i,lastViewedAt:E,indicateNewMessages:!0,channelId:g}),i.length)){const e=CC(i),t=(0,Qe.xl)(n,e);c=t.create_at,l=s(n,t)}return{lastViewedAt:E,isFirstLoad:EC(n,g),formattedPostIds:o,atLatestPost:d,atOldestPost:h,latestPostTimeStamp:c,postListIds:i,latestAriaLabelFunc:l,isPrefetchingInProcess:C,channelManuallyUnread:b}}}),(function(e){return{actions:(0,a.bindActionCreators)({loadUnreads:b.D2,loadPosts:b.Nz,loadLatestPosts:b.e_,loadPostsAround:b.cX,checkAndSetMobileView:b.Yz,syncPostsInChannel:b.RE,markChannelAsViewed:o.gI,markChannelAsRead:o.Eo,updateNewMessagesAtInChannel:T.JI},e)}}))(fC));function _C(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class vC extends M.PureComponent{constructor(e){super(e),_C(this,"changeUnreadChunkTimeStamp",(e=>{this.setState({unreadChunkTimeStamp:e,loaderForChangeOfPostsChunk:!0},(()=>{window.requestAnimationFrame((()=>{this.setState({loaderForChangeOfPostsChunk:!1})}))}))})),this.state={unreadChunkTimeStamp:e.lastViewedAt,loaderForChangeOfPostsChunk:!1,channelLoading:e.channelLoading}}static getDerivedStateFromProps(e,t){return null===t.unreadChunkTimeStamp&&e.lastViewedAt?{unreadChunkTimeStamp:e.lastViewedAt}:e.channelLoading!==t.channelLoading?{unreadChunkTimeStamp:e.lastViewedAt,channelLoading:e.channelLoading}:null}render(){return this.props.channelLoading||this.state.loaderForChangeOfPostsChunk?M.createElement("div",{id:"post-list",className:"post-list-v2"},M.createElement("div",{className:"filter-x"},""),M.createElement(Ga.Z,{position:"absolute",key:"loading",message:M.createElement(V.Z,{id:"loading_screen.loading_content",defaultMessage:"Đang tải nội dung"})})):M.createElement("div",{id:"post-list",className:"post-list-v2",role:"main"},M.createElement("div",{className:"filter-x"},""),M.createElement(bC,{unreadChunkTimeStamp:this.state.unreadChunkTimeStamp,channelId:this.props.channelId,changeUnreadChunkTimeStamp:this.changeUnreadChunkTimeStamp,focusedPostId:this.props.focusedPostId}))}}_C(vC,"propTypes",{lastViewedAt:y().number,channelLoading:y().bool,channelId:y().string,focusedPostId:y().string});const yC=(0,i.EN)((0,n.connect)((function(){return function(e,t){const s=(0,u.Xv)(e,t.match.params.team);let n;const a=(0,m.mr)(e,t.channelId);let i=e.views.channel.lastChannelViewTime[t.channelId];a&&(a.type===N.gT.DM_CHANNEL&&a.teammate_id&&(n=(0,p.PR)(e,a.teammate_id)),i=a.last_post_at?i:a.last_post_at);const r=(0,u.gb)(e);return{lastViewedAt:i,channelLoading:((e,t,s,n,a)=>{if(e.postid)return!1;if(t&&s){if(t.type!==N.gT.DM_CHANNEL&&t.name!==e.identifier)return!0;if(t.type===N.gT.DM_CHANNEL&&n&&e.identifier!=="@".concat(n.username))return!0;const i=s.id;return!!(t.team_id&&t.team_id!==i||a&&!a[i])}return!0})(t.match.params,a,s,n,r)}}}))(vC)),MC=s.p+"files/daa08e6ee76dbbf096e390f862d038a7.png";function PC(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class wC extends M.PureComponent{constructor(e){super(e),PC(this,"handleNext",(e=>this.skipTutorial(e))),PC(this,"skipTutorial",(e=>{switch(e.preventDefault(),this.state.currentScreen){case 0:(0,Ye.L9)("tutorial","tutorial_screen_1_welcome_to_mattermost_skip");break;case 1:(0,Ye.L9)("tutorial","tutorial_screen_2_how_mattermost_works_skip");break;case 2:(0,Ye.L9)("tutorial","tutorial_screen_3_youre_all_set_skip")}const{currentUserId:t}=this.props,s=[{user_id:t,category:N.uP.TUTORIAL_STEP,name:t,value:N.gT.TutorialSteps.FINISHED.toString()}];this.props.actions.savePreferences(t,s),this.props.actions.unhideNextSteps()})),PC(this,"createScreen",(()=>{switch(this.state.currentScreen){case 0:return this.createScreenOne();case 1:return this.createScreenTwo();case 2:return this.createScreenThree()}return null})),PC(this,"handleCircleClick",((e,t)=>{e.preventDefault(),this.setState({currentScreen:t})})),PC(this,"createCircles",(()=>{const e=[];for(let t=0;t<3;t++){let s="circle";t===this.state.currentScreen&&(s+=" active"),e.push(M.createElement("a",{id:"tutorialIntroCircle"+t,href:"#",key:"circle"+t,className:s,"data-screen":t,onClick:e=>this.handleCircleClick(e,t)}))}return M.createElement("div",{className:"tutorial__circles"},e)})),this.state={currentScreen:0}}createScreenOne(){const e=this.createCircles();return M.createElement("div",{id:"tutorialIntroOne"},M.createElement("h3",null,M.createElement(V.Z,{id:"tutorial_intro.screenOne.title1",defaultMessage:"Welcome to:"})),M.createElement("h1",null,M.createElement(V.Z,{id:"tutorial_intro.screenOne.title2",defaultMessage:"Gomlo"})),M.createElement("p",null,M.createElement(V.Z,{id:"tutorial_intro.screenOne.body1",defaultMessage:"Your team communication all in one place, instantly searchable and available anywhere."})),M.createElement("p",null,M.createElement(V.Z,{id:"tutorial_intro.screenOne.body2",defaultMessage:"Keep your team connected to help them achieve what matters most."})),e)}createScreenTwo(){const e=this.createCircles();let t=null,s=null;if(this.props.appDownloadLink){const e=(0,Sn.Hb)(this.props.appDownloadLink);t=M.createElement(V.Z,{id:"tutorial_intro.mobileApps",defaultMessage:"Install the apps for {link} for easy access and notifications on the go.",values:{link:M.createElement("a",{id:"appDownloadLink",href:e,target:"_blank",rel:"noopener noreferrer"},M.createElement(V.Z,{id:"tutorial_intro.mobileAppsLinkText",defaultMessage:"PC, Mac, iOS and Android"}))}}),s=M.createElement("a",{id:"appDownloadImage",href:e,target:"_blank",rel:"noopener noreferrer"},M.createElement("img",{alt:"tutorial icons",className:"tutorial__app-icons",src:MC,loading:"lazy"}))}return M.createElement("div",{id:"tutorialIntroTwo"},M.createElement("h3",null,M.createElement(V.Z,{id:"tutorial_intro.screenTwo.title",defaultMessage:"How Mattermost Works:"})),M.createElement("p",null,M.createElement(V.Z,{id:"tutorial_intro.screenTwo.body1",defaultMessage:"Communication happens in public discussion channels, private channels and direct messages."})),M.createElement("p",null,M.createElement(V.Z,{id:"tutorial_intro.screenTwo.body2",defaultMessage:"Everything is archived and searchable from any web-enabled desktop, laptop or phone."})),t,s,e)}createScreenThree(){let e,t;this.props.isLicensed&&this.props.restrictTeamInvite||(e=M.createElement(kE.Z,{id:"tutorialIntroInvite",className:"intro-links color--link style--none",modalId:N.r8.INVITATION,dialogType:ta},M.createElement(V.Z,{id:"tutorial_intro.invite",defaultMessage:"Invite Teammates"})),t=M.createElement("p",null,e,M.createElement(V.Z,{id:"tutorial_intro.whenReady",defaultMessage:" when you're ready."})));const s=this.createCircles();let n=null;return this.props.supportEmail&&(n=M.createElement("p",{id:"supportInfo"},M.createElement(V.Z,{id:"tutorial_intro.support",defaultMessage:"Need anything, just email us at "}),M.createElement("a",{href:"mailto:"+this.props.supportEmail,target:"_blank",rel:"noopener noreferrer"},this.props.supportEmail),".")),M.createElement("div",{id:"tutorialIntroThree"},M.createElement("h3",null,M.createElement(V.Z,{id:"tutorial_intro.allSet",defaultMessage:"You're all set"})),t,n,M.createElement(V.Z,{id:"tutorial_intro.end",defaultMessage:'Click "Next" to enter {channel}. This is the first channel teammates see when they sign up. Use it for posting updates everyone needs to know.',values:{channel:this.props.townSquareDisplayName}}),s)}render(){const e=this.createScreen();return M.createElement("div",{className:"tutorial-steps__container"},M.createElement("div",{id:"tutorialIntroContent",className:"tutorial__content"},M.createElement("div",{className:"tutorial__steps"},e,M.createElement("div",{className:"tutorial__footer"},M.createElement("button",{id:"tutorialNextButton",className:"btn btn-primary",onClick:this.handleNext},M.createElement(V.Z,{id:"tutorial_intro.next",defaultMessage:"Next"})),M.createElement("a",{id:"tutorialSkipLink",className:"tutorial-skip",href:"#",onClick:this.skipTutorial},M.createElement(V.Z,{id:"tutorial_intro.skip",defaultMessage:"Skip Tutorial"}))))))}}PC(wC,"propTypes",{currentUserId:y().string.isRequired,step:y().number,townSquareDisplayName:y().string.isRequired,appDownloadLink:y().string,isLicensed:y().bool.isRequired,restrictTeamInvite:y().bool.isRequired,supportEmail:y().string.isRequired,actions:y().shape({savePreferences:y().func.isRequired,unhideNextSteps:y().func.isRequired}).isRequired});const SC=(0,n.connect)((function(e){const t=(0,p.rc)(e);return{currentUserId:t,step:(0,d.wS)(e,N.uP.TUTORIAL_STEP,t,0)}}),(function(e){return{actions:(0,a.bindActionCreators)({savePreferences:Oe.$A,unhideNextSteps:zt},e)}}))(wC);class TC extends M.PureComponent{componentDidMount(){this.props.isRoot&&document.body.classList.add("app__body"),this.props.currentUser.last_picture_update||this.props.actions.setDefaultProfileImage(this.props.currentUser.id)}componentWillUnmount(){this.props.isRoot&&document.body.classList.remove("app__body")}render(){return M.createElement("div",{id:"app-content",className:"app__content"},M.createElement(SC,{townSquareDisplayName:this.props.townSquareDisplayName,appDownloadLink:this.props.appDownloadLink,isLicensed:this.props.isLicensed,restrictTeamInvite:this.props.restrictTeamInvite,supportEmail:this.props.supportEmail}))}}TC.propTypes={isRoot:y().bool,townSquareDisplayName:y().string.isRequired,appDownloadLink:y().string,isLicensed:y().bool.isRequired,restrictTeamInvite:y().bool.isRequired,supportEmail:y().string.isRequired,currentUser:y().object,actions:y().shape({setDefaultProfileImage:y().func.isRequired}).isRequired},TC.defaultProps={isRoot:!0};const NC=(0,n.connect)((function(e){const t=(0,h.lJ)(e),s=(0,h.iE)(e),n=(0,u.kA)(e),a=(0,m.p7)(e)[N.ZP.DEFAULT_CHANNEL],i=a?a.display_name:N.ZP.DEFAULT_CHANNEL_UI_NAME,r=s.AppDownloadLink,o="true"===t.IsLicensed,l=!(0,Z.Rm)(e,{team:n.id,permission:D.Pl.INVITE_USER}),c=s.SupportEmail;return{currentUser:(0,p.ts)(e),townSquareDisplayName:i,appDownloadLink:r,isLicensed:o,restrictTeamInvite:l,supportEmail:c}}),(function(e){return{actions:(0,a.bindActionCreators)({setDefaultProfileImage:r.QJ},e)}}))(TC);function RC(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function IC(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?RC(Object(s),!0).forEach((function(t){OC(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):RC(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function OC(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class LC extends M.PureComponent{static getDerivedStateFromProps(e,t){let s={};const n=e.match.params.postid;return e.match.url!==t.url&&e.channelId!==t.channelId&&(s={deferredPostView:LC.createDeferredPostView(),url:e.match.url,focusedPostId:n}),e.channelId!==t.channelId&&(s=IC(IC({},s),{},{channelId:e.channelId,focusedPostId:n})),n&&n!==t.focusedPostId&&(s=IC(IC({},s),{},{focusedPostId:n})),e.showNextSteps!==t.showNextSteps&&(s=IC(IC({},s),{},{showNextSteps:e.showNextSteps})),Object.keys(s).length?s:null}constructor(e){super(e),OC(this,"channelViewRef",void 0),OC(this,"getChannelView",(()=>this.channelViewRef.current)),OC(this,"onClickCloseChannel",(()=>{this.props.actions.goToLastViewedChannel()})),this.state={url:e.match.url,channelId:e.channelId,focusedPostId:e.match.params.postid,deferredPostView:LC.createDeferredPostView(),showNextSteps:e.showNextSteps},this.channelViewRef=M.createRef()}async componentDidMount(){await this.props.actions.getContacts(0,500),!this.props.showNextSteps&&!this.props.showNextStepsTips||this.props.isOnboardingHidden||this.props.actions.setShowNextStepsView(!0),this.props.channelMemberLoading&&this.props.actions.getMyChannelMember(this.props.channelId),this.props.channelRolesLoading&&this.props.actions.getMyChannelMember(this.props.channelRole),window.scrollTo(0,1)}componentDidUpdate(e){if(this.props.channelMemberLoading&&e.channelId!==this.props.channelId&&this.props.actions.getMyChannelMember(this.props.channelId),this.props.channelRolesLoading&&e.channelRole!==this.props.channelRole&&this.props.actions.getRoleByName(this.props.channelRole),e.channelId!==this.props.channelId||e.channelIsArchived!==this.props.channelIsArchived){(0,Ye.B1)("ChannelView#componentDidUpdate");const[e]=(0,Ye.L8)("SidebarChannelLink#click","ChannelView#componentDidUpdate"),[t]=(0,Ye.L8)("TeamLink#click","ChannelView#componentDidUpdate");(0,Ye.tl)(["SidebarChannelLink#click","ChannelView#componentDidUpdate","TeamLink#click"]),-1!==e&&(0,Ye.L9)("performance","channel_switch",{duration:Math.round(e)}),-1!==t&&(0,Ye.L9)("performance","team_switch",{duration:Math.round(t)}),this.props.channelIsArchived&&!this.props.viewArchivedChannels&&this.props.actions.goToLastViewedChannel()}this.props.match.url!==e.match.url&&this.props.showNextStepsEphemeral&&this.props.actions.setShowNextStepsView(!1)}render(){const{channelIsArchived:e}=this.props;if(this.props.showTutorial)return M.createElement(NC,{isRoot:!1});if(this.props.showNextStepsEphemeral)return M.createElement(Jm,null);let t;this.props.deactivatedChannel?t=M.createElement("div",{className:"post-create__container",id:"post-create"},M.createElement("div",{className:"channel-archived__message"},M.createElement(Dt.Z,{id:"create_post.deactivated",defaultMessage:"You are viewing an archived channel with a **deactivated user**. New messages cannot be posted."}),M.createElement("button",{className:"btn btn-primary channel-archived__close-btn",onClick:this.onClickCloseChannel},M.createElement(V.Z,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})))):e?t=M.createElement("div",{className:"post-create__container",id:"post-create"},M.createElement("div",{id:"channelArchivedMessage",className:"channel-archived__message"},M.createElement(Dt.Z,{id:"archivedChannelMessage",defaultMessage:"You are viewing an **archived channel**. New messages cannot be posted."}),M.createElement("button",{className:"btn btn-primary channel-archived__close-btn",onClick:this.onClickCloseChannel},M.createElement(V.Z,{id:"center_panel.archived.closeChannel",defaultMessage:"Close Channel"})))):this.props.channelRolesLoading||(t=M.createElement("div",{className:"post-create__container",id:"post-create"},M.createElement(jm,{getChannelView:this.getChannelView})));const s=this.state.deferredPostView;return M.createElement("div",{ref:this.channelViewRef,id:"app-content",className:"app__content"},M.createElement(Xe,{overlayType:"center"}),M.createElement(um,this.props),M.createElement(s,{channelId:this.props.channelId,focusedPostId:this.state.focusedPostId}),t)}}OC(LC,"propTypes",{channelId:y().string.isRequired,channelRole:y().string.isRequired,deactivatedChannel:y().bool.isRequired,channelRolesLoading:y().bool.isRequired,channelMemberLoading:y().bool.isRequired,match:y().shape({url:y().string.isRequired,params:y().shape({postid:y().string}).isRequired}).isRequired,showTutorial:y().bool.isRequired,showNextSteps:y().bool.isRequired,showNextStepsTips:y().bool.isRequired,isOnboardingHidden:y().bool.isRequired,showNextStepsEphemeral:y().bool.isRequired,channelIsArchived:y().bool.isRequired,viewArchivedChannels:y().bool.isRequired,isCloud:y().bool.isRequired,actions:y().shape({goToLastViewedChannel:y().func.isRequired,setShowNextStepsView:y().func.isRequired,getProfiles:y().func.isRequired,getContacts:y().func.isRequired,getMyChannelMember:y().func.isRequired,getRoleByName:y().func.isRequired}).isRequired}),OC(LC,"createDeferredPostView",(()=>function(e,t=null){class s extends M.PureComponent{constructor(e,t){super(e,t),this.state={shouldRender:!0}}render(){return this.state.shouldRender?M.createElement(e,this.props):t}}return Ru()(s,e)}(yC,M.createElement("div",{id:"post-list",className:"a11y__region","data-a11y-sort-order":"1","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0}))));const AC=(0,Jt.P1)(((e,t)=>(0,I.PR)(e,t)),(e=>Boolean(e&&e.delete_at))),kC=(0,i.EN)((0,n.connect)((function(e){const t=(0,m.TB)(e),s=(0,h.iE)(e),n="true"===s.EnableTutorial,a=(0,d.wS)(e,N.uP.TUTORIAL_STEP,(0,p.rc)(e),N.PN.FINISHED),i="true"===s.ExperimentalViewArchivedChannels;let r=!0,o=!0,l="";if(t&&t.id){const s=(0,Su.F3)(e),n=(0,Z.TL)(e);if(n[t.id]){o=!1;const e=n[t.id].values();for(const t of e){l=t,s[t]&&(r=!1);break}}}return{channelId:t?t.id:"",channelRole:l,channelRolesLoading:r,channelMemberLoading:o,deactivatedChannel:!!t&&AC(e,t.id),focusedPostId:e.views.channel.focusedPostId,showTutorial:n&&a<=N.PN.INTRO_SCREENS,showNextSteps:Cs(e),showNextStepsTips:bs(e),isOnboardingHidden:Es(e),showNextStepsEphemeral:e.views.nextSteps.show,channelIsArchived:!!t&&0!==t.delete_at,viewArchivedChannels:i,isCloud:"true"===(0,h.lJ)(e).Cloud}}),(function(e){return{actions:(0,a.bindActionCreators)({setShowNextStepsView:Wt,goToLastViewedChannel:b.NL,getProfiles:r.cp,getContacts:Mo.K2,getMyChannelMember:o.Or,getRoleByName:Tu.n5},e)}}))(LC));function xC(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class DC extends M.PureComponent{constructor(e){super(e),xC(this,"replaceUrlTimeout",void 0),xC(this,"replaceUrlIfPermalink",(()=>{this.props.match.params.postid&&(this.replaceUrlTimeout=setTimeout((()=>{const e=this.props.match.url.split("/").slice(0,-1).join("/");st.m.replace(e)}),N.ZP.PERMALINK_FADEOUT))})),this.state={prevProps:e}}componentDidUpdate(e){this.props.match.params.team===e.match.params.team&&this.props.match.params.identifier===e.match.params.identifier||(clearTimeout(this.replaceUrlTimeout),this.props.actions.onChannelByIdentifierEnter(this.props),this.replaceUrlIfPermalink())}componentDidMount(){this.props.actions.onChannelByIdentifierEnter(this.props),this.replaceUrlIfPermalink()}componentWillUnmount(){clearTimeout(this.replaceUrlTimeout)}render(){return M.createElement(kC,null)}}xC(DC,"propTypes",{match:y().shape({params:y().shape({identifier:y().string.isRequired,team:y().string.isRequired,postid:y().string,path:y().string.isRequired}).isRequired,url:y().string.isRequired}).isRequired,actions:y().shape({onChannelByIdentifierEnter:y().func.isRequired}).isRequired,history:y().any.isRequired});const ZC=(0,i.EN)((0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({onChannelByIdentifierEnter:_u},e)}}))(DC)),HC=(0,O.v)(M.lazy((()=>s.e(789).then(s.bind(s,34789)))),M.createElement("div",{className:"app__content"},M.createElement(Ga.Z,null)));class qC extends M.PureComponent{constructor(e){super(e),this.state={returnTo:"",lastReturnTo:""}}static getDerivedStateFromProps(e,t){return t.lastReturnTo!==e.location.pathname&&e.location.pathname.includes("/pl/")?{lastReturnTo:e.location.pathname,returnTo:t.lastReturnTo}:{lastReturnTo:e.location.pathname}}render(){const{lastChannelPath:e,isCollapsedThreadsEnabled:t}=this.props,s=this.props.match.url;return M.createElement("div",{key:"inner-wrap",className:W()("inner-wrap","channel__wrap",{"move--right":this.props.lhsOpen,"move--left":this.props.rhsOpen,"move--left-small":this.props.rhsMenuOpen})},M.createElement("div",{className:"row header"},M.createElement("div",{id:"navbar_wrapper"},M.createElement(Cu,null))),M.createElement("div",{className:W()("row main",{"CollapsedReplies___feature-enabled":t})},M.createElement(i.rs,null,M.createElement(i.AW,{path:"".concat(s,"/pl/:postid"),render:e=>M.createElement(Fd,Object.assign({},e,{returnTo:this.state.returnTo}))}),M.createElement(i.AW,{path:"/:team/:path(group|messages)/:identifier/:postid?",component:ZC}),t?M.createElement(i.AW,{path:"/:team/threads/:threadIdentifier?",component:HC}):null,M.createElement(i.l_,{to:e}))))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(qC,"propTypes",{match:y().shape({url:y().string.isRequired}).isRequired,location:y().shape({pathname:y().string.isRequired}).isRequired,lastChannelPath:y().string.isRequired,lhsOpen:y().bool.isRequired,rhsOpen:y().bool.isRequired,rhsMenuOpen:y().bool.isRequired,isCollapsedThreadsEnabled:y().bool.isRequired});const jC=(0,n.connect)(((e,t)=>({lastChannelPath:"".concat(t.match.url,"/group/").concat(D.LQ.DEFAULT_CHANNEL),lhsOpen:hi(e),rhsOpen:(0,Ke.aC)(e),rhsMenuOpen:(0,Ke.Xb)(e),isCollapsedThreadsEnabled:(0,d.ym)(e)})))(qC),UC=s.p+"files/5b82a1607e296d585d77a90592519fc0.png",FC=s.p+"files/6662c02e89f1c44e80154d63bb0ac915.png",BC=s.p+"files/b878449e6777ecc1d49dfd08f1f24370.png",GC=s.p+"files/8a96876d7dfe22d81b8dff8e86a194de.png",VC=s.p+"files/2f23fc8fac3043a45cfa4c6425acba6a.png",KC=s.p+"files/2780f9b0ca6045a4fc791c34f036a610.png",YC=s.p+"files/5e96f6ca576fdc05c69c87de86c414f3.png",WC=s.p+"files/065ac24ea35608cff096d6ea1c3adf0e.png",zC=s.p+"files/51bc8db053cf30bd74d32d675691758f.png",JC=s.p+"files/e84d4cc67eac47798c7f5cd45c60d154.png",XC=s.p+"files/c3da1c35cad386c6501cdacbbd054ab8.png",QC=s.p+"files/3740e45e4f59e6666f75d5c9f1a8c9f9.png",$C=s.p+"files/9668685171bdb4af7e3ec8b994ddb95b.png",eb=s.p+"files/5a651bbc99921126a5f982d6146fa121.png",tb=s.p+"files/d159b2076750236383cca0bb145b3962.png";function sb(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var nb;!function(e){e.Mention="Mention",e.Unread="Unread",e.None="None"}(nb||(nb={}));class ab extends M.PureComponent{constructor(...e){super(...e),sb(this,"updateTitle",(()=>{const{siteName:e,currentChannel:t,currentTeam:s,currentTeammate:n,unreads:a,inGlobalThreads:i,contactName:r}=this.props,{formatMessage:o}=this.props.intl,l=e||"",c=a.mentionCount>0?"(".concat(a.mentionCount,") "):"",d=!this.isDynamicFaviconSupported&&a.messageCount>0?"* ":"";if(t&&s&&t.id){let e=t.display_name;t.type===N.gT.DM_CHANNEL&&null!=n&&(e=r||n.display_name),document.title="".concat(c).concat(d).concat(e," - ").concat(s.display_name," ").concat(l)}else document.title=s&&i?o({id:"globalThreads.title",defaultMessage:"{prefix}Threads - {displayName} {siteName}"},{prefix:"".concat(c).concat(d),displayName:s.display_name,siteName:l}):o({id:"sidebar.team_select",defaultMessage:"{siteName} - Join a team"},{siteName:l||"Gomlo"})})),sb(this,"updateFavicon",(e=>{if(!R.vU()&&!R.i7())return;if(!document.querySelector('link[rel="icon"]'))return;const t=document.querySelector('link[rel="icon"][sizes="16x16"]'),s=document.querySelector('link[rel="icon"][sizes="24x24"]'),n=document.querySelector('link[rel="icon"][sizes="32x32"]'),a=document.querySelector('link[rel="icon"][sizes="64x64"]'),i=document.querySelector('link[rel="icon"][sizes="96x96"]'),r=e=>"string"==typeof e?e:"";switch(e){case nb.Mention:t.href=r(KC),s.href=r(YC),n.href=r(WC),a.href=r(zC),i.href=r(JC);break;case nb.Unread:t.href=r(XC),s.href=r(QC),n.href=r($C),a.href=r(eb),i.href=r(tb);break;default:t.href=r(UC),s.href=r(FC),n.href=r(BC),a.href=r(GC),i.href=r(VC)}}))}componentDidUpdate(e){this.updateTitle();const t=this.getBadgeStatus(e.unreads),s=this.getBadgeStatus(this.props.unreads);t!==s&&this.updateFavicon(s)}get isDynamicFaviconSupported(){return R.i7()||R.vU()}getBadgeStatus(e){return e.mentionCount>0?nb.Mention:e.messageCount>0?nb.Unread:nb.None}render(){return null}}sb(ab,"propTypes",{unreads:y().shape({messageCount:y().number.isRequired,mentionCount:y().number.isRequired}).isRequired,siteName:y().string,inGlobalThreads:y().bool.isRequired,contactName:y().string.isRequired});const ib=(0,K.ZP)(ab),rb=(0,i.EN)((0,n.connect)((function(e,{location:{pathname:t}}){const s=(0,h.iE)(e),n=(0,m.TB)(e),a=n&&n.teammate_id?n:null,r=(0,u.kA)(e);let o="";if(a){const t=(0,p.PR)(e,a.teammate_id);o=t?(0,Po.No)(e,t.id):""}return{currentChannel:n,currentTeam:r,currentTeammate:a,siteName:s.SiteName,unreads:(0,m.y8)(e),inGlobalThreads:null!=(0,i.LX)(t,{path:"/:team/threads/:threadIdentifier?"}),contactName:o}}),(function(e){return{actions:(0,a.bindActionCreators)({},e)}}))(ib)),ob=function(){const[e,t]=(0,M.useState)(!1);return e?M.createElement("div",{className:"fixed"},"alert"):null};class lb extends M.Component{shouldComponentUpdate(e){return this.props.pathName!==e.pathName||this.props.fetchingChannels!==e.fetchingChannels||this.props.useLegacyLHS!==e.useLegacyLHS}componentDidMount(){const e=window.navigator.platform;document.body.classList.add("app__body","channel-view"),(R.w6()||R.un())&&document.body.classList.add("browser--ie"),"Win32"===e||"Win64"===e?document.body.classList.add("os--windows"):"MacIntel"!==e&&"MacPPC"!==e||document.body.classList.add("os--mac")}componentWillUnmount(){document.body.classList.remove("app__body","channel-view")}render(){const e=Ni,t=xd;return M.createElement("div",{id:"channel_view",className:"channel-view"},M.createElement(L.Z,null),M.createElement(k.Z,null),M.createElement(rb,null),M.createElement("div",{className:"container-fluid"},M.createElement(kt,null),M.createElement(ni,null),M.createElement(i.AW,{component:e}),M.createElement(i.AW,{component:t}),!this.props.fetchingChannels&&M.createElement(i.AW,{component:jC}),this.props.fetchingChannels&&M.createElement(Ga.Z,null),M.createElement(A.Z,{pluggableName:"Root"}),M.createElement(Se,null),M.createElement(li,null),M.createElement(oe,null),M.createElement(he,null),M.createElement(He,null),M.createElement(Ie,null),M.createElement(Ge,{isMac:I.V5()}),M.createElement(ci.Z,null),M.createElement(ob,null)))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(lb,"propTypes",{pathName:y().string.isRequired,fetchingChannels:y().bool.isRequired,useLegacyLHS:y().bool.isRequired});var cb=s(24493);function db(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const hb=M.lazy((()=>s.e(875).then(s.bind(s,47875)))),pb=(0,O.v)(hb);let ub,mb=Date.now();class gb extends M.PureComponent{constructor(e){super(e),db(this,"blurTime",void 0),db(this,"initialed",void 0),db(this,"teamLoaded",void 0),db(this,"handleBlur",(()=>{window.isActive=!1,this.blurTime=(new Date).getTime(),this.props.currentUser&&this.props.actions.viewChannel("")})),db(this,"handleFocus",(()=>{const e=this.props.currentChannelId;e&&(this.props.actions.markChannelAsReadOnFocus(e),window.isActive=!0),Date.now()-this.blurTime>3e4&&this.props.currentTeamId})),db(this,"joinTeam",(async(e,t,s=!1)=>{const{data:n}=await this.props.actions.getTeamByName(e.match.params.team);if(n&&0===n.delete_at){const{error:a}=await e.actions.addUserToTeam(n.id,e.currentUser&&e.currentUser.id);a?e.history.push("/error?type=team_not_found"):(s&&cb.Z.setTeamIdJoinedOnLoad(n.id),this.initialed?this.setState({team:n}):t.team=n,this.initTeam(n,t))}else e.history.push("/error?type=team_not_found")})),db(this,"initTeam",((e,t)=>{this.teamLoaded&&e.id===this.props.previousTeamId||(this.teamLoaded=!0,e.id!==this.props.previousTeamId&&T.Fy(),this.props.actions.selectTeam(e),this.props.actions.setPreviousTeamId(e.id),I.a_(this.props.currentUser)&&(this.initialed?this.setState({finishedFetchingChannels:!1}):t.finishedFetchingChannels=!1),this.props.actions.fetchMyChannelIds(e.id,"",0,20).then((()=>{this.initialed?this.setState({finishedFetchingChannels:!0}):t.finishedFetchingChannels=!0})))})),db(this,"updateCurrentTeam",((e,t)=>{const s=e.teamsList?e.teamsList.find((t=>t.name===e.match.params.team)):null;s&&(t.team=s,this.initTeam(s,t))})),db(this,"onShortcutKeyDown",(e=>{if(e.shiftKey&&I._E(e)&&I.pD(e,N.ZP.KeyCodes.L)){const e=document.getElementById("sidebar-right");if(e)if(e.className.match("sidebar--right sidebar--right--expanded move--left")){const e=document.getElementById("reply_textbox");e&&e.focus()}else{const e=document.getElementById("post_textbox");e&&e.focus()}}})),this.blurTime=(new Date).getTime(),this.initialed=!1,this.teamLoaded=!1,this.props.mfaRequired?this.props.history.push("/mfa/setup"):(clearInterval(ub),ub=window.setInterval((()=>{const e=(new Date).getTime();e>mb+6e4&&(0,S.GL)(!1),mb=e}),3e4),this.state={team:null,finishedFetchingChannels:!1,prevTeam:this.props.match.params.team,teamsList:this.props.teamsList},this.updateCurrentTeam(this.props,this.state),cb.Z.setTeamIdJoinedOnLoad(null),this.state.team||this.joinTeam(this.props,this.state,!0))}static getDerivedStateFromProps(e,t){if(t.prevTeam!==e.match.params.team){const t=e.teamsList?e.teamsList.find((t=>t.name===e.match.params.team)):null;return{prevTeam:e.match.params.team,team:t||null}}return{prevTeam:e.match.params.team}}componentDidMount(){this.initialed=!0,(0,E.cP)(),(0,S.iD)(),window.isActive=!0,I._v(this.props.theme),R.IT()&&w().enable(),window.addEventListener("focus",this.handleFocus),window.addEventListener("blur",this.handleBlur),window.addEventListener("keydown",this.onShortcutKeyDown)}componentDidUpdate(e){const{theme:t}=this.props;I.JB(e.theme,t)||I._v(t),this.props.match.params.team!==e.match.params.team&&(this.state.team&&this.initTeam(this.state.team,this.state),this.state.team||this.joinTeam(this.props,this.state))}componentWillUnmount(){window.isActive=!1,(0,E.eI)(),(0,S.lN)(),R.IT()&&w().disable(),clearInterval(ub),window.removeEventListener("focus",this.handleFocus),window.removeEventListener("blur",this.handleBlur),window.removeEventListener("keydown",this.onShortcutKeyDown)}render(){var e;return null===this.state.team?M.createElement("div",null):M.createElement(i.rs,null,M.createElement(i.AW,{path:"/:team/integrations",component:pb}),M.createElement(i.AW,{path:"/:team/emoji",component:pb}),null===(e=this.props.plugins)||void 0===e?void 0:e.map((e=>M.createElement(i.AW,{key:e.id,path:"/:team/"+e.route,render:()=>M.createElement(A.Z,{pluggableName:"NeedsTeamComponent",pluggableId:e.id})}))),M.createElement(i.AW,{render:e=>M.createElement(lb,{pathName:e.location.pathname,fetchingChannels:!this.state.finishedFetchingChannels,useLegacyLHS:this.props.useLegacyLHS})}))}}db(gb,"propTypes",{currentUser:y().shape({id:y().string.isRequired}),currentChannelId:y().string,currentTeamId:y().string,useLegacyLHS:y().bool.isRequired,actions:y().shape({fetchMyChannelIds:y().func.isRequired,fetchMyChannelsAndMembers:y().func.isRequired,getMyTeamUnreads:y().func.isRequired,viewChannel:y().func.isRequired,markChannelAsReadOnFocus:y().func.isRequired,getTeamByName:y().func.isRequired,addUserToTeam:y().func.isRequired,selectTeam:y().func.isRequired,setPreviousTeamId:y().func.isRequired,loadStatusesForChannelAndSidebar:y().func.isRequired,loadProfilesForDirect:y().func.isRequired,getAllGroupsAssociatedToChannelsInTeam:y().func.isRequired,getAllGroupsAssociatedToTeam:y().func.isRequired,getGroupsByUserId:y().func.isRequired,getGroups:y().func.isRequired}).isRequired,mfaRequired:y().bool.isRequired,match:y().shape({params:y().shape({team:y().string.isRequired}).isRequired}).isRequired,previousTeamId:y().string,history:y().shape({}).isRequired,teamsList:y().array.isRequired,theme:y().any.isRequired,plugins:y().any});const fb=(0,i.EN)((0,n.connect)((function(e,t){const s=(0,h.lJ)(e),n=(0,h.iE)(e),a=(0,p.ts)(e),i=e.plugins.components.NeedsTeamComponent;return{license:s,theme:(0,d.gh)(e),mfaRequired:(0,_.b2)(a,s,n,t.match.url),currentUser:a,currentTeamId:(0,u.ev)(e),previousTeamId:(0,f.x_)(e),teamsList:(0,u.Dc)(e),currentChannelId:(0,m.gO)(e),useLegacyLHS:"true"===n.EnableLegacySidebar,plugins:i}}),(function(e){return{actions:(0,a.bindActionCreators)({fetchMyChannelIds:o.B_,fetchMyChannelsAndMembers:o.oO,getMyTeamUnreads:l.Jw,viewChannel:o.SU,markChannelAsReadOnFocus:b.Kx,getTeamByName:l.Xv,addUserToTeam:C.aJ,setPreviousTeamId:g.h,selectTeam:l.MA,loadStatusesForChannelAndSidebar:E.Vq,loadProfilesForDirect:r.VU,getAllGroupsAssociatedToChannelsInTeam:c.UL,getAllGroupsAssociatedToTeam:c.K9,getGroupsByUserId:c.FE,getGroups:c.jA},e)}}))(gb))},80020:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p}),s(33948);var n,a,i,r=s(37703),o=s(38348),l=s(45697),c=s.n(l),d=s(67294);class h extends d.PureComponent{render(){const{hasPermission:e,children:t,invert:s=!1}=this.props;return e&&!s||!e&&s?t:null}}n=h,a="propTypes",i={channelId:c().string,teamId:c().string,permissions:c().arrayOf(c().string).isRequired,hasPermission:c().bool.isRequired,invert:c().bool,children:c().node.isRequired},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i;const p=(0,r.connect)((function(e,t){if(!t.channelId||null===t.teamId||void 0===t.teamId)return{hasPermission:!1};for(const s of t.permissions)if((0,o.Ai)(e,{channel:t.channelId,team:t.teamId,permission:s}))return{hasPermission:!0};return{hasPermission:!1}}))(h)},33574:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d}),s(33948);var n=s(37703),a=s(38348),i=s(45697),r=s.n(i),o=s(67294);function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c extends o.PureComponent{render(){return this.props.hasPermission&&!this.props.invert||!this.props.hasPermission&&this.props.invert?this.props.children:null}}l(c,"propTypes",{teamId:r().string,permissions:r().arrayOf(r().string).isRequired,hasPermission:r().bool.isRequired,invert:r().bool,children:r().node.isRequired}),l(c,"defaultProps",{invert:!1});const d=(0,n.connect)((function(e,t){if(!t.teamId)return{hasPermission:!1};for(const s of t.permissions)if((0,a.Rm)(e,{team:t.teamId,permission:s}))return{hasPermission:!0};return{hasPermission:!1}}))(c)},79541:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var n,a,i,r=s(45697),o=s.n(r),l=s(67294),c=s(43253),d=s(44012);class h extends l.Component{shouldComponentUpdate(e){return e.show!==this.props.show}render(){return l.createElement(c.Z,{dialogClassName:"a11y__modal",show:this.props.show,onHide:this.props.onHide,role:"dialog","aria-labelledby":"postDeletedModalLabel","data-testid":"postDeletedModal"},l.createElement(c.Z.Header,{closeButton:!0},l.createElement(c.Z.Title,{componentClass:"h1",id:"postDeletedModalLabel"},l.createElement(d.Z,{id:"post_delete.notPosted",defaultMessage:"Comment could not be posted"}))),l.createElement(c.Z.Body,null,l.createElement("p",null,l.createElement(d.Z,{id:"post_delete.someone",defaultMessage:"Someone deleted the message on which you tried to post a comment."}))),l.createElement(c.Z.Footer,null,l.createElement("button",{type:"button",className:"btn btn-primary",autoFocus:!0,onClick:this.props.onHide,"data-testid":"postDeletedModalOkButton"},l.createElement(d.Z,{id:"post_delete.okay",defaultMessage:"Okay"}))))}}n=h,a="propTypes",i={show:o().bool.isRequired,onHide:o().func.isRequired},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i},30529:(e,t,s)=>{"use strict";s.d(t,{Z:()=>E});var n=s(37703),a=s(42560),i=s(89980),r=s(11106),o=s(45697),l=s.n(o),c=(s(33948),s(67294)),d=s(7681),h=s(28788),p=s(92337),u=s(85174),m=s(74935);function g(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class f extends c.PureComponent{constructor(...e){super(...e),g(this,"getProfilePictureURL",(()=>{const{post:e,user:t}=this.props;return t&&t.id===e.user_id?m.bb(t.id,t.last_picture_update):e.user_id?m.bb(e.user_id):""})),g(this,"getStatus",((e,t,s)=>e||t||s&&s.is_bot?"":this.props.status)),g(this,"getPostIconURL",((e,t,s)=>{const{enablePostIconOverride:n,hasImageProxy:a,post:i}=this.props,r=i.props;let o="",l="";return r&&(o=r.override_icon_url,l=r.use_user_icon),this.props.compactDisplay?"":!t&&s&&!l&&n?o&&""!==o?u.Q4(o,a):p.ZP.DEFAULT_WEBHOOK_LOGO:e}))}render(){const{compactDisplay:e,isBusy:t,isRHS:s,post:n,user:a,isBot:i}=this.props,r=u.Ew(n),o=u.Wo(n);if(r&&!e&&!o&&!i)return c.createElement(h.Z,{className:"icon"});const l=u.zj(n),p=!l&&!o,m=this.getProfilePictureURL(),g=this.getPostIconURL(m,l,o),f=n.props?n.props.override_icon_emoji:"",E=n.props?n.props.override_username:"",C="string"==typeof f&&""!==f,b=this.getStatus(l,o,a);return c.createElement(d.Z,{hasMention:p,isBusy:t,isRHS:s,size:"md",src:g,profileSrc:m,isEmoji:C,status:b,userId:null==a?void 0:a.id,channelId:n.channel_id,username:null==a?void 0:a.username,overwriteIcon:this.props.overwriteIcon,overwriteName:E})}}g(f,"propTypes",{compactDisplay:l().bool.isRequired,enablePostIconOverride:l().bool.isRequired,hasImageProxy:l().bool.isRequired,isBusy:l().bool,isRHS:l().bool,status:l().string,isBot:l().bool,postIconOverrideURL:l().string,overwriteIcon:l().string}),g(f,"defaultProps",{status:p.gg.OFFLINE});const E=(0,n.connect)((function(e,t){const s=(0,a.iE)(e),n=(0,i.PR)(e,t.userId),o="true"===s.EnablePostIconOverride&&t.post&&t.post.props&&t.post.props.override_icon_url;let l;return o&&(l=r.je.getAbsoluteUrl(o)),{enablePostIconOverride:"true"===s.EnablePostIconOverride,overwriteIcon:l,hasImageProxy:"true"===s.HasImageProxy,status:(0,i.ZO)(e,t.userId),isBot:Boolean(n&&n.is_bot),user:n}}))(f)},35995:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var n=s(45697),a=s.n(n),i=s(67294),r=s(49801),o=s(12898);const l=[r.ap.aS,r.ap.o$],c=({date:e})=>i.createElement(o.Z,null,i.createElement(r.ZP,{value:e,useTime:!1,useSemanticOutput:!1,ranges:l}));c.propTypes={date:a().oneOfType([a().number,a().instanceOf(Date)]).isRequired};const d=(0,i.memo)(c)},59474:(e,t,s)=>{"use strict";s.d(t,{Z:()=>V});var n,a,i,r=s(45697),o=s.n(r),l=s(67294),c=s(37703),d=s(14890),h=s(92405),p=s(16146),u=s(39138),m=s.n(u),g=s(12266),f=s(92337),E=s(74935),C=s(67705),b=s(56039),_=s(64852),v=s(33459),y=s(42329),M=s(26961),P=(s(4723),s(2418)),w=s(21843);class S extends l.PureComponent{getStatusColors(e){return{good:"#00c100",warning:"#dede01",danger:e.errorTextColor,default:e.centerChannelColor,primary:e.buttonBg,success:e.onlineIndicator}}render(){const{action:e,handleAction:t,disabled:s,theme:n}=this.props;let a;if(e.style){const t=this.getStatusColors(n)[e.style]||n[e.style]||e.style.match("^#(?:[0-9a-fA-F]{3}){1,2}$")&&e.style;t&&(a={borderColor:(0,P.v5)(t,.25),color:t,borderWidth:2})}return l.createElement("button",{"data-action-id":e.id,"data-action-cookie":e.cookie,disabled:s,key:e.id,onClick:e=>t(e,this.props.action.options),style:a},l.createElement(w.Z,{loading:this.props.actionExecuting,text:this.props.actionExecutingMessage},l.createElement(_.Z,{message:e.name,options:{mentionHighlight:!1,markdown:!1,autolinkedUrlSchemes:[]}})))}}n=S,a="propTypes",i={handleAction:o().func.isRequired,disabled:o().bool,actionExecuting:o().bool,actionExecutingMessage:o().string},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i;const T=(0,c.connect)((function(e){return{theme:(0,M.gh)(e)}}))(S);var N=s(63951),R=s(47715),I=s(49725),O=s(70668),L=s(59030),A=s(28958),k=s(52166),x=s(51695);function D(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Z extends l.PureComponent{constructor(e){super(e),D(this,"providers",void 0),D(this,"handleSelected",(e=>{var t;if(!e)return;const{action:s}=this.props;let n="",a="";if("users"===s.data_source){const t=e;a=t.username,n=t.id}else if("channels"===s.data_source){const t=e;a=t.display_name,n=t.id}else{const t=e;a=t.text,n=t.value}this.props.actions.selectAttachmentMenuAction(this.props.postId,this.props.action.id||"",this.props.action.cookie||"",null===(t=this.props.action)||void 0===t?void 0:t.data_source,a,n),this.setState({value:a})}));const t=e.action;let s;this.providers=[],t&&("users"===t.data_source?this.providers=[new L.Z(e.actions.autocompleteUsers)]:"channels"===t.data_source?this.providers=[new A.Z(e.actions.autocompleteChannels)]:t.options&&(this.providers=[new O.Z(t.options)]));let n="";t.default_option&&t.options&&(s=t.options.find((e=>e.value===t.default_option)),n=s?s.text:""),this.state={selected:s,value:n}}static getDerivedStateFromProps(e,t){return e.selected&&e.selected!==t.selected?{value:e.selected.text,selected:e.selected}:null}render(){const{action:e,disabled:t}=this.props;return l.createElement(x.Z.Consumer,null,(({handlePopupOpened:s})=>l.createElement(k.Z,{providers:this.providers,onSelected:this.handleSelected,placeholder:e.name,inputClassName:"post-attachment-dropdown",value:this.state.value,toggleFocus:s,disabled:t})))}}D(Z,"propTypes",{postId:o().string.isRequired,disabled:o().bool,actions:o().shape({autocompleteChannels:o().func.isRequired,selectAttachmentMenuAction:o().func.isRequired,autocompleteUsers:o().func.isRequired}).isRequired});const H=(0,c.connect)((function(e,t){const s=e.views.posts.menuActions[t.postId];return{selected:t.action&&t.action.id?s&&s[t.action&&t.action.id]:void 0}}),(function(e){return{actions:(0,d.bindActionCreators)({selectAttachmentMenuAction:I.m,autocompleteChannels:N.J3,autocompleteUsers:R.w5},e)}}))(Z);var q=s(59925);function j(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class U extends l.PureComponent{constructor(e){super(e),j(this,"mounted",!1),j(this,"imageProps",{}),j(this,"handleHeightReceivedForThumbUrl",(({height:e})=>{const{attachment:t}=this.props;(!this.props.imagesMetadata||this.props.imagesMetadata&&!this.props.imagesMetadata[t.thumb_url])&&this.handleHeightReceived(e)})),j(this,"handleHeightReceivedForImageUrl",(({height:e})=>{const{attachment:t}=this.props;(!this.props.imagesMetadata||this.props.imagesMetadata&&!this.props.imagesMetadata[t.image_url])&&this.handleHeightReceived(e)})),j(this,"handleHeightReceived",(e=>{this.mounted&&e>0&&this.setState((e=>({checkOverflow:e.checkOverflow+1})))})),j(this,"renderPostActions",(()=>{const e=this.props.attachment.actions;if(!e||!e.length)return"";const t=[];return e.forEach((e=>{if(e.id&&e.name)switch(e.type){case"select":t.push(l.createElement(H,{key:e.id,postId:this.props.postId,action:e,disabled:e.disabled}));break;case"button":default:t.push(l.createElement(T,{key:e.id,action:e,disabled:e.disabled,handleAction:this.handleAction,actionExecuting:this.state.actionExecuting,actionExecutingMessage:this.state.actionExecutingMessage||void 0}))}})),l.createElement("div",{className:"attachment-actions"},t)})),j(this,"handleAction",((e,t)=>{e.preventDefault();const s=this.getActionOption(t,"ActionExecutingMessage");s&&this.setState({actionExecuting:!0,actionExecutingMessage:s.value});const n=this.getActionOption(t,"TrackEventId");n&&(0,q.L9)("admin","click_warn_metric_bot_id",{metric:n.value});const a=e.currentTarget.getAttribute("data-action-id")||"",i=e.currentTarget.getAttribute("data-action-cookie")||"";this.props.actions.doPostActionWithCookie(this.props.postId,a,i).then((()=>{this.handleCustomActions(t),s&&this.setState({actionExecuting:!1,actionExecutingMessage:null})}))})),j(this,"handleCustomActions",(e=>{const t=this.getActionOption(e,"WarnMetricMailtoUrl");if(t){const e=JSON.parse(t.value);window.location.href="mailto:"+e.mail_recipient+"?cc="+e.mail_cc+"&subject="+encodeURIComponent(e.mail_subject)+"&body="+encodeURIComponent(e.mail_body)}})),j(this,"getActionOption",((e,t)=>{let s=null;return e&&(s=e.find((e=>e.text===t))),s})),j(this,"getFieldsTable",(()=>{const e=this.props.attachment.fields;if(!e||!e.length)return"";const t=[];let s=[],n=[],a=0,i=!1,r=0;const o={markdown:!1,mentionHighlight:!1};return e.forEach(((e,c)=>{(2===a||!0!==e.short||i)&&(t.push(l.createElement("table",{className:"attachment-fields",key:"attachment__table__"+r},l.createElement("thead",null,l.createElement("tr",null,s)),l.createElement("tbody",null,l.createElement("tr",null,n)))),s=[],n=[],a=0,r+=1,i=!1),s.push(l.createElement("th",{className:"attachment-field__caption",key:"attachment__field-caption-"+c+"__"+r},l.createElement(_.Z,{message:e.title,options:o}))),n.push(l.createElement("td",{className:"attachment-field",key:"attachment__field-"+c+"__"+r},l.createElement(_.Z,{message:e.value}))),a+=1,i=!(!0===e.short)})),s.length>0&&t.push(l.createElement("table",{className:"attachment-fields",key:"attachment__table__"+r},l.createElement("thead",null,l.createElement("tr",null,s)),l.createElement("tbody",null,l.createElement("tr",null,n)))),l.createElement("div",null,t)})),j(this,"handleFormattedTextClick",(e=>E.QJ(e,this.props.currentRelativeTeamUrl))),this.state={checkOverflow:0,actionExecuting:!1,actionExecutingMessage:null},this.imageProps={onImageLoaded:this.handleHeightReceived}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const{attachment:e,options:t}=this.props;let s,n="";e.pretext&&(n="attachment--pretext",s=l.createElement("div",{className:"attachment__thumb-pretext"},l.createElement(_.Z,{message:e.pretext})));let a,i,r,o,c,d=[];if((e.author_name||e.author_icon)&&(e.author_icon&&d.push(l.createElement(b.Z,{key:"attachment__author-icon",src:e.author_icon,imageMetadata:this.props.imagesMetadata&&this.props.imagesMetadata[e.author_icon]},(e=>l.createElement("img",{alt:"attachment author icon",className:"attachment__author-icon",src:e,height:"14",width:"14",loading:"lazy"})))),e.author_name&&d.push(l.createElement("span",{className:"attachment__author-name",key:"attachment__author-name"},e.author_name))),e.author_link&&(0,g.lt)(e.author_link)&&(d=[l.createElement("a",{href:e.author_link,target:"_blank",rel:"noopener noreferrer",key:"attachment__author-name"},d)]),e.title&&(a=e.title_link&&(0,g.lt)(e.title_link)?l.createElement("h1",{className:"attachment__title"},l.createElement("a",{className:"attachment__title-link",href:e.title_link,target:"_blank",rel:"noopener noreferrer"},e.title)):l.createElement("h1",{className:"attachment__title"},l.createElement(_.Z,{message:e.title,options:{mentionHighlight:!1,renderer:new C.Z,autolinkedUrlSchemes:[]}}))),e.text&&(i=l.createElement(v.Z,{checkOverflow:this.state.checkOverflow,isAttachmentText:!0,text:e.text},l.createElement(_.Z,{message:e.text||"",options:t,imageProps:this.imageProps}))),e.image_url){const t=this.props.imagesMetadata&&this.props.imagesMetadata[e.image_url];r=l.createElement("div",{className:"attachment__image-container"},l.createElement(b.Z,{src:e.image_url,imageMetadata:t},(e=>l.createElement(y.Z,{className:"attachment__image",onImageLoaded:this.handleHeightReceivedForImageUrl,src:e,dimensions:t}))))}if(e.footer){let t;if(e.footer_icon){const s=this.props.imagesMetadata&&this.props.imagesMetadata[e.footer_icon];t=l.createElement(b.Z,{src:e.footer_icon,imageMetadata:s},(e=>l.createElement("img",{alt:"attachment footer icon",className:"attachment__footer-icon",src:e,height:"16",width:"16",loading:"lazy"})))}o=l.createElement("div",{className:"attachment__footer-container"},t,l.createElement("span",null,m()(e.footer,{length:f.gT.MAX_ATTACHMENT_FOOTER_LENGTH,omission:"…"})))}if(e.thumb_url){const t=this.props.imagesMetadata&&this.props.imagesMetadata[e.thumb_url];c=l.createElement("div",{className:"attachment__thumb-container"},l.createElement(b.Z,{src:e.thumb_url,imageMetadata:t},(e=>l.createElement(y.Z,{onImageLoaded:this.handleHeightReceivedForThumbUrl,src:e,dimensions:t}))))}const h=this.getFieldsTable(),p=this.renderPostActions();let u;return e.color&&"#"===e.color[0]&&(u={borderLeftColor:e.color}),l.createElement("div",{className:"attachment "+n,ref:"attachment",onClick:this.handleFormattedTextClick},s,l.createElement("div",{className:"attachment__content"},l.createElement("div",{className:u?"clearfix attachment__container":"clearfix attachment__container attachment__container--"+e.color,style:u},d,a,l.createElement("div",null,l.createElement("div",{className:c?"attachment__body":"attachment__body attachment__body--no_thumb"},i,r,h,o,p),c,l.createElement("div",{style:F.footer})))))}}j(U,"propTypes",{postId:o().string.isRequired,actions:o().shape({doPostActionWithCookie:o().func.isRequired}).isRequired,currentRelativeTeamUrl:o().string.isRequired});const F={footer:{clear:"both"}},B=(0,c.connect)((function(e){return{currentRelativeTeamUrl:(0,p.gm)(e)}}),(function(e){return{actions:(0,d.bindActionCreators)({doPostActionWithCookie:h.T},e)}}))(U);function G(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class V extends l.PureComponent{render(){const e=[];return this.props.attachments.forEach(((t,s)=>{e.push(l.createElement(B,{attachment:t,postId:this.props.postId,key:"att_"+s,options:this.props.options,imagesMetadata:this.props.imagesMetadata}))})),l.createElement("div",{id:"messageAttachmentList_".concat(this.props.postId),className:"attachment__list"},e)}}G(V,"propTypes",{postId:o().string.isRequired,attachments:o().array.isRequired}),G(V,"defaultProps",{imagesMetadata:{}})},73862:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var n=s(37703),a=s(14890),i=s(42560),r=s(85357),o=s(26961),l=s(89980),c=s(49725),d=s(92337),h=s(45697),p=s.n(h),u=(s(33948),s(88674),s(19601),s(41817),s(67294)),m=s(42329),g=s(56039),f=s(85174),E=s(12266);function C(e){return void 0!==e.height&&void 0!==e.width}function b(e,t){return Math.sqrt(Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2))}function _(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function v(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?_(Object(s),!0).forEach((function(t){y(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function y(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s(85827);const M={height:80,width:80};class P extends u.PureComponent{constructor(...e){super(...e),y(this,"getImageMetadata",(e=>{if(!e)return;const t=this.props.post.metadata.images;return t?t[e]:void 0})),y(this,"isLargeImage",(e=>{if(!e)return!1;const{height:t,width:s}=e;return s>=150&&s/t>=16/9})),y(this,"handleRemovePreview",(async()=>{const e=Object.assign({},this.props.post.props);e[d.tk.REMOVE_LINK_PREVIEW]="true";const t={id:this.props.post.id,props:e};return this.props.actions.editPost(t)}))}renderImageToggle(){return u.createElement("button",{className:"style--none post__embed-visibility color--link","data-expanded":this.props.isEmbedVisible,"aria-label":"Toggle Embed Visibility",onClick:this.props.toggleEmbedVisibility})}renderLargeImage(e,t){if(this.props.isEmbedVisible)return u.createElement(g.Z,{src:e,imageMetadata:t},(e=>u.createElement(m.Z,{className:"attachment__image attachment__image--opengraph large_image",src:e,dimensions:t})))}renderSmallImage(e,t){if(this.props.isEmbedVisible)return u.createElement("div",{className:"attachment__image__container--opengraph"},u.createElement(g.Z,{src:e,imageMetadata:t},(e=>u.createElement(m.Z,{className:"attachment__image attachment__image--opengraph",src:e,dimensions:t}))))}truncateText(e){return e&&e.length>300?e.substring(0,300-"...".length)+"...":e}hasPreviewBeenRemoved(){const{post:e}=this.props;return!(!e||!e.props)&&"true"===e.props[d.tk.REMOVE_LINK_PREVIEW]}render(){if(!this.props.previewEnabled||!this.props.enableLinkPreviews)return null;if(!this.props.post||(0,f.Ew)(this.props.post))return null;if(this.hasPreviewBeenRemoved())return null;const e=this.props.openGraphData;if(!e)return null;const t=function(e,t){var s;if(null==e||null===(s=e.images)||void 0===s||!s.length)return;const n=e.images.map((e=>{const s=e.secure_url||e.url;return e.width&&e.height||!t||!t[s]?e:v(v({},e),{},{height:e.height||t[s].height,width:e.width||t[s].width})})),a=(i=M,n.reduce(((e,t)=>C(e)&&C(t)&&b(t,i)>=b(e,i)?e:t),{}));var i;return a.secure_url||a.url}(e,this.props.post.metadata.images),s=this.getImageMetadata(t),n=this.isLargeImage(s);let a,i;return this.props.currentUserId===this.props.post.user_id&&(a=u.createElement("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:this.handleRemovePreview,"data-testid":"removeLinkPreviewButton"},u.createElement("span",{"aria-hidden":"true"},"×"))),(e.description||t)&&(i=u.createElement("div",{className:"attachment__body attachment__body--opengraph"},u.createElement("div",null,this.truncateText(e.description)," ",t&&n&&this.renderImageToggle()),t&&n&&this.renderLargeImage(t,s))),u.createElement("div",{className:"attachment attachment--opengraph"},u.createElement("div",{className:"attachment__content"},u.createElement("div",{className:"clearfix attachment__container attachment__container--opengraph"},u.createElement("div",{className:"attachment__body__wrap attachment__body__wrap--opengraph"},u.createElement("span",{className:"sitename"},this.truncateText(e.site_name)),a,u.createElement("h1",{className:"attachment__title attachment__title--opengraph"+(e.title?"":" is-url")},u.createElement("a",{className:"attachment__title-link attachment__title-link--opengraph",href:(0,E.Hb)(e.url||this.props.link),target:"_blank",rel:"noopener noreferrer",title:e.title||e.url||this.props.link},this.truncateText(e.title||e.url||this.props.link))),i),t&&!n&&this.renderSmallImage(t,s))))}}y(P,"propTypes",{postId:p().string.isRequired,link:p().string.isRequired,currentUserId:p().string,enableLinkPreviews:p().bool,previewEnabled:p().bool,isEmbedVisible:p().bool,toggleEmbedVisibility:p().func.isRequired,actions:p().shape({editPost:p().func.isRequired}).isRequired});const w=(0,n.connect)((function(e,t){const s=(0,i.iE)(e);return{currentUserId:(0,l.rc)(e),enableLinkPreviews:"true"===s.EnableLinkPreviews,openGraphData:(0,r.XH)(e,t.postId,t.link),previewEnabled:(0,o.o4)(e,d.uP.CATEGORY_DISPLAY_SETTINGS,d.uP.LINK_PREVIEW_DISPLAY,!0)}}),(function(e){return{actions:(0,a.bindActionCreators)({editPost:c.d},e)}}))(P)},80562:(e,t,s)=>{"use strict";s.d(t,{Z:()=>K});var n=s(37703),a=s(14890),i=s(62696),r=s(34959),o=s(51),l=s(45697),c=s.n(l),d=(s(33948),s(4723),s(67294)),h=s(59929),p=s(59474),u=s(73862),m=s(98368),g=s(10005),f=s(16146),E=(s(41817),s(74935)),C=s(67705),b=s(64852),_=s(33459),v=s(80722),y=s(4205),M=(s(88674),s(74806)),P=s(50766),w=s(21843),S=s(93183);function T(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class N extends d.PureComponent{constructor(e){super(e),T(this,"handleClick",(async()=>{const{binding:e,post:t,intl:s}=this.props;if(!e.call)return;let n="";const{data:a}=await this.props.actions.getChannel(t.channel_id);a&&(n=a.team_id);const i=(0,S.qM)(e.app_id,P.NR.IN_POST+"/"+e.location,t.channel_id,n,t.id,t.root_id),r=(0,S.Zw)(e.call,i,{post:P.JI.EXPAND_ALL});this.setState({executing:!0});const o=await this.props.actions.doAppCall(r,P._L.SUBMIT,s);if(this.setState({executing:!1}),o.error){const e=o.error,n=e.error||s.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForPost(e,n,t)}const l=o.data;switch(l.type){case P.Bp.OK:l.markdown&&this.props.actions.postEphemeralCallResponseForPost(l,l.markdown,t);break;case P.Bp.NAVIGATE:case P.Bp.FORM:break;default:{const e=s.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:l.type});this.props.actions.postEphemeralCallResponseForPost(l,e,t)}}})),this.state={executing:!1}}render(){const{binding:e}=this.props;return e.call?d.createElement("button",{onClick:this.handleClick,style:void 0},d.createElement(w.Z,{loading:this.state.executing},d.createElement(b.Z,{message:e.label,options:{mentionHighlight:!1,markdown:!1,autolinkedUrlSchemes:[]}}))):null}}T(N,"propTypes",{actions:c().shape({getChannel:c().func.isRequired}).isRequired});const R=(0,M.ZP)(N),I=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({doAppCall:y.cW,getChannel:v.mr,postEphemeralCallResponseForPost:y.Rv},e)}}))(R);var O=s(70668),L=s(52166),A=s(51695);function k(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class x extends d.PureComponent{constructor(e){super(e),k(this,"providers",void 0),k(this,"handleSelected",(async e=>{var t;if(!e)return;this.setState({selected:e});const s=null===(t=this.props.binding.bindings)||void 0===t?void 0:t.find((t=>t.location===e.value));if(!s)return void console.debug("Trying to select element not present in binding.");if(!s.call)return;const{post:n,intl:a}=this.props;let i="";const{data:r}=await this.props.actions.getChannel(n.channel_id);r&&(i=r.team_id);const o=(0,S.qM)(s.app_id,P.NR.IN_POST+"/"+s.location,n.channel_id,i,n.id,n.root_id),l=(0,S.Zw)(s.call,o,{post:P.JI.EXPAND_ALL}),c=await this.props.actions.doAppCall(l,P._L.SUBMIT,a);if(c.error){const e=c.error,t=e.error||a.formatMessage({id:"apps.error.unknown",defaultMessage:"Unknown error occurred."});return void this.props.actions.postEphemeralCallResponseForPost(e,t,n)}const d=c.data;switch(d.type){case P.Bp.OK:d.markdown&&this.props.actions.postEphemeralCallResponseForPost(d,d.markdown,n);break;case P.Bp.NAVIGATE:case P.Bp.FORM:break;default:{const e=this.props.intl.formatMessage({id:"apps.error.responses.unknown_type",defaultMessage:"App response type not supported. Response type: {type}."},{type:d.type});this.props.actions.postEphemeralCallResponseForPost(d,e,n)}}}));const t=e.binding;if(this.providers=[],t.bindings){const e=t.bindings.map((e=>({text:e.label,value:e.location})));this.providers=[new O.Z(e)]}this.state={}}render(){const{binding:e}=this.props;return d.createElement(A.Z.Consumer,null,(({handlePopupOpened:t})=>{var s;return d.createElement(L.Z,{providers:this.providers,onSelected:this.handleSelected,placeholder:e.label,inputClassName:"post-attachment-dropdown",value:null===(s=this.state.selected)||void 0===s?void 0:s.text,toggleFocus:t})}))}}k(x,"propTypes",{actions:c().shape({getChannel:c().func.isRequired}).isRequired});const D=(0,M.ZP)(x),Z=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({doAppCall:y.cW,getChannel:v.mr,postEphemeralCallResponseForPost:y.Rv},e)}}))(D);function H(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class q extends d.PureComponent{constructor(...e){super(...e),H(this,"fillBindings",(e=>{const t=JSON.parse(JSON.stringify(e));return(0,S.r)(t),t.bindings})),H(this,"renderBindings",(()=>{if(!this.props.embed.app_id)return null;if(!this.props.embed.bindings)return null;const e=this.fillBindings(this.props.embed);if(!e||!e.length)return null;const t=[];return e.forEach((e=>{e.call&&e.location&&(e.bindings&&e.bindings.length>0?t.push(d.createElement(Z,{key:e.location,post:this.props.post,binding:e})):t.push(d.createElement(I,{key:e.location,post:this.props.post,binding:e})))})),d.createElement("div",{className:"attachment-actions"},t)})),H(this,"handleFormattedTextClick",(e=>E.QJ(e,this.props.currentRelativeTeamUrl)))}render(){const{embed:e,options:t}=this.props;let s,n;e.label&&(s=d.createElement("h1",{className:"attachment__title"},d.createElement(b.Z,{message:e.label,options:{mentionHighlight:!1,renderer:new C.Z,autolinkedUrlSchemes:[]}}))),e.description&&(n=d.createElement(_.Z,{isAttachmentText:!0,text:e.description},d.createElement(b.Z,{message:e.description,options:t})));const a=this.renderBindings();return d.createElement("div",{className:"attachment",ref:"attachment",onClick:this.handleFormattedTextClick},d.createElement("div",{className:"attachment__content"},d.createElement("div",{className:"clearfix attachment__container attachment__container--"},s,d.createElement("div",null,d.createElement("div",{className:"attachment__body attachment__body--no_thumb"},n,a),d.createElement("div",{style:j.footer})))))}}H(q,"propTypes",{currentRelativeTeamUrl:c().string.isRequired});const j={footer:{clear:"both"}},U=(0,n.connect)((function(e){return{currentRelativeTeamUrl:(0,f.gm)(e)}}))(q);function F(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class B extends d.PureComponent{render(){const e=[];return this.props.embeds.forEach(((t,s)=>{e.push(d.createElement(U,{embed:t,post:this.props.post,key:"att_"+s,options:this.props.options}))})),d.createElement("div",{id:"messageAttachmentList_".concat(this.props.post.id),className:"attachment__list"},e)}}function G(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}F(B,"propTypes",{embeds:c().array.isRequired}),F(B,"defaultProps",{imagesMetadata:{}});class V extends d.PureComponent{constructor(...e){super(...e),G(this,"toggleEmbedVisibility",(()=>{this.props.actions.toggleEmbedVisibility(this.props.post.id)})),G(this,"getEmbed",(()=>{const{metadata:e}=this.props.post;return(0,h.VV)(e)})),G(this,"isEmbedToggleable",(e=>{const t=this.props.pluginPostWillRenderEmbedComponents||[];for(const s of t)if(s.match(e))return Boolean(s.toggleable);return"image"===e.type||"opengraph"===e.type&&g.Z.isYoutubeLink(e.url)})),G(this,"renderEmbed",(e=>{const t=this.props.pluginPostWillRenderEmbedComponents||[];for(const s of t)if(s.match(e)){const t=s.component;return this.props.isEmbedVisible&&d.createElement(t,{embed:e})}switch(e.type){case"image":return this.props.isEmbedVisible?d.createElement(m.Z,{imageMetadata:this.props.post.metadata.images[e.url],link:e.url,post:this.props.post}):null;case"message_attachment":{let e=[];return this.props.post.props&&this.props.post.props.attachments&&(e=this.props.post.props.attachments),d.createElement(p.Z,{attachments:e,postId:this.props.post.id,options:this.props.options,imagesMetadata:this.props.post.metadata.images})}case"opengraph":return g.Z.isYoutubeLink(e.url)?this.props.isEmbedVisible?d.createElement(g.Z,{postId:this.props.post.id,link:e.url,show:this.props.isEmbedVisible}):null:d.createElement(u.Z,{postId:this.props.post.id,link:e.url,isEmbedVisible:this.props.isEmbedVisible,post:this.props.post,toggleEmbedVisibility:this.toggleEmbedVisibility});default:return null}})),G(this,"renderToggle",(e=>d.createElement("button",{key:"toggle",className:"style--none post__embed-visibility color--link ".concat(e?"pull-left":""),"data-expanded":this.props.isEmbedVisible,"aria-label":"Toggle Embed Visibility",onClick:this.toggleEmbedVisibility})))}render(){const e=this.getEmbed();if(this.props.appsEnabled&&((t=this.props.post.props)&&t.app_bindings&&t.app_bindings.length))return d.createElement(d.Fragment,null,this.props.children,d.createElement(B,{embeds:this.props.post.props.app_bindings,post:this.props.post}));var t;if(e){const t=this.isEmbedToggleable(e),s=/^\s*https?:\/\/.*$/.test(this.props.post.message);return d.createElement("div",null,t&&s&&this.renderToggle(!0),this.props.children,t&&!s&&this.renderToggle(!1),this.renderEmbed(e))}return this.props.children}}G(V,"propTypes",{pluginPostWillRenderEmbedComponents:c().array,children:c().element,isEmbedVisible:c().bool,appsEnabled:c().bool.isRequired,actions:c().shape({toggleEmbedVisibility:c().func.isRequired}).isRequired});const K=(0,n.connect)((function(e,t){return{isEmbedVisible:(0,o.Y_)(e,t.post.id),pluginPostWillRenderEmbedComponents:e.plugins.components.PostWillRenderEmbedComponent,appsEnabled:(0,i.D)(e)}}),(function(e){return{actions:(0,a.bindActionCreators)({toggleEmbedVisibility:r.bV},e)}}))(V)},51695:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});const n=s(67294).createContext({handlePopupOpened:null})},16242:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var n=s(37703),a=s(14890),i=s(34959),r=s(45697),o=s.n(r),l=s(67294),c=s(19728),d=s(44012),h=s(94184),p=s.n(h),u=s(15558),m=s(37060),g=s(30685),f=s(92337),E=s(74935),C=s(82251);function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _ extends l.PureComponent{constructor(){super(),b(this,"handlePress",(e=>{e.preventDefault();const{actions:t,isFlagged:s,postId:n}=this.props;s?t.unflagPost(n):t.flagPost(n)})),b(this,"handleA11yActivateEvent",(()=>{this.setState({a11yActive:!0})})),b(this,"handleA11yDeactivateEvent",(()=>{this.setState({a11yActive:!1})})),this.buttonRef=l.createRef(),this.state={a11yActive:!1}}componentDidMount(){this.buttonRef.current&&(this.buttonRef.current.addEventListener(f.sp.ACTIVATE,this.handleA11yActivateEvent),this.buttonRef.current.addEventListener(f.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}componentWillUnmount(){this.buttonRef.current&&(this.buttonRef.current.removeEventListener(f.sp.ACTIVATE,this.handleA11yActivateEvent),this.buttonRef.current.removeEventListener(f.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}componentDidUpdate(){this.state.a11yActive&&this.buttonRef.current&&this.buttonRef.current.dispatchEvent(new Event(f.sp.UPDATE))}render(){const e=this.props.isFlagged;let t;return t=e?l.createElement(g.Z,{className:p()("icon","icon--small","icon--small-filled",{"post-menu__item--selected":e})}):l.createElement(m.Z,{className:p()("icon","icon--small")}),l.createElement(u.Z,{className:"hidden-xs",key:"flagtooltipkey".concat(e?"flagged":""),delayShow:f.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:l.createElement(c.Z,{id:"flagTooltip",className:"hidden-xs"},l.createElement(d.Z,{id:e?(0,C.t)("flag_post.unflag"):(0,C.t)("flag_post.flag"),defaultMessage:e?"Remove from Saved":"Save"}))},l.createElement("button",{ref:this.buttonRef,id:"".concat(this.props.location,"_flagIcon_").concat(this.props.postId),"aria-label":e?(0,E._u)("flag_post.unflag","Remove from Saved").toLowerCase():(0,E._u)("flag_post.flag","Save").toLowerCase(),className:"post-menu__item",onClick:this.handlePress},t))}}b(_,"propTypes",{location:o().oneOf([f.tY.CENTER,f.tY.RHS_ROOT,f.tY.RHS_COMMENT,f.tY.SEARCH]).isRequired,postId:o().string.isRequired,isFlagged:o().bool.isRequired,actions:o().shape({flagPost:o().func.isRequired,unflagPost:o().func.isRequired}).isRequired}),b(_,"defaultProps",{location:f.tY.CENTER});const v=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({flagPost:i.co,unflagPost:i.xk},e)}}))(_)},98368:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var n=s(45697),a=s.n(n),i=s(67294),r=s(56039),o=s(42329),l=s(78335);function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class d extends i.PureComponent{constructor(e){super(e),c(this,"showModal",(e=>{e.preventDefault(),this.setState({showModal:!0})})),c(this,"hideModal",(()=>{this.setState({showModal:!1})})),this.state={showModal:!1}}render(){return i.createElement("div",{className:"post__embed-container"},i.createElement(r.Z,{src:this.props.link,imageMetadata:this.props.imageMetadata},(e=>i.createElement(i.Fragment,null,i.createElement(o.Z,{className:"img-div attachment__image cursor--pointer",src:e,dimensions:this.props.imageMetadata,showLoader:!0,onClick:this.showModal}),i.createElement(l.Z,{show:this.state.showModal,onModalDismissed:this.hideModal,post:this.props.post,startIndex:0,fileInfos:[{has_preview_image:!1,link:e,extension:this.props.imageMetadata.format}]})))))}}c(d,"propTypes",{imageMetadata:a().object.isRequired,link:a().string.isRequired,post:a().object.isRequired});const h=d},35856:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var n=s(37703),a=s(74650),i=s(26961),r=s(16146),o=s(42560),l=s(67844),c=s(45697),d=s.n(c),h=(s(85827),s(24603),s(39714),s(15306),s(67294)),p=s(44012),u=s(85174),m=s(74935),g=s(2803),f=s(94741),E=s(33459);function C(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class b extends h.PureComponent{constructor(e){super(e),C(this,"imageProps",void 0),C(this,"checkPostOverflow",(()=>{this.setState((e=>({checkOverflow:e.checkOverflow+1})))})),C(this,"handleHeightReceived",(e=>{e>0&&this.checkPostOverflow()})),C(this,"handleFormattedTextClick",(e=>m.QJ(e,this.props.currentRelativeTeamUrl))),this.state={collapse:!0,hasOverflow:!1,checkOverflow:0},this.imageProps={onImageLoaded:this.handleHeightReceived,onImageHeightChanged:this.checkPostOverflow}}renderDeletedPost(){return h.createElement("p",null,h.createElement(p.Z,{id:"post_body.deleted",defaultMessage:"(message deleted)"}))}renderEditedIndicator(){return u.cq(this.props.post)?h.createElement("span",{id:"postEdited_".concat(this.props.post.id),className:"post-edited__indicator"},h.createElement(p.Z,{id:"post_message_view.edited",defaultMessage:"(edited)"})):null}render(){const{post:e,enableFormatting:t,options:s,pluginPostTypes:n,compactDisplay:i,isRHS:r,theme:o,wordBlocked:l}=this.props;if(e.state===a.V8.POST_DELETED)return this.renderDeletedPost();let c=l.reduce(((e,t)=>{const s=new RegExp(t,"ig");return t.length<3?e.replace(s,"✴✴"):e.replace(s,"✴✴✴")}),e.message);if(!t)return h.createElement("span",null,c);const d=e.props&&e.props.type?e.props.type:e.type;if(n&&n.hasOwnProperty(d)){const t=n[d].component;return h.createElement(t,{post:e,compactDisplay:i,isRHS:r,theme:o})}const p=m.Kx(e);if(i&&p){const e=m._u("post_info.message.visible.compact"," (Only visible to you)");c=c.concat(e)}const u=r?"rhsPostMessageText_".concat(e.id):"postMessageText_".concat(e.id);return h.createElement(E.Z,{checkOverflow:this.state.checkOverflow,text:c},h.createElement("div",{"aria-readonly":"true",tabIndex:0,id:u,className:"post-message__text",dir:"auto",onClick:this.handleFormattedTextClick},h.createElement(g.Z,{message:c,imageProps:this.imageProps,isRHS:r,options:s,post:e,channelId:e.channel_id,mentionKeys:[]})),this.renderEditedIndicator(),h.createElement(f.Z,{pluggableName:"PostMessageAttachment",postId:e.id,onHeightChange:this.handleHeightReceived}))}}C(b,"propTypes",{enableFormatting:d().bool,compactDisplay:d().bool,isRHS:d().bool,isRHSOpen:d().bool,isRHSExpanded:d().bool,pluginPostTypes:d().any,currentRelativeTeamUrl:d().string.isRequired,wordBlocked:d().arrayOf(d().string).isRequired}),C(b,"defaultProps",{options:{},isRHS:!1,pluginPostTypes:{}});const _=(0,n.connect)((function(e){return{enableFormatting:(0,i.o4)(e,a.uP.CATEGORY_ADVANCED_SETTINGS,"formatting",!0),isRHSExpanded:(0,l.OZ)(e),isRHSOpen:(0,l.aC)(e),pluginPostTypes:e.plugins.postTypes,theme:(0,i.gh)(e),currentRelativeTeamUrl:(0,r.gm)(e),wordBlocked:(0,o.Cu)(e)}}))(b)},46098:(e,t,s)=>{"use strict";s.d(t,{Z:()=>C});var n=s(14890),a=s(37703),i=s(53497),r=s(45697),o=s.n(r),l=(s(33948),s(67294)),c=s(44012),d=s(74806),h=s(82251),p=s(30685);function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let m;var g;!function(e){e[e.Flagged=0]="Flagged",e[e.Pinned=1]="Pinned",e[e.PinnedAndFlagged=2]="PinnedAndFlagged",e[e.Neither=3]="Neither"}(m||(m={})),function(e){e.Flagged="flagged",e.Pinned="pinned",e.PinnedAndFlagged="pinnedAndFlagged"}(g||(g={}));class f extends l.PureComponent{constructor(...e){super(...e),u(this,"messageInfos",{flagged:{id:(0,h.t)("post_pre_header.flagged"),defaultMessage:"Saved"},pinned:{id:(0,h.t)("post_pre_header.pinned"),defaultMessage:"Pinned"}}),u(this,"handleLinkClick",((e,t)=>{e===g.Pinned&&t?this.props.actions.showPinnedPosts(t):this.props.actions.showFlaggedPosts()}))}getPostStatus(e,t){return e?t?m.PinnedAndFlagged:m.Flagged:t?m.Pinned:m.Neither}getMessageInfo(e,t,s){if(t&&s)return!1;if(e===m.PinnedAndFlagged){if(!s&&!t)return g.PinnedAndFlagged;if(s)return g.Flagged;if(t)return g.Pinned}return e!==m.Flagged||t?e===m.Pinned&&!s&&g.Pinned:g.Flagged}render(){const{isFlagged:e,isPinned:t,skipPinned:s,skipFlagged:n,channelId:a}=this.props,i=this.getMessageInfo(this.getPostStatus(e,t),n,s);return(e||t)&&i?l.createElement("div",{className:"post-pre-header"},l.createElement("div",{className:"post-pre-header__icons-container"},t&&!s&&l.createElement("span",{className:"icon-pin icon icon--post-pre-header"}),e&&!n&&l.createElement(p.Z,{className:"icon icon--post-pre-header"})),l.createElement("div",{className:"post-pre-header__text-container"},i&&i!==g.PinnedAndFlagged&&l.createElement("span",null,l.createElement("a",{onClick:()=>this.handleLinkClick(i,a)},l.createElement(c.Z,{id:this.messageInfos[i].id,defaultMessage:this.messageInfos[i].defaultMessage}))),i&&i===g.PinnedAndFlagged&&l.createElement("span",null,l.createElement("a",{onClick:()=>this.handleLinkClick(g.Pinned,a)},l.createElement(c.Z,{id:this.messageInfos[g.Pinned].id,defaultMessage:this.messageInfos[g.Pinned].defaultMessage})),l.createElement("span",{className:"post-pre-header__link-separator"},"⬤"),l.createElement("a",{onClick:()=>this.handleLinkClick(g.Flagged)},l.createElement(c.Z,{id:this.messageInfos[g.Flagged].id,defaultMessage:this.messageInfos[g.Flagged].defaultMessage}))))):null}}u(f,"propTypes",{isFlagged:o().bool.isRequired,isPinned:o().bool,skipPinned:o().bool,skipFlagged:o().bool,channelId:o().string.isRequired,actions:o().shape({showFlaggedPosts:o().func.isRequired,showPinnedPosts:o().func.isRequired}).isRequired});const E=(0,d.ZP)(f),C=(0,a.connect)(null,(e=>({actions:(0,n.bindActionCreators)({showFlaggedPosts:i.Yv,showPinnedPosts:i.B7},e)})))(E)},42897:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var n=s(37703),a=s(16146),i=s(45697),r=s.n(i),o=(s(33948),s(19601),s(39714),s(67294)),l=s(73727),c=s(19728),d=s(34288),h=s(47470),p=s(92337),u=s(74935),m=s(15558),g=s(49801);function f(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const E=[g.ap.aS,g.ap.o$];class C extends o.PureComponent{constructor(...e){super(...e),f(this,"handleClick",(()=>{(0,u.tq)()&&d.Fy()}))}render(){const{eventTime:e,isPermalink:t,location:s,postId:n,teamUrl:a,timestampProps:i={}}=this.props,r=o.createElement(g.ZP,Object.assign({value:e,className:"post__time",useDate:!1},i)),d=(0,h.tq)()||!t?o.createElement("div",{role:"presentation",className:"post_permalink_mobile_view"},r):o.createElement(l.Link,{id:"".concat(s,"_time_").concat(n),to:"".concat(a,"/pl/").concat(n),className:"post__permalink",onClick:this.handleClick},r);return o.createElement(m.Z,{delayShow:500,placement:"top",overlay:o.createElement(c.Z,{id:e.toString(),className:"hidden-xs"},o.createElement(g.ZP,{value:e,ranges:E}))},d)}}f(C,"propTypes",{isPermalink:r().bool.isRequired,eventTime:r().number,location:r().string,postId:r().string.isRequired,teamUrl:r().string.isRequired}),f(C,"defaultProps",{eventTime:0,location:p.tY.CENTER});const b=(0,n.connect)((function(e){return{teamUrl:(0,a.gm)(e)}}))(C)},78910:(e,t,s)=>{"use strict";s.d(t,{Z:()=>N}),s(32023);var n=s(37703),a=s(14890),i=s(92405),r=s(18493),o=s(89980),l=s(70493),c=s(61045),d=s(3601),h=s(26961),p=s(38348),u=s(2015),m=s(73476),g=s(42560),f=s(34959),E=s(52332),C=s(74935),b=s(45697),_=s.n(b),v=(s(88674),s(15306),s(67294)),y=s(19728),M=s(44012),P=s(15558);function w(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class S extends v.PureComponent{constructor(e){super(e),w(this,"reactionButtonRef",v.createRef()),w(this,"reactionCountRef",v.createRef()),w(this,"animating",!1),w(this,"handleClick",(()=>{if(!this.props.canAddReaction||!this.props.canRemoveReaction||this.animating)return;const{currentUserReacted:e}=this.props.sortedUsers;this.animating=!0,this.setState((t=>e?{displayNumber:t.displayNumber-1,reactedClass:"Reaction--unreacting"}:{displayNumber:t.displayNumber+1,reactedClass:"Reaction--reacting"}))})),w(this,"handleAnimationEnded",(()=>{const{actions:e,post:t,emojiName:s}=this.props,{currentUserReacted:n}=this.props.sortedUsers;this.animating=!1,this.setState((e=>"Reaction--reacting"===e.reactedClass?{reactedClass:"Reaction--reacted"}:"Reaction--unreacting"===e.reactedClass?{reactedClass:"Reaction--unreacted"}:e)),n?e.removeReaction(t.id,s):e.addReaction(t.id,s)})),w(this,"loadMissingProfiles",(async()=>{const e=this.props.reactions.map((e=>e.user_id));this.props.actions.getMissingProfilesByIds(e)}));const{reactionCount:t}=this.props,{currentUserReacted:s}=this.props.sortedUsers;this.state=s?{reactedClass:"Reaction--reacted",displayNumber:t}:{reactedClass:"Reaction--unreacted",displayNumber:t}}componentDidUpdate(e){if(e.reactionCount!==this.props.reactionCount){const{currentUserReacted:e}=this.props.sortedUsers,t=e?"Reaction--reacted":"Reaction--unreacted";this.animating=!1,this.setState({displayNumber:this.props.reactionCount,reactedClass:t})}}render(){if(!this.props.emojiImageUrl)return null;const{currentUserReacted:e,users:t}=this.props.sortedUsers,{reactionCount:s,otherUsersCount:n,canAddReaction:a,canRemoveReaction:i}=this.props,{displayNumber:r}=this.state,o=e?s:s+1,l=e?s-1:s,c=l>0?l:"",d=o>0?o:"",h=r>0?r:"",p=a&&i?"":"Reaction--read-only";let u,m;u=n>0?t.length>0?v.createElement(M.Z,{id:"reaction.usersAndOthersReacted",defaultMessage:"{users} and {otherUsers, number} other {otherUsers, plural, one {user} other {users}}",values:{users:t.join(", "),otherUsers:n}}):v.createElement(M.Z,{id:"reaction.othersReacted",defaultMessage:"{otherUsers, number} {otherUsers, plural, one {user} other {users}}",values:{otherUsers:n}}):t.length>1?v.createElement(M.Z,{id:"reaction.usersReacted",defaultMessage:"{users} and {lastUser}",values:{users:t.slice(0,-1).join(", "),lastUser:t[t.length-1]}}):t[0],m=t.length+n>1?e?v.createElement(M.Z,{id:"reaction.reactionVerb.youAndUsers",defaultMessage:"reacted"}):v.createElement(M.Z,{id:"reaction.reactionVerb.users",defaultMessage:"reacted"}):e?v.createElement(M.Z,{id:"reaction.reactionVerb.you",defaultMessage:"reacted"}):v.createElement(M.Z,{id:"reaction.reactionVerb.user",defaultMessage:"reacted"});const g=v.createElement(M.Z,{id:"reaction.reacted",defaultMessage:"{users} {reactionVerb} with {emoji}",values:{users:v.createElement("b",null,u),reactionVerb:m,emoji:v.createElement("b",null,":"+this.props.emojiName+":")}});let f;const E=this.props.emojiName.replace(/_/g," ");let b="".concat(C._u("reaction.reactWidth.ariaLabel","react with")," ").concat(E);return e&&i?(b="".concat(C._u("reaction.removeReact.ariaLabel","remove reaction")," ").concat(E),f=v.createElement(M.Z,{id:"reaction.clickToRemove",defaultMessage:"(click to remove)"})):!e&&a&&(f=v.createElement(M.Z,{id:"reaction.clickToAdd",defaultMessage:"(click to add)"})),v.createElement(P.Z,{delayShow:500,placement:"top",shouldUpdatePosition:!0,overlay:v.createElement(y.Z,{id:"".concat(this.props.post.id,"-").concat(this.props.emojiName,"-reaction")},g,v.createElement("br",null),f),onEnter:this.loadMissingProfiles},v.createElement("button",{id:"postReaction-".concat(this.props.post.id,"-").concat(this.props.emojiName),"aria-label":b,className:"Reaction ".concat(this.state.reactedClass," ").concat(p),onClick:this.handleClick,ref:this.reactionButtonRef},v.createElement("span",{className:"d-flex align-items-center"},v.createElement("span",{className:"Reaction__emoji emoticon",style:{backgroundImage:"url("+this.props.emojiImageUrl+")"}}),v.createElement("span",{ref:this.reactionCountRef,className:"Reaction__count"},v.createElement("span",{className:"Reaction__number"},v.createElement("span",{className:"Reaction__number--display"},h),v.createElement("span",{className:"Reaction__number--unreacted",onAnimationEnd:this.handleAnimationEnded},c),v.createElement("span",{className:"Reaction__number--reacted"},d))))))}}function T(e,t,s,n,a,i,r,o){return!(!(0,p.Ai)(e,{team:t,channel:s,permission:o})||n===m.Z.DEFAULT_CHANNEL&&"true"===a.ExperimentalTownSquareIsReadOnly&&"true"===i.IsLicensed&&!r.roles.includes("system_admin"))}w(S,"propTypes",{currentUserId:_().string.isRequired,emojiName:_().string.isRequired,reactionCount:_().number.isRequired,profiles:_().array.isRequired,otherUsersCount:_().number.isRequired,reactions:_().array.isRequired,canAddReaction:_().bool.isRequired,canRemoveReaction:_().bool.isRequired,emojiImageUrl:_().string.isRequired,actions:_().shape({addReaction:_().func.isRequired,getMissingProfilesByIds:_().func.isRequired,removeReaction:_().func.isRequired}).isRequired,sortedUsers:_().shape({currentUserReacted:_().bool.isRequired,users:_().arrayOf(_().string).isRequired}).isRequired});const N=(0,n.connect)((function(){const e=(0,o.o7)();return function(t,s){const n=(0,g.iE)(t),a=(0,g.lJ)(t),i=(0,o.ts)(t),r=e(t,s.reactions);let p;p=E.xn.has(s.emojiName)?E.Ax[E.xn.get(s.emojiName)]:(0,c.RH)(t).get(s.emojiName);let m="";p&&(m=(0,d.UK)(p));const f=(0,l.mr)(t,s.post.channel_id)||{},b=0!==f.delete_at,_=f.team_id,v=(0,o.rc)(t),y=(0,h.kl)(t);let M=!1,P=!1;return b||(M=T(t,_,s.post.channel_id,f.name,n,a,i,u.Z.REMOVE_REACTION),P=T(t,_,s.post.channel_id,f.name,n,a,i,u.Z.ADD_REACTION)),{profiles:r,otherUsersCount:s.reactions.length-r.length,currentUserId:v,reactionCount:s.reactions.length,canAddReaction:M,canRemoveReaction:P,emojiImageUrl:m,sortedUsers:(0,C.Qk)(s.reactions,v,r,y)}}}),(function(e){return{actions:(0,a.bindActionCreators)({addReaction:f.rU,removeReaction:i.WO,getMissingProfilesByIds:r.C4},e)}}))(S)},33459:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var n=s(37703),a=s(26961),i=s(67844),r=s(92337),o=s(45697),l=s.n(o),c=s(67294),d=s(74935);function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class p extends c.PureComponent{constructor(e){super(e),h(this,"maxHeight",void 0),h(this,"textContainer",void 0),h(this,"overflowRef",void 0),h(this,"toggleCollapse",(e=>{e.preventDefault(),this.setState((e=>({isCollapsed:!e.isCollapsed})))})),h(this,"checkTextOverflow",(()=>{this.overflowRef&&window.cancelAnimationFrame(this.overflowRef),this.overflowRef=window.requestAnimationFrame((()=>{let e=!1;this.textContainer.current&&this.textContainer.current.scrollHeight>this.maxHeight&&(e=!0),e!==this.state.isOverflow&&this.setState({isOverflow:e})}))})),h(this,"handleResize",(()=>{this.checkTextOverflow()})),this.maxHeight=this.props.isAttachmentText?200:600,this.textContainer=c.createRef(),this.state={isCollapsed:!0,isOverflow:!1}}componentDidMount(){this.checkTextOverflow(),window.addEventListener("resize",this.handleResize)}componentDidUpdate(e){this.props.text===e.text&&this.props.isRHSExpanded===e.isRHSExpanded&&this.props.isRHSOpen===e.isRHSOpen&&this.props.checkOverflow===e.checkOverflow||this.checkTextOverflow()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize),this.overflowRef&&window.cancelAnimationFrame(this.overflowRef)}render(){const{isCollapsed:e,isOverflow:t}=this.state,{children:s,isAttachmentText:n,compactDisplay:a}=this.props;let i,r="post-message";e?(i=this.maxHeight,r+=" post-message--collapsed"):r+=" post-message--expanded";const o=n?"post-attachment-collapse__gradient":"post-collapse__gradient",l=n?"post-attachment-collapse__show-more":"post-collapse__show-more";let h=null;if(t){!n&&e&&a&&i&&(i-=22);let t="fa fa-angle-up",s=(0,d._u)("post_info.message.show_less","Show less");e&&(t="fa fa-angle-down",s=(0,d._u)("post_info.message.show_more","Show more")),h=c.createElement("div",{className:"post-collapse"},c.createElement("div",{id:"collapseGradient",className:o}),c.createElement("div",{className:l},c.createElement("div",{className:"post-collapse__show-more-line"}),c.createElement("button",{id:"showMoreButton",className:"post-collapse__show-more-button",onClick:this.toggleCollapse},c.createElement("span",{className:t}),s),c.createElement("div",{className:"post-collapse__show-more-line"}))),r+=" post-message--overflow"}return c.createElement("div",{className:r},c.createElement("div",{style:{maxHeight:i},className:"post-message__text-container",ref:this.textContainer},s),h)}}h(p,"propTypes",{children:l().node,checkOverflow:l().number,isAttachmentText:l().bool,isRHSExpanded:l().bool.isRequired,isRHSOpen:l().bool.isRequired,text:l().string,compactDisplay:l().bool.isRequired});const u=(0,n.connect)((function(e){return{isRHSExpanded:(0,i.OZ)(e),isRHSOpen:(0,i.aC)(e),compactDisplay:(0,a.U2)(e,r.uP.CATEGORY_DISPLAY_SETTINGS,r.uP.MESSAGE_DISPLAY,r.uP.MESSAGE_DISPLAY_DEFAULT)===r.uP.MESSAGE_DISPLAY_COMPACT}}))(p)},89922:(e,t,s)=>{"use strict";s.d(t,{Z:()=>re});var n=s(37703),a=s(14890),i=s(15433),r=s(45697),o=s.n(r),l=(s(88674),s(67294)),c=s(43253),d=s(44012),h=s(45288),p=s(89262),u=s(92337),m=s(74935),g=s(47470),f=s(82251),E=s(39864),C=s(92094),b=(s(19601),s(73210),s(23157),s(23123),s(33948),s(32023),s(44054)),_=s(70493),v=s(7681),y=s(26961),M=s(42560),P=s(16146),w=s(89980),S=s(80722),T=s(47590),N=s(85357),R=s(71816),I=s(79097),O=s(54300),L=s(46261),A=s(68403),k=s(67844),x=s(72009),D=s(64972),Z=s(91857);function H(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function q(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?H(Object(s),!0).forEach((function(t){j(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):H(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function j(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const U=x.Z.getState,F=(0,w.J1)();class B extends Z.Z{static get propTypes(){return q(q({},super.propTypes),{},{channelMember:o().object,hasDraft:o().bool,userImageUrl:o().string,dmChannelTeammate:o().object})}render(){const{item:e,isSelection:t,userImageUrl:s,status:n,userItem:a}=this.props,i=e.channel,r=i.delete_at&&0!==i.delete_at,o=this.props.channelMember,c=this.props.dmChannelTeammate;let d=null;o&&o.notify_props&&o.mention_count>0&&(d=l.createElement("span",{className:"badge"},o.mention_count));let h="mentions__name";t&&(h+=" suggestion--selected");let p,g=l.createElement(l.Fragment,null,i.display_name,l.createElement("div",{className:"mentions__fullname"},"~".concat(i.name)));p=r?l.createElement("div",{className:"suggestion-list__icon suggestion-list__icon--large"},l.createElement("i",{className:"icon icon-archive-outline"})):this.props.hasDraft?l.createElement("div",{className:"suggestion-list__icon suggestion-list__icon--large"},l.createElement("i",{className:"icon icon-pencil-outline"})):i.type===u.gT.OPEN_CHANNEL?l.createElement("div",{className:"suggestion-list__icon suggestion-list__icon--large"},l.createElement("i",{className:"icon icon-globe"})):i.type===u.gT.PRIVATE_CHANNEL?l.createElement("div",{className:"suggestion-list__icon suggestion-list__icon--large"},l.createElement("i",{className:"icon icon-lock-outline"})):i.type===u.gT.GM_CHANNEL?l.createElement("div",{className:"suggestion-list__icon suggestion-list__icon--large"},l.createElement("div",{className:"status status--group"},"G")):l.createElement("div",{className:"pull-left"},l.createElement(v.Z,{src:s,status:c&&c.is_bot?null:n,size:"sm"}));let f=null,E=null;if(i.type===u.gT.DM_CHANNEL){let e;f=l.createElement(l.Fragment,null,l.createElement(O.Z,{show:Boolean(c&&c.is_bot),className:"badge-autocomplete"}),l.createElement(L.Z,{show:Boolean(c&&m.a_(c)),className:"badge-autocomplete"})),E=l.createElement(A.Z,{showTooltip:!0,userID:a.id,emojiStyle:{marginBottom:2,marginLeft:8}}),a.delete_at&&(e=" - "+m._u("channel_switch_modal.deactivated","Deactivated")),g=c&&c.is_bot?l.createElement(l.Fragment,null,a.username,e):i.display_name?l.createElement(l.Fragment,null,i.display_name,l.createElement("div",{className:"mentions__fullname"},"@".concat(a.username),e)):l.createElement(l.Fragment,null,a.username,e)}else i.type===u.gT.GM_CHANNEL&&(g=i.display_name);let C=null;return i.shared&&(C=l.createElement(I.Z,{className:"shared-channel-icon",channelType:i.type})),l.createElement("div",Object.assign({onClick:this.handleClick,onMouseMove:this.handleMouseMove,className:h,role:"listitem",ref:e=>{this.node=e},id:"switchChannel_".concat(i.name),"data-testid":i.name,"aria-label":g||i.name},Z.Z.baseProps),p,l.createElement("span",{className:"suggestion-list__info_user"},g),E,C,f,d)}}const G=(0,n.connect)((function(e,t){const s=t.item&&t.item.channel,n=s?s.id:"",a=!!n&&(0,k.HG)(e,u.hC.DRAFT,n),i=s&&(0,w.PR)(e,s.userId),r=i&&m.bb(i.id,i.last_picture_update);let o=s&&s.type===u.gT.DM_CHANNEL&&m.PR(e,s.id);const l=(0,w.dQ)(e,s.name),c=(0,w.ZO)(e,s.userId);return s&&m.Qr(o)&&(o=(0,w.PR)(e,s.userId)),{channelMember:(0,_.h4)(e)[n],hasDraft:a&&Boolean(a.message.trim()||a.fileInfos.length||a.uploadsInProgress.length),userImageUrl:r,dmChannelTeammate:o,status:c,userItem:l}}),null,null,{forwardRef:!0})(B);let V="";function K(e,t){const s=!!e.channel.delete_at&&0!==e.channel.delete_at,n=!!t.channel.delete_at&&0!==t.channel.delete_at;if(s&&!n)return 1;if(!s&&n)return-1;if(e.deactivated&&!t.deactivated)return 1;if(t.deactivated&&!e.deactivated)return-1;const a=e.channel,i=t.channel;let r=a.display_name.toLowerCase(),o=i.display_name.toLowerCase();a.type===u.gT.DM_CHANNEL&&r.startsWith("@")&&(r=r.substring(1)),i.type===u.gT.DM_CHANNEL&&o.startsWith("@")&&(o=o.substring(1));const l=r.startsWith(V),c=o.startsWith(V);return a.type!==u.gT.OPEN_CHANNEL||e.last_viewed_at||i.type===u.gT.OPEN_CHANNEL&&!t.last_viewed_at?i.type!==u.gT.OPEN_CHANNEL||t.last_viewed_at?l&&!c?-1:!l&&c?1:e.last_viewed_at&&t.last_viewed_at?t.last_viewed_at-e.last_viewed_at:e.last_viewed_at?-1:t.last_viewed_at?1:(0,R.Ut)("en",a,i):-1:1}class Y extends D.Z{handlePretextChanged(e,t){if(e){if(V=e,this.startNewRequest(e),this.shouldCancelDispatch(e))return!1;const s=(0,_.zE)(U()).concat((0,_.y2)(U())),n=Object.assign([],F(U(),e,!1)),a=this.formatList(e,s,n);a&&t(a),this.fetchUsersAndChannels(e,t)}else this.formatUnreadChannelsAndDispatch(t);return!0}async fetchUsersAndChannels(e,t){const s=U(),n=(0,P.ev)(s);if(!n)return;const a=(0,S.r6)(n,e)(x.Z.dispatch,x.Z.getState);let i=[],r=[];try{i={users:[]};const{data:e}=await a;r=e}catch(e){x.Z.dispatch((0,T.H)(e))}if(this.shouldCancelDispatch(e))return;const o=(0,w.rc)(s),l=(0,_.zE)(s).concat((0,_.y2)(s))||[],c=Object.assign([],F(s,e,!1))||[],d=this.formatList(e,l,c),h=r.concat((0,_._3)(s))||[],p=Object.assign([],i.users)||[],u=this.formatList(e,h,p,!1);x.Z.dispatch({type:b.bZ.RECEIVED_PROFILES_LIST,data:[...c.filter((e=>e.id!==o)),...p.filter((e=>e.id!==o))]});const m=[...d.terms,...u.terms.filter((e=>!d.terms.includes(e)))],g=[...d.items,...u.items.filter((e=>!d.terms.includes(e.channel.userId||e.channel.id)))];t(q(q({},d),{items:g,terms:m}))}userWrappedChannel(e,t){let s="";return(e.first_name||e.last_name)&&e.nickname?s+="".concat(m.Pp(e)," (").concat(e.nickname,")"):!e.nickname||e.first_name||e.last_name?(e.first_name||e.last_name)&&(s+="".concat(m.Pp(e))):s+="".concat(e.nickname),{channel:{display_name:s,name:e.username,id:t?t.id:e.id,userId:e.id,update_at:e.update_at,type:u.gT.DM_CHANNEL,last_picture_update:e.last_picture_update||0},name:e.username,deactivated:e.delete_at}}formatList(e,t,s,n=!0){const a=[],i=(0,_.h4)(U()),r={},o=function(e){const t=e.toLowerCase(),s=t.trim().split(/[ ,]+/),n=U(),a=(0,w.ZQ)(n),i={};return e=>{let r="".concat(e.display_name).concat(e.name);if(e.type===u.gT.GM_CHANNEL||e.type===u.gT.DM_CHANNEL){const t=a[e.id]||new Set([]);if(!t.size&&e.type===u.gT.DM_CHANNEL){const s=m.uD(e.name);(0,w.PR)(n,s)&&t.add(s)}for(const e of t){let t=i[e];if(!t){const s=(0,w.PR)(n,e);if(!s)continue;const{nickname:a,username:r}=s;t="".concat(a).concat(r).concat(m.Pp(s)),i[e]=t}r+=t}}if(s.length>1){const e=r.toLowerCase();return s.every((t=>e.includes(t)))}return r.toLowerCase().includes(t)}}(e),l=U(),c=(0,M.iE)(l),d="true"===c.ExperimentalViewArchivedChannels;for(const e of Object.keys(t)){const h=t[e];if(!r[h.id]&&o(h)){const e=Object.assign({},h),t=0!==h.delete_at;let o={channel:e,name:e.name,deactivated:!1};if(i[h.id])o.last_viewed_at=i[h.id].last_viewed_at;else if(n)continue;if(!d&&t)continue;if(t&&i[h.id])o.type=u.gT.ARCHIVED_CHANNEL;else{if(t&&!i[h.id])continue;if(e.type===u.gT.GM_CHANNEL){if(e.name=e.display_name,o.name=e.name,!(0,R.ai)(c,(0,y.VJ)(l),h,(0,N.YA)(l)[h.id],(0,R.I)((0,_.h4)(l),h))&&n)continue}else if(e.type===u.gT.DM_CHANNEL){const t=m.uD(e.name),n=s.find((e=>e.id===t));if(!n)continue;r[n.id]=!0,o=this.userWrappedChannel(n,e),i[h.id]&&(o.last_viewed_at=i[h.id].last_viewed_at)}}r[h.id]=!0,a.push(o)}}for(let e=0;e<s.length;e++){const t=s[e];if(r[t.id])continue;const o=this.userWrappedChannel(t),l=(0,w.rc)(U()),c=m.T8(l,t.id),d=(0,_.ZO)(U(),c);if(d&&i[d.id])o.last_viewed_at=i[d.id].last_viewed_at;else if(n)continue;r[t.id]=!0,a.push(o)}return{matchedPretext:e,terms:a.sort(K).map((e=>e.channel.userId||e.channel.id)),items:a,component:G}}formatUnreadChannelsAndDispatch(e){const t=(0,_.kL)(),s=(0,_.er)(U(),!1),n=[];for(let e=0;e<s.length;e++){const a=t(U(),{id:s[e]})||{};let i={channel:a,name:a.name,deactivated:!1};if(a.type===u.gT.GM_CHANNEL)i.name=a.display_name;else if(a.type===u.gT.DM_CHANNEL){const e=(0,w.PR)(U(),m.uD(a.name));if(!e)continue;i=this.userWrappedChannel(e,a)}i.type=u.gT.MENTION_UNREAD_CHANNELS,n.push(i)}e({matchedPretext:"",terms:n.map((e=>e.channel.id)),items:n,component:G})}}var W=s(6602);const z=x.Z.getState;class J extends Z.Z{render(){const{item:e,isSelection:t}=this.props;let s="mentions__name";return t&&(s+=" suggestion--selected"),l.createElement("div",Object.assign({onClick:this.handleClick,className:s,onMouseMove:this.handleMouseMove,ref:e=>{this.node=e}},Z.Z.baseProps),l.createElement("div",{className:"status"},l.createElement(d.Z,{id:"general_tab.teamIcon",defaultMessage:"Team Icon"},(e=>l.createElement("i",{className:"fa fa-group",title:e})))),e.display_name)}}let X="";function Q(e,t){const s=e.display_name.toLowerCase(),n=t.display_name.toLowerCase(),a=s.startsWith(X),i=n.startsWith(X);if(a&&i){const a=(0,W.B)(z());return s!==n?s.localeCompare(n,a,{numeric:!0}):e.name.localeCompare(t.name,a,{numeric:!0})}return a?-1:1}class $ extends D.Z{handlePretextChanged(e,t){if(e){X=e,this.startNewRequest(e);const s=P.Dc(z()).filter((t=>-1!==t.display_name.toLowerCase().indexOf(e)||-1!==t.name.indexOf(e))),n=s.sort(Q).map((e=>e.name));return t({matchedPretext:e,terms:n,items:s,component:J}),!0}return!1}}var ee=s(28292),te=s(13516);function se(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ne="channel",ae="team";class ie extends l.PureComponent{constructor(e){super(e),se(this,"channelProviders",void 0),se(this,"teamProviders",void 0),se(this,"switchBox",void 0),se(this,"focusTextbox",(()=>{if(null===this.switchBox)return;const e=this.switchBox.getTextbox();document.activeElement!==e&&(e.focus(),m.e6(e))})),se(this,"setSwitchBoxRef",(e=>{this.switchBox=e,this.focusTextbox()})),se(this,"onHide",(()=>{this.focusPostTextbox(),this.setState({text:""}),this.props.onHide()})),se(this,"focusPostTextbox",(()=>{g.tq()||setTimeout((()=>{const e=document.querySelector("#post_textbox");e&&e.focus()}))})),se(this,"onChange",(e=>{this.setState({text:e.target.value,shouldShowLoadingSpinner:!0})})),se(this,"handleKeyDown",(e=>{m.pD(e,u.ZP.KeyCodes.TAB)&&(e.preventDefault(),this.switchMode())})),se(this,"handleSubmit",(async e=>{if(e)if(this.state.mode===ne){const{joinChannelById:t,switchToChannel:s}=this.props.actions,n=e.channel;e.type===u.ZP.MENTION_MORE_CHANNELS&&n.type===u.ZP.OPEN_CHANNEL&&await t(n.id),s(n).then((e=>{"data"in e&&this.onHide()}))}else p.m.push("/"+e.name),this.onHide()})),se(this,"enableChannelProvider",(()=>{this.channelProviders[0].disableDispatches=!1,this.teamProviders[0].disableDispatches=!0})),se(this,"enableTeamProvider",(()=>{this.teamProviders[0].disableDispatches=!1,this.channelProviders[0].disableDispatches=!0})),se(this,"switchMode",(()=>{this.state.mode===ne&&this.props.showTeamSwitcher?(this.enableTeamProvider(),this.setState({mode:ae})):this.state.mode===ae&&(this.enableChannelProvider(),this.setState({mode:ne}))})),se(this,"handleOnClick",(e=>{e.preventDefault();const t=e.currentTarget.getAttribute("data-mode");this.enableChannelProvider(),this.setState({mode:t}),this.focusTextbox()})),se(this,"handleSuggestionsReceived",(e=>{const t=e.items.some((e=>e.loading));this.setState({shouldShowLoadingSpinner:t,pretext:e.matchedPretext,hasSuggestions:e.items.length>0})})),se(this,"render",(()=>{let e=this.channelProviders,t=l.createElement("h1",null,l.createElement(d.Z,{id:"quick_switch_modal.switchChannels",defaultMessage:"Switch Channels"})),s=(0,f.t)("quick_switch_modal.channelsShortcut.windows"),n="CTRL+K";m.V5()&&(s=(0,f.t)("quick_switch_modal.channelsShortcut.mac"),n="CMD+K");let a,i=(0,f.t)("quick_switch_modal.teamsShortcut.windows"),r="CTRL+ALT+K";if(m.V5()&&(i=(0,f.t)("quick_switch_modal.teamsShortcut.mac"),r="CMD+ALT+K"),this.props.showTeamSwitcher){let a="",o="";this.state.mode===ae?(e=this.teamProviders,o="active"):a="active",t=l.createElement("div",{className:"nav nav-tabs"},l.createElement("li",{className:a},l.createElement("a",{"data-mode":"channel",href:"#",onClick:this.handleOnClick},l.createElement(d.Z,{id:"quick_switch_modal.channels",defaultMessage:"Channels"}),l.createElement("span",{className:"small"},l.createElement(d.Z,{id:s,defaultMessage:n})))),l.createElement("li",{className:o},l.createElement("a",{"data-mode":"team",href:"#",onClick:this.handleOnClick},l.createElement(d.Z,{id:"quick_switch_modal.teams",defaultMessage:"Teams"}),l.createElement("span",{className:"small"},l.createElement(d.Z,{id:i,defaultMessage:r})))))}return a=m.tq()?l.createElement(h.Z,{id:"quick_switch_modal.help_mobile",defaultMessage:"Type to find a channel."}):this.props.showTeamSwitcher?l.createElement(h.Z,{id:"quick_switch_modal.help",defaultMessage:"Start typing then use TAB to toggle channels/teams, **UP/DOWN** to browse, **ENTER** to select, and **ESC** to dismiss."}):l.createElement(h.Z,{id:"quick_switch_modal.help_no_team",defaultMessage:"Type to find a channel. Use **UP/DOWN** to browse, **ENTER** to select, **ESC** to dismiss."}),l.createElement(c.Z,{dialogClassName:"a11y__modal channel-switcher",ref:"modal",show:!0,onHide:this.onHide,enforceFocus:!1,restoreFocus:!1,role:"dialog","aria-labelledby":"quickSwitchModalLabel","aria-describedby":"quickSwitchHint",animation:!1},l.createElement(c.Z.Header,{id:"quickSwitchModalLabel",closeButton:!0}),l.createElement(c.Z.Body,null,l.createElement("div",{className:"channel-switcher__header"},t,l.createElement("div",{className:"channel-switcher__hint",id:"quickSwitchHint"},a)),l.createElement("div",{className:"channel-switcher__suggestion-box"},l.createElement("i",{className:"icon icon-magnify icon-16"}),l.createElement(E.Z,{id:"quickSwitchInput","aria-label":m._u("quick_switch_modal.input","quick switch input"),ref:this.setSwitchBoxRef,className:"form-control focused",onChange:this.onChange,value:this.state.text,onKeyDown:this.handleKeyDown,onItemSelected:this.handleSubmit,listComponent:C.Z,maxLength:"64",providers:e,listStyle:"bottom",completeOnTab:!1,spellCheck:"false",delayInputUpdate:!0,openWhenEmpty:!0,onSuggestionsReceived:this.handleSuggestionsReceived,forceSuggestionsWhenBlur:!0}),!this.state.shouldShowLoadingSpinner&&!this.state.hasSuggestions&&this.state.text&&l.createElement(ee.Z,{variant:te.U.ChannelSearch,titleValues:{channelName:'"'.concat(this.state.pretext,'"')}}))))})),this.channelProviders=[new Y],this.teamProviders=[new $],this.switchBox=null,this.state={text:"",mode:ne,hasSuggestions:!0,shouldShowLoadingSpinner:!0,pretext:""}}}se(ie,"propTypes",{onHide:o().func.isRequired,showTeamSwitcher:o().bool.isRequired,actions:o().shape({joinChannelById:o().func.isRequired,switchToChannel:o().func.isRequired}).isRequired});const re=(0,n.connect)((function(){return{showTeamSwitcher:!1}}),(function(e){return{actions:(0,a.bindActionCreators)({joinChannelById:i.$B,switchToChannel:i.qZ},e)}}))(ie)},50512:(e,t,s)=>{"use strict";s.d(t,{Z:()=>M});var n=s(67294),a=s(14890),i=s(37703),r=s(74838),o=s(53497),l=s(67844),c=s(3598),d=s(92337),h=s(45697),p=s.n(h),u=s(94184),m=s.n(u),g=s(36246),f=s(93620),E=s(89922),C=s(74935),b=s(57006);function _(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class v extends n.PureComponent{constructor(e){super(e),_(this,"handleResize",(()=>{this.setState({showSearchBar:v.getShowSearchBar(this.props)})})),_(this,"mentionButtonClick",(e=>{e.preventDefault(),this.searchMentions()})),_(this,"searchMentions",(()=>{const{rhsState:e,actions:{closeRightHandSide:t,showMentions:s}}=this.props;e===d.Hp.MENTION?t():s()})),_(this,"searchButtonClick",(e=>{e.preventDefault(),this.props.actions.openRHSSearch()})),_(this,"handleShortcut",(e=>{const{actions:{closeModal:t}}=this.props;C._E(e)&&e.shiftKey&&(C.pD(e,d.gT.KeyCodes.M)&&(e.preventDefault(),t(d.r8.QUICK_SWITCH),this.searchMentions()),C.pD(e,d.gT.KeyCodes.L)&&t(d.r8.QUICK_SWITCH))})),_(this,"handleQuickSwitchKeyPress",(e=>{C._E(e)&&!e.shiftKey&&C.pD(e,d.gT.KeyCodes.K)&&(e.altKey||(e.preventDefault(),this.toggleQuickSwitchModal()))})),_(this,"toggleQuickSwitchModal",(()=>{const{isQuickSwitcherOpen:e,actions:{openModal:t,closeModal:s}}=this.props;e?s(d.r8.QUICK_SWITCH):t({modalId:d.r8.QUICK_SWITCH,dialogType:E.Z})})),this.state={showSearchBar:v.getShowSearchBar(e)}}componentDidMount(){document.addEventListener("keydown",this.handleShortcut),document.addEventListener("keydown",this.handleQuickSwitchKeyPress),window.addEventListener("resize",this.handleResize)}componentWillUnmount(){document.removeEventListener("keydown",this.handleShortcut),document.removeEventListener("keydown",this.handleQuickSwitchKeyPress),window.removeEventListener("resize",this.handleResize)}static getDerivedStateFromProps(e){return{showSearchBar:v.getShowSearchBar(e)}}static getShowSearchBar(e){return!C.tq()&&(C.bn()>1140||e.rhsOpen)}render(){const{rhsOpen:e,rhsState:t}=this.props;return n.createElement(n.Fragment,null,n.createElement(g.Z,{isFocus:C.tq()||e&&Boolean(t),hideSearchBar:!this.state.showSearchBar,enableFindShortcut:!0}),n.createElement(b.Z,{iconComponent:n.createElement(f.Z,{className:"icon icon--standard","aria-hidden":"true"}),ariaLabel:!0,buttonClass:m()("channel-header__icon",{"channel-header__icon--active":t===d.Hp.MENTION}),buttonId:"channelHeaderMentionButton",onClick:this.mentionButtonClick,tooltipKey:"recentMentions"}))}}_(v,"propTypes",{rhsOpen:p().bool.isRequired,isQuickSwitcherOpen:p().bool,actions:p().shape({showMentions:p().func.isRequired,openRHSSearch:p().func.isRequired,closeRightHandSide:p().func.isRequired,openModal:p().func.isRequired,closeModal:p().func.isRequired}).isRequired});const y=v,M=(0,i.connect)((function(e){return{rhsState:(0,l.kV)(e),rhsOpen:(0,l.aC)(e),isQuickSwitcherOpen:(0,c.g)(e,d.r8.QUICK_SWITCH)}}),(e=>({actions:(0,a.bindActionCreators)({showMentions:o.rb,openRHSSearch:o.Xv,closeRightHandSide:o.Lg,openModal:r.h,closeModal:r.M},e)})))(y)},36246:(e,t,s)=>{"use strict";s.d(t,{Z:()=>rt});var n,a,i,r=s(37703),o=s(14890),l=s(2913),c=s(70493),d=s(53497),h=s(63951),p=s(47715),u=s(67844),m=s(92337),g=(s(73210),s(23123),s(27852),s(24603),s(39714),s(33948),s(88674),s(67294)),f=s(86896),E=s(94184),C=s.n(E),b=s(52952),_=s(47470),v=s(74935),y=s(57006),M=s(46919),P=s(37060),w=s(93620),S=s(2192),T=s(6429),N=s(45697),R=s.n(N),I=s(44012),O=s(4002),L=s.n(O),A=s(73935),k=s(92094);function x(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function D(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Z extends k.Z{constructor(e){super(e),D(this,"getContent",(()=>L()(A.findDOMNode(this.popoverRef.current)).find(".popover-content"))),this.itemRefs=new Map,this.popoverRef=g.createRef(),this.suggestionReadOut=g.createRef()}generateLabel(e){e.username?(this.currentLabel=e.username,(e.first_name||e.last_name)&&e.nickname?this.currentLabel+=" ".concat(e.first_name," ").concat(e.last_name," ").concat(e.nickname):e.nickname?this.currentLabel+=" ".concat(e.nickname):(e.first_name||e.last_name)&&(this.currentLabel+=" ".concat(e.first_name," ").concat(e.last_name))):e.type===m.ZP.DM_CHANNEL||e.type===m.ZP.GM_CHANNEL?this.currentLabel=e.display_name:this.currentLabel=e.name,this.currentLabel&&(this.currentLabel=this.currentLabel.toLowerCase()),this.announceLabel()}renderChannelDivider(e){let t;return t=e===m.ZP.OPEN_CHANNEL?g.createElement(I.Z,{id:"suggestion.search.public",defaultMessage:"Public Channels"}):e===m.ZP.PRIVATE_CHANNEL?g.createElement(I.Z,{id:"suggestion.search.private",defaultMessage:"Private Channels"}):g.createElement(I.Z,{id:"suggestion.search.direct",defaultMessage:"Direct Messages"}),g.createElement("div",{key:e+"-divider",className:"search-autocomplete__divider"},g.createElement("span",null,t))}render(){if(0===this.props.items.length)return null;const e=[];let t=!1;for(let s=0;s<this.props.items.length;s++){const n=this.props.items[s],a=this.props.terms[s],i=a===this.props.selection,r=this.props.components[s];this.props.renderDividers&&(0!==s&&n.type===this.props.items[s-1].type||(n.type===m.ZP.DM_CHANNEL||n.type===m.ZP.GM_CHANNEL?(t||e.push(this.renderChannelDivider(m.ZP.DM_CHANNEL)),t=!0):n.type===m.ZP.PRIVATE_CHANNEL?e.push(this.renderChannelDivider(m.ZP.PRIVATE_CHANNEL)):n.type===m.ZP.OPEN_CHANNEL&&e.push(this.renderChannelDivider(m.ZP.OPEN_CHANNEL)))),i&&(this.currentItem=n),e.push(g.createElement(r,{key:a,ref:e=>this.itemRefs.set(a,e),item:n,term:a,matchedPretext:this.props.matchedPretext[s],isSelection:i,onClick:this.props.onCompleteWord,onMouseMove:this.props.onItemHover}))}return g.createElement(T.Z,{ref:this.popoverRef,id:"search-autocomplete__popover",className:"search-help-popover autocomplete visible",placement:"bottom"},g.createElement("div",{ref:this.suggestionReadOut,"aria-live":"polite",className:"hidden-label"}),e)}}D(Z,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?x(Object(s),!0).forEach((function(t){D(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},k.Z.propTypes));class H extends g.PureComponent{render(){if(0===this.props.items.length)return null;const e=this.props.items[0],t=this.props.terms[0],s=this.props.components[0],n=g.createElement(s,{key:t,ref:t,item:e,term:t,matchedPretext:this.props.matchedPretext[0],isSelection:!1,onClick:this.props.onCompleteWord});return g.createElement(T.Z,{id:"search-autocomplete__popover",className:"search-help-popover autocomplete visible",placement:"bottom"},n)}}n=H,a="propTypes",i={onCompleteWord:R().func.isRequired,items:R().array.isRequired,terms:R().array.isRequired,components:R().array.isRequired,matchedPretext:R().array.isRequired},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i;var q=s(39864),j=s(56640);const{KeyCodes:U}=m.ZP,F={searchForm:{overflow:"visible"}},B=e=>{const{isFocused:t,keepFocused:s,searchTerms:n,suggestionProviders:a}=e,i=(0,g.useRef)(),r=(0,f.Z)();return(0,g.useEffect)((()=>{t||s?setTimeout((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.focus()}),0):setTimeout((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.blur()}),0)}),[t,s]),(0,g.useEffect)((()=>{t&&!s&&n.endsWith('""')&&setTimeout((()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.focus()}),0)}),[n]),g.createElement("div",{id:e.isSideBarRight?"sbrSearchFormContainer":"searchFormContainer",className:"search-form__container"},g.createElement("form",{role:"application",className:C()(["search__form",{"search__form--focused":t}]),onSubmit:e.handleSubmit,style:F.searchForm,autoComplete:"off","aria-labelledby":"searchBox"},g.createElement("div",{className:"search__font-icon"},g.createElement("i",{className:"icon icon-magnify icon-16"})),""!==e.searchType&&g.createElement("div",{className:"searchTypeBadge",onMouseDown:e.handleFocus},"messages"===e.searchType&&g.createElement(I.Z,{id:"search_bar.search_types.messages",defaultMessage:"MESSAGES"}),"files"===e.searchType&&g.createElement(I.Z,{id:"search_bar.search_types.files",defaultMessage:"FILES"}),g.createElement("i",{className:"icon icon-close icon-12",onMouseDown:()=>{e.setKeepFocused(!0)},onClick:()=>e.clearSearchType&&e.clearSearchType()})),g.createElement(q.Z,{ref:t=>{i.current=t,e.getFocus&&e.getFocus(e.handleFocus)},id:e.isSideBarRight?"sbrSearchBox":"searchBox",tabIndex:"0",className:"search-bar form-control a11y__region",containerClass:"w-full","data-a11y-sort-order":"9","aria-describedby":e.isSideBarRight?"sbr-searchbar-help-popup":"searchbar-help-popup","aria-label":r.formatMessage({id:"search_bar.search",defaultMessage:"Search"}),placeholder:r.formatMessage({id:"search_bar.search",defaultMessage:"Search"}),value:e.searchTerms,onFocus:e.handleFocus,onBlur:e.handleBlur,onChange:e.handleChange,onKeyDown:t=>{var s;v.pD(t,U.ESCAPE)&&(null===(s=i.current)||void 0===s||s.blur(),t.stopPropagation(),t.preventDefault()),v.pD(t,U.DOWN)&&(t.preventDefault(),e.updateHighlightedSearchHint(1,!0)),v.pD(t,U.UP)&&(t.preventDefault(),e.updateHighlightedSearchHint(-1,!0)),v.pD(t,U.ENTER)&&e.handleEnterKey(t),v.pD(t,U.BACKSPACE)&&!n&&e.clearSearchType&&e.clearSearchType()},listComponent:Z,dateComponent:H,providers:a,type:"search",autoFocus:e.isFocus&&""===n,delayInputUpdate:!0,renderDividers:!0,clearable:!0,onClear:e.handleClear}),e.isSearchingTerm&&g.createElement(j.Z,null),e.children))};B.propTypes={searchTerms:R().string.isRequired,updateHighlightedSearchHint:R().func.isRequired,handleChange:R().func.isRequired,handleSubmit:R().func.isRequired,handleEnterKey:R().func.isRequired,handleClear:R().func.isRequired,handleFocus:R().func.isRequired,handleBlur:R().func.isRequired,keepFocused:R().bool.isRequired,setKeepFocused:R().func.isRequired,isFocused:R().bool.isRequired,suggestionProviders:R().array.isRequired,isSearchingTerm:R().bool.isRequired,isFocus:R().bool.isRequired,isSideBarRight:R().bool,searchType:R().string.isRequired,clearSearchType:R().func,getFocus:R().func,children:R().node},B.defaultProps={isSideBarRight:!1,getFocus:()=>{},children:null};const G=B;var V=s(42560),K=s(85357),Y=s(79247),W=s(43832),z=s(26961),J=s(84827),X=s(16146),Q=(s(19601),s(31298)),$=s(60871),ee=s(8943),te=s(21843),se=s(28292),ne=s(81214),ae=s(49671),ie=s(89980),re=(s(15306),s(19728)),oe=s(89262),le=s(12266),ce=s(15558),de=s(15240),he=s(38122),pe=s(43932);function ue(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class me extends g.PureComponent{constructor(e){super(e),ue(this,"jumpToConv",(e=>{e.stopPropagation(),oe.m.replace("/".concat(this.props.teamName,"/messages/@").concat(this.props.user.username)),(0,v.tq)()&&this.props.actions.closeRightHandSide()})),ue(this,"copyLink",(()=>{(0,v.vQ)("".concat((0,le.fO)(),"/").concat(this.props.teamName,"/messages/@").concat(this.props.user.username))})),ue(this,"stopPropagation",(e=>{e.stopPropagation()})),ue(this,"keepOpen",(e=>{this.setState({keepOpen:e})})),this.state={keepOpen:(0,v.tq)()}}render(){const{contact:e,user:t}=this.props,{keepOpen:s}=this.state;return g.createElement("div",{"data-testid":"search-item-container",className:"search-item__container"},g.createElement("div",{className:C()("ContactSearchResultItem",{"keep-open":s})},g.createElement("button",{className:"contactData",onClick:this.jumpToConv},g.createElement(pe.Z,{src:(0,v.bb)(t.id,t.last_picture_update),size:"xl"}),g.createElement("div",{className:"contact__info"},g.createElement("span",{className:"contactDataName"},e.display_name),g.createElement("span",{className:"fileMetadata"},"@",t.username))),g.createElement(ce.Z,{delayShow:1e3,placement:"top",overlay:g.createElement(re.Z,{id:"file-name__tooltip"},(0,v._u)("contact_search_result_item.more_actions","More Actions"))},g.createElement(he.Z,{onToggle:this.keepOpen,stopPropagationOnToggle:!0},g.createElement("a",{href:"#",className:"action-icon dots-icon"},g.createElement("i",{className:"icon icon-dots-vertical"})),g.createElement(de.Z,{ariaLabel:"file menu",openLeft:!0},g.createElement(de.Z.ItemAction,{onClick:this.jumpToConv,ariaLabel:(0,v._u)("contact_search_result_item.open_in_channel","Nhắn tin"),text:(0,v._u)("contact_search_result_item.open_in_channel","Nhắn tin")}),g.createElement(de.Z.ItemAction,{onClick:this.copyLink,ariaLabel:(0,v._u)("contact_search_result_item.copy_link","Copy link"),text:(0,v._u)("contact_search_result_item.copy_link","Copy link")}))))))}}const ge=(0,r.connect)((function(){return function(e,t){return{user:(0,ie.PR)(e,t.contact.user_id)}}}),(function(e){return{actions:(0,o.bindActionCreators)({closeRightHandSide:d.Lg},e)}}))(me);var fe=s(13516);function Ee(e){return g.createElement("div",{className:"FilesFilterMenu"},g.createElement(he.Z,null,g.createElement("span",{className:"action-icon dots-icon"},"all"!==e.selectedFilter&&g.createElement("i",{className:"icon-dot"}),g.createElement("i",{className:"icon icon-filter-variant"})),g.createElement(de.Z,{ariaLabel:"file menu",openLeft:!0},g.createElement(de.Z.ItemAction,{ariaLabel:"Tất cả",text:"Tất cả",onClick:()=>e.onFilter("all"),icon:"all"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}),g.createElement(de.Z.ItemAction,{ariaLabel:"Hình ảnh",text:"Hình ảnh",onClick:()=>e.onFilter("images"),icon:"images"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}),g.createElement(de.Z.ItemAction,{ariaLabel:"Âm thanh",text:"Âm thanh",onClick:()=>e.onFilter("audio"),icon:"audio"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}),g.createElement(de.Z.ItemAction,{ariaLabel:"Video",text:"Video",onClick:()=>e.onFilter("video"),icon:"video"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}),g.createElement(de.Z.ItemAction,{ariaLabel:"Tài liệu (Doc)",text:"Tài liệu (Doc)",onClick:()=>e.onFilter("documents"),icon:"documents"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}),g.createElement(de.Z.ItemAction,{ariaLabel:"Bảng tính (Excel)",text:"Bảng tính (Excel)",onClick:()=>e.onFilter("spreadsheets"),icon:"spreadsheets"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}),g.createElement(de.Z.ItemAction,{ariaLabel:"Trình chiếu (Powerpoint)",text:"Trình chiếu (Powerpoint)",onClick:()=>e.onFilter("presentations"),icon:"presentations"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}),g.createElement(de.Z.ItemAction,{ariaLabel:"Mã",text:"Mã",onClick:()=>e.onFilter("code"),icon:"code"===e.selectedFilter?g.createElement("i",{className:"icon icon-check"}):null}))))}Ee.propTypes={selectedFilter:R().string.isRequired,onFilter:R().func.isRequired};const{KeyCodes:Ce}=m.ZP;function be(e){return g.createElement("div",{className:"MessagesOrFilesSelector"},g.createElement("div",{className:"buttons-container"},g.createElement("button",{onClick:()=>e.onChange("messages"),onKeyDown:t=>v.pD(t,Ce.ENTER)&&e.onChange("messages"),className:"messages"===e.selected?"active tab messages-tab":"tab messages-tab"},g.createElement(I.Z,{id:"search_bar.messages_tab",defaultMessage:"Messages"}),g.createElement("span",{className:"counter"},e.messagesCounter)),g.createElement("button",{onClick:()=>e.onChange("contacts"),onKeyDown:t=>v.pD(t,Ce.ENTER)&&e.onChange("messages"),className:"contacts"===e.selected?"active tab contacts-tab":"tab contacts-tab"},g.createElement(I.Z,{id:"search_bar.contacts_tab",defaultMessage:"Danh bạ"}),g.createElement("span",{className:"counter"},e.contactsCounter)),g.createElement("button",{onClick:()=>e.onChange("files"),onKeyDown:t=>v.pD(t,Ce.ENTER)&&e.onChange("files"),className:"files"===e.selected?"active tab files-tab":"tab files-tab"},g.createElement(I.Z,{id:"search_bar.files_tab",defaultMessage:"Files"}),g.createElement("span",{className:"counter"},e.filesCounter))),"files"===e.selected&&g.createElement(Ee,{selectedFilter:e.selectedFilter,onFilter:e.onFilter}))}function _e(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function ve(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}be.propTypes={selected:R().string.isRequired,messagesCounter:R().string.isRequired,contactsCounter:R().string.isRequired,filesCounter:R().string.isRequired,onChange:R().func.isRequired,onFilter:R().func.isRequired};const ye="files",Me="messages",Pe="contacts",we=e=>g.createElement("div",Object.assign({},e,{className:"scrollbar--view"})),Se=e=>g.createElement("div",Object.assign({},e,{className:"scrollbar--horizontal"})),Te=e=>g.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"})),Ne=e=>{const t=(0,g.useRef)(null),[s,n]=(0,g.useState)(e.searchType),a=(0,f.Z)();(0,g.useEffect)((()=>{var s;"all"!==e.searchFilterType&&e.setSearchFilterType("all"),n(e.searchType),null===(s=t.current)||void 0===s||s.scrollToTop()}),[e.searchTerms]),(0,g.useEffect)((()=>{0!==e.searchPage||e.isChannelFiles||setTimeout((()=>{e.getMorePostsForSearch(),e.getMoreFilesForSearch(),e.getMoreContactsForSearch()}),100)}),[e.searchPage,e.searchTerms]);const i=(0,$.Ds)((()=>{e.getMorePostsForSearch()}),100,!1,(()=>{})),r=(0,$.Ds)((()=>{e.getMoreFilesForSearch()}),100,!1,(()=>{})),o=(0,$.Ds)((()=>{e.getMoreContactsForSearch()}),100,!1,(()=>{})),{results:l,fileResults:c,contacts:d,searchTerms:h,isCard:p,isSearchAtEnd:u,isSearchFilesAtEnd:E,isSearchContactsAtEnd:b,isSearchingTerm:_,isFlaggedPosts:y,isSearchingFlaggedPost:w,isPinnedPosts:S,isChannelFiles:T,isSearchingPinnedPost:N,isSideBarExpanded:R,isMentionSearch:O,isOpened:L,updateSearchTerms:A,handleSearchHintSelection:k,searchFilterType:x,setSearchFilterType:D}=e,Z=!l||!Array.isArray(l)||0===l.length,H=!c||!Array.isArray(c)||0===c.length,q=!d||!Array.isArray(d)||0===d.length,j=_||w||N||!L,U=!(s===Me&&u||s===ye&&E||s===Pe&&b||T||y||S),F=!(y||O||p||S||T);let B,G,V=l;const K={},Y={variant:fe.U.ChannelSearch};O?(Y.variant=fe.U.Mentions,K.id="search_header.title2",K.defaultMessage="Recent Mentions"):y?(Y.variant=fe.U.FlaggedPosts,Y.subtitleValues={icon:g.createElement(P.Z,{className:"icon  no-results__mini_icon"})},K.id="search_header.title3",K.defaultMessage="Saved Posts"):S?(Y.variant=fe.U.PinnedPosts,Y.subtitleValues={text:g.createElement("strong",null,"Pin to Channel")},V=[...l],V.sort(((e,t)=>t.create_at-e.create_at)),K.id="search_header.pinnedPosts",K.defaultMessage="Pinned Posts"):T?(Y.variant="all"===x?fe.U.ChannelFiles:fe.U.ChannelFilesFiltered,K.id="search_header.channelFiles",K.defaultMessage="Files"):p?(K.id="search_header.title5",K.defaultMessage="Extra information"):!h&&Z&&H?(K.id="search_header.search",K.defaultMessage="Search"):(Y.titleValues={channelName:'"'.concat(h,'"')},K.id="search_header.results",K.defaultMessage="Search Results");const W=a.formatMessage(K),z=e=>{k(),A(e)};switch(!0){case j:B=g.createElement("div",{className:"sidebar--right__subheader a11y__section"},g.createElement("div",{className:"sidebar--right__loading"},g.createElement(te.Z,{text:v._u("search_header.loading","Searching")})));break;case Z&&!h&&!O&&!S&&!y&&!T:B=g.createElement("div",{className:"sidebar--right__subheader search__hints a11y__section"},g.createElement(M.Z,{onOptionSelected:z,options:m.M9}));break;case Z&&s===Me&&!T:case H&&(s===ye||T):B=g.createElement("div",{className:C()(["sidebar--right__subheader a11y__section",{"sidebar-expanded":R}])},g.createElement(se.Z,Y));break;case q&&s===Pe:const t=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(s),!0).forEach((function(t){ve(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):_e(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},Y);t.variant=fe.U.Contacts,B=g.createElement("div",{className:C()(["sidebar--right__subheader a11y__section",{"sidebar-expanded":R}])},g.createElement(se.Z,t));break;default:(s===ye||T)&&(V=c),B=s===Pe?d.map((t=>g.createElement(ge,{key:t.id,teamName:e.currentTeamName,contact:t}))):V.map(((t,n)=>s!==Me||e.isChannelFiles?g.createElement(ae.Z,{key:t.id,fileInfo:t,teamName:e.currentTeamName,channelType:e.channels[t.channel_id]&&e.channels[t.channel_id].type,channelDisplayName:e.channels[t.channel_id]&&e.channels[t.channel_id].display_name}):g.createElement(ne.Z,{key:t.id,compactDisplay:e.compactDisplay,post:t,channelName:e.channels[t.channel_id]&&e.channels[t.channel_id].display_name,channelType:e.channels[t.channel_id]&&e.channels[t.channel_id].type,channelIsArchived:e.channels[t.channel_id]&&0!==e.channels[t.channel_id].delete_at,matches:e.matches[t.id],term:e.isFlaggedPosts||e.isPinnedPosts||e.isMentionSearch?"":h,isMentionSearch:e.isMentionSearch,a11yIndex:n,isFlaggedPosts:e.isFlaggedPosts,isPinnedPosts:e.isPinnedPosts}))),G=U?g.createElement("div",{className:"loading-screen"},g.createElement("div",{className:"loading__content"},g.createElement("div",{className:"round round-1"}),g.createElement("div",{className:"round round-2"}),g.createElement("div",{className:"round round-3"}))):null}return g.createElement("div",{id:"searchContainer",className:"SearchResults sidebar-right__body"},g.createElement(ee.Z,null,W,e.channelDisplayName&&g.createElement("div",{className:"sidebar--right__title__channel"},e.channelDisplayName)),F&&g.createElement(be,{selected:s,selectedFilter:x,messagesCounter:u||0===e.searchPage?"".concat(l.length):"".concat(l.length,"+"),filesCounter:E||0===e.searchPage?"".concat(c.length):"".concat(c.length,"+"),contactsCounter:b||0===e.searchPage?"".concat(d.length):"".concat(d.length,"+"),onChange:n,onFilter:D}),T&&g.createElement("div",{className:"channel-files__header"},g.createElement("div",{className:"channel-files__title"},g.createElement(I.Z,{id:"search_results.channel-files-header",defaultMessage:"Recent files"})),g.createElement(Ee,{selectedFilter:x,onFilter:D})),g.createElement(Q.ZP,{ref:t,autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:Se,renderThumbVertical:Te,renderView:we,onScroll:()=>{if(!(e.isFlaggedPosts||e.isPinnedPosts||e.isSearchingTerm||e.isSearchGettingMore||e.isChannelFiles)){var n,a,l;const e=(null===(n=t.current)||void 0===n?void 0:n.getScrollHeight())||0;((null===(a=t.current)||void 0===a?void 0:a.getScrollTop())||0)+((null===(l=t.current)||void 0===l?void 0:l.getClientHeight())||0)+30>=e&&(s===ye?r():s===Pe?o():i())}}},g.createElement("div",{id:"search-items-container",role:"application",className:C()(["search-items-container post-list__table a11y__region",{"no-results":Z&&s===Me||H&&s===ye||q&&s===Pe,"channel-files-container":T}]),"data-a11y-sort-order":"3","data-a11y-focus-child":!0,"data-a11y-loop-navigation":!1,"aria-label":a.formatMessage({id:"accessibility.sections.rhs",defaultMessage:"{regionTitle} complimentary region"},{regionTitle:W})},B,G)))};Ne.defaultProps={isCard:!1,isOpened:!1,channelDisplayName:"",children:null};const Re=(e,t)=>{for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&"results"!==s&&Object.prototype.hasOwnProperty.call(t,s)&&"fileResults"!==s&&t[s]!==e[s])return!1;const{results:s}=e,{results:n}=t;if(s.length!==n.length)return!1;for(let e=0;e<s.length;e++)if(s[e]!==n[e])return!1;const{fileResults:a}=e,{fileResults:i}=t;if(a.length!==i.length)return!1;for(let e=0;e<a.length;e++)if(a[e]!==i[e])return!1;return!0},Ie=g.memo(Ne,Re),Oe=(0,r.connect)((function(){let e,t,s,n=[];return function(a){var i;const r="true"===(0,V.iE)(a).ExperimentalViewArchivedChannels,o=(0,K.BP)(a),l={};o&&o!==e&&(e=o,s=[],e.forEach((e=>{if(!e)return;const t=(0,c.mr)(a,e.channel_id);t&&0!==t.delete_at&&!r||(l[e.channel_id]=t,s.push(e))})));const d=(0,W.lJ)(a);d&&d!==t&&(t=d,n=[],t.forEach((e=>{if(!e)return;const t=(0,c.mr)(a,e.channel_id);t&&0!==t.delete_at&&!r||n.push(e)}))),t.forEach((e=>{if(!e)return;const t=(0,c.mr)(a,e.channel_id);l[e.channel_id]=t})),e.forEach((e=>{if(!e)return;const t=(0,c.mr)(a,e.channel_id);l[e.channel_id]=t}));const h=(0,J.M6)(a)||{};return{results:s,fileResults:n,contacts:(0,Y.mY)(a),channels:l,matches:(0,K.Or)(a),searchTerms:(0,u.kH)(a),isSearchingTerm:(0,u.Cd)(a),isSearchingFlaggedPost:(0,u.Nz)(a),isSearchingPinnedPost:(0,u.Yn)(a),isSearchGettingMore:(0,u.yS)(a),isSearchAtEnd:h.isEnd,isSearchFilesAtEnd:h.isFilesEnd,isSearchContactsAtEnd:h.isContactEnd,searchPage:null===(i=h.params)||void 0===i?void 0:i.page,compactDisplay:z.U2(a,m.uP.CATEGORY_DISPLAY_SETTINGS,m.uP.MESSAGE_DISPLAY,m.uP.MESSAGE_DISPLAY_DEFAULT)===m.uP.MESSAGE_DISPLAY_COMPACT,currentTeamName:(0,X.kA)(a).name}}}))(Ie);var Le=s(64972),Ae=s(76938),ke=s(58367),xe=s(13776),De=s(6602),Ze=s(63738),He=s.n(Ze),qe=s(30071),je=s(91857);s(30381);const Ue={};class Fe extends je.Z{constructor(...e){super(...e),function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(this,"handleDayClick",(e=>{const t=e.toISOString().split("T")[0];this.props.onClick(t,this.props.matchedPretext)}))}componentDidMount(){const e=this.props.locale.toLowerCase();e&&"en"!==e&&!Ue[e]&&(Ue[e]=s(46700)("./".concat(e)))}componentDidUpdate(e){const t=this.props.locale.toLowerCase();t&&"en"!==t&&t!==e.locale&&!Ue[t]&&(Ue[t]=s(46700)("./".concat(t)))}render(){let e;this.props.currentDate&&(e={today:this.props.currentDate});const t=this.props.locale.toLowerCase();return g.createElement(He(),{onDayClick:this.handleDayClick,showOutsideDays:!0,modifiers:e,localeUtils:qe.default,locale:t,ref:e=>{this.node=e}})}}const Be=(0,r.connect)((function(e){const t=(0,ie.rc)(e),s=(0,Ae.S)(e,t),n=(0,De.B)(e);let a;return(0,xe.Y)(e)&&(a=s.useAutomaticTimezone?(0,ke.Oz)(s.automaticTimezone):(0,ke.Oz)(s.manualTimezone)),{currentDate:a,locale:n}}))(Fe);class Ge extends Le.Z{handlePretextChanged(e,t){const s=/\b(?:on|before|after):\s*(\S*)$/i.exec(e.toLowerCase());if(s){const e=s[1];this.startNewRequest(e);const n=Object.assign([],[{label:"Selected Date",date:e}]);t({matchedPretext:e,terms:n.map((e=>e.date)),items:n,component:Be})}return Boolean(s)}allowDividers(){return!1}presentationType(){return"date"}}s(23157);var Ve=s(71816),Ke=s(72009),Ye=s(69632),We=s(54300);class ze extends je.Z{render(){const{item:e,isSelection:t,teammate:s,currentUser:n}=this.props;let a="search-autocomplete__item";t&&(a+=" selected a11y--focused");const i=function(e,t){let s;if(e.type===m.ZP.DM_CHANNEL){const n=g.createElement(Ye.Z,{url:(0,v.bb)((0,Ve.aU)(t,e.name)),size:"sm"});s=g.createElement(g.Fragment,null,n,g.createElement("span",{className:"ml-3"},"@",e.display_name))}return e.type===m.ZP.GM_CHANNEL&&(s=g.createElement(g.Fragment,null,g.createElement("div",{className:"search-autocomplete__icon"},g.createElement("div",{className:"status status--group"},"G")),g.createElement("span",{className:"ml-3"},"@",e.display_name.replace(/ /g,"")))),e.type===m.ZP.OPEN_CHANNEL&&(s=g.createElement(g.Fragment,null,g.createElement("div",{className:"search-autocomplete__icon"},g.createElement("i",{className:"icon light icon--standard icon--no-spacing icon-globe"})),g.createElement("span",{className:"ml-3"},e.display_name),g.createElement("span",{className:"ml-2 light"},"~",e.name))),e.type===m.ZP.PRIVATE_CHANNEL&&(s=g.createElement(g.Fragment,null,g.createElement("div",{className:"search-autocomplete__icon"},g.createElement("i",{className:"icon light icon--standard icon--no-spacing icon-lock-outline"})),g.createElement("span",{className:"ml-3"},e.display_name),g.createElement("span",{className:"ml-2 light"},"~",e.name))),s}(e,n);let r=null;return e.type===m.ZP.DM_CHANNEL&&(r=g.createElement(We.Z,{show:Boolean(s&&s.is_bot),className:"badge-popoverlist"})),g.createElement("div",Object.assign({onClick:this.handleClick,onMouseMove:this.handleMouseMove,className:a},je.Z.baseProps),g.createElement("span",{"data-testid":"listItem",className:"search-autocomplete__name"},i),r)}}const Je=(0,r.connect)(((e,t)=>({teammate:(0,v.PR)(e,t.item.id),currentUser:(0,ie.rc)(e)})),null,null,{forwardRef:!0})(ze),Xe=Ke.Z.getState;function Qe(e,t){const s=e?"":"@";return t.type===m.ZP.DM_CHANNEL?s+t.display_name:t.type===m.ZP.GM_CHANNEL?s+t.display_name.replace(/ /g,""):(t.type===m.ZP.OPEN_CHANNEL||(t.type,m.ZP.PRIVATE_CHANNEL),t.name)}class $e extends Le.Z{constructor(e){super(),this.autocompleteChannelsForSearch=e}handlePretextChanged(e,t){const s=/\b(?:in|channel):\s*(\S*)$/i.exec(e.toLowerCase());if(s){let e=s[1];const n=e.startsWith("@");n&&(e=e.replace(/^@/,"")),this.startNewRequest(e),this.autocompleteChannelsForSearch(e,(s=>{if(this.shouldCancelDispatch(e))return;let a=s;n&&(a=a.filter((e=>(0,Ve.I3)(e)||(0,Ve.wk)(e))));const i=(0,De.B)(Xe());a=a.sort(Ve.ck.bind(null,i,[m.ZP.OPEN_CHANNEL,m.ZP.PRIVATE_CHANNEL,m.ZP.DM_CHANNEL,m.ZP.GM_CHANNEL]));const r=a.map(Qe.bind(null,n));t({matchedPretext:e,terms:r,items:a,component:Je})}))}return Boolean(s)}}var et=s(58423);class tt extends je.Z{render(){const{item:e,isSelection:t}=this.props;let s="search-autocomplete__item";t&&(s+=" selected a11y--focused");const n=e.username;let a,i="";return(e.first_name||e.last_name)&&e.nickname?i="".concat(v.Pp(e)," (").concat(e.nickname,")"):e.nickname?i="(".concat(e.nickname,")"):(e.first_name||e.last_name)&&(i="".concat(v.Pp(e))),e.remote_id&&(a=g.createElement(et.Z,{className:"mention__shared-user-icon",withTooltip:!0})),g.createElement("div",Object.assign({className:s,ref:e=>{this.node=e},onClick:this.handleClick,onMouseMove:this.handleMouseMove},je.Z.baseProps),g.createElement(Ye.Z,{size:"sm",username:n,url:v.bb(e.id,e.last_picture_update)}),g.createElement("div",{className:"mention--align ml-3"},g.createElement("span",null,"@",n),g.createElement(We.Z,{show:Boolean(e.is_bot),className:"badge-autocomplete"}),g.createElement("span",{className:"ml-2 mention__fullname"},i)),a)}}class st extends Le.Z{constructor(e){super(),this.autocompleteUsersInTeam=e}handlePretextChanged(e,t){const s=/\bfrom:\s*(\S*)$/i.exec(e.toLowerCase());return this.doAutocomplete(s,t),Boolean(s)}async doAutocomplete(e,t){if(!e)return;const s=e[1];this.startNewRequest(s);const n=await this.autocompleteUsersInTeam(s);if(this.shouldCancelDispatch(s))return;const a=Object.assign([],n.users);t({matchedPretext:s,terms:a.map((e=>e.username)),items:a,component:tt})}allowDividers(){return!0}}const nt=(e,t)=>{let s=[],n=m.M9;if("files"===t&&(n=m.yg),""===e.trim())return n;const a=e.split(/\s+/g),i=a[a.length-1],r=a[a.length-2];if(r?!n.some((({searchTerm:e})=>r.toLowerCase().endsWith(e.toLowerCase()))):!n.some((({searchTerm:t})=>e.toLowerCase().endsWith(t.toLowerCase()))))try{s=n.filter((e=>new RegExp(i,"ig").test(e.searchTerm)&&e.searchTerm.toLowerCase()!==i.toLowerCase()))}catch(e){s=[]}return s},at=e=>{const{actions:t,searchTerms:s,searchType:n,currentChannel:a,hideSearchBar:i,enableFindShortcut:r}=e,o=(0,f.Z)(),[l,c]=(0,g.useState)(!1),[d,h]=(0,g.useState)(!1),[p,u]=(0,g.useState)(!1),[E,N]=(0,g.useState)(-1),[R,I]=(0,g.useState)(nt(s,n)),[O,L]=(0,g.useState)("all"),A=(0,g.useRef)([new Ge,new $e(t.autocompleteChannelsForSearch),new st(t.autocompleteUsersInTeam)]),k=(0,_.P)()&&(0,b.l)((0,_.zF)(),"4.7.0");(0,g.useEffect)((()=>{if(!r)return;const e=e=>{v._E(e)&&v.pD(e,m.ZP.KeyCodes.F)&&(k||!k&&e.shiftKey)&&(e.preventDefault(),i&&(t.openRHSSearch(),h(!0)),a&&j("in:".concat(a.name," ")),D())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[a,i]),(0,g.useEffect)((()=>{v.tq()||I(nt(s,n))}),[s,n]),(0,g.useEffect)((()=>{!v.tq()&&l&&d&&Z()}),[s]),(0,g.useEffect)((()=>{e.isFocus&&!e.isRhsOpen?D():Z()}),[e.isRhsOpen]);const x=()=>t.closeRightHandSide(),D=()=>c(!0),Z=()=>{setTimeout((()=>{d?h(!1):c(!1)}),0),F()},H=()=>{l?h(!0):c(!0)},q=e=>{const t=(null==s?void 0:s.split(" "))||[];t.pop(),t.push(e.toLowerCase()),j(t.join(" "))},j=e=>{t.updateSearchTerms(e),F()},U=e=>{const s=e.target.value;t.updateSearchTerms(s)},F=(e=0,t=!1)=>{if(Math.abs(e)>1)return;let s=E+e;switch(e){case 1:s=s===R.length?0:s;break;case-1:s=s<0?R.length-1:s;break;case 0:default:s=-1}N(s),u(t)},B=a=>{!p||n||s?p&&(a.preventDefault(),h(!0),q(R[E].searchTerm)):(a.preventDefault(),h(!0),t.updateSearchType(0===E?"messages":"files"),N(-1)),e.isMentionSearch&&(a.preventDefault(),t.updateRhsState(m.Hp.SEARCH))},V=e=>{e.preventDefault(),K().then((()=>{h(!1),c(!1)}))},K=async()=>{if(0===s.trim().length)return;const{error:n}=await t.showSearchResults(Boolean(e.isMentionSearch));n||Y()},Y=()=>{v.tq()&&W()},W=()=>{e.isMentionSearch&&(c(!1),t.updateRhsState(m.Hp.SEARCH)),t.updateSearchTerms(""),t.updateSearchType("")},z=e=>{N(e),u(!1)},J=()=>g.createElement(g.Fragment,null,g.createElement("div",{className:"sidebar-collapse__container"},g.createElement("div",{id:e.isSideBarRight?"sbrSidebarCollapse":"sidebarCollapse",className:"sidebar-collapse",onClick:x},g.createElement("span",{className:"fa fa-2x fa-angle-left",title:o.formatMessage({id:"generic_icons.back",defaultMessage:"Back Icon"})}))),g.createElement(G,{updateHighlightedSearchHint:F,handleEnterKey:B,handleClear:W,handleChange:U,handleSubmit:V,handleFocus:D,handleBlur:Z,keepFocused:d,setKeepFocused:h,isFocused:l,suggestionProviders:A.current,isSideBarRight:e.isSideBarRight,isSearchingTerm:e.isSearchingTerm,isFocus:e.isFocus,getFocus:e.getFocus,searchTerms:s,searchType:n,clearSearchType:()=>t.updateSearchType("")},!v.tq()&&(()=>{let a=0;if(null==s||s.split(/[: ]/g).forEach((e=>{let t=m.M9;"files"===n&&(t=m.yg),t.some((({searchTerm:t})=>t.toLowerCase()===e.toLowerCase()))&&a++})),0===R.length||e.isMentionSearch)return g.createElement(g.Fragment,null);const i="search-help-popover".concat(l&&a<=2?" visible":"");return g.createElement(T.Z,{id:"".concat(e.isSideBarRight?"sbr-":"","searchbar-help-popup"),placement:"bottom",className:i},g.createElement(M.Z,{options:R,withTitle:!0,onOptionSelected:q,onMouseDown:H,highlightedIndex:E,onOptionHover:z,onSearchTypeSelected:n||s?void 0:e=>t.updateSearchType(e),searchType:n}))})()));return e.isSideBarRight?g.createElement("div",{className:"sidebar--right__content"},g.createElement("div",{className:"search-bar__container channel-header alt"},g.createElement("div",{className:"sidebar-right__table"},J(),g.createElement(y.Z,{iconComponent:g.createElement(w.Z,{className:"icon icon--standard","aria-hidden":"true"}),ariaLabel:!0,buttonClass:C()("channel-header__icon",{"channel-header__icon--active":e.isMentionSearch}),buttonId:e.isSideBarRight?"sbrChannelHeaderMentionButton":"channelHeaderMentionButton",onClick:s=>{s.preventDefault(),e.isMentionSearch?t.closeRightHandSide():t.showMentions()},tooltipKey:"recentMentions",isRhsOpen:e.isRhsOpen}),g.createElement(y.Z,{iconComponent:g.createElement(P.Z,{className:"icon icon--standard"}),ariaLabel:!0,buttonClass:C()("channel-header__icon ",{"channel-header__icon--active":e.isFlaggedPosts}),buttonId:e.isSideBarRight?"sbrChannelHeaderFlagButton":"channelHeaderFlagButton",onClick:s=>{s.preventDefault(),e.isFlaggedPosts?t.closeRightHandSide():t.showFlaggedPosts()},tooltipKey:"flaggedPosts",isRhsOpen:e.isRhsOpen}))),e.searchVisible?g.createElement(Oe,{isMentionSearch:e.isMentionSearch,isFlaggedPosts:!1,isPinnedPosts:e.isPinnedPosts,isChannelFiles:e.isChannelFiles,shrink:()=>{e.actions.setRhsExpanded(!1)},channelDisplayName:e.channelDisplayName,isOpened:e.isSideBarRightOpen,updateSearchTerms:q,handleSearchHintSelection:H,isSideBarExpanded:e.isRhsExpanded,getMorePostsForSearch:e.actions.getMorePostsForSearch,getMoreFilesForSearch:e.actions.getMoreFilesForSearch,getMoreContactsForSearch:e.actions.getMoreContactsForSearch,setSearchFilterType:t=>{switch(t){case"documents":e.actions.filterFilesSearchByExt(["doc","pdf","docx","odt","rtf","txt"]);break;case"spreadsheets":e.actions.filterFilesSearchByExt(["xls","xlsx","ods"]);break;case"presentations":e.actions.filterFilesSearchByExt(["ppt","pptx","odp"]);break;case"code":e.actions.filterFilesSearchByExt(["py","go","java","kt","c","cpp","h","html","js","ts","cs","vb","php","pl","r","rb","sql","swift","json"]);break;case"images":e.actions.filterFilesSearchByExt(["png","jpg","jpeg","bmp","tiff","svg","psd","xcf"]);break;case"audio":e.actions.filterFilesSearchByExt(["ogg","mp3","wav","flac"]);break;case"video":e.actions.filterFilesSearchByExt(["ogm","mp4","avi","webm","mov","mkv","mpeg","mpg"]);break;default:e.actions.filterFilesSearchByExt([])}L(t),e.isChannelFiles&&a?e.actions.showChannelFiles(a.id):e.actions.showSearchResults(!1)},searchFilterType:O,setSearchType:e=>t.updateSearchType(e),searchType:n||"messages"}):e.children):i?g.createElement(y.Z,{iconComponent:g.createElement(S.Z,{className:"icon icon--standard","aria-hidden":"true"}),ariaLabel:!0,buttonId:"channelHeaderSearchButton",onClick:e=>{e.preventDefault(),t.openRHSSearch()},tooltipKey:"search"}):g.createElement("div",{id:"searchbarContainer",className:"flex-child search-bar__container"},g.createElement("div",{className:"sidebar-right__table"},J()))};at.defaultProps={searchTerms:"",channelDisplayName:"",isFocus:!1,isSideBarRight:!1,getFocus:()=>{}};const it=g.memo(at),rt=(0,r.connect)((function(e){const t=(0,u.kV)(e);return{currentChannel:(0,c.TB)(e),isRhsExpanded:(0,u.OZ)(e),isRhsOpen:(0,u.aC)(e),isSearchingTerm:(0,u.Cd)(e),searchTerms:(0,u.fP)(e),searchType:(0,u.ge)(e),searchVisible:Boolean(t)&&t!==m.Hp.PLUGIN,isMentionSearch:t===m.Hp.MENTION,isFlaggedPosts:!1,isPinnedPosts:t===m.Hp.PIN,isChannelFiles:t===m.Hp.CHANNEL_FILES}}),(function(e){return{actions:(0,o.bindActionCreators)({updateSearchTerms:d.MR,updateSearchType:d.I_,showSearchResults:d.O8,showChannelFiles:d.Cj,showMentions:d.rb,showFlaggedPosts:d.Yv,setRhsExpanded:d.JI,closeRightHandSide:d.Lg,autocompleteChannelsForSearch:h.Z$,autocompleteUsersInTeam:p.XM,updateRhsState:d.D5,getMorePostsForSearch:l.X_,openRHSSearch:d.Xv,getMoreFilesForSearch:l.P3,filterFilesSearchByExt:d._$,getMoreContactsForSearch:l.mE},e)}}))(it)},46919:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var n=s(45697),a=s.n(n),i=s(67294),r=s(44012),o=s(94184),l=s.n(o);const c=e=>e.onSearchTypeSelected&&!e.searchType?i.createElement("div",{className:"search-hint__search-type-selector",onMouseDown:e.onMouseDown},i.createElement("div",null,i.createElement(r.Z,{id:"search_bar.usage.search_type_question",defaultMessage:"Bạn muốn tìm kiếm gì?"})),i.createElement("div",{className:"button-container"},i.createElement("button",{className:l()({highlighted:0===e.highlightedIndex}),onClick:()=>e.onSearchTypeSelected&&e.onSearchTypeSelected("messages")},i.createElement("i",{className:"icon icon-message-text-outline"}),i.createElement(r.Z,{id:"search_bar.usage.search_type_messages",defaultMessage:"Tin nhắn"})),i.createElement("button",{className:l()({highlighted:1===e.highlightedIndex}),onClick:()=>e.onSearchTypeSelected&&e.onSearchTypeSelected("files")},i.createElement("i",{className:"icon icon-file-document-outline"}),i.createElement(r.Z,{id:"search_bar.usage.search_type_files",defaultMessage:"Tập tin"})))):i.createElement(i.Fragment,null,e.withTitle&&!e.searchType&&i.createElement("h4",{className:"search-hint__title"},i.createElement(r.Z,{id:"search_bar.usage.title",defaultMessage:"Search options"})),e.withTitle&&"files"===e.searchType&&i.createElement("h4",{className:"search-hint__title"},i.createElement(r.Z,{id:"search_bar.usage.title_files",defaultMessage:"File search options"})),e.withTitle&&"messages"===e.searchType&&i.createElement("h4",{className:"search-hint__title"},i.createElement(r.Z,{id:"search_bar.usage.title_messages",defaultMessage:"Message search options"})),i.createElement("ul",{role:"list",className:"search-hint__suggestions-list",onMouseDown:e.onMouseDown,onTouchEnd:e.onMouseDown},e.options.map(((t,s)=>i.createElement("li",{className:l()("search-hint__suggestions-list__option",{highlighted:s===e.highlightedIndex}),key:t.searchTerm,onMouseDown:()=>e.onOptionSelected(t.searchTerm),onTouchEnd:()=>e.onOptionSelected(t.searchTerm),onMouseOver:()=>(t=>{e.onOptionHover&&e.onOptionHover(t)})(s)},i.createElement("div",{className:"search-hint__suggestion-list__flex-wrap"},i.createElement("span",{className:"search-hint__suggestion-list__label"},t.additionalDisplay?t.additionalDisplay:t.searchTerm)),i.createElement("div",{className:"search-hint__suggestion-list__value"},i.createElement(r.Z,{id:t.message.id,defaultMessage:t.message.defaultMessage})))))));c.propTypes={withTitle:a().bool,onOptionSelected:a().func.isRequired,onMouseDown:a().func,options:a().arrayOf(a().shape({searchTerm:a().string.isRequired,additionalDisplay:a().string})).isRequired,highlightedIndex:a().number,onOptionHover:a().func,onSearchTypeSelected:a().func,searchType:a().oneOf(["files","messages","contacts",""])};const d=c},8943:(e,t,s)=>{"use strict";s.d(t,{Z:()=>C});var n,a,i,r=s(37703),o=s(14890),l=s(53497),c=s(67844),d=s(45697),h=s.n(d),p=s(67294),u=s(19728),m=s(44012),g=s(15558),f=s(92337);class E extends p.PureComponent{render(){const e=p.createElement(u.Z,{id:"closeSidebarTooltip"},p.createElement(m.Z,{id:"rhs_header.closeSidebarTooltip",defaultMessage:"Close"})),t=p.createElement(u.Z,{id:"expandSidebarTooltip"},p.createElement(m.Z,{id:"rhs_header.expandSidebarTooltip",defaultMessage:"Expand Sidebar"})),s=p.createElement(u.Z,{id:"shrinkSidebarTooltip"},p.createElement(m.Z,{id:"rhs_header.collapseSidebarTooltip",defaultMessage:"Collapse Sidebar"}));return p.createElement("div",{className:"sidebar--right__header"},p.createElement("span",{className:"sidebar--right__title"},this.props.children),p.createElement("div",{className:"pull-right"},p.createElement(g.Z,{delayShow:f.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:this.props.isExpanded?s:t},p.createElement("button",{type:"button",className:"sidebar--right__expand btn-icon",onClick:this.props.actions.toggleRhsExpanded},p.createElement(m.Z,{id:"rhs_header.expandSidebarTooltip.icon",defaultMessage:"Expand Sidebar Icon"},(e=>p.createElement("i",{className:"icon icon-arrow-expand","aria-label":e}))),p.createElement(m.Z,{id:"rhs_header.collapseSidebarTooltip.icon",defaultMessage:"Collapse Sidebar Icon"},(e=>p.createElement("i",{className:"icon icon-arrow-collapse","aria-label":e}))))),p.createElement(g.Z,{delayShow:f.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:e},p.createElement("button",{id:"searchResultsCloseButton",type:"button",className:"sidebar--right__close btn-icon","aria-label":"Close",onClick:this.props.actions.closeRightHandSide},p.createElement(m.Z,{id:"rhs_header.closeTooltip.icon",defaultMessage:"Close Sidebar Icon"},(e=>p.createElement("i",{className:"icon icon-close","aria-label":e})))))))}}n=E,a="propTypes",i={isExpanded:h().bool.isRequired,children:h().node,actions:h().shape({closeRightHandSide:h().func.isRequired,toggleRhsExpanded:h().func.isRequired}).isRequired},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i;const C=(0,r.connect)((function(e){return{isExpanded:(0,c.OZ)(e)}}),(function(e){return{actions:(0,o.bindActionCreators)({closeRightHandSide:l.Lg,toggleRhsExpanded:l.fV},e)}}))(E)},81214:(e,t,s)=>{"use strict";s.d(t,{Z:()=>B});var n=s(37703),a=s(14890),i=s(70493),r=s(42560),o=s(89980),l=s(85357),c=s(26961),d=s(16146),h=s(59929),p=s(53497),u=s(85174),m=s(74935),g=s(67294),f=s(45697),E=s.n(f),C=s(44012),b=s(74806),_=s(19728),v=s(74650),y=s(35856),M=s(75515),P=s(25350),w=s(38373),S=s(15558),T=s(30529),N=s(20528),R=s(35995),I=s(80562),O=s(16242),L=s(32136),A=s(42897),k=s(89262),x=s(54300),D=s(971),Z=s(46098),H=s(92337),q=s(72654);function j(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class U extends g.PureComponent{constructor(e){super(e),j(this,"handleFocusRHSClick",(e=>{e.preventDefault(),this.props.actions.selectPost(this.props.post)})),j(this,"handleJumpClick",(e=>{e.preventDefault(),m.tq()&&this.props.actions.closeRightHandSide(),this.props.actions.setRhsExpanded(!1),k.m.push("/".concat(this.props.currentTeamName,"/pl/").concat(this.props.post.id))})),j(this,"handleCardClick",(e=>{e&&this.props.actions.selectPostCard(e)})),j(this,"handleDropdownOpened",(e=>{this.setState({dropdownOpened:e})})),j(this,"renderPostTime",(()=>{const e=this.props.post,t=!(v.V8.POST_DELETED===e.state||h.ZK(e));return g.createElement(A.Z,{isPermalink:t,eventTime:e.create_at,postId:e.id,location:H.tY.SEARCH})})),j(this,"getClassName",(()=>{let e="post post--thread";return this.props.compactDisplay&&(e+=" post--compact"),this.state.dropdownOpened&&(e+=" post--hovered"),e})),j(this,"handleSearchItemFocus",(()=>{this.setState({currentAriaLabel:"".concat(this.getChannelName(),", ").concat(this.props.createAriaLabel(this.props.intl))})})),j(this,"getChannelName",(()=>{const{channelType:e}=this.props;let{channelName:t}=this.props;return e===H.ZP.DM_CHANNEL&&(t=this.props.intl.formatMessage({id:"search_item.direct",defaultMessage:"Direct Message (with {username})"},{username:this.props.displayName})),t})),this.state={dropdownOpened:!1,showPreview:!1}}render(){const{post:e,channelIsArchived:t}=this.props,s=this.getChannelName();let n,a=!1;e.props&&e.props.from_webhook&&e.props.override_username&&this.props.enablePostUsernameOverride&&(n=e.props.override_username,a=!0);const i=g.createElement(T.Z,{compactDisplay:this.props.compactDisplay,post:e,userId:e.user_id}),r=g.createElement("div",{className:"post__img"},i);let o="";u.cq(this.props.post)&&(o+=" post--edited");let l,c,d,h,p=null;e.file_ids&&e.file_ids.length>0&&(p=g.createElement(M.Z,{post:e,compactDisplay:this.props.compactDisplay})),e.state===H.ZP.POST_DELETED||e.state===v.V8.POST_DELETED?l=g.createElement("p",null,g.createElement(C.Z,{id:"post_body.deleted",defaultMessage:"(message deleted)"})):(m.tq()||(c=g.createElement(O.Z,{location:H.tY.SEARCH,postId:e.id,isFlagged:this.props.isFlagged})),e.props&&e.props.card&&(d=g.createElement(S.Z,{delayShow:H.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:g.createElement(_.Z,null,g.createElement(C.Z,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},g.createElement("button",{className:"card-icon__container icon--show style--none",onClick:e=>{e.preventDefault(),this.handleCardClick(this.props.post)}},g.createElement(D.Z,{className:"icon icon__info","aria-hidden":"true"})))),h=g.createElement("div",{className:"col__controls post-menu"},g.createElement(w.Z,{post:e,location:H.tY.SEARCH,isFlagged:this.props.isFlagged,handleDropdownOpened:this.handleDropdownOpened,commentCount:this.props.commentCountForPost,isMenuOpen:this.state.dropdownOpened,isReadOnly:t||null}),c,g.createElement(P.Z,{location:H.tY.SEARCH,handleCommentClick:this.handleFocusRHSClick,commentCount:this.props.replyCount,postId:e.id,searchStyle:"search-item__comment",extraClass:this.props.replyCount?"icon--visible":""}),g.createElement("a",{href:"#",onClick:this.handleJumpClick,className:"search-item__jump"},g.createElement(C.Z,{id:"search_item.jump",defaultMessage:"Jump"}))),l=g.createElement(I.Z,{post:e,options:{searchTerm:this.props.term,searchMatches:this.props.matches}},g.createElement(y.Z,{post:e,options:{searchTerm:this.props.term,searchMatches:this.props.matches,mentionHighlight:this.props.isMentionSearch},isRHS:!0})));const f=m.jH(e.create_at);return g.createElement("div",{"data-testid":"search-item-container",className:"search-item__container"},g.createElement(R.Z,{date:f}),g.createElement("div",{className:"a11y__section ".concat(this.getClassName()),id:"searchResult_"+e.id,"aria-label":this.state.currentAriaLabel,onFocus:this.handleSearchItemFocus,"data-a11y-sort-order":this.props.a11yIndex},g.createElement("div",{className:"search-channel__name","aria-hidden":"true"},s,t&&g.createElement("span",{className:"search-channel__archived"},g.createElement(L.Z,{className:"icon icon__archive channel-header-archived-icon svg-text-color"}),g.createElement(C.Z,{id:"search_item.channelArchived",defaultMessage:"Archived"}))),g.createElement(Z.Z,{isFlagged:this.props.isFlagged,isPinned:e.is_pinned,skipPinned:this.props.isPinnedPosts,skipFlagged:this.props.isFlaggedPosts,channelId:e.channel_id}),g.createElement("div",{role:"application",className:"post__content"},r,g.createElement("div",null,g.createElement("div",{className:"post__header"},g.createElement("div",{className:"col col__name"},g.createElement(N.Z,{userId:e.user_id,overwriteName:n,disablePopover:a,isRHS:!0}),g.createElement(x.Z,{show:Boolean(e.props&&e.props.from_webhook&&!this.props.isBot)})),g.createElement("div",{className:"col"},this.renderPostTime(),d),h),g.createElement("div",{className:"search-item-snippet post__body"},g.createElement("div",{className:o},l,p))))))}}j(U,"propTypes",{post:E().object,createAriaLabel:E().func,matches:E().array,channelName:E().string,channelType:E().string,channelIsArchived:E().bool,compactDisplay:E().bool,isMentionSearch:E().bool,term:E().string,isFlagged:E().bool.isRequired,currentTeamName:E().string,commentCountForPost:E().number,enablePostUsernameOverride:E().bool.isRequired,isBot:E().bool.isRequired,a11yIndex:E().number,actions:E().shape({closeRightHandSide:E().func.isRequired,selectPost:E().func.isRequired,selectPostCard:E().func.isRequired,setRhsExpanded:E().func.isRequired}).isRequired,intl:q.gm.isRequired,displayName:E().string.isRequired,replyCount:E().number,isFlaggedPosts:E().bool,isPinnedPosts:E().bool}),j(U,"defaultProps",{isBot:!1,channelIsArchived:!1});const F=(0,b.ZP)(U),B=(0,n.connect)((function(){const e=(0,u.yk)(),t=(0,u.Tx)(),s=(0,l.U6)();return(n,a)=>{const{post:l}=a,p=(0,r.iE)(n),u=(0,c.VJ)(n),g="true"===p.EnablePostUsernameOverride,f=(0,o.PR)(n,l.user_id),E=(0,i.mr)(n,l.channel_id)||{delete_at:0},C=(0,m.PR)(n,E.id);return{currentTeamName:(0,d.kA)(n).name,createAriaLabel:t(n,l),channelId:E.id,channelName:E.display_name||"",channelType:E.type,channelIsArchived:0!==E.delete_at,commentCountForPost:s(n,{post:l}),enablePostUsernameOverride:g,isFlagged:(0,h.hX)(l.id,u),isBot:!!f&&f.is_bot,directTeammate:C,displayName:(0,m.hI)(n,C),replyCount:e(n,l)}}}),(function(e){return{actions:(0,a.bindActionCreators)({closeRightHandSide:p.Lg,selectPost:p.mF,selectPostCard:p.Ok,setRhsExpanded:p.JI},e)}}))(F)},64501:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var n=s(37703),a=s(92337),i=s(74935),r=s(45697),o=s.n(r),l=(s(33948),s(67294)),c=s(44012);function d(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class h extends l.PureComponent{constructor(...e){super(...e),d(this,"togglePreview",(e=>{var t,s;e.preventDefault(),null===(t=(s=this.props).updatePreview)||void 0===t||t.call(s,!this.props.showPreview)}))}render(){const{isMarkdownPreviewEnabled:e}=this.props,t=this.props.message&&this.props.message.length>0;let s,n="";this.props.message&&this.props.message.length>this.props.characterLimit&&(n="hidden"),s=this.props.previewMessageLink?l.createElement("span",null,this.props.previewMessageLink):l.createElement(c.Z,{id:"textbox.edit",defaultMessage:"Edit message"});let a=null;e&&(a=l.createElement("button",{id:"previewLink",onClick:this.togglePreview,className:"style--none textbox-preview-link color--link"},this.props.showPreview?s:l.createElement(c.Z,{id:"textbox.preview",defaultMessage:"Preview"})));const i=l.createElement("div",{style:{visibility:t?"visible":"hidden",opacity:t?"0.45":"0"},className:"help__format-text"},l.createElement("b",null,l.createElement(c.Z,{id:"textbox.bold",defaultMessage:"**bold**"})),l.createElement("i",null,l.createElement(c.Z,{id:"textbox.italic",defaultMessage:"*italic*"})),l.createElement("span",null,"~~",l.createElement("s",null,l.createElement(c.Z,{id:"textbox.strike",defaultMessage:"strike"})),"~~ "),l.createElement("span",null,l.createElement(c.Z,{id:"textbox.inlinecode",defaultMessage:"`inline code`"})),l.createElement("span",null,l.createElement(c.Z,{id:"textbox.preformatted",defaultMessage:"```preformatted```"})),l.createElement("span",null,l.createElement(c.Z,{id:"textbox.quote",defaultMessage:">quote"})));return l.createElement("div",{className:"help__text "+n},i,a)}}d(h,"propTypes",{isMarkdownPreviewEnabled:o().bool.isRequired,message:o().string,updatePreview:o().func,previewMessageLink:o().string,characterLimit:o().number.isRequired,showPreview:o().bool}),d(h,"defaultProps",{message:""});const p=a.ZP.PRE_RELEASE_FEATURES,u=(0,n.connect)((e=>({isMarkdownPreviewEnabled:(0,i.cr)(p.MARKDOWN_PREVIEW,e)})))(h)},12874:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n=s(45697),a=s.n(n),i=(s(19601),s(67294)),r=s(94184),o=s.n(r);function l(e){let{prepend:t,append:s,children:n,isActive:a,hasDot:r,allowTextOverflow:l=!1}=e,c=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["prepend","append","children","isActive","hasDot","allowTextOverflow"]);return i.createElement("button",Object.assign({},c,{className:o()("Button Button___transparent",{"is-active":a,allowTextOverflow:l},c.className)}),t&&i.createElement("span",{className:"Button_prepended"},t),i.createElement("span",{className:"Button_label"},n,r&&i.createElement("span",{className:"dot"})),s&&i.createElement("span",{className:"Button_appended"},s))}l.propTypes={prepend:a().node,append:a().node,isActive:a().bool,hasDot:a().bool,allowTextOverflow:a().bool};const c=(0,i.memo)(l)},61577:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d}),s(45697),s(19601);var n=s(67294),a=s(86896),i=s(94184),r=s.n(i),o=s(12874),l=s(82251);function c(e){var t;let{isFollowing:s}=e,i=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["isFollowing"]);const{formatMessage:c}=(0,a.Z)();return n.createElement(o.Z,Object.assign({},i,{className:r()(i.className,"FollowButton"),disabled:null!==(t=i.disabled)&&void 0!==t?t:null==s,isActive:null!=s&&s}),c(s?{id:(0,l.t)("threading.following"),defaultMessage:"Following"}:{id:(0,l.t)("threading.notFollowing"),defaultMessage:"Follow"}))}const d=(0,n.memo)(c)},96329:(e,t,s)=>{"use strict";s.d(t,{_:()=>n}),s(67294);const n={units:["now","minute","hour","day","week"],useTime:!1,day:"numeric"}},82704:(e,t,s)=>{"use strict";s.d(t,{Q:()=>l}),s(15306);var n=s(67294),a=s(5977),i=s(37703),r=s(89980),o=s(16146);function l(){const{params:e}=(0,a.$B)(),t=(0,a.k6)(),s=(0,i.useSelector)(o.ev),l=(0,i.useSelector)(r.rc);return(0,n.useMemo)((()=>({params:e,history:t,currentTeamId:s,currentUserId:l,clear:()=>t.replace("/".concat(e.team,"/threads")),select:s=>t.push("/".concat(e.team,"/threads").concat(s?"/"+s:"")),goToInChannel:(s,n=e.team)=>t.push("/".concat(n,"/pl/").concat(null!=s?s:e.threadIdentifier))})),[e.team,e.threadIdentifier,s,l])}},81827:(e,t,s)=>{"use strict";s.d(t,{Z:()=>Lt});var n=s(37703),a=s(14890),i=s(16146),r=s(89980),o=s(85357),l=s(70493),c=s(60862),d=s(26961),h=s(92405),p=s(55165),u=s(92337),m=s(74935),g=s(16403),f=s(53497),E=s(45697),C=s.n(E),b=(s(19601),s(39714),s(4002)),_=s.n(b),v=s(67294),y=s(31298),M=s(94184),P=s.n(M),w=s(74650),S=s(8142),T=s(47470),N=(s(73210),s(42560)),R=s(38348),I=s(80722),O=s(22558),L=s(27640),A=s(6602),k=(s(88674),s(33948),s(23157),s(22222)),x=s(61045),D=s(59929),Z=s(34959),H=s(77905),q=s(73787),j=s(99206),U=s(3440),F=s(67844);function B(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function G(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?B(Object(s),!0).forEach((function(t){V(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):B(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function V(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function K(){return(0,j.Qg)(u.hC.COMMENT_DRAFT,((e,t)=>t?G(G({},t),{},{uploadsInProgress:[]}):t))}function Y(e,t){return(0,j.Bc)("".concat(u.hC.COMMENT_DRAFT).concat(e),t)}function W(e,t){const s=(0,o.Jf)(w.V8.MESSAGE_TYPES.COMMENT);return()=>(n,a)=>{const i=(0,F.HG)(a(),u.hC.COMMENT_DRAFT,e);if(""!==i.message&&i.message!==s(a()))return;-1===t?n((0,h.Pc)(w.V8.MESSAGE_TYPES.COMMENT)):1===t&&n((0,h.Rc)(w.V8.MESSAGE_TYPES.COMMENT));const r=s(a());n(Y(e,G(G({},i),{},{message:r})))}}function z(e,t,s){return async(n,a)=>{const i=a(),o=(0,r.rc)(i),l=m.u3();let c={file_ids:[],message:s.message,channel_id:e,root_id:t,parent_id:t,pending_post_id:"".concat(o,":").concat(l),user_id:o,create_at:l,metadata:{},props:G({},s.props)};const d=await n((0,q.H)(c));return d.error?{error:d.error}:(c=d.data,n(Z.qb(c,s.fileInfos)))}}var J=s(28645),X=s(10873),Q=(s(32023),s(44012)),$=s(74806),ee=s(76279),te=s(34288),se=s(72654),ne=s(85174),ae=s(14906),ie=s(32579),re=s(12227),oe=s(13685),le=s(62788),ce=s(83440),de=s(79541),he=s(49880),pe=s(32103),ue=s(64501),me=s(45288),ge=s(52881);function fe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Ee(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(s),!0).forEach((function(t){Ce(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):fe(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ce(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const be=u.ZP.KeyCodes;class _e extends v.PureComponent{static getDerivedStateFromProps(e,t){let s={createPostErrorId:e.createPostErrorId,rootId:e.rootId,messageInHistory:e.messageInHistory,draft:t.draft||Ee(Ee({},e.draft),{},{caretPosition:e.draft.message.length,uploadsInProgress:[]})};const n=e.rootId!==t.rootId,a=e.messageInHistory!==t.messageInHistory;return(n||a)&&(s=Ee(Ee({},s),{},{draft:Ee(Ee({},e.draft),{},{uploadsInProgress:n?[]:e.draft.uploadsInProgress})})),"api.post.create_post.root_id.app_error"===e.createPostErrorId&&e.createPostErrorId!==t.createPostErrorId&&(s=Ee(Ee({},s),{},{showPostDeletedModal:!0})),s}constructor(e){super(e),Ce(this,"setShowPreview",(e=>{this.props.setShowPreview(e)})),Ce(this,"focusTextboxIfNecessary",(e=>{this.props.rhsExpanded&&(document.getElementsByClassName("channel-switch-modal").length||(0,ne.a0)(e,document.activeElement)&&this.focusTextbox())})),Ce(this,"setCaretPosition",(e=>{const t=this.textboxRef.current&&this.textboxRef.current.getInputBox();this.setState({caretPosition:e},(()=>{m.Mq(t,e)}))})),Ce(this,"pasteHandler",(e=>{if(!e.clipboardData||!e.clipboardData.items||"reply_textbox"!==e.target.id)return;const{clipboardData:t}=e,s=(0,ae.hC)(t);if(!s)return;e.preventDefault();const{draft:n}=this.state;let a=n.message;if((0,ae.lw)(s.className)){const{formattedMessage:e,formattedCodeBlock:s}=(0,ae.fB)(this.state.caretPosition,a,t),n=this.state.caretPosition+s.length;a=e,this.setCaretPosition(n)}else{const e=n.message.length;a=(0,ae.Kt)(s,n.message.trim(),this.state.caretPosition);const t=a.length-(e-this.state.caretPosition);this.setCaretPosition(t)}const i=Ee(Ee({},n),{},{message:a});this.props.onUpdateCommentDraft(i),this.setState({draft:i})})),Ce(this,"handleNotifyAllConfirmation",(e=>{this.hideNotifyAllModal(),this.doSubmit(e)})),Ce(this,"hideNotifyAllModal",(()=>{this.setState({showConfirmModal:!1})})),Ce(this,"showNotifyAllModal",(()=>{this.setState({showConfirmModal:!0})})),Ce(this,"toggleEmojiPicker",(()=>{this.setState({showEmojiPicker:!this.state.showEmojiPicker})})),Ce(this,"hideEmojiPicker",(()=>{this.setState({showEmojiPicker:!1})})),Ce(this,"handleEmojiClick",(e=>{const t=e.name||e.aliases[0];if(!t)return;const{draft:s}=this.state;let n="";if(""===s.message)n=":".concat(t,": ");else{const{draft:{message:e}}=this.state,{firstPiece:s,lastPiece:a}=(0,ne.Nn)(this.state.caretPosition,e);n=""===s?":".concat(t,": ").concat(a," "):"".concat(s," :").concat(t,": ").concat(a," ");const i=""===s?":".concat(t,": ").length:"".concat(s," :").concat(t,": ").length;this.setCaretPosition(i)}const a=Ee(Ee({},s),{},{message:n});this.props.onUpdateCommentDraft(a),this.draftsForPost[this.props.rootId]=a,this.setState({showEmojiPicker:!1,draft:a})})),Ce(this,"handleGifClick",(e=>{const{draft:t}=this.state;let s="";s=""===t.message?e:/\s+$/.test(t.message)?"".concat(t.message).concat(e," "):"".concat(t.message," ").concat(e," ");const n=Ee(Ee({},t),{},{message:s});this.props.onUpdateCommentDraft(n),this.draftsForPost[this.props.rootId]=n,this.setState({showEmojiPicker:!1,draft:n}),this.focusTextbox()})),Ce(this,"handlePostError",(e=>{this.setState({postError:e})})),Ce(this,"handleSubmit",(async e=>{e.preventDefault(),this.setShowPreview(!1);const{channelMembersCount:t,enableConfirmNotificationsToChannel:s,useChannelMentions:n,isTimezoneEnabled:a,groupsWithAllowReference:i,channelMemberCountsByGroup:r,useGroupMentions:o}=this.props,{draft:l}=this.state,c=s&&n;let d=0,h=0,p=[];const m=!(0,ne.t7)(l.message);if(s&&m&&o&&(p=(0,ne.TA)(l.message,i),p.length>0&&(p=p.map((e=>{const t=r[e.id];return t&&t.channel_member_count>u.ZP.NOTIFY_ALL_MEMBERS&&t.channel_member_count>d&&(d=t.channel_member_count,h=t.channel_member_timezones_count),"@".concat(e.name)})),p=[...new Set(p)])),!o&&p.length>0){const e=Ee(Ee({},l),{},{props:Ee(Ee({},l.props),{},{disable_group_highlight:!0})});this.props.onUpdateCommentDraft(e),this.setState({draft:e})}if(c&&t>u.ZP.NOTIFY_ALL_MEMBERS&&!m&&(d=t-1,p=["@all","@group"],a)){const{data:e}=await this.props.getChannelTimezones(this.props.channelId);h=e?e.length:0}if(!n&&(0,ne.t7)(l.message,{checkAllMentions:!0})){const e=Ee(Ee({},l),{},{props:Ee(Ee({},l.props),{},{mentionHighlightDisabled:!0})});this.props.onUpdateCommentDraft(e),this.setState({draft:e})}if(d>0)return this.setState({channelTimezoneCount:h,memberNotifyCount:d,mentions:p}),void this.showNotifyAllModal();await this.doSubmit(e)})),Ce(this,"doSubmit",(async e=>{e&&e.preventDefault();const{draft:t}=this.state;if(!this.shouldEnableAddButton())return;if(t.uploadsInProgress.length>0)return;if(this.state.postError)return this.setState({errorClass:"animation--highlight"}),void setTimeout((()=>{this.setState({errorClass:null})}),u.ZP.ANIMATION_TIMEOUT);if(this.props.rootDeleted)return void this.showPostDeletedModal();const s=Date.now()-this.lastBlurAt<150;this.focusTextbox(s);const n=this.state.serverError;let a=!1;(0,ne.cW)(n)&&t.message===n.submittedMessage&&(a=!0);const i={ignoreSlash:a};try{await this.props.onSubmit(i),this.setState({postError:null,serverError:null})}catch(e){return(0,ne.cW)(e)&&this.props.onUpdateCommentDraft(t),e.submittedMessage=t.message,void this.setState({serverError:e})}this.setState({draft:Ee(Ee({},this.props.draft),{},{uploadsInProgress:[]})})})),Ce(this,"commentMsgKeyPress",(e=>{const{ctrlSend:t,codeBlockOnCtrlEnter:s}=this.props,{allowSending:n,withClosedCodeBlock:a,message:i}=(0,ne.bp)(e,this.state.draft.message,t,s,0,0,this.state.caretPosition);if(n){if(e.persist(),this.textboxRef.current&&this.textboxRef.current.blur(),a&&i){const{draft:t}=this.state,s=Ee(Ee({},t),{},{message:i});this.props.onUpdateCommentDraft(s),this.setState({draft:s},(()=>this.handleSubmit(e))),this.draftsForPost[this.props.rootId]=s}else this.handleSubmit(e);this.setShowPreview(!1),setTimeout((()=>{this.focusTextbox()}))}this.emitTypingEvent()})),Ce(this,"reactToLastMessage",(e=>{e.preventDefault();const{emitShortcutReactToLastPostFrom:t}=this.props;t(u.tY.RHS_ROOT)})),Ce(this,"emitTypingEvent",(()=>{const{channelId:e,rootId:t}=this.props;te.bH(e,t)})),Ce(this,"scrollToBottom",(()=>{const e=_()(".post-right__scroll");e[0]&&e.parent().scrollTop(e[0].scrollHeight)})),Ce(this,"handleChange",(e=>{const t=e.target.value;let s=this.state.serverError;(0,ne.cW)(s)&&(s=null);const{draft:n}=this.state,a=Ee(Ee({},n),{},{message:t});cancelAnimationFrame(this.saveDraftFrame),this.saveDraftFrame=requestAnimationFrame((()=>{this.props.onUpdateCommentDraft(a)})),this.setState({draft:a,serverError:s},(()=>{this.scrollToBottom()})),this.draftsForPost[this.props.rootId]=a})),Ce(this,"handleMouseUpKeyUp",(e=>{const t=m.qK(e.target);this.setState({caretPosition:t})})),Ce(this,"handleSelect",(e=>{m.cf(this.textboxRef.current.getInputBox(),e)})),Ce(this,"handleKeyDown",(e=>{const t=(e.ctrlKey||e.metaKey)&&e.shiftKey&&m.pD(e,be.BACK_SLASH);if(m.m(e))return void this.setState({draft:Ee(Ee({},this.state.draft),{},{message:m.V4(e)})});if((this.props.ctrlSend||this.props.codeBlockOnCtrlEnter)&&m.pD(e,u.ZP.KeyCodes.ENTER)&&(e.ctrlKey||e.metaKey))return this.setShowPreview(!1),void this.commentMsgKeyPress(e);const{draft:s}=this.state,{message:n}=s;if(!e.ctrlKey&&!e.metaKey&&!e.altKey&&!e.shiftKey&&m.pD(e,u.ZP.KeyCodes.UP)&&""===n){e.preventDefault(),this.textboxRef.current&&this.textboxRef.current.blur();const{data:t}=this.props.onEditLatestPost();t||this.focusTextbox(!0)}const a=m._E(e)&&!e.altKey&&!e.shiftKey,i=m._E(e,!0)&&e.altKey;a&&(m.pD(e,u.ZP.KeyCodes.UP)?(e.preventDefault(),this.props.onMoveHistoryIndexBack()):m.pD(e,u.ZP.KeyCodes.DOWN)?(e.preventDefault(),this.props.onMoveHistoryIndexForward()):(m.pD(e,u.ZP.KeyCodes.B)||m.pD(e,u.ZP.KeyCodes.I))&&this.applyHotkeyMarkdown(e)),i&&m.pD(e,u.ZP.KeyCodes.K)&&this.applyHotkeyMarkdown(e),t&&this.reactToLastMessage(e)})),Ce(this,"applyHotkeyMarkdown",(e=>{const t=m.IG(e),{draft:s}=this.state,n=Ee(Ee({},s),{},{message:t.message});this.props.onUpdateCommentDraft(n),this.draftsForPost[this.props.rootId]=n,this.setState({draft:n},(()=>{const e=this.textboxRef.current.getInputBox();m.AU(e,t.selectionStart,t.selectionEnd)}))})),Ce(this,"handleFileUploadChange",(()=>{this.focusTextbox()})),Ce(this,"handleUploadStart",(e=>{const{draft:t}=this.state,s=[...t.uploadsInProgress,...e],n=Ee(Ee({},t),{},{uploadsInProgress:s});this.props.onUpdateCommentDraft(n),this.setState({draft:n}),this.draftsForPost[this.props.rootId]=n,this.focusTextbox()})),Ce(this,"handleUploadProgress",(({clientId:e,name:t,percent:s,type:n})=>{const a=Ee(Ee({},this.state.uploadsProgressPercent),{},{[e]:{percent:s,name:t,type:n}});this.setState({uploadsProgressPercent:a})})),Ce(this,"handleFileUploadComplete",((e,t,s,n)=>{const a=this.draftsForPost[n],i=[...a.uploadsInProgress],r=(0,ee.Vi)([...a.fileInfos,...e],this.props.locale);for(let e=0;e<t.length;e++){const s=i.indexOf(t[e]);-1!==s&&i.splice(s,1)}const o=Ee(Ee({},a),{},{fileInfos:r,uploadsInProgress:i});this.props.updateCommentDraftWithRootId(n,o),this.draftsForPost[n]=o,this.props.rootId===n&&this.setState({draft:o})})),Ce(this,"handleUploadError",((e,t=-1,s,n=-1)=>{if(-1!==t){const e=Ee({},this.draftsForPost[n]),s=[...e.uploadsInProgress],a=s.indexOf(t);-1!==a&&s.splice(a,1);const i=Ee(Ee({},e),{},{uploadsInProgress:s});this.props.updateCommentDraftWithRootId(n,i),this.draftsForPost[n]=i,this.props.rootId===n&&this.setState({draft:i})}let a=e;e&&"string"==typeof e&&(a=new Error(e)),this.setState({serverError:a},(()=>{a&&this.scrollToBottom()}))})),Ce(this,"removePreview",(e=>{const{draft:t}=this.state,s=[...t.fileInfos],n=[...t.uploadsInProgress];this.handleUploadError(null);let a=s.findIndex((t=>t.id===e));-1===a?(a=n.indexOf(e),-1!==a&&(n.splice(a,1),this.fileUploadRef.current&&this.fileUploadRef.current.cancelUpload(e))):s.splice(a,1);const i=Ee(Ee({},t),{},{fileInfos:s,uploadsInProgress:n});this.props.onUpdateCommentDraft(i),this.setState({draft:i}),this.draftsForPost[this.props.rootId]=i,this.handleFileUploadChange()})),Ce(this,"getFileCount",(()=>{const{draft:{fileInfos:e,uploadsInProgress:t}}=this.state;return e.length+t.length})),Ce(this,"getFileUploadTarget",(()=>this.textboxRef.current)),Ce(this,"getCreateCommentControls",(()=>this.createCommentControlsRef.current)),Ce(this,"focusTextbox",((e=!1)=>{!this.textboxRef.current||!e&&T.tq()||this.textboxRef.current.focus()})),Ce(this,"shouldEnableAddButton",(()=>!!this.props.enableAddButton||(0,ne.cW)(this.state.serverError))),Ce(this,"showPostDeletedModal",(()=>{this.setState({showPostDeletedModal:!0})})),Ce(this,"hidePostDeletedModal",(()=>{this.setState({showPostDeletedModal:!1}),this.props.resetCreatePostRequest()})),Ce(this,"handleBlur",(()=>{this.lastBlurAt=Date.now()})),Ce(this,"handleHeightChange",((e,t)=>{this.setState({renderScrollbar:e>t}),window.requestAnimationFrame((()=>{this.textboxRef.current&&this.setState({scrollbarWidth:m.LF(this.textboxRef.current.getInputBox())})})),this.props.onHeightChange&&this.props.onHeightChange()})),this.state={showPostDeletedModal:!1,showConfirmModal:!1,showEmojiPicker:!1,channelTimezoneCount:0,uploadsProgressPercent:{},renderScrollbar:!1,scrollbarWidth:0,mentions:[],memberNotifyCount:0},this.lastBlurAt=0,this.draftsForPost={},this.doInitialScrollToBottom=!1,this.textboxRef=v.createRef(),this.fileUploadRef=v.createRef(),this.createCommentControlsRef=v.createRef()}componentDidMount(){const{useGroupMentions:e,getChannelMemberCountsByGroup:t,channelId:s,clearCommentDraftUploads:n,onResetHistoryIndex:a,setShowPreview:i,draft:r}=this.props;n(),a(),i(!1),this.focusTextbox(),document.addEventListener("paste",this.pasteHandler),document.addEventListener("keydown",this.focusTextboxIfNecessary),e&&t(s),""!==r.message&&(this.doInitialScrollToBottom=!0)}componentWillUnmount(){this.props.resetCreatePostRequest(),document.removeEventListener("paste",this.pasteHandler),document.removeEventListener("keydown",this.focusTextboxIfNecessary),this.saveDraftFrame&&(cancelAnimationFrame(this.saveDraftFrame),this.props.onUpdateCommentDraft(this.state.draft))}componentDidUpdate(e,t){t.draft.uploadsInProgress.length<this.state.draft.uploadsInProgress.length&&this.scrollToBottom(),t.showEmojiPicker&&!this.state.showEmojiPicker&&this.focusTextbox(),e.shouldShowPreview&&!this.props.shouldShowPreview&&this.focusTextbox(),e.rootId===this.props.rootId&&e.selectedPostFocussedAt===this.props.selectedPostFocussedAt||(this.props.useGroupMentions&&this.props.getChannelMemberCountsByGroup(this.props.channelId),this.focusTextbox()),this.doInitialScrollToBottom&&(this.scrollToBottom(),this.doInitialScrollToBottom=!1)}render(){const{draft:e}=this.state,t=this.props.readOnlyChannel||!this.props.canPost,{formatMessage:s}=this.props.intl,n=this.shouldEnableAddButton(),{renderScrollbar:a,channelTimezoneCount:i,mentions:r,memberNotifyCount:o}=this.state,l=m._u("accessibility.sections.rhsFooter","reply input region");let c="",d="";r.includes("@all")||r.includes("@group")?(d=v.createElement(Q.Z,{id:"notify_all.title.confirm",defaultMessage:"Confirm sending notifications to entire channel"}),c=i>0?v.createElement(me.Z,{id:"notify_all.question_timezone",defaultMessage:"By using **@all** or **@group** you are about to send notifications to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{totalMembers:o,timezones:i}}):v.createElement(me.Z,{id:"notify_all.question",defaultMessage:"By using **@all** or **@group** you are about to send notifications to **{totalMembers} people**. Are you sure you want to do this?",values:{totalMembers:o}})):r.length>0&&(d=v.createElement(Q.Z,{id:"notify_all.title.confirm_groups",defaultMessage:"Confirm sending notifications to groups"}),c=1===r.length?i>0?v.createElement(me.Z,{id:"notify_all.question_timezone_one_group",defaultMessage:"By using **{mention}** you are about to send notifications of up to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{mention:r[0],totalMembers:o,timezones:i}}):v.createElement(me.Z,{id:"notify_all.question_one_group",defaultMessage:"By using **{mention}** you are about to send notifications of up to **{totalMembers} people**. Are you sure you want to do this?",values:{mention:r[0],totalMembers:o}}):i>0?v.createElement(me.Z,{id:"notify_all.question_timezone_groups",defaultMessage:"By using **{mentions}** and **{finalMention}** you are about to send notifications of up to **{totalMembers} people** in **{timezones, number} {timezones, plural, one {timezone} other {timezones}}**. Are you sure you want to do this?",values:{mentions:r.slice(0,-1).join(", "),finalMention:r[r.length-1],totalMembers:o,timezones:i}}):v.createElement(me.Z,{id:"notify_all.question_groups",defaultMessage:"By using **{mentions}** and **{finalMention}** you are about to send notifications of up to **{totalMembers} people**. Are you sure you want to do this?",values:{mentions:r.slice(0,-1).join(", "),finalMention:r[r.length-1],totalMembers:o}}));const h=v.createElement(Q.Z,{id:"notify_all.confirm",defaultMessage:"Confirm"});let p=null;this.state.serverError&&(p=v.createElement(ge.Z,{id:"postServerError",error:this.state.serverError,submittedMessage:this.state.serverError.submittedMessage,handleSubmit:this.handleSubmit}));let g=null;if(this.state.postError){const e="post-error"+(this.state.errorClass?" "+this.state.errorClass:"");g=v.createElement("label",{className:e},this.state.postError)}let f=null;!t&&(e.fileInfos.length>0||e.uploadsInProgress.length>0)&&(f=v.createElement(oe.Z,{fileInfos:e.fileInfos,onRemove:this.removePreview,uploadsInProgress:e.uploadsInProgress,uploadsProgressPercent:this.state.uploadsProgressPercent}));let E=null;e.uploadsInProgress.length>0&&(E=v.createElement("span",{className:"post-right-comments-upload-in-progress"},1===e.uploadsInProgress.length?v.createElement(Q.Z,{id:"create_comment.file",defaultMessage:"File uploading"}):v.createElement(Q.Z,{id:"create_comment.files",defaultMessage:"Files uploading"})));let C,b="btn btn-primary comment-btn";n||(b+=" disabled"),t||this.props.shouldShowPreview||(C=v.createElement(le.Z,{ref:this.fileUploadRef,fileCount:this.getFileCount(),getTarget:this.getFileUploadTarget,onFileUploadChange:this.handleFileUploadChange,onUploadStart:this.handleUploadStart,onFileUpload:this.handleFileUploadComplete,onUploadError:this.handleUploadError,onUploadProgress:this.handleUploadProgress,rootId:this.props.rootId,channelId:this.props.channelId,postType:"comment"}));let _=null;const y=s({id:"emoji_picker.emojiPicker",defaultMessage:"Emoji Picker"}).toLowerCase();let M;!this.props.enableEmojiPicker||t||this.props.shouldShowPreview||(_=v.createElement("div",null,v.createElement(re.Z,{show:this.state.showEmojiPicker,target:this.getCreateCommentControls,onHide:this.hideEmojiPicker,onEmojiClose:this.hideEmojiPicker,onEmojiClick:this.handleEmojiClick,onGifClick:this.handleGifClick,enableGifPicker:this.props.enableGifPicker,topOffset:55}),v.createElement("button",{"aria-label":y,type:"button",onClick:this.toggleEmojiPicker,className:P()("emoji-picker__container","post-action",{"post-action--active":this.state.showEmojiPicker})},v.createElement(he.Z,{className:"icon icon--emoji emoji-rhs "})))),M=t?m._u("create_post.read_only","This channel is read-only. Only members with permission can post here."):m._u("create_comment.addComment","Add a comment...");let w="";a&&(w=" scroll");const S=this.textboxRef.current;let T="top";return S&&S.getInputBox().getBoundingClientRect().top<u.ZP.SUGGESTION_LIST_SPACE_RHS&&(T="bottom"),v.createElement("form",{onSubmit:this.handleSubmit},v.createElement("div",{role:"form","aria-label":l,tabIndex:"-1",className:"post-create a11y__region".concat(w),style:this.state.renderScrollbar&&this.state.scrollbarWidth?{"--detected-scrollbar-width":"".concat(this.state.scrollbarWidth,"px")}:void 0,"data-a11y-sort-order":"4"},v.createElement("div",{id:this.props.rootId,className:"post-create-body comment-create-body"},v.createElement("div",{className:"post-body__cell"},v.createElement(pe.Z,{onChange:this.handleChange,onKeyPress:this.commentMsgKeyPress,onKeyDown:this.handleKeyDown,onSelect:this.handleSelect,onMouseUp:this.handleMouseUpKeyUp,onKeyUp:this.handleMouseUpKeyUp,onComposition:this.emitTypingEvent,onHeightChange:this.handleHeightChange,handlePostError:this.handlePostError,value:t?"":e.message,onBlur:this.handleBlur,createMessage:M,emojiEnabled:this.props.enableEmojiPicker,initialText:"",channelId:this.props.channelId,rootId:this.props.rootId,isRHS:!0,popoverMentionKeyClick:!0,id:"reply_textbox",ref:this.textboxRef,disabled:t,characterLimit:this.props.maxPostSize,preview:this.props.shouldShowPreview,suggestionListStyle:T,badConnection:this.props.badConnection,listenForMentionKeyClick:!0,useChannelMentions:this.props.useChannelMentions}),v.createElement("span",{ref:this.createCommentControlsRef,className:"post-body__actions"},C,_))),v.createElement("div",{className:"post-create-footer"},v.createElement("div",{className:"d-flex justify-content-between"},v.createElement("div",{className:"col"},v.createElement(ce.Z,{channelId:this.props.channelId,postId:this.props.rootId}),g),v.createElement("div",{className:"col col-auto"},v.createElement(ue.Z,{characterLimit:this.props.maxPostSize,showPreview:this.props.shouldShowPreview,updatePreview:this.setShowPreview,message:t?"":this.state.message}))),v.createElement("div",{className:"text-right mt-2"},E,v.createElement("input",{type:"button",disabled:!n,id:"addCommentButton",className:b,value:s({id:"create_comment.comment",defaultMessage:"Add Comment"}),onClick:this.handleSubmit}),f,p))),v.createElement(de.Z,{show:this.state.showPostDeletedModal,onHide:this.hidePostDeletedModal}),v.createElement(ie.Z,{title:d,message:c,confirmButtonText:h,show:this.state.showConfirmModal,onConfirm:this.handleNotifyAllConfirmation,onCancel:this.hideNotifyAllModal}))}}Ce(_e,"propTypes",{channelId:C().string.isRequired,channelMembersCount:C().number.isRequired,rootId:C().string.isRequired,rootDeleted:C().bool.isRequired,messageInHistory:C().string,draft:C().shape({message:C().string.isRequired,uploadsInProgress:C().array.isRequired,fileInfos:C().array.isRequired}).isRequired,enableAddButton:C().bool.isRequired,codeBlockOnCtrlEnter:C().bool,ctrlSend:C().bool,latestPostId:C().string,locale:C().string.isRequired,createPostErrorId:C().string,clearCommentDraftUploads:C().func.isRequired,intl:se.gm.isRequired,onUpdateCommentDraft:C().func.isRequired,updateCommentDraftWithRootId:C().func.isRequired,onSubmit:C().func.isRequired,onResetHistoryIndex:C().func.isRequired,onMoveHistoryIndexBack:C().func.isRequired,onMoveHistoryIndexForward:C().func.isRequired,onEditLatestPost:C().func.isRequired,getChannelTimezones:C().func.isRequired,resetCreatePostRequest:C().func.isRequired,readOnlyChannel:C().bool,enableConfirmNotificationsToChannel:C().bool.isRequired,enableEmojiPicker:C().bool.isRequired,enableGifPicker:C().bool.isRequired,badConnection:C().bool.isRequired,maxPostSize:C().number.isRequired,rhsExpanded:C().bool.isRequired,isTimezoneEnabled:C().bool.isRequired,selectedPostFocussedAt:C().number.isRequired,emitShortcutReactToLastPostFrom:C().func,canPost:C().bool.isRequired,useChannelMentions:C().bool.isRequired,useGroupMentions:C().bool.isRequired,setShowPreview:C().func.isRequired,shouldShowPreview:C().bool.isRequired,getChannelMemberCountsByGroup:C().func.isRequired,groupsWithAllowReference:C().object,channelMemberCountsByGroup:C().object,onHeightChange:C().func});const ve=(0,$.ZP)(_e),ye=(0,n.connect)((function(){const e=(0,o.Jf)(w.V8.MESSAGE_TYPES.COMMENT);return(t,s)=>{const n=t.requests.posts.createPost.error||{},a=(0,F.HG)(t,u.hC.COMMENT_DRAFT,s.rootId),i=0!==a.message.trim().length||0!==a.fileInfos.length,o=(0,l.e7)(t)[s.channelId]?(0,l.e7)(t)[s.channelId].member_count:1,c=e(t),h=t.entities.channels.channels[s.channelId]||{},p=(0,N.iE)(t),m=(0,N.lJ)(t),g="true"===p.EnableConfirmNotificationsToChannel,f="true"===p.EnableEmojiPicker,E="true"===p.EnableGifPicker,C=(0,L.S)(t)>1,b="true"===p.ExperimentalTimezone,_=(0,R.Ai)(t,{channel:h.id,team:h.team_id,permission:w.Pl.CREATE_POST}),v=(0,R.Ai)(t,{channel:h.id,team:h.team_id,permission:w.Pl.USE_CHANNEL_MENTIONS}),y="true"===(null==m?void 0:m.IsLicensed)&&"true"===(null==m?void 0:m.LDAPGroups)&&(0,R.Ai)(t,{channel:h.id,team:h.team_id,permission:w.Pl.USE_GROUP_MENTIONS}),M=(0,l.am)(t,s.channelId),P=y?(0,O.mK)(t,h.team_id,h.id):null;return{draft:a,messageInHistory:c,enableAddButton:i,channelMembersCount:o,codeBlockOnCtrlEnter:(0,d.o4)(t,w.uP.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter",!0),ctrlSend:(0,d.o4)(t,w.uP.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),createPostErrorId:n.server_error_id,readOnlyChannel:!(0,r.BW)(t)&&"true"===p.ExperimentalTownSquareIsReadOnly&&h.name===u.gT.DEFAULT_CHANNEL,enableConfirmNotificationsToChannel:g,enableEmojiPicker:f,enableGifPicker:E,locale:(0,A.B)(t),maxPostSize:parseInt(p.MaxPostSize,10)||u.gT.DEFAULT_CHARACTER_LIMIT,rhsExpanded:(0,F.OZ)(t),badConnection:C,isTimezoneEnabled:b,selectedPostFocussedAt:(0,F.Om)(t),canPost:_,useChannelMentions:v,shouldShowPreview:(0,J.xI)(t),groupsWithAllowReference:P,useGroupMentions:y,channelMemberCountsByGroup:M}}}),(function(){let e,t,s,n,l,c,d,p;function g(){return(0,h.Ot)(w.V8.MESSAGE_TYPES.COMMENT)}return(f,E)=>(c!==E.rootId&&(e=function(e){return t=>Y(e,t)}(E.rootId),s=W(E.rootId,-1),n=W(E.rootId,1)),c===E.rootId&&d===E.channelId||(l=function(e,t){const s=function(e,t){return(0,k.P1)(r.rc,(t=>(0,o.T$)(t,e)),(e=>t=>(0,o.xl)(e,t)),((e,s,n)=>{let a=null;if(!s)return a;for(const i of s){const s=n(i)||{};if(!(s.user_id!==e||s.props&&s.props.from_webhook||s.state===u.gT.POST_DELETED||s.type&&s.type.startsWith(u.gT.SYSTEM_MESSAGE_PREFIX)||(0,D.ZK)(s))){if(!t){a=s;break}if(s.root_id===t||s.id===t){a=s;break}}}return a}))}(e,t),n=(0,o.U6)();return()=>(e,t)=>{const a=t(),i=s(a);return i?e(Z.Jp(i.id,n(a,{post:i}),"reply_textbox",m._u("create_comment.commentTitle","Comment"),!0)):{data:!1}}}(E.channelId,E.rootId)),c===E.rootId&&d===E.channelId&&p===E.latestPostId||(t=function(e,t,s){return(n={})=>async(a,r)=>{const o=(0,F.HG)(r(),u.hC.COMMENT_DRAFT,t),{message:l}=o;a((0,h.$s)(l)),a(Y(t,null));const c=m.oL.exec(l),d=(0,x.RH)(r()),p=new U.Z(d);var g,f,E;c&&p.has(c[2])?a((g=s,f=c[1],E=c[2],e=>{"+"===f?e(Z.rU(g,E)):"-"===f&&e((0,h.WO)(g,E))})):0!==l.indexOf("/")||n.ignoreSlash?a(z(e,t,o)):await a(function(e,t,s){return async(n,a)=>{const r=a(),o=(0,i.ev)(r);let l={channel_id:e,team_id:o,root_id:t,parent_id:t},{message:c}=s;const d=await n((0,q.J)(c,l));if(d.error)return{error:d.error};if(!d.data.message&&!d.data.args)return{};c=d.data.message,l=d.data.args;const{error:h}=await n((0,H.P)(c,l));if(h){if(h.sendMessage)return n(z(e,t,s));throw h}return{}}}(e,t,o))}}(E.channelId,E.rootId,E.latestPostId)),c=E.rootId,d=E.channelId,p=E.latestPostId,(0,a.bindActionCreators)({clearCommentDraftUploads:K,onUpdateCommentDraft:e,updateCommentDraftWithRootId:Y,onSubmit:t,onResetHistoryIndex:g,onMoveHistoryIndexBack:s,onMoveHistoryIndexForward:n,onEditLatestPost:l,resetCreatePostRequest:h.aw,getChannelTimezones:I.ng,emitShortcutReactToLastPostFrom:Z.id,setShowPreview:X.yx,getChannelMemberCountsByGroup:I.am},f))}),null,{forwardRef:!0})(ve);var Me=s(35995),Pe=s(6171),we=s(76908),Se=s(49801);const Te=[Se.ap.aS,Se.ap.o$];class Ne extends v.PureComponent{render(){const{isMobile:e,createAt:t,isScrolling:s,isRhsPost:n,toastPresent:a}=this.props;if(!e||0===t)return null;const i=P()("post-list__timestamp",{scrolling:s,rhs:n,toastAdjustment:a});return v.createElement("div",{className:i,"data-testid":"floatingTimestamp"},v.createElement("div",null,v.createElement("span",null,v.createElement(Se.ZP,{value:t,useTime:!1,ranges:Te}))))}}var Re,Ie,Oe;Re=Ne,Ie="propTypes",Oe={isScrolling:C().bool.isRequired,isMobile:C().bool.isRequired,createAt:C().oneOfType([C().instanceOf(Date),C().number]).isRequired,toastPresent:C().bool.isRequired,isRhsPost:C().bool},Ie in Re?Object.defineProperty(Re,Ie,{value:Oe,enumerable:!0,configurable:!0,writable:!0}):Re[Ie]=Oe;const Le=(0,n.connect)((function(e,t){let s=t.postId;if(Pe.mM(s)){const e=Pe.v0(s);s=e[e.length-1]}const n=(0,o.xl)(e,s),a=(0,we.E)(e);return{createAt:n?n.create_at:0,toastPresent:a}}))(Ne);var Ae=s(51),ke=s(21226),xe=s(47667),De=s(19728),Ze=s(38373),He=s(75515),qe=s(15558),je=s(30529);function Ue(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function Fe(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Be extends v.PureComponent{constructor(...e){super(...e),Fe(this,"retryPost",(e=>{e.preventDefault();const t=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(s),!0).forEach((function(t){Fe(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ue(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},this.props.post);Reflect.deleteProperty(t,"id"),this.props.actions.createPost(t)})),Fe(this,"cancelPost",(e=>{e.preventDefault(),this.props.actions.removePost(this.props.post)}))}render(){return v.createElement("span",{className:"pending-post-actions"},v.createElement("a",{className:"post-retry",href:"#",onClick:this.retryPost},v.createElement(Q.Z,{id:"pending_post_actions.retry",defaultMessage:"Retry"}))," - ",v.createElement("a",{className:"post-cancel",href:"#",onClick:this.cancelPost},v.createElement(Q.Z,{id:"pending_post_actions.cancel",defaultMessage:"Cancel"})))}}Fe(Be,"propTypes",{actions:C().shape({createPost:C().func.isRequired,removePost:C().func.isRequired}).isRequired});const Ge=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({createPost:Z.qb,removePost:h.M8},e)}}))(Be);var Ve=s(16242),Ke=s(42897),Ye=s(2015),We=s(80020);function ze(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Je extends v.PureComponent{constructor(...e){super(...e),ze(this,"handleAddEmoji",(e=>{this.setState({showEmojiPicker:!1});const t=e.name||e.aliases[0];this.props.actions.addReaction(this.props.postId,t),this.props.toggleEmojiPicker()}))}render(){const{channelId:e,location:t,postId:s,showEmojiPicker:n,teamId:a}=this.props;let i,r;return t!==u.tY.RHS_ROOT&&t!==u.tY.RHS_COMMENT||(i=re.Z.RHS_SPACE_REQUIRED_ABOVE,r=re.Z.RHS_SPACE_REQUIRED_BELOW),v.createElement(We.Z,{channelId:e,teamId:a,permissions:[Ye.Z.ADD_REACTION]},v.createElement(v.Fragment,null,v.createElement(re.Z,{show:n,target:this.props.getDotMenuRef,onHide:this.props.toggleEmojiPicker,onEmojiClose:this.props.toggleEmojiPicker,onEmojiClick:this.handleAddEmoji,topOffset:-7,spaceRequiredAbove:i,n:!0,spaceRequiredBelow:r}),v.createElement(qe.Z,{className:"hidden-xs",delayShow:500,placement:"top",overlay:v.createElement(De.Z,{id:"reaction-icon-tooltip",className:"hidden-xs"},v.createElement(Q.Z,{id:"post_info.tooltip.add_reactions",defaultMessage:"Add Reaction"}))},v.createElement("button",{"data-testid":"post-reaction-emoji-icon",id:"".concat(t,"_reaction_").concat(s),"aria-label":(0,m._u)("post_info.tooltip.add_reactions","Add Reaction").toLowerCase(),className:P()("post-menu__item","post-menu__item--reactions",{"post-menu__item--active":n}),onClick:this.props.toggleEmojiPicker},v.createElement(he.Z,{className:"icon icon--small"})))))}}ze(Je,"propTypes",{channelId:C().string,postId:C().string.isRequired,teamId:C().string.isRequired,getDotMenuRef:C().func.isRequired,location:C().oneOf(["CENTER","RHS_ROOT","RHS_COMMENT"]),showEmojiPicker:C().bool,toggleEmojiPicker:C().func.isRequired,actions:C().shape({addReaction:C().func.isRequired}).isRequired}),ze(Je,"defaultProps",{location:u.tY.CENTER,showEmojiPicker:!1});const Xe=(0,n.connect)(null,(function(e){return{actions:(0,a.bindActionCreators)({addReaction:Z.rU},e)}}))(Je);var Qe=s(3601),$e=s(78910),et=s(36141);function tt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class st extends v.PureComponent{constructor(e){super(e),tt(this,"addReactionButtonRef",v.createRef()),tt(this,"getTarget",(()=>this.addReactionButtonRef.current)),tt(this,"handleEmojiClick",(e=>{this.setState({showEmojiPicker:!1});const t=(0,Qe.Vi)(e)?e.name:e.aliases[0];this.props.actions.addReaction(this.props.post.id,t)})),tt(this,"hideEmojiPicker",(()=>{this.setState({showEmojiPicker:!1})})),tt(this,"toggleEmojiPicker",(()=>{this.setState({showEmojiPicker:!this.state.showEmojiPicker})})),this.state={showEmojiPicker:!1}}render(){const e=new Map,t=[];if(this.props.reactions)for(const s of Object.values(this.props.reactions)){const n=s.emoji_name;e.has(n)?e.get(n).push(s):(t.push(n),e.set(n,[s]))}if(0===e.size)return null;const s=t.map((t=>v.createElement($e.Z,{key:t,post:this.props.post,emojiName:t,reactions:e.get(t)||[]}))),n=this.getTarget();let a=15;n&&(a=window.innerWidth-n.getBoundingClientRect().right-260,a<0&&(a=15));let i=null;if(this.props.enableEmojiPicker){const e=v.createElement(De.Z,{id:"addReactionTooltip"},v.createElement(Q.Z,{id:"reaction_list.addReactionTooltip",defaultMessage:"Add a reaction"}));i=v.createElement("span",{className:"emoji-picker__container"},v.createElement(re.Z,{show:this.state.showEmojiPicker,target:this.getTarget,onHide:this.hideEmojiPicker,onEmojiClose:this.hideEmojiPicker,onEmojiClick:this.handleEmojiClick,rightOffset:a,topOffset:-5}),v.createElement(We.Z,{channelId:this.props.post.channel_id,teamId:this.props.teamId,permissions:[Ye.Z.ADD_REACTION]},v.createElement(qe.Z,{placement:"top",delayShow:u.ZP.OVERLAY_TIME_DELAY,overlay:e},v.createElement("button",{"aria-label":(0,m._u)("reaction.add.ariaLabel","Add a reaction"),className:"Reaction",onClick:this.toggleEmojiPicker},v.createElement("span",{id:"addReaction-".concat(this.props.post.id),className:"Reaction__add",ref:this.addReactionButtonRef},v.createElement(et.Z,null))))))}let r="post-add-reaction";return this.state.showEmojiPicker&&(r+=" post-add-reaction-emoji-picker-open"),v.createElement("div",{"aria-label":(0,m._u)("reaction.container.ariaLabel","reactions"),className:"post-reaction-list"},s,v.createElement("div",{className:r},i))}}tt(st,"propTypes",{teamId:C().string.isRequired,enableEmojiPicker:C().bool.isRequired,actions:C().shape({addReaction:C().func.isRequired}).isRequired});const nt=(0,n.connect)((function(){const e=(0,o.r)();return function(t,s){const n="true"===(0,N.iE)(t).EnableEmojiPicker&&!s.isReadOnly;return{teamId:((0,l.mr)(t,s.post.channel_id)||{}).team_id,reactions:e(t,s.post.id),enableEmojiPicker:n}}}),(function(e){return{actions:(0,a.bindActionCreators)({addReaction:Z.rU},e)}}))(st);var at=s(80562),it=s(35856);function rt({post:e,previewCollapsed:t,previewEnabled:s,isEmbedVisible:n,pluginPostTypes:a}){const i=e.type&&a.hasOwnProperty(e.type);let r;const o=v.createElement(it.Z,{post:e,isRHS:!0,hasMention:!0});return r=e.state===w.V8.POST_DELETED||i?o:v.createElement(at.Z,{post:e,previewCollapsed:t,previewEnabled:s,isEmbedVisible:n},o),r}var ot=s(54300),lt=s(17189),ct=s(971),dt=s(46098),ht=s(20528),pt=s(68403);function ut(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function mt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(s),!0).forEach((function(t){gt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ut(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function gt(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ft extends v.PureComponent{constructor(e){super(e),gt(this,"handleShortcutReactToLastPost",(e=>{if(e){const{isReadOnly:e,channelIsArchived:t,enableEmojiPicker:s,post:n,actions:{emitShortcutReactToLastPostFrom:a}}=this.props;a(u.tY.NO_WHERE);const i=n&&n.state===w.V8.POST_DELETED,r=n&&(0,D.Kx)(n),o=n&&ne.Ew(n),l=n&&ne.zj(n),c=n&&n.failed,d=this.postHeaderRef.current.getBoundingClientRect();!(d.top-110>0&&d.bottom<window.innerHeight)||r||o||e||c||l||i||t||(0,m.tq)()||!s||this.setState({hover:!0},(()=>{this.toggleEmojiPicker()}))}})),gt(this,"removePost",(()=>{this.props.removePost(this.props.post)})),gt(this,"createRemovePostButton",(()=>v.createElement("button",{className:"post__remove theme color--link style--none",type:"button",onClick:this.removePost},"×"))),gt(this,"renderPostTime",(()=>{const e=this.props.post,t=!(w.V8.POST_DELETED===e.state||(0,D.ZK)(e));return v.createElement(Ke.Z,{isPermalink:t,eventTime:e.create_at,postId:e.id,location:u.tY.RHS_COMMENT,timestampProps:mt(mt({},this.props.timestampProps),{},{style:this.props.isConsecutivePost&&!this.props.compactDisplay?"narrow":void 0})})})),gt(this,"toggleEmojiPicker",(()=>{const e=!this.state.showEmojiPicker;this.setState({showEmojiPicker:e})})),gt(this,"getClassName",((e,t,s)=>{let n="post post--thread same--root post--comment";return this.props.currentUserId===e.user_id&&(n+=" current--user"),(t||s)&&(n+=" post--system"),this.props.compactDisplay&&(n+=" post--compact"),(this.state.dropdownOpened||this.state.showEmojiPicker)&&(n+=" post--hovered"),this.props.isConsecutivePost&&(n+=" same--user"),this.state.alt&&!this.props.channelIsArchived&&(n+=" cursor--pointer"),n})),gt(this,"handleAlt",(e=>{this.state.alt!==e.altKey&&this.setState({alt:e.altKey})})),gt(this,"handleDropdownOpened",(e=>{this.setState({dropdownOpened:e})})),gt(this,"getDotMenuRef",(()=>this.dotMenuRef.current)),gt(this,"setHover",(()=>{this.setState({hover:!0})})),gt(this,"unsetHover",(()=>{this.setState({hover:!1})})),gt(this,"handleA11yActivateEvent",(()=>{this.setState({a11yActive:!0})})),gt(this,"handleA11yDeactivateEvent",(()=>{this.setState({a11yActive:!1})})),gt(this,"handlePostClick",(e=>{this.props.channelIsArchived||e.altKey&&this.props.actions.markPostAsUnread(this.props.post,"RHS_COMMENT")})),gt(this,"handlePostFocus",(()=>{this.updateAriaLabel()})),gt(this,"updateAriaLabel",(()=>{const{post:e,author:t,reactions:s,isFlagged:n,intl:a,emojiMap:i}=this.props;this.setState({currentAriaLabel:ne.XN(e,t,n,s,a,i)})})),this.postRef=v.createRef(),this.dotMenuRef=v.createRef(),this.state={showEmojiPicker:!1,dropdownOpened:!1,alt:!1,hover:!1,a11yActive:!1,currentAriaLabel:""},this.postHeaderRef=v.createRef()}componentDidMount(){document.addEventListener("keydown",this.handleAlt),document.addEventListener("keyup",this.handleAlt),this.postRef.current&&(this.postRef.current.addEventListener(u.sp.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.addEventListener(u.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}componentWillUnmount(){document.removeEventListener("keydown",this.handleAlt),document.removeEventListener("keyup",this.handleAlt),this.postRef.current&&(this.postRef.current.removeEventListener(u.sp.ACTIVATE,this.handleA11yActivateEvent),this.postRef.current.removeEventListener(u.sp.DEACTIVATE,this.handleA11yDeactivateEvent))}componentDidUpdate(e){const{shortcutReactToLastPostEmittedFrom:t,isLastPost:s}=this.props;this.state.a11yActive&&this.postRef.current.dispatchEvent(new Event(u.sp.UPDATE)),e.shortcutReactToLastPostEmittedFrom!==t&&t===u.tY.RHS_ROOT&&this.handleShortcutReactToLastPost(s),this.props.post.state===w.V8.POST_DELETED&&e.post.state!==w.V8.POST_DELETED&&this.updateAriaLabel()}render(){const{post:e,isConsecutivePost:t,isReadOnly:s,channelIsArchived:n}=this.props,a=e&&e.state===w.V8.POST_DELETED,i=(0,D.Kx)(e),r=ne.Ew(e),o=(0,D.L9)(e),l=ne.zj(e);let c,d,h,p,g=null;(this.props.compactDisplay||(0,m.tq)())&&(g=v.createElement(ht.Z,{userId:e.user_id,channelId:e.channel_id,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0})),t||(g=v.createElement(ht.Z,{userId:e.user_id,channelId:e.channel_id,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0}),d=v.createElement(je.Z,{compactDisplay:this.props.compactDisplay,isBusy:this.props.isBusy,isRHS:!0,post:e,userId:e.user_id,channelId:e.channel_id}),e.props&&e.props.from_webhook?(g=e.props.override_username&&this.props.enablePostUsernameOverride?v.createElement(ht.Z,{userId:e.user_id,channelId:e.channel_id,hideStatus:!0,overwriteName:e.props.override_username,disablePopover:!0}):v.createElement(ht.Z,{userId:e.user_id,channelId:e.channel_id,hideStatus:!0,disablePopover:!0}),c=v.createElement(ot.Z,{className:"col col__name"})):l?(g=v.createElement("span",{className:"auto-responder"},v.createElement(ht.Z,{userId:e.user_id,channelId:e.channel_id,hideStatus:!0,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0})),c=v.createElement(lt.Z,{className:"col col__name"},v.createElement(Q.Z,{id:"post_info.auto_responder",defaultMessage:"AUTOMATIC REPLY"}))):r&&this.props.isBot?(g=v.createElement(ht.Z,{userId:e.user_id,channelId:e.channel_id,hideStatus:!0}),h=v.createElement("span",{className:"post__visibility"},v.createElement(Q.Z,{id:"post_info.message.visible",defaultMessage:"(Only visible to you)"}))):r&&(g=v.createElement(ht.Z,{overwriteName:v.createElement(Q.Z,{id:"post_info.system",defaultMessage:"System"}),overwriteImage:u.ZP.SYSTEM_MESSAGE_PROFILE_IMAGE,disablePopover:!0,channelId:e.channel_id}),h=v.createElement("span",{className:"post__visibility"},v.createElement(Q.Z,{id:"post_info.message.visible",defaultMessage:"(Only visible to you)"}))));let f="";e.failed&&(f+=" post-failed",p=v.createElement(Ge,{post:this.props.post})),ne.cq(this.props.post)&&(f+=" post--edited");let E,C=null;e.file_ids&&e.file_ids.length>0&&(C=v.createElement(He.Z,{post:e,compactDisplay:this.props.compactDisplay})),s||i||e.failed||r||!this.props.enableEmojiPicker||n||(E=v.createElement(Xe,{channelId:e.channel_id,postId:e.id,teamId:this.props.teamId,getDotMenuRef:this.getDotMenuRef,location:u.tY.RHS_COMMENT,showEmojiPicker:this.state.showEmojiPicker,toggleEmojiPicker:this.toggleEmojiPicker}));let b,_=null;if((0,m.tq)()||i||e.failed||r||(_=v.createElement(Ve.Z,{location:u.tY.RHS_COMMENT,postId:e.id,isFlagged:this.props.isFlagged})),i)b=v.createElement("div",{className:"col col__remove"},this.createRemovePostButton());else if(a)b=null;else if(!r&&((0,m.tq)()||this.state.hover||this.state.a11yActive||this.state.dropdownOpened||this.state.showEmojiPicker)){const e=v.createElement(Ze.Z,{post:this.props.post,location:u.tY.RHS_COMMENT,isFlagged:this.props.isFlagged,handleDropdownOpened:this.handleDropdownOpened,handleAddReactionClick:this.toggleEmojiPicker,isReadOnly:s||n,isMenuOpen:this.state.dropdownOpened,enableEmojiPicker:this.props.enableEmojiPicker});b=v.createElement("div",{ref:this.dotMenuRef,className:"col post-menu"},e,E,_)}const y=this.renderPostTime();let M,P;return e.props&&e.props.card&&(M=v.createElement(qe.Z,{delayShow:u.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:v.createElement(De.Z,null,v.createElement(Q.Z,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},v.createElement("button",{className:"card-icon__container icon--show style--none",onClick:e=>{e.preventDefault(),this.props.handleCardClick(this.props.post)}},v.createElement(ct.Z,{className:"icon icon__info","aria-hidden":"true"})))),r||(P=v.createElement(pt.Z,{userID:e.user_id,showTooltip:!0,emojiSize:14,emojiStyle:{marginLeft:4,marginTop:1}})),v.createElement("div",{role:"listitem",ref:this.postRef,id:"rhsPost_"+e.id,tabIndex:"-1",className:"a11y__section ".concat(this.getClassName(e,r,o)),onClick:this.handlePostClick,onMouseOver:this.setHover,onMouseLeave:this.unsetHover,"aria-label":this.state.currentAriaLabel,onFocus:this.handlePostFocus,"data-a11y-sort-order":this.props.a11yIndex},v.createElement(dt.Z,{isFlagged:this.props.isFlagged,isPinned:e.is_pinned,channelId:e.channel_id}),v.createElement("div",{role:"application",className:"post__content"},v.createElement("div",{className:"post__img"},d),v.createElement("div",null,v.createElement("div",{className:"post__header",ref:this.postHeaderRef},v.createElement("div",{className:"col col__name"},g,c,P),v.createElement("div",{className:"col"},y,M,h),b),v.createElement("div",{className:"post__body"},v.createElement("div",{className:f},p,v.createElement(rt,{post:e,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,isEmbedVisible:this.props.isEmbedVisible,pluginPostTypes:this.props.pluginPostTypes})),C,v.createElement(nt,{post:e,isReadOnly:s||n})))))}}gt(ft,"propTypes",{post:C().object,teamId:C().string.isRequired,currentUserId:C().string.isRequired,compactDisplay:C().bool,author:C().string,reactions:C().object,isFlagged:C().bool.isRequired,isBusy:C().bool,removePost:C().func.isRequired,previewCollapsed:C().string.isRequired,previewEnabled:C().bool.isRequired,isEmbedVisible:C().bool,enableEmojiPicker:C().bool.isRequired,enablePostUsernameOverride:C().bool.isRequired,isReadOnly:C().bool.isRequired,pluginPostTypes:C().object,channelIsArchived:C().bool.isRequired,isConsecutivePost:C().bool,handleCardClick:C().func,a11yIndex:C().number,isBot:C().bool.isRequired,isLastPost:C().bool,shortcutReactToLastPostEmittedFrom:C().string,intl:se.gm.isRequired,actions:C().shape({markPostAsUnread:C().func.isRequired,emitShortcutReactToLastPostFrom:C().func}),emojiMap:C().object.isRequired,timestampProps:C().object});const Et=(0,$.ZP)(ft);function Ct(e,t){const s=t.post,n=t.previousPostId&&(0,o.xl)(e,t.previousPostId);let a=!1;if(n){const e=Boolean(s.props&&s.props.from_webhook),t=Boolean(n.props&&n.props.from_webhook);!(n&&n.user_id===s.user_id&&s.create_at-n.create_at<=w.V8.POST_COLLAPSE_TIMEOUT)||e||t||(0,D.Ew)(s)||(0,D.Ew)(n)||n.root_id!==s.root_id&&n.id!==s.root_id||(a=!0)}return a}const bt=(0,n.connect)((function(e,t){const s=(0,o.r)(),n=(0,r.RX)(),a=(0,ke.kM)(e),c=(0,N.iE)(e),h="true"===c.EnableEmojiPicker,p="true"===c.EnablePostUsernameOverride,m=t.teamId||(0,i.ev)(e),g=e.entities.channels.channels[t.post.channel_id],f=(0,ke.dj)(e),E=(0,r.PR)(e,t.post.user_id),C=Boolean(E&&E.is_bot);return{author:n(e,t.post.user_id),reactions:s(e,t.post.id),enableEmojiPicker:h,enablePostUsernameOverride:p,isEmbedVisible:(0,Ae.Y_)(e,t.post.id),isReadOnly:(0,l.hV)(e,t.post.channel_id),teamId:m,pluginPostTypes:e.plugins.postTypes,channelIsArchived:(0,xe.t2)(g),isConsecutivePost:Ct(e,t),isFlagged:null!=(0,d.U2)(e,u.uP.CATEGORY_FLAGGED_POST,t.post.id,null),compactDisplay:(0,d.U2)(e,u.uP.CATEGORY_DISPLAY_SETTINGS,u.uP.MESSAGE_DISPLAY,u.uP.MESSAGE_DISPLAY_DEFAULT)===u.uP.MESSAGE_DISPLAY_COMPACT,shortcutReactToLastPostEmittedFrom:f,emojiMap:a,isBot:C}}),(function(e){return{actions:(0,a.bindActionCreators)({markPostAsUnread:Z.VW,emitShortcutReactToLastPostFrom:Z.id},e)}}))(Et);function _t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class vt extends v.PureComponent{constructor(e){super(e),_t(this,"handleShortcutReactToLastPost",(e=>{if(e){const{post:t,enableEmojiPicker:s,channelIsArchived:n,actions:{emitShortcutReactToLastPostFrom:a}}=this.props;a(u.tY.NO_WHERE);const i=t&&t.state===w.V8.POST_DELETED,r=t&&m.Kx(t),o=t&&ne.Ew(t),l=t&&t.failed,c=t&&t.type===u.ZP.PostTypes.FAKE_PARENT_DELETED,d=this.postHeaderRef.current.getBoundingClientRect();d.top-110>0&&d.bottom<window.innerHeight&&(r||o||i||l||m.tq()||n||c||!s||this.toggleEmojiPicker(e))}})),_t(this,"renderPostTime",(e=>{const t=this.props.post;if(t.type===u.ZP.PostTypes.FAKE_PARENT_DELETED)return null;const s=!(e||w.V8.POST_DELETED===t.state||D.ZK(t));return v.createElement(Ke.Z,{isPermalink:s,eventTime:t.create_at,postId:t.id,location:u.tY.RHS_ROOT,timestampProps:this.props.timestampProps})})),_t(this,"toggleEmojiPicker",(()=>{const e=!this.state.showEmojiPicker;this.setState({showEmojiPicker:e})})),_t(this,"getClassName",((e,t,s)=>{let n="post post--root post--thread";return this.props.currentUserId===e.user_id&&(n+=" current--user"),(t||s)&&(n+=" post--system"),this.props.compactDisplay&&(n+=" post--compact"),(this.state.dropdownOpened||this.state.showEmojiPicker)&&(n+=" post--hovered"),this.state.alt&&!this.props.channelIsArchived&&(n+=" cursor--pointer"),n})),_t(this,"handleAlt",(e=>{this.state.alt!==e.altKey&&this.setState({alt:e.altKey})})),_t(this,"handleDropdownOpened",(e=>{this.setState({dropdownOpened:e})})),_t(this,"handlePostClick",(e=>{this.props.channelIsArchived||e.altKey&&this.props.actions.markPostAsUnread(this.props.post,"RHS_ROOT")})),_t(this,"handlePostFocus",(()=>{const{post:e,author:t,reactions:s,isFlagged:n,emojiMap:a}=this.props;this.setState({currentAriaLabel:ne.XN(e,t,n,s,this.props.intl,a)})})),_t(this,"getDotMenuRef",(()=>this.dotMenuRef.current)),this.state={alt:!1,showEmojiPicker:!1,testStateObj:!0,dropdownOpened:!1,currentAriaLabel:""},this.postHeaderRef=v.createRef(),this.dotMenuRef=v.createRef()}componentDidMount(){document.addEventListener("keydown",this.handleAlt),document.addEventListener("keyup",this.handleAlt)}componentWillUnmount(){document.removeEventListener("keydown",this.handleAlt),document.removeEventListener("keyup",this.handleAlt)}componentDidUpdate(e){const{shortcutReactToLastPostEmittedFrom:t,isLastPost:s}=this.props;e.shortcutReactToLastPostEmittedFrom!==t&&t===u.tY.RHS_ROOT&&this.handleShortcutReactToLastPost(s)}render(){const{post:e,isReadOnly:t,teamId:s,channelIsArchived:n}=this.props,a=e&&e.state===w.V8.POST_DELETED,i=m.Kx(e),r=ne.Ew(e),o=D.L9(e);let l;t||i||e.failed||r||!this.props.enableEmojiPicker||n||(l=v.createElement(Xe,{channelId:e.channel_id,postId:e.id,teamId:s,getDotMenuRef:this.getDotMenuRef,location:u.tY.RHS_ROOT,showEmojiPicker:this.state.showEmojiPicker,toggleEmojiPicker:this.toggleEmojiPicker}));let c,d,h=null;e.file_ids&&e.file_ids.length>0&&(h=v.createElement(He.Z,{post:e,compactDisplay:this.props.compactDisplay})),r?c=v.createElement(ht.Z,{overwriteName:v.createElement(Q.Z,{id:"post_info.system",defaultMessage:"System"}),overwriteImage:u.ZP.SYSTEM_MESSAGE_PROFILE_IMAGE,disablePopover:!0}):e.props&&e.props.from_webhook?(c=e.props.override_username&&this.props.enablePostUsernameOverride?v.createElement(ht.Z,{key:e.user_id,userId:e.user_id,hideStatus:!0,overwriteName:e.props.override_username,disablePopover:!0}):v.createElement(ht.Z,{key:e.user_id,userId:e.user_id,hideStatus:!0,disablePopover:!0}),d=v.createElement(ot.Z,null)):c=v.createElement(ht.Z,{key:e.user_id,userId:e.user_id,isBusy:this.props.isBusy,isRHS:!0,hasMention:!0});let p="";ne.cq(this.props.post)&&(p+=" post--edited");const g=v.createElement(Ze.Z,{post:this.props.post,location:u.tY.RHS_ROOT,isFlagged:this.props.isFlagged,handleDropdownOpened:this.handleDropdownOpened,handleAddReactionClick:this.toggleEmojiPicker,commentCount:this.props.commentCount,isMenuOpen:this.state.dropdownOpened,isReadOnly:t||n,enableEmojiPicker:this.props.enableEmojiPicker});let f,E,C,b;return!(i||e.failed||r||m.tq())&&(f=v.createElement(Ve.Z,{location:u.tY.RHS_ROOT,postId:e.id,isFlagged:this.props.isFlagged})),a||this.props.post.type===u.ZP.PostTypes.FAKE_PARENT_DELETED||(E=v.createElement("div",{ref:this.dotMenuRef,className:"col post-menu"},g,l,f)),this.props.post.props&&this.props.post.props.card&&(C=v.createElement(qe.Z,{delayShow:u.ZP.OVERLAY_TIME_DELAY,placement:"top",overlay:v.createElement(De.Z,null,v.createElement(Q.Z,{id:"post_info.info.view_additional_info",defaultMessage:"View additional info"}))},v.createElement("button",{className:"card-icon__container icon--show style--none",onClick:e=>{e.preventDefault(),this.props.handleCardClick(this.props.post)}},v.createElement(ct.Z,{className:"icon icon__info","aria-hidden":"true"})))),r||(b=v.createElement(pt.Z,{userID:e.user_id,showTooltip:!0,emojiSize:14,emojiStyle:{marginLeft:4,marginTop:1}})),v.createElement("div",{role:"listitem",id:"rhsPost_"+e.id,tabIndex:"-1",className:"thread__root a11y__section ".concat(this.getClassName(e,r,o)),"aria-label":this.state.currentAriaLabel,onClick:this.handlePostClick,onFocus:this.handlePostFocus,"data-a11y-sort-order":"0"},v.createElement(dt.Z,{isFlagged:this.props.isFlagged,isPinned:e.is_pinned,channelId:e.channel_id}),v.createElement("div",{role:"application",className:"post__content"},v.createElement("div",{className:"post__img"},v.createElement(je.Z,{compactDisplay:this.props.compactDisplay,isBusy:this.props.isBusy,isRHS:!0,post:e,userId:e.user_id,channelId:e.channel_id})),v.createElement("div",null,v.createElement("div",{className:"post__header",ref:this.postHeaderRef},v.createElement("div",{className:"col__name"},c,d,b),v.createElement("div",{className:"col"},this.renderPostTime(i),C),E),v.createElement("div",{className:"post__body"},v.createElement("div",{className:p},v.createElement(rt,{post:e,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,isEmbedVisible:this.props.isEmbedVisible,pluginPostTypes:this.props.pluginPostTypes})),h,v.createElement(nt,{post:e,isReadOnly:t||n})))))}}_t(vt,"propTypes",{post:C().object.isRequired,teamId:C().string.isRequired,currentUserId:C().string.isRequired,compactDisplay:C().bool,commentCount:C().number.isRequired,author:C().string,reactions:C().object,isFlagged:C().bool.isRequired,previewCollapsed:C().string,previewEnabled:C().bool,isBusy:C().bool,isEmbedVisible:C().bool,enableEmojiPicker:C().bool.isRequired,enablePostUsernameOverride:C().bool.isRequired,isReadOnly:C().bool.isRequired,pluginPostTypes:C().object,channelIsArchived:C().bool.isRequired,handleCardClick:C().func.isRequired,isLastPost:C().bool,shortcutReactToLastPostEmittedFrom:C().string,intl:se.gm.isRequired,actions:C().shape({markPostAsUnread:C().func.isRequired,emitShortcutReactToLastPostFrom:C().func}),emojiMap:C().object.isRequired,timestampProps:C().object}),_t(vt,"defaultProps",{commentCount:0});const yt=(0,$.ZP)(vt),Mt=(0,n.connect)((function(e,t){const s=(0,o.r)(),n=(0,r.RX)(),a=(0,N.iE)(e),c="true"===a.EnableEmojiPicker,h="true"===a.EnablePostUsernameOverride,p=t.teamId||(0,i.ev)(e),m=(0,l.mr)(e,t.post.channel_id),g=(0,ke.kM)(e),f=(0,ke.dj)(e);return{author:n(e,t.post.user_id),reactions:s(e,t.post.id),emojiMap:g,enableEmojiPicker:c,enablePostUsernameOverride:h,isEmbedVisible:(0,Ae.Y_)(e,t.post.id),isReadOnly:(0,l.hV)(e,t.post.channel_id),teamId:p,pluginPostTypes:e.plugins.postTypes,channelIsArchived:(0,xe.t2)(m),isFlagged:null!=(0,d.U2)(e,u.uP.CATEGORY_FLAGGED_POST,t.post.id,null),compactDisplay:(0,d.U2)(e,u.uP.CATEGORY_DISPLAY_SETTINGS,u.uP.MESSAGE_DISPLAY,u.uP.MESSAGE_DISPLAY_DEFAULT)===u.uP.MESSAGE_DISPLAY_COMPACT,shortcutReactToLastPostEmittedFrom:f}}),(function(e){return{actions:(0,a.bindActionCreators)({markPostAsUnread:Z.VW,emitShortcutReactToLastPostFrom:Z.id},e)}}))(yt);function Pt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function wt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(s),!0).forEach((function(t){St(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Pt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function St(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Tt=wt(wt({},s(96329)._),{},{units:["now","minute","hour","day","week","month","year"]});function Nt(e){return v.createElement("div",Object.assign({},e,{className:"scrollbar--view"}))}function Rt(){return v.createElement("div",null)}function It(e){return v.createElement("div",Object.assign({},e,{className:"scrollbar--vertical"}))}class Ot extends v.Component{static getDerivedStateFromProps(e,t){let s={selected:e.selected};return t.selected&&e.selected&&t.selected.id!==e.selected.id&&(s=wt(wt({},s),{},{openTime:(new Date).getTime()})),s}constructor(e){super(e),St(this,"scrollStopAction",void 0),St(this,"rhspostlistRef",void 0),St(this,"containerRef",void 0),St(this,"postCreateContainerRef",void 0),St(this,"handleResize",(()=>{this.setState({windowWidth:m.bn(),windowHeight:m.uK()}),T.tq()&&"reply_textbox"===document.activeElement.id&&this.scrollToBottom(),this.resizeRhsPostList()})),St(this,"handleCardClick",(e=>{e&&this.props.actions.selectPostCard(e)})),St(this,"handleCardClickPost",(e=>{e&&this.props.actions.selectPostCard(e)})),St(this,"filterPosts",((e,t,s)=>{const n=[];return e.forEach((e=>{"system_ephemeral"===e.type&&e.create_at<s||e.root_id===t.id&&n.unshift(e)})),n})),St(this,"scrollToBottom",(()=>{_()(".post-right__scroll")[0]&&_()(".post-right__scroll").parent().scrollTop(_()(".post-right__scroll")[0].scrollHeight)})),St(this,"updateFloatingTimestamp",(()=>{if(m.tq()&&this.props.posts){const e=this.rhspostlistRef.current.childNodes,t=this.rhspostlistRef.current.getBoundingClientRect();let s="";const n=100;for(let a=0;a<e.length;a++)if(e[a].offsetTop+t.top-n>0){s=this.props.posts[a].id;break}s!==this.state.topRhsPostId&&this.setState({topRhsPostId:s})}})),St(this,"handleScroll",(e=>{var t;this.updateFloatingTimestamp();const s=e.target,n=s.scrollHeight-s.getBoundingClientRect().height,a=s.scrollTop,i=null===(t=this.getLastPost())||void 0===t?void 0:t.getBoundingClientRect();if(this.state.isScrolling||this.setState({isScrolling:!0}),i){const e=a>=n-i.height;this.setState({userScrolledToBottom:e})}this.scrollStopAction.fireAfter(u.ZP.SCROLL_DELAY)})),St(this,"handleScrollStop",(()=>{this.setState({isScrolling:!1})})),St(this,"handlePostCommentResize",(()=>{this.resizeRhsPostList(),this.scrollToBottom()})),this.scrollStopAction=new S.Z(this.handleScrollStop);const t=(new Date).getTime();this.state={windowWidth:m.bn(),windowHeight:m.uK(),isScrolling:!1,topRhsPostId:"",openTime:t,postsContainerHeight:0,userScrolledToBottom:!1},this.rhspostlistRef=v.createRef(),this.containerRef=v.createRef(),this.postCreateContainerRef=v.createRef()}getLastPost(){var e;const t=null===(e=this.rhspostlistRef.current)||void 0===e?void 0:e.children;return t&&t[t.length-1]}resizeRhsPostList(){var e,t;const s=null===(e=this.containerRef.current)||void 0===e?void 0:e.getBoundingClientRect().height,n=null===(t=this.postCreateContainerRef.current)||void 0===t?void 0:t.getBoundingClientRect().height;s&&n&&this.setState({postsContainerHeight:s-(n+56)})}componentDidMount(){this.scrollToBottom(),this.resizeRhsPostList(),window.addEventListener("resize",this.handleResize),this.morePostsToFetch()&&this.props.actions.getPostThread(this.props.selected.id,!0),this.props.isCollapsedThreadsEnabled&&(null==this.props.userThread?this.fetchThread():this.markThreadRead())}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}morePostsToFetch(){var e;const t=m.B_(this.props.posts),s=(null==t?void 0:t.reply_count)||(null===(e=this.props.userThread)||void 0===e?void 0:e.reply_count)||0;return t&&this.props.posts.length<s+1}fetchThread(){this.props.actions.getThread(this.props.currentUserId,this.props.currentTeamId,this.props.selected.id,!0)}markThreadRead(){this.props.userThread&&(this.props.userThread.last_viewed_at<this.props.userThread.last_reply_at||this.props.userThread.unread_mentions||this.props.userThread.unread_replies)&&this.props.actions.updateThreadRead(this.props.currentUserId,this.props.currentTeamId,this.props.selected.id,Date.now())}componentDidUpdate(e){var t,s;const n=e.posts||[],a=this.props.posts||[],i=this.props.socketConnectionStatus&&!e.socketConnectionStatus,r=this.props.selected.id!==e.selected.id;(i||r)&&(this.props.actions.getPostThread(this.props.selected.id),this.props.isCollapsedThreadsEnabled&&null==this.props.userThread&&this.fetchThread()),this.props.isCollapsedThreadsEnabled&&(null===(t=this.props.userThread)||void 0===t?void 0:t.id)!==(null===(s=e.userThread)||void 0===s?void 0:s.id)&&this.markThreadRead(),n.length>=a.length||(a[0].user_id===this.props.currentUserId||this.state.userScrolledToBottom)&&this.scrollToBottom()}shouldComponentUpdate(e,t){return!m.JB(t.postsArray,this.props.posts)||!m.JB(t.selected,this.props.selected)||!m.JB(e.userThread,this.props.userThread)||e.previewEnabled!==this.props.previewEnabled||t.isBusy!==this.state.isBusy||t.isScrolling!==this.state.isScrolling||t.topRhsPostId!==this.state.topRhsPostId}render(){if(null==this.props.posts||null==this.props.selected||!this.props.channel)return v.createElement("span",null);const e=this.filterPosts(this.props.posts,this.props.selected,this.state.openTime),t=e.length,{selected:s,currentUserId:n}=this.props;let a=!1,i={};0===t?a=!0:i=e[t-1];let r=s.create_at;!r&&this.props.posts.length>0&&(r=this.props.posts[this.props.posts.length-1].create_at);const o=m.jH(r);let l=o;const c=[];let d,h=1;for(let s=0;s<t;s++){const t=e[s],a=s>0?e[s-1].id:"";if(!this.props.useRelativeTimestamp){const e=m.jH(t.create_at);e.toDateString()!==l.toDateString()&&(l=e,c.push(v.createElement(Me.Z,{key:e.toString(),date:e})))}const r=t.id?t.id:t.pending_post_id;c.push(v.createElement(bt,{key:r+"commentKey",post:t,previousPostId:a,teamId:this.props.channel.team_id,currentUserId:n,isBusy:this.state.isBusy,removePost:this.props.actions.removePost,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,handleCardClick:this.handleCardClickPost,a11yIndex:h++,isLastPost:t.id===i.id,timestampProps:this.props.useRelativeTimestamp?Tt:void 0}))}const p=s.type===u.ZP.PostTypes.FAKE_PARENT_DELETED,g=0!==this.props.channel.delete_at;if(p||(d=g?v.createElement("div",{className:"channel-archived-warning"},v.createElement(me.Z,{id:"archivedChannelMessage",defaultMessage:"You are viewing an **archived channel**. New messages cannot be posted."})):v.createElement("div",{className:"post-create__container",ref:this.postCreateContainerRef},v.createElement(ye,{onHeightChange:this.handlePostCommentResize,channelId:s.channel_id,rootId:s.id,rootDeleted:s.state===w.V8.POST_DELETED,latestPostId:t>0?e[t-1].id:s.id}))),this.props.channel.type===u.ZP.DM_CHANNEL){const e=this.props.directTeammate;e&&e.delete_at&&(d=v.createElement("div",{className:"post-create-message"},v.createElement(me.Z,{id:"create_post.deactivated",defaultMessage:"You are viewing an archived channel with a **deactivated user**. New messages cannot be posted."})))}return v.createElement(v.Fragment,null,v.createElement("div",{className:P()("ThreadViewer",this.props.className),ref:this.containerRef},!this.props.useRelativeTimestamp&&v.createElement(Le,{isScrolling:this.state.isScrolling,isMobile:m.tq(),postId:this.state.topRhsPostId,isRhsPost:!0}),v.createElement(y.ZP,{autoHide:!0,autoHideTimeout:500,autoHideDuration:500,renderThumbHorizontal:Rt,renderThumbVertical:It,autoHeightMax:this.state.postsContainerHeight,renderView:Nt,onScroll:this.handleScroll},v.createElement("div",{className:"post-right__scroll"},v.createElement("div",{role:"application","aria-label":m._u("accessibility.sections.rhsContent","message details complimentary region"),className:"post-right__content a11y__region","data-a11y-sort-order":"3","data-a11y-focus-child":!0,"data-a11y-order-reversed":!0},!this.props.useRelativeTimestamp&&!p&&v.createElement(Me.Z,{date:o}),v.createElement(Mt,{post:s,commentCount:t,teamId:this.props.channel.team_id,currentUserId:this.props.currentUserId,previewCollapsed:this.props.previewCollapsed,previewEnabled:this.props.previewEnabled,isBusy:this.state.isBusy,handleCardClick:this.handleCardClick,isLastPost:a,timestampProps:this.props.useRelativeTimestamp?Tt:void 0}),!this.props.useRelativeTimestamp&&p&&o&&v.createElement(Me.Z,{date:o}),v.createElement("div",{ref:this.rhspostlistRef,className:"post-right-comments-container"},c)),d))))}}St(Ot,"propTypes",{isCollapsedThreadsEnabled:C().bool.isRequired,posts:C().array.isRequired,previousRhsState:C().string,currentUserId:C().string.isRequired,currentTeamId:C().string.isRequired,previewCollapsed:C().string.isRequired,previewEnabled:C().bool.isRequired,socketConnectionStatus:C().bool.isRequired,actions:C().shape({removePost:C().func.isRequired,selectPostCard:C().func.isRequired,getPostThread:C().func.isRequired,getThread:C().func.isRequired,updateThreadRead:C().func.isRequired}).isRequired,useRelativeTimestamp:C().bool});const Lt=(0,n.connect)((function(){const e=(0,o.Zf)();return function(t,{rootPostId:s}){const n=(0,r.rc)(t),a=(0,i.ev)(t),h=(0,o.xl)(t,s),p=(0,l.mr)(t,null==h?void 0:h.channel_id),f=(0,g.L)(t);let E=[],C=null;h&&(E=e(t,{rootId:h.id}),C=(0,c.bJ)(t,h.id));const b=(0,d.U2)(t,u.uP.CATEGORY_DISPLAY_SETTINGS,u.uP.COLLAPSE_DISPLAY,u.uP.COLLAPSE_DISPLAY_DEFAULT);return{isCollapsedThreadsEnabled:(0,d.ym)(t),currentUserId:n,currentTeamId:a,userThread:C,selected:h,channel:p,posts:E,socketConnectionStatus:f.connected,previewCollapsed:b,previewEnabled:(0,d.o4)(t,u.uP.CATEGORY_DISPLAY_SETTINGS,u.uP.LINK_PREVIEW_DISPLAY,"true"===u.uP.LINK_PREVIEW_DISPLAY_DEFAULT),directTeammate:(0,m.PR)(t,null==p?void 0:p.id)}}}),(function(e){return{actions:(0,a.bindActionCreators)({removePost:h.M8,getPostThread:h.ct,selectPostCard:f.Jm,getThread:p.bJ,updateThreadRead:p.bl},e)}}))(Ot)},36141:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s(67294),a=s(86896);function i(e){const{formatMessage:t}=(0,a.Z)();return n.createElement("span",e,n.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",role:"img","aria-label":t({id:"generic_icons.add-reaction",defaultMessage:"Add Reaction Icon"})},n.createElement("path",{d:"M10 8.00001C10.32 8.00001 10.5973 7.88267 10.832 7.64801C11.0773 7.40267 11.2 7.12001 11.2 6.80001C11.2 6.48001 11.0773 6.20267 10.832 5.96801C10.5973 5.72267 10.32 5.60001 10 5.60001C9.68 5.60001 9.39733 5.72267 9.152 5.96801C8.91733 6.20267 8.8 6.48001 8.8 6.80001C8.8 7.12001 8.91733 7.40267 9.152 7.64801C9.39733 7.88267 9.68 8.00001 10 8.00001ZM5.2 8.00001C5.52 8.00001 5.79733 7.88267 6.032 7.64801C6.27733 7.40267 6.4 7.12001 6.4 6.80001C6.4 6.48001 6.27733 6.20267 6.032 5.96801C5.79733 5.72267 5.52 5.60001 5.2 5.60001C4.88 5.60001 4.59733 5.72267 4.352 5.96801C4.11733 6.20267 4 6.48001 4 6.80001C4 7.12001 4.11733 7.40267 4.352 7.64801C4.59733 7.88267 4.88 8.00001 5.2 8.00001ZM13.584 7.93601C13.584 7.97867 13.584 8.05334 13.584 8.16001L13.6 8.40001C13.6 9.48801 13.328 10.496 12.784 11.424C12.2507 12.3307 11.5307 13.0507 10.624 13.584C9.696 14.128 8.688 14.4 7.6 14.4C6.512 14.4 5.504 14.128 4.576 13.584C3.66933 13.0507 2.94933 12.3307 2.416 11.424C1.872 10.496 1.6 9.48801 1.6 8.40001C1.6 7.31201 1.872 6.30401 2.416 5.37601C2.94933 4.46934 3.66933 3.74934 4.576 3.21601C5.504 2.67201 6.512 2.40001 7.6 2.40001L8.064 2.41601C8.17067 1.84001 8.352 1.32801 8.608 0.880006C8.23467 0.826673 7.89867 0.800006 7.6 0.800006C6.224 0.800006 4.944 1.14667 3.76 1.84001C2.61867 2.51201 1.712 3.41867 1.04 4.56001C0.346667 5.74401 0 7.02401 0 8.40001C0 9.77601 0.346667 11.056 1.04 12.24C1.712 13.3813 2.61867 14.288 3.76 14.96C4.944 15.6533 6.224 16 7.6 16C8.976 16 10.256 15.6533 11.44 14.96C12.5813 14.288 13.488 13.3813 14.16 12.24C14.8533 11.056 15.2 9.77601 15.2 8.40001C15.2 8.10134 15.1733 7.76534 15.12 7.39201C14.672 7.64801 14.16 7.82934 13.584 7.93601ZM12 5.72205e-06H13.6V2.40001H16V4.00001H13.6V6.40001H12V4.00001H9.6V2.40001H12V5.72205e-06ZM3.504 10C3.83467 10.832 4.36267 11.504 5.088 12.016C5.84533 12.5387 6.68267 12.8 7.6 12.8C8.51733 12.8 9.35467 12.5387 10.112 12.016C10.8373 11.504 11.3653 10.832 11.696 10H3.504Z"})))}},1823:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s(67294),a=s(86896);function i(e){const{formatMessage:t}=(0,a.Z)();return n.createElement("span",e,n.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",role:"img","aria-label":t({id:"generic_icons.attach",defaultMessage:"Attachment Icon"})},n.createElement("g",{fill:"inherit",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-1029.000000, -954.000000)",fillRule:"nonzero",fill:"inherit"},n.createElement("g",{transform:"translate(25.000000, 937.000000)"},n.createElement("g",{transform:"translate(1004.000000, 17.000000)"},n.createElement("path",{d:"M5.35,15.56 C3.98,15.56 2.61,15.039 1.567,13.997 C0.557,12.984 0,11.642 0,10.212 C0,8.783 0.557,7.44 1.566,6.429 L6.869,1.126 C8.371,-0.376 10.812,-0.375 12.314,1.125 C13.815,2.627 13.815,5.069 12.314,6.57 L7.011,11.873 C6.094,12.792 4.603,12.79 3.687,11.873 C2.771,10.958 2.771,9.467 3.687,8.551 L8.99,3.248 C9.323,2.916 9.861,2.916 10.193,3.248 C10.525,3.579 10.525,4.118 10.193,4.449 L4.89,9.752 C4.637,10.006 4.637,10.418 4.89,10.672 C5.143,10.923 5.555,10.925 5.809,10.672 L11.113,5.369 C11.952,4.53 11.952,3.166 11.113,2.327 C10.276,1.49 8.911,1.488 8.073,2.327 L2.769,7.631 C2.079,8.32 1.699,9.237 1.699,10.212 C1.699,11.188 2.079,12.104 2.768,12.794 C4.19,14.216 6.502,14.216 7.925,12.798 L7.929,12.794 C7.929,12.793 7.929,12.793 7.929,12.793 L15.355,5.369 C15.687,5.037 16.224,5.037 16.556,5.369 C16.888,5.7 16.888,6.239 16.556,6.57 L8.779,14.348 L8.761,14.332 C7.776,15.15 6.562,15.56 5.35,15.56 Z"})))))))}},30685:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s(67294),a=s(86896);function i(e){const{formatMessage:t}=(0,a.Z)();return n.createElement("span",e,n.createElement("svg",{width:"12px",height:"15px",viewBox:"0 0 12 15",role:"img","aria-label":t({id:"generic_icons.flagged",defaultMessage:"Flagged Icon"})},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-1073.000000, -33.000000)",fillRule:"nonzero",fill:"inherit"},n.createElement("g",{transform:"translate(-1.000000, 0.000000)"},n.createElement("g",{transform:"translate(1064.000000, 22.000000)"},n.createElement("g",{transform:"translate(10.000000, 11.000000)"},n.createElement("path",{d:"M9.76172 0.800049H2.23828C1.83984 0.800049 1.48828 0.952393 1.18359 1.25708C0.902344 1.53833 0.761719 1.88989 0.761719 2.31177V14.3L6 12.05L11.2383 14.3V2.31177C11.2383 1.88989 11.0859 1.53833 10.7812 1.25708C10.5 0.952393 10.1602 0.800049 9.76172 0.800049Z"}))))))))}},971:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s(67294),a=s(86896);function i(e){const{formatMessage:t}=(0,a.Z)();return n.createElement("span",e,n.createElement("svg",{className:"svg-text-color","aria-label":t({id:"generic_icons.info",defaultMessage:"Info Icon"}),width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"inherit",fillRule:"evenodd"},n.createElement("g",{transform:"translate(-1015.000000, -516.000000)",fill:"inherit"},n.createElement("path",{d:"M1027,540 C1020.37258,540 1015,534.627417 1015,528 C1015,521.372583 1020.37258,516 1027,516 C1033.62742,516 1039,521.372583 1039,528 C1039,534.627417 1033.62742,540 1027,540 Z M1027,527 C1025.89543,527 1025,527.895431 1025,529 L1025,533 C1025,534.104569 1025.89543,535 1027,535 C1028.10457,535 1029,534.104569 1029,533 L1029,529 C1029,527.895431 1028.10457,527 1027,527 Z M1027,525 C1028.10457,525 1029,524.104569 1029,523 C1029,521.895431 1028.10457,521 1027,521 C1025.89543,521 1025,521.895431 1025,523 C1025,524.104569 1025.89543,525 1027,525 Z"})))))}},12898:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n,a,i,r=s(45697),o=s.n(r),l=s(67294);class c extends l.PureComponent{render(){const{children:e}=this.props;return l.createElement("div",{"data-testid":"basicSeparator",className:"Separator BasicSeparator"},l.createElement("hr",{className:"separator__hr"}),e&&l.createElement("div",{className:"separator__text"},e))}}n=c,a="propTypes",i={children:o().node},a in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i},88771:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c,r:()=>d});var n=s(45697),a=s.n(n),i=(s(19601),s(33948),s(67294)),r=s(19728),o=s(15558);const l=e=>{let{id:t,content:s,children:n,placement:a="top",className:l="hidden-xs",delayShow:c=500,style:d}=e,h=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["id","content","children","placement","className","delayShow","style"]);return i.createElement(o.Z,Object.assign({},h,{delayShow:c,placement:a,overlay:i.createElement(r.Z,{id:t,style:d,className:l,placement:a},s)}),n)};l.propTypes={id:a().string.isRequired,content:a().node.isRequired,children:a().node.isRequired,className:a().string,arrowOffsetTop:a().oneOfType([a().number,a().string])};const c=l;function d(){const[e,t]=(0,i.useState)(!1);return[(0,i.useMemo)((()=>({onEntered:()=>t(!0),animation:!e,delayShow:e?0:void 0})),[e,t]),t]}},12770:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var n=s(45697),a=s.n(n),i=(s(19601),s(33948),s(67294)),r=s(86896),o=s(37703),l=s(17621),c=s.n(l),d=s(89980),h=s(26961),p=s(82251),u=s(74935),m=s(88771),g=s(69632),f=s(18493);const E=(0,d.Pq)();function C(e){let{userId:t,overlayProps:s}=e,n=function(e,t){if(null==e)return{};var s,n,a=function(e,t){if(null==e)return{};var s,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||(a[s]=e[s]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)s=i[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,["userId","overlayProps"]);const a=(0,o.useSelector)((e=>(0,d.PR)(e,t))),r=(0,o.useSelector)((e=>E(e,!0)(a)));return i.createElement(m.Z,Object.assign({id:"name-".concat(t),content:r},s),i.createElement(g.Z,Object.assign({url:(0,u.bb)(t,null==a?void 0:a.last_picture_update),tabIndex:0},n)))}function b({size:e,userIds:t,totalUsers:s,fetchMissingUsers:n=!0}){const{formatMessage:a}=(0,r.Z)(),l=(0,o.useDispatch)(),[u,b]=(0,m.r)(),[_,v,{overflowUnnamedCount:y,nonDisplayCount:M}]=function(e,t=e.length){const s=Math.max(e.length,t)>4?3:4,n=e.slice(0,s),a=e.slice(s),i=Math.max(t-n.length-a.length,0);return[n,a,{overflowUnnamedCount:i,nonDisplayCount:a.length+i}]}(t,s),P=(0,o.useSelector)((e=>v.map((t=>E(e,!0)((0,d.PR)(e,t)))).join(", "))),{centerChannelBg:w,centerChannelColor:S}=(0,o.useSelector)(h.gh),T=(0,i.useMemo)((()=>({background:c().mix(w,S,8).toRgbString()})),[w,S]);return(0,i.useEffect)((()=>{n&&l((0,f.C4)(t))}),[n,t]),i.createElement("div",{className:"Avatars Avatars___".concat(e),onMouseLeave:()=>b(!1)},_.map((t=>i.createElement(C,{style:T,key:t,userId:t,size:e,tabIndex:0,overlayProps:u}))),Boolean(M)&&i.createElement(m.Z,Object.assign({id:"names-overflow"},u,{content:v.length?a({id:(0,p.t)("avatars.overflowUsers"),defaultMessage:"{overflowUnnamedCount, plural, =0 {{names}} =1 {{names} and one other} other {{names} and # others}}"},{overflowUnnamedCount:y,names:P}):a({id:(0,p.t)("avatars.overflowUnnamedOnly"),defaultMessage:"{overflowUnnamedCount, plural, =1 {one other} other {# others}}"},{overflowUnnamedCount:y})}),i.createElement(g.Z,{style:T,size:e,tabIndex:0,text:M>99?"".concat(99,"+"):"+".concat(M)})))}b.propTypes={totalUsers:a().number,breakAt:a().number,fetchMissingUsers:a().bool};const _=(0,i.memo)(b)},10005:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var n=s(37703),a=s(70493),i=s(42560),r=s(85357),o=s(45697),l=s.n(o),c=(s(4723),s(73210),s(67294));const d=/(?:http|https):\/\/(?:www\.|m\.)?(?:(?:youtube\.com\/(?:(?:v\/)|(?:(?:watch|embed\/watch)(?:\/|.*v=))|(?:embed\/)|(?:user\/[^/]+\/u\/[0-9]\/)))|(?:youtu\.be\/))([^#&?]*)/;var h=s(56039);function p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class u extends c.PureComponent{constructor(e){super(e),p(this,"play",(()=>{this.setState({playing:!0})})),p(this,"stop",(()=>{this.setState({playing:!1})})),this.state={playing:!1}}static getDerivedStateFromProps(e,t){return!e.show&&t.playing?{playing:!1}:null}render(){const{metadata:e,link:t}=this.props,s=function(e){const t=e.trim().match(d);return t&&11===t[1].length?t[1]:null}(t),n=function(e){var t,s,n,a,i,r;const o=e.match(/[\\?&](t|time|start|time_continue)=([0-9]+h)?([0-9]+m)?([0-9]+s?)/);if(null==o||!o[0])return"";const l=null!==(t=null===(s=o[2])||void 0===s?void 0:s.match(/([0-9]+)h/))&&void 0!==t?t:null,c=null!==(n=null===(a=o[3])||void 0===a?void 0:a.match(/([0-9]+)m/))&&void 0!==n?n:null,d=null!==(i=null===(r=o[4])||void 0===r?void 0:r.match(/([0-9]+)s?/))&&void 0!==i?i:null;let h=0;return null!=l&&l[1]&&(h+=3600*parseInt(l[1],10)),null!=c&&c[1]&&(h+=60*parseInt(c[1],10)),null!=d&&d[1]&&(h+=parseInt(d[1],10)),"&start=".concat(h)}(t),a=c.createElement("h4",null,c.createElement("span",{className:"video-type"},"YouTube - "),c.createElement("span",{className:"video-title"},c.createElement("a",{href:this.props.link,target:"blank",rel:"noopener noreferrer"},(null==e?void 0:e.title)||"unknown")));let i;if(this.state.playing)i=c.createElement("iframe",{src:"https://www.youtube.com/embed/"+s+"?autoplay=1&autohide=1&border=0&wmode=opaque&fs=1&enablejsapi=1"+n,width:"480px",height:"360px",frameBorder:"0",allowFullScreen:!0});else{const t=null==e?void 0:e.images[0];i=c.createElement("div",{className:"embed-responsive video-div__placeholder"},c.createElement("div",{className:"video-thumbnail__container"},c.createElement(h.Z,{src:(null==t?void 0:t.secure_url)||(null==t?void 0:t.url)||""},(e=>c.createElement("img",{src:e,alt:"youtube video thumbnail",className:"video-thumbnail",loading:"lazy"}))),c.createElement("div",{className:"block"},c.createElement("span",{className:"play-button"},c.createElement("span",null)))))}return c.createElement("div",{className:"post__embed-container"},c.createElement("div",null,a,c.createElement("div",{className:"video-div embed-responsive-item",onClick:this.play},i)))}static isYoutubeLink(e){return Boolean(e.trim().match(d))}}p(u,"propTypes",{postId:l().string.isRequired,link:l().string.isRequired,show:l().bool.isRequired});const m=(0,n.connect)((function(e,t){const s=(0,i.iE)(e);return{currentChannelId:(0,a.gO)(e),googleDeveloperKey:s.GoogleDeveloperKey,hasImageProxy:"true"===s.HasImageProxy,metadata:(0,r.XH)(e,t.postId,t.link)}}))(u)},43832:(e,t,s)=>{"use strict";s.d(t,{c9:()=>l,Tw:()=>c,lJ:()=>d}),s(64765);var n=s(22222),a=s(8706),i=s(76279);function r(e){return e.entities.files.files}function o(e,t){return t&&e.entities.files.fileIdsByPostId[t]||[]}function l(e){return e.entities.files.filePublicLink}function c(){return(0,n.P1)(r,o,a.M,((e,t,s)=>{const n=t.map((t=>e[t])).filter((e=>Boolean(e)));return(0,i.Vi)(n,s)}))}const d=(0,n.P1)((function(e){return e.entities.files.filesFromSearch}),(e=>e.entities.search.fileResults),((e,t)=>t?t.map((t=>e[t])):[]))},27640:(e,t,s)=>{"use strict";function n(e){return e.views.system.websocketConnectionErrorCount}s.d(t,{S:()=>n})},28645:(e,t,s)=>{"use strict";function n(e){return e.views.textbox.shouldShowPreviewOnCreateComment}function a(e){return e.views.textbox.shouldShowPreviewOnCreatePost}function i(e){return e.views.textbox.shouldShowPreviewOnEditChannelHeaderModal}function r(e){return e.views.textbox.shouldShowPreviewOnEditPostModal}s.d(t,{xI:()=>n,QH:()=>a,a7:()=>i,fM:()=>r})},8142:(e,t,s)=>{"use strict";function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s.d(t,{Z:()=>a});class a{constructor(e){n(this,"action",void 0),n(this,"timer",void 0),this.action=e,this.timer=-1,this.fire=this.fire.bind(this)}fire(){this.action(),this.timer=-1}fireAfter(e){this.timer>=0&&window.clearTimeout(this.timer),this.timer=window.setTimeout(this.fire,e)}cancel(){window.clearTimeout(this.timer)}}},67705:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s(12266),a=s(31587);class i extends a.Z{link(e,t,s){let a=e;(0,n.UG)(e)||(a="http://".concat(a));let i='<a class="theme markdown__link" href="'.concat(a,'" target="_blank"');return t&&(i+=' title="'+t+'"'),i+=">".concat(s,"</a>"),i}}},14906:(e,t,s)=>{"use strict";s.d(t,{hC:()=>a,lw:()=>i,Kt:()=>o,fB:()=>l}),s(15306),s(73210);var n=s(85174);function a(e){if(-1===Array.from(e.types).indexOf("text/html"))return!1;const t=e.getData("text/html");if(!/<table/i.test(t))return!1;return function(e){const t=document.createElement("div");return t.innerHTML=e,t.querySelector("table")}(t)||!1}function i(e){return/\b(js|blob|diff)-./.test(e)}function r(e){return null==e.textContent?" ":e.textContent.trim().replace(/\|/g,"\\|").replace(/\n/g," ")}function o(e,t,s){const n=Array.from(e.querySelectorAll("tr")),a=n.shift(),i=a?(o=a,Array.from(o.querySelectorAll("td, th")).map(r)):[];var o;const l=i.map((()=>"---")),c="|".concat(i.join(" | "),"|\n|").concat(l.join(" | "),"|\n"),d=n.map((e=>"|".concat(Array.from(e.querySelectorAll("td")).map(r).join(" | "),"|"))).join("\n"),h="".concat(c).concat(d,"\n");return t?void 0===s?"".concat(t,"\n\n").concat(h):[t.slice(0,s),h,t.slice(s)].join("\n"):h}function l(e,t,s){const{firstPiece:a,lastPiece:i}=(0,n.Nn)(e,t),r=""===i?"":"\n",o=(""===a?"":"\n")+"```\n"+function(e){return-1!==Array.from(e.types).indexOf("text/plain")&&e.getData("text/plain")}(s)+"\n```"+r;return{formattedMessage:"".concat(a).concat(o).concat(i),formattedCodeBlock:o}}},59930:(e,t,s)=>{"use strict";s.d(t,{b2:()=>o});var n=s(92337),a=s(74935);n.vU.PAGE_NOT_FOUND;const i=["/mfa/setup","/mfa/confirm"],r=["","email","ldap"];function o(e,t,s,n){if("true"===t.MFA&&"true"===s.EnableMultifactorAuthentication&&"true"===s.EnforceMultifactorAuthentication&&-1===i.indexOf(n)){if((0,a.a_)(e)&&"true"!==s.GuestAccountsEnforceMultifactorAuthentication)return!1;if(e&&!e.mfa_active&&-1!==r.indexOf(e.auth_service))return!0}return!1}},24654:()=>{}}]);