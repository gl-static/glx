(self.webpackChunkchatting_webapp=self.webpackChunkchatting_webapp||[]).push([[120],{71120:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var r=a(37703),s=a(14890),l=a(18493),o=a(42560),i=a(74935),n=a(45697),p=a.n(n),c=(a(33948),a(60285),a(64765),a(4723),a(67294)),d=a(5977),m=a(16406),u=a(96512),h=a(44012),f=a(85163),w=a(92337),E=a(82251),g=a(927);function _(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class b extends c.PureComponent{constructor(e){super(e),_(this,"submit",(e=>{e.preventDefault();const t={},a=this.passwordInput.current.value;if(!a)return t.error=i._u("claim.oauth_to_email.enterPwd","Please enter a password."),void this.setState(t);const{valid:r,error:s}=i.eW(a,this.props.passwordConfig);if(!r&&s)return void this.setState({error:s});const l=this.passwordConfirmInput.current.value;if(!l||a!==l)return t.error=i._u("claim.oauth_to_email.pwdNotMatch","Passwords do not match."),void this.setState(t);t.error=null,this.setState(t),(0,f.wg)(this.props.currentType,this.props.email,a,(e=>{e.follow_link&&(window.location.href=e.follow_link)}),(e=>{this.setState({error:e.message})}))})),this.state={},this.passwordInput=c.createRef(),this.passwordConfirmInput=c.createRef()}render(){var e=null;this.state.error&&(e=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.error)));var t="form-group";e&&(t+=" has-error");const a="".concat(this.props.currentType===w.ZP.SAML_SERVICE?w.ZP.SAML_SERVICE.toUpperCase():i.cv(this.props.currentType)," SSO");return c.createElement("div",null,c.createElement("h3",null,c.createElement(h.Z,{id:"claim.oauth_to_email.title",defaultMessage:"Switch {type} Account to Email",values:{type:a}})),c.createElement("form",{onSubmit:this.submit},c.createElement("p",null,c.createElement(h.Z,{id:"claim.oauth_to_email.description",defaultMessage:"Upon changing your account type, you will only be able to login with your email and password."})),c.createElement("p",null,c.createElement(h.Z,{id:"claim.oauth_to_email.enterNewPwd",defaultMessage:"Enter a new password for your {site} email account",values:{site:this.props.siteName}})),c.createElement("div",{className:t},c.createElement(g.Z,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:(0,E.t)("claim.oauth_to_email.newPwd"),defaultMessage:"New Password"},spellCheck:"false"})),c.createElement("div",{className:t},c.createElement(g.Z,{type:"password",className:"form-control",name:"passwordconfirm",ref:this.passwordConfirmInput,placeholder:{id:(0,E.t)("claim.oauth_to_email.confirm"),defaultMessage:"Confirm Password"},spellCheck:"false"})),e,c.createElement("button",{type:"submit",className:"btn btn-primary"},c.createElement(h.Z,{id:"claim.oauth_to_email.switchTo",defaultMessage:"Switch {type} to Email and Password",values:{type:a}}))))}}_(b,"propTypes",{currentType:p().string,email:p().string,siteName:p().string,passwordConfig:p().object});var v=a(6125);function P(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class y extends c.PureComponent{constructor(e){super(e),P(this,"preSubmit",(e=>{e.preventDefault();var t={},a=this.passwordInput.current.value;if(!a)return t.error=i._u("claim.email_to_oauth.pwdError","Please enter your password."),void this.setState(t);this.setState({password:a}),t.error=null,this.setState(t),this.submit(this.props.email,a,"")})),P(this,"submit",((e,t,a)=>{(0,f.go)(e,t,a,this.props.newType,(e=>{e.follow_link&&(window.location.href=e.follow_link)}),(e=>{this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==e.server_error_id?this.setState({error:e.message,showMfa:!1}):this.setState({showMfa:!0})}))})),this.state={showMfa:!1,password:""},this.passwordInput=c.createRef()}render(){var e=null;this.state.error&&(e=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.error)));var t="form-group";e&&(t+=" has-error");const a=this.props.newType===w.ZP.SAML_SERVICE?w.ZP.SAML_SERVICE.toUpperCase():i.cv(this.props.newType),r="".concat(a," SSO");let s;return s=this.state.showMfa?c.createElement(v.Z,{loginId:this.props.email,password:this.state.password,submit:this.submit}):c.createElement("form",{onSubmit:this.preSubmit},c.createElement("p",null,c.createElement(h.Z,{id:"claim.email_to_oauth.ssoType",defaultMessage:"Upon claiming your account, you will only be able to login with {type} SSO",values:{type:a}})),c.createElement("p",null,c.createElement(h.Z,{id:"claim.email_to_oauth.ssoNote",defaultMessage:"You must already have a valid {type} account",values:{type:a}})),c.createElement("p",null,c.createElement(h.Z,{id:"claim.email_to_oauth.enterPwd",defaultMessage:"Enter the password for your {site} account",values:{site:this.props.siteName}})),c.createElement("div",{className:t},c.createElement(g.Z,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:(0,E.t)("claim.email_to_oauth.pwd"),defaultMessage:"Password"},spellCheck:"false"})),e,c.createElement("button",{type:"submit",className:"btn btn-primary"},c.createElement(h.Z,{id:"claim.email_to_oauth.switchTo",defaultMessage:"Switch Account to {uiType}",values:{uiType:r}}))),c.createElement("div",null,c.createElement("h3",null,c.createElement(h.Z,{id:"claim.email_to_oauth.title",defaultMessage:"Switch Email/Password Account to {uiType}",values:{uiType:r}})),s)}}function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}P(y,"propTypes",{newType:p().string,email:p().string,siteName:p().string}),a(23157);class S extends c.PureComponent{constructor(e){super(e),N(this,"preSubmit",(e=>{e.preventDefault();var t={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""};const a=this.ldapPasswordInput.current.value;if(!a)return t.ldapPasswordError=i._u("claim.ldap_to_email.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(t);const r=this.passwordInput.current.value;if(!r)return t.passwordError=i._u("claim.ldap_to_email.pwdError","Please enter your password."),void this.setState(t);const{valid:s,error:l}=i.eW(r,this.props.passwordConfig);if(!s&&l)return void this.setState({passwordError:l});const o=this.passwordConfirmInput.current.value;if(!o||r!==o)return t.confirmError=i._u("claim.ldap_to_email.pwdNotMatch","Passwords do not match."),void this.setState(t);t.password=r,t.ldapPassword=a,this.setState(t),this.submit(this.props.email,r,"",a)})),N(this,"submit",((e,t,a,r)=>{this.props.switchLdapToEmail(r||this.state.ldapPassword,this.props.email,t,a).then((({data:e,error:t})=>{e&&e.follow_link?window.location.href=e.follow_link:t&&(t.server_error_id.startsWith("model.user.is_valid.pwd")?this.setState({passwordError:t.message,showMfa:!1}):"ent.ldap.do_login.invalid_password.app_error"===t.server_error_id?this.setState({ldapPasswordError:t.message,showMfa:!1}):this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==t.server_error_id?this.setState({serverError:t.message,showMfa:!1}):this.setState({showMfa:!0}))}))})),this.state={passwordError:"",confirmError:"",ldapPasswordError:"",serverError:""},this.ldapPasswordInput=c.createRef(),this.passwordInput=c.createRef(),this.passwordConfirmInput=c.createRef()}render(){let e=null,t="form-group";this.state.serverError&&(e=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.serverError)),t+=" has-error");let a=null,r="form-group";this.state.passwordError&&(a=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.passwordError)),r+=" has-error");let s=null,l="form-group";this.state.ldapPasswordError&&(s=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),l+=" has-error");let o=null,n="form-group";this.state.confirmError&&(o=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.confirmError)),n+=" has-error");const p=i._u("claim.ldap_to_email.ldapPwd","AD/LDAP Password");let d;return d=this.state.showMfa?c.createElement(v.Z,{loginId:this.props.email,password:this.state.password,submit:this.submit}):c.createElement("form",{onSubmit:this.preSubmit,className:t},c.createElement("p",null,c.createElement(h.Z,{id:"claim.ldap_to_email.email",defaultMessage:"After switching your authentication method, you will use {email} to login. Your AD/LDAP credentials will no longer allow access to Mattermost.",values:{email:this.props.email}})),c.createElement("p",null,c.createElement(h.Z,{id:"claim.ldap_to_email.enterLdapPwd",defaultMessage:"{ldapPassword}:",values:{ldapPassword:p}})),c.createElement("div",{className:l},c.createElement("input",{type:"password",className:"form-control",name:"ldapPassword",ref:this.ldapPasswordInput,placeholder:p,spellCheck:"false"})),s,c.createElement("p",null,c.createElement(h.Z,{id:"claim.ldap_to_email.enterPwd",defaultMessage:"New email login password:"})),c.createElement("div",{className:r},c.createElement(g.Z,{type:"password",className:"form-control",name:"password",ref:this.passwordInput,placeholder:{id:(0,E.t)("claim.ldap_to_email.pwd"),defaultMessage:"Password"},spellCheck:"false"})),a,c.createElement("div",{className:n},c.createElement(g.Z,{type:"password",className:"form-control",name:"passwordconfirm",ref:this.passwordConfirmInput,placeholder:{id:(0,E.t)("claim.ldap_to_email.confirm"),defaultMessage:"Confirm Password"},spellCheck:"false"})),o,c.createElement("button",{type:"submit",className:"btn btn-primary"},c.createElement(h.Z,{id:"claim.ldap_to_email.switchTo",defaultMessage:"Switch account to email/password"})),e),c.createElement("div",null,c.createElement("h3",null,c.createElement(h.Z,{id:"claim.ldap_to_email.title",defaultMessage:"Switch AD/LDAP Account to Email/Password"})),d)}}function M(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}N(S,"propTypes",{email:p().string,passwordConfig:p().object,switchLdapToEmail:p().func.isRequired}),a(73210);class C extends c.PureComponent{constructor(e){super(e),M(this,"preSubmit",(e=>{e.preventDefault();var t={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:""};const a=this.emailPasswordInput.current&&this.emailPasswordInput.current.value;if(!a)return t.passwordError=i._u("claim.email_to_ldap.pwdError","Please enter your password."),void this.setState(t);const r=this.ldapIdInput.current&&this.ldapIdInput.current.value.trim();if(!r)return t.ldapError=i._u("claim.email_to_ldap.ldapIdError","Please enter your AD/LDAP ID."),void this.setState(t);const s=this.ldapPasswordInput.current&&this.ldapPasswordInput.current.value;if(!s)return t.ldapPasswordError=i._u("claim.email_to_ldap.ldapPasswordError","Please enter your AD/LDAP password."),void this.setState(t);t.password=a,t.ldapId=r,t.ldapPassword=s,this.setState(t),this.submit(this.props.email,a,"",r,s)})),M(this,"submit",((e,t,a,r,s)=>{(0,f.Is)(e,t,a,r||this.state.ldapId,s||this.state.ldapPassword,(e=>{e.follow_link&&(window.location.href=e.follow_link)}),(e=>{if(this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==e.server_error_id)switch(e.id){case"ent.ldap.do_login.user_not_registered.app_error":case"ent.ldap.do_login.user_filtered.app_error":case"ent.ldap.do_login.matched_to_many_users.app_error":this.setState({ldapError:e.message,showMfa:!1});break;case"ent.ldap.do_login.invalid_password.app_error":this.setState({ldapPasswordError:e.message,showMfa:!1});break;case"api.user.check_user_password.invalid.app_error":this.setState({passwordError:e.message,showMfa:!1});break;default:this.setState({serverError:e.message,showMfa:!1})}else this.setState({showMfa:!0})}))})),this.state={passwordError:"",ldapError:"",ldapPasswordError:"",serverError:"",showMfa:!1},this.emailPasswordInput=c.createRef(),this.ldapIdInput=c.createRef(),this.ldapPasswordInput=c.createRef()}render(){let e=null,t="form-group";this.state.serverError&&(e=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.serverError)),t+=" has-error");let a=null,r="form-group";this.state.passwordError&&(a=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.passwordError)),r+=" has-error");let s=null,l="form-group";this.state.ldapError&&(s=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.ldapError)),l+=" has-error");let o,n,p=null,d="form-group";return this.state.ldapPasswordError&&(p=c.createElement("div",{className:"form-group has-error"},c.createElement("label",{className:"control-label"},this.state.ldapPasswordError)),d+=" has-error"),o=this.props.ldapLoginFieldName?this.props.ldapLoginFieldName:i._u("claim.email_to_ldap.ldapId","AD/LDAP ID"),n=this.state.showMfa?c.createElement(v.Z,{loginId:this.props.email,password:this.state.password,submit:this.submit}):c.createElement("form",{onSubmit:this.preSubmit,className:t},c.createElement("p",null,c.createElement(h.Z,{id:"claim.email_to_ldap.ssoType",defaultMessage:"Upon claiming your account, you will only be able to login with AD/LDAP"})),c.createElement("p",null,c.createElement(h.Z,{id:"claim.email_to_ldap.ssoNote",defaultMessage:"You must already have a valid AD/LDAP account"})),c.createElement("p",null,c.createElement(h.Z,{id:"claim.email_to_ldap.enterPwd",defaultMessage:"Enter the password for your {site} email account",values:{site:this.props.siteName}})),c.createElement("input",{type:"text",style:I.usernameInput,name:"fakeusernameremembered"}),c.createElement("div",{className:r},c.createElement(g.Z,{type:"password",className:"form-control",name:"emailPassword",ref:this.emailPasswordInput,autoComplete:"off",placeholder:{id:(0,E.t)("claim.email_to_ldap.pwd"),defaultMessage:"Password"},spellCheck:"false"})),a,c.createElement("p",null,c.createElement(h.Z,{id:"claim.email_to_ldap.enterLdapPwd",defaultMessage:"Enter the ID and password for your AD/LDAP account"})),c.createElement("div",{className:l},c.createElement("input",{type:"text",className:"form-control",name:"ldapId",ref:this.ldapIdInput,autoComplete:"off",placeholder:o,spellCheck:"false"})),s,c.createElement("div",{className:d},c.createElement(g.Z,{type:"password",className:"form-control",name:"ldapPassword",ref:this.ldapPasswordInput,autoComplete:"off",placeholder:{id:(0,E.t)("claim.email_to_ldap.ldapPwd"),defaultMessage:"AD/LDAP Password"},spellCheck:"false"})),p,c.createElement("button",{type:"submit",className:"btn btn-primary"},c.createElement(h.Z,{id:"claim.email_to_ldap.switchTo",defaultMessage:"Switch Account to AD/LDAP"})),e),c.createElement("div",null,c.createElement("h3",null,c.createElement(h.Z,{id:"claim.email_to_ldap.title",defaultMessage:"Switch Email/Password Account to AD/LDAP"})),n)}}M(C,"propTypes",{email:p().string,siteName:p().string,ldapLoginFieldName:p().string});const I={usernameInput:{display:"none"}};class k extends c.PureComponent{render(){const e=new URLSearchParams(this.props.location.search).get("email"),t=new URLSearchParams(this.props.location.search).get("new_type"),a=new URLSearchParams(this.props.location.search).get("old_type");return c.createElement("div",null,c.createElement(u.Z,null),c.createElement("div",{className:"col-sm-12"},c.createElement("div",{className:"signup-team__container"},c.createElement("img",{alt:"signup logo",className:"signup-team-logo",src:m.Z,loading:"lazy"}),c.createElement("div",{id:"claim"},c.createElement(d.rs,null,c.createElement(d.AW,{path:"".concat(this.props.match.url,"/oauth_to_email"),render:()=>c.createElement(b,{currentType:a,email:e,siteName:this.props.siteName,passwordConfig:this.props.passwordConfig})}),c.createElement(d.AW,{path:"".concat(this.props.match.url,"/email_to_oauth"),render:()=>c.createElement(y,{newType:t,email:e,siteName:this.props.siteName})}),c.createElement(d.AW,{path:"".concat(this.props.match.url,"/ldap_to_email"),render:()=>c.createElement(S,{email:e,passwordConfig:this.props.passwordConfig,switchLdapToEmail:this.props.actions.switchLdapToEmail})}),c.createElement(d.AW,{path:"".concat(this.props.match.url,"/email_to_ldap"),render:()=>c.createElement(C,{email:e,siteName:this.props.siteName,ldapLoginFieldName:this.props.ldapLoginFieldName})}))))))}}var Z,A,L;Z=k,A="propTypes",L={location:p().shape({search:p().string.isRequired}).isRequired,siteName:p().string,ldapLoginFieldName:p().string,passwordConfig:p().shape({minimumLength:p().number.isRequired,requireLowercase:p().bool.isRequired,requireUppercase:p().bool.isRequired,requireNumber:p().bool.isRequired,requireSymbol:p().bool.isRequired}),match:p().shape({url:p().string.isRequired}).isRequired,actions:p().shape({switchLdapToEmail:p().func.isRequired}).isRequired},A in Z?Object.defineProperty(Z,A,{value:L,enumerable:!0,configurable:!0,writable:!0}):Z[A]=L;const T=(0,r.connect)((function(e){const t=(0,o.iE)(e);return{siteName:t.SiteName,ldapLoginFieldName:t.LdapLoginFieldName,passwordConfig:(0,i.lD)(t)}}),(function(e){return{actions:(0,s.bindActionCreators)({switchLdapToEmail:l.jh},e)}}))(k)},96512:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var r=a(45697),s=a.n(r),l=(a(39714),a(67294)),o=a(44012),i=a(73727);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class p extends l.PureComponent{render(){return l.createElement("div",{id:"back_button",className:"signup-header"},l.createElement(i.Link,{onClick:this.props.onClick,to:this.props.url},l.createElement(o.Z,{id:"generic_icons.back",defaultMessage:"Back Icon"},(e=>l.createElement("span",{id:"back_button_icon",className:"fa fa-1x fa-angle-left",title:e.toString()}))),l.createElement(o.Z,{id:"web.header.back",defaultMessage:"Back"})))}}n(p,"propTypes",{url:s().string,onClick:s().func}),n(p,"defaultProps",{url:"/"})},6125:(e,t,a)=>{"use strict";a.d(t,{Z:()=>m}),a(15306),a(73210);var r=a(45697),s=a.n(r),l=a(67294),o=a(44012),i=a(74935),n=a(82251),p=a(58657),c=a(927);function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class m extends l.PureComponent{constructor(e){super(e),d(this,"handleChange",(e=>{e.preventDefault();const t=e.target.value.trim().replace(/\s/g,"");t!==this.state.token&&this.setState({token:t})})),d(this,"handleSubmit",(e=>{e.preventDefault();this.setState({serverError:"",saving:!0}),this.props.submit(this.props.loginId.toLowerCase(),this.props.password,this.state.token)})),this.state={saving:!1,token:"",serverError:""}}render(){let e,t="";return this.state.serverError&&(e=l.createElement("label",{className:"control-label"},this.state.serverError),t=" has-error"),l.createElement("form",{onSubmit:this.handleSubmit},l.createElement("div",{className:"signup__email-container"},l.createElement("p",null,l.createElement(o.Z,{id:"login_mfa.enterToken",defaultMessage:"To complete the sign in process, please enter a token from your smartphone's authenticator"})),l.createElement("div",{className:"form-group"+t},e),l.createElement("div",{className:"form-group"+t},l.createElement(c.Z,{type:"text",className:"form-control",name:"token",placeholder:{id:(0,n.t)("login_mfa.token"),defaultMessage:"MFA Token"},spellCheck:"false",autoComplete:"off",autoFocus:!0,onChange:this.handleChange})),l.createElement("div",{className:"form-group"},l.createElement(p.Z,{saving:this.state.saving,disabled:this.state.saving,onClick:this.handleSubmit,defaultMessage:(0,i._u)("login_mfa.submit","Submit"),savingMessage:(0,i._u)("login_mfa.submitting","Submitting...")}))))}}d(m,"propTypes",{loginId:s().string.isRequired,password:s().string.isRequired,submit:s().func.isRequired})},58657:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var r=a(45697),s=a.n(r),l=(a(19601),a(67294)),o=a(44012),i=a(21843);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class p extends l.PureComponent{render(){const e=this.props,{saving:t,disabled:a,savingMessage:r,defaultMessage:s,btnClass:o,extraClasses:n}=e,p=function(e,t){if(null==e)return{};var a,r,s=function(e,t){if(null==e)return{};var a,r,s={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}(e,["saving","disabled","savingMessage","defaultMessage","btnClass","extraClasses"]);let c="save-button btn";return a&&!t||(c+=" "+o),n&&(c+=" "+n),l.createElement("button",Object.assign({type:"submit","data-testid":"saveSetting",id:"saveSetting",className:c,disabled:a},p),l.createElement(i.Z,{loading:t,text:r},l.createElement("span",null,s)))}}n(p,"propTypes",{saving:s().bool.isRequired,disabled:s().bool,id:s().string,onClick:s().func,savingMessage:s().node,defaultMessage:s().node,btnClass:s().string,extraClasses:s().string}),n(p,"defaultProps",{btnClass:"btn-primary",defaultMessage:l.createElement(o.Z,{id:"save_button.save",defaultMessage:"Save"}),disabled:!1,extraClasses:"",savingMessage:l.createElement(o.Z,{id:"save_button.saving",defaultMessage:"Saving"})})},16406:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});const r=a.p+"files/7c11bcdd056cc8e521c9a6047942faaa.png"}}]);